<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    <!--
  @font-face {
    font-family: 'Segoe UI';
    src: local('Segoe UI');
    unicode-range: U+0-1FFF, U+3000-1EFFF, U+1F???, U+20000-10FFFF;
  }
  @font-face {
    font-family: 'Segoe UI';
    src: local('Segoe UI Emoji');
    unicode-range: U+2???, U+1F???;
  }
  *, *::before, *::after {box-sizing: border-box; transition-duration: 0.2s;}
  body.collapsing {transition: none;}
  body {font: 11pt 'Segoe UI',Verdana,Arial,Helvetica,sans-serif; background: white; color: black; margin: 10px;}
  body.dark {color: #ddd; background: #111;}
  body.collapsing > * {display: none;}
  body.refpage {font-size: 10pt;}
  a {text-decoration-style: dotted;}
  a:link {color: blue;} body.dark a:link {color: #99f;}
  a:visited {color: purple;} body.dark a:visited {color: #f6f;}
  a:active {color: red;} body.dark a:active {color: #f99;}
  tt, var, code, pre, .code, dl.codedd > dd, dl.codedt > dt {font-family: 'Lucida Console','Droid Sans Mono','Bistream Vera Sans Mono',monospace;}
  .article {padding: 0 10px; margin: -10px -10px 0 -10px;}
  .topspace {margin-top: 0.5em;}
  .faded {opacity: 0.6;}
  /* Breadcrumb navigation */
  .nav {margin: 0 -10px; padding: 0; list-style: none; position: relative; font-size: 20px; height: 2em;}
  .nav *:focus {outline: none;}
  body.refpage .nav {font-size: 15px; margin-top: -10px;}
  .nav *::before, .nav *::after {transition: color 0.2s, background-color 0.2s, border-color 0.2s;}
  .nav li {padding: 0 0 0 5px; list-style: none; display: inline-block; position: relative; height: 2em; margin: 0 0.5em; background: #ddf; vertical-align: top;}
  body.dark .nav li {background: #06c;}
  .nav li:first-child {padding-left: 10px; margin-left: 0;}
  .nav li:last-child {font-weight: bold;}
  .nav a {color: black; text-decoration: none; height: 2em; line-height: 34px; display: inline-block;}
  body.dark .nav a {color: white;}
  body.refpage .nav a {line-height: 30px;}
  .nav li::before, .nav li::after {content: ""; position: absolute; top: 0; width: 0; height: 0;}
  .nav li:not(:first-child)::before {right: 100%; border: 1em solid #ddf; border-left-color: transparent; border-right-width: 0;}
  body.dark .nav li:not(:first-child)::before {border-color: #06c; border-left-color: transparent;}
  .nav li::after {left: 100%; border: 1em solid transparent; border-left-color: #ddf; border-right-width: 0;}
  body.dark .nav li::after {border-left-color: #06c;}
  .nav li:hover {background: #99f;}
  body.dark .nav li:hover {background: #0080ff;}
  .nav li:hover:not(:first-child)::before {right: 100%; border: 1em solid #99f; border-left-color: transparent; border-right-width: 0;}
  body.dark .nav li:hover:not(:first-child)::before {border-color: #0080ff; border-left-color: transparent;}
  .nav li:hover::after {left: 100%; border: 1em solid transparent; border-left-color: #99f; border-right-width: 0;}
  body.dark .nav li:hover::after {border-left-color: #0080ff;}
  body:not(.refpage) .nav li:first-child::before {width: 32px; height: 32px; background: url("reference.png"); background-repeat: no-repeat; background-position: 50% 50%; background-size: 32px; display: inline-block; vertical-align: middle; position: relative; top: auto; margin: 0 5px 0 -5px;}
  /* Headers */
  H1, H2 {text-align: left; padding: 0; margin: 0; clear: both;}
  H3 {font-size: 1.166667em; font-weight:bold; margin: 1em 0; clear: both;}
  .vcenter {vertical-align: middle;}
  .embed-image {color: black !important; background: white !important; padding: 10px;}  /* always white bg, even on dark theme */
  .embed-image > img {display: block; margin: 0 auto;}
  .figure {margin: 0 10%; font-size: 9pt; text-align: justify;}
  .figure img {display: block; margin: 10px auto;}
  .sidebar {float: right; position: relative; background: #f7f7f7; border: 1px solid #aaa; margin: 0 0 10px 10px; padding: 5px; width: 30%; font-size: 10pt; min-width: 250px; max-width: 60%; text-align: justify; box-shadow: 0 0 5px #ccc; min-width: min-content;}
  body.dark .sidebar {background: #333; border-color: #555;}
  .sidebar.embed-image {padding: 10px;}
  .sidebar.embed-image.image-only {width: unset; min-width: unset;}
  .sidebar *:first-child {margin-top: 0px;}
  .sidebar *:last-child {margin-bottom: 0px;}
  .sidebar + h3, .sidebar + h4, .sidebar + h3 + pre {clear: none;}
  .sidebar > h3, .sidebar > h4 {text-align: center;}
  pre + .sidebar {margin-top: 11pt;}
  .has-shadow {box-shadow: 0 0 5px #ccc;}
  body.dark .has-shadow {box-shadow: 0 0 5px #333;}
  /* Tables */
  table {border-collapse: collapse; border-spacing: 1em 0;}
  td, th {text-align: left; vertical-align: top; padding: 3px 0;}
  table td:not(:last-child),table th:not(:last-child) {padding-right: 1em;}
  table.nopadding {border-collapse: collapse;}
  table.nopadding td, table.nopadding th {padding: 0;}
  td.center, th.center {text-align: center;}
  th {border-bottom: 1px solid #555;}
  body.dark th {border-bottom-color: #aaa;}
  table.regex td:not(:last-child), table.overload td:not(:last-child), table.codefirst td:first-child {white-space: nowrap; font-family: 'Lucida Console','Droid Sans Mono','Bistream Vera Sans Mono',monospace;}
	table.regex td:not(:last-child) i, table.codefirst td:first-child i, pre i, .code * i, .codedd * i {font-family: 'Segoe UI',Verdana,Arial,Helvetica,sans-serif;}
  table.withborder {box-shadow: 0 0 5px #ccc;}
  body.dark table.widthborder {box-shadow: 0 0 5px #333;}
  table.withborder td, table.withborder th {padding:3px; border: 1px solid #555;}
  body.dark table.withborder td, body.dark table.withborder th {border-color: #aaa;}
  table.filters tbody:nth-child(2n) {background: #f7f7f7;}
  body.dark table.filters tbody:nth-child(2n) {background: #333;}
  table.api td:first-child, table.api td:nth-child(2) {white-space: nowrap; font-family: 'Lucida Console','Droid Sans Mono','Bistream Vera Sans Mono',monospace; padding-right: 1em;}
  table.api th:not(:last-child) {padding-right: 1em;}
  .macro_info {max-width: 75%; margin: 0 auto; text-align: center;}
  .macro_info td, .macro_info th {padding: 3px 10px;}
  .macro_head, .macro_subhead {background: #ddf;}
  body.dark .macro_head, body.dark .macro_subhead {background: #06c;}
  /* Legend */
  .legend {display: grid; margin: 1em; grid-template-columns: repeat(3, minmax(10em,15em)); column-gap: 2em; row-gap: 5px;}
  .legend-item {min-width: 25%; white-space: nowrap;}
  .legend-icon {display: inline-block; text-align: center; width:40px; font-size: 20px; text-shadow: 1px 0 0 white, -1px 0 0 white, 0 1px 0 white, 0 -1px 0 white;}
  /* Misc. */
  select {font-size: inherit;}
  .nobr {white-space: nowrap;}
  /* Notes */
  .note {position: relative; background: #eee; border: 1px solid #aaa; padding: 15px 10px; overflow: visible; box-shadow: 0 0 5px #ccc; clear: both;}
  .note p:first-child {margin-top: 0;}
  .note p:last-child {margin-bottom: 0;}
  body.dark .note {background: #555;}
  .note::before {content: '\26a0\fe0f'; display: block; position: absolute; left: -8px; top: -13px; font-size: 20px; height: 30px;}
  body.dark .note::before {text-shadow: 0 0 5px white !important;}
  .sidebar::before {display: block; position: absolute; left: 0; top: 0; font-size: 20px; height: 30px;}
  .underhood::before {content: '\1f527\fe0f';}
  .underhood.sidebar p:first-child::before {content: 'Under the Hood'; display: block; font-size: 1.166667em; font-weight: bold; text-align: center; margin: 0 0 1em 0; clear: both;}
  .play::before {content: '\1f3b3\fe0f'; display: block; position: absolute; left: 0; top: 0; font-size: 20px; height: 30px;}
  .play p:first-child::before {content: 'Play Area'; display: block; font-size: 1.166667em; font-weight: bold; text-align: center; margin: 0 0 1em 0; clear: both;}
  .security {background: #f99; border-color: #c00000;}
  body.dark .security {background: #600;}
  .note.security::before {content: '\1f512\fe0f'; text-shadow: 0 0 3px #f00;}
  .performance, .tip {background: #cec; border-color: #008000;}
  body.dark .performance, body.dark .tip {background: #004000;}
  .note.performance::before, .note.tip::before {text-shadow: 0 0 3px #008000;}
  .note.performance::before {content: '\1f3c3\fe0f';}
  .note.tip::before {content: '\1f44d\fe0f';}
  .compatibility {background: #fffc99; border-color: #aaa400;}
  body.dark .compatibility {color: #ffd; background: #999400;}
  .note.compatibility::before {content: '\1f3db\fe0f'; text-shadow: 0 0 3px #ff0;}
  .didyouknow {background: #fc9; border-color: #ff8000;}
  body.dark .didyouknow {background: #a50;}
  .didyouknow::before {content: '\1f4a1\fe0f'; text-shadow: 0 0 3px #ff0;}
  .didyouknow.sidebar {padding-left: 30px;}
  .note.deprecated {color: #111; background: #c0b4a8;}
  body.dark .note.deprecated {color: #eee; background: #403c38;}
  .note.deprecated::before {content: '\1f995\fe0f'; text-shadow: 0 0 3px #808080;}
  .note:hover::before, .sidebar:hover::before {transform: scale(1.5);}
  /* DM blocks */
  pre.dmcode, pre.cpp, pre.client-command {background: #fcfcfc; border: 1px solid #aaa; padding: 15px 10px; overflow-x: auto; box-shadow: 0 0 5px #ccc; clear: both;}
  body.dark pre.dmcode, body.dark pre.cpp, pre.client-command {background: #222; border-color: #555; box-shadow: 0 0 5px #555;}
  h3 + pre.dmcode, h3 + pre.cpp, h3 + pre.client-command {position: relative; top: -1.5em; margin-bottom: -1.5em;}
  h3.dmcode, h3.cpp {position: relative; font-size: 1em; background: white; padding: 0 5px; left: 6px; font-style: italic; z-index: 1; display: table;}
  body.dark h3.dmcode, body.dark h3.cpp {background: #111;}
  .dmcode, .cpp {line-height: 1.35;}
  .dmcode a, .cpp a {text-decoration: none;}
  .DMk {color: #00f;} body.dark .DMk {color: #5af;}
  .DMs {color: #069;} body.dark .DMs {color: #0ac;}
  .DMc {color: #666;} body.dark .DMc {color: #999;}
  .DMn {color: #A00;} body.dark .DMn {color: #f66;}
  .DMi {color: #303;} body.dark .DMi {color: #e9e;}
  .DMpp {color: #008000;} body.dark .DMpp {color: #0a0;}
  /* BYOND version info */
  .byondver_tag {font: 8pt 'Segoe UI',Verdana,Arial,Helvetica,sans-serif; background: #ddf; display: inline-block; height: 20px; line-height: 0.833; padding: 5px; border-radius: 10px;}
  body.dark .byondver_tag {background: #06c;}
  .article > .byondver_tag {font-size: 11pt; background: transparent; display: block; position: absolute; top: 0; right: 0; height: auto; height: 24px; border-radius: 12px 0 0 12px; padding-left: 10px;}
  body.dark .article > .byondver_tag {background: transparent;}
  body.refpage > .byondver_tag {background: transparent; display: block; position: absolute; top: 0; right: 0; border-radius: 10px 0 0 10px; padding-left: 10px;}
  body.dark.refpage > .byondver_tag {background: transparent;}
  .deprecated, .article > .deprecated:not(.note), body.refpage > .deprecated:not(.note) {color: white; background: #666;}
  body.dark .deprecated:not(.note) {color: black; background: #999;}
      -->
  </style>
  <script src="prettyref.js"></script>
  <script><!--
    window.addEventListener('message', function(m){
      if(typeof m.data != 'string') return;
      if(m.data.match(/^nav:/)) window.location.hash = m.data.substr(4);
      if(m.data.match(/^search:/)) m.source.postMessage('search:'+JSON.stringify(search(m.data.substr(7))), '*');
      if(m.data.match(/^dark:/)) document.body.classList.toggle('dark',!!JSON.parse(m.data.substr(5)));
    });
  //--></script>
  <title>DM Reference</title>
</head>
<body class=collapsing><div id=refbody>
<script><!--
if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) document.body.classList.add('dark');
//--></script>

<h1>DM Reference</h1>
<p>

<p>View the live web reference <a href="http://www.byond.com/docs/ref">here</a>.

<hr>

<a name=/DM>
<h2>DM language details</h2>

<p>The DM (Dream Maker) language uses a syntax similar to C/C++ to build
networked multi-user worlds.  This reference and the accompanying guide
discuss the structure and function of DM.

<p>This reference is arranged in sections:

<ul>
<li><b>The DM language:</b> The majority of the reference; items in this section can have top-level entries.</li>
<li><b>Special notes:</b> Articles describing advanced features or concepts in more depth.</li>
<li><b>User interface skins:</b> Anything related to creating custom UIs for your world.</li>
<li><b>Appendix:</b> Additional reference informtation that might apply to multiple topics, e.g. regarding colors or HTML.</li>
</ul>

<p>You can filter the reference content by subject, which helps narrow down
anything you might be looking for.

<p>In various articles you may see notes or sidebar content:

<div class="legend">
<div class="legend-item"><span class="legend-icon">&#x26a0;&#xfe0f;</span>Important note</div>
<div class="legend-item"><span class="legend-icon">&#x1f512;&#xfe0f;</span>Security concerns</div>
<div class="legend-item"><span class="legend-icon">&#x1f3c3;&#xfe0f;</span>Performance tip</div>
<div class="legend-item"><span class="legend-icon">&#x1f44d;&#xfe0f;</span>Rule of thumb</div>
<div class="legend-item"><span class="legend-icon">&#x1f3db;&#xfe0f;</span>Compatibility</div>
<div class="legend-item"><span class="legend-icon">&#x1f4a1;&#xfe0f;</span>Did you know?</div>
<div class="legend-item"><span class="legend-icon">&#x1f527;&#xfe0f;</span>Under the hood</div>
<div class="legend-item"><span class="legend-icon">&#x1f995;&#xfe0f;</span>Deprecated feature</div>
<div class="legend-item"><span class="legend-icon">&#x1f3b3;&#xfe0f;</span>Play area</div>
</div>

<hr>

<a name=/DM/cache>
<h2>cache</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define/FILE_DIR>FILE_DIR definition</a>
<dd><a href=#/world/var/cache_lifespan>cache_lifespan var (world)</a>
<dd><a href=#/proc/fcopy_rsc>fcopy_rsc proc</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/DM/icon>icons</a>
<dd><a href=#/DM/sound>sounds</a>
</dl>

<p>Files specified in single quotes are loaded (at compile time) into the
world cache file (ending in <code>.rsc</code>).  These are referred to as
resource files.  At runtime these files are downloaded by players into their
<code>byond.rsc</code> file for future use.  With the appropriate verbs or
through savefiles, players may also upload files into the world cache.

<p>If a resource file is not used for a long time, it will be automatically
removed from the cache file to save space.  If a cache file gets too bulky,
however, you may manually delete it and start from scratch.

<p>To make compilation faster and to make it easier to distribute code, the
compiler will use an existing cache file if possible.  That means you could
compile up a world, and send people the <code>.dm</code> and
<code>.rsc</code> files without any need to package all the individual
resource files.  It is also possible to include additional supplementary
<code>.rsc</code> files by using the <code>#include</code> statement.

<hr>

<a name=/DM/comment>
<h2>comment</h2>

<p>Comments may be used to explain code.  They can also be used to turn off a
line or block of code.  All text inside a comment is ignored by the compiler.

<p>The single line comment begins with <code>//</code> and runs to the end of
the line.

<p>The multi-line comment begins with <code>/*</code> and runs until
<code>*/</code>.

<p>Multi-line comments may be nested.

<h3>Example:</h3>
<xmp>
  // single line comment
  /*
     multi-line comment
  */
</xmp>

<hr>

<a name=/DM/garbage>
<h2>garbage collection</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/del>del proc</a>
<dd><a href=#/world>world</a>
<dd><a href=#/proc/refcount>refcount proc</a>
</dl>

<p>At runtime, data objects are garbage collected.  That means data which
is no longer in use gets automatically deleted to free up system memory.
This applies to text strings, lists, savefiles, datum objects, and so on.

<p>The garbage collector works by using an efficient reference counting
system.  Once an item is no longer referenced by any variable, it gets
deleted.  For the most part, that frees you from having to think about memory
allocation, which is wonderful, especially in the case of text strings, which
tend to be allocated on the fly all over the place.

<p>There are a couple provisos that you should note.  One is that circular
references will never be deleted by the garbage collector.  By <em>circular
reference</em>, I mean a pair of objects with variables that point to each
other, or even an object with a variable that points to itself.  In rare
cases, you may even depend on this behavior.  When you are done with such
objects, you should either null out the circular reference, or you should
forcibly destroy each object with the <code>del</code> instruction.

<div class="sidebar underhood">
<p>This is a quick list of things that count as references to an object:
<ul>
<li>Stored in a var</li>
<li>An item in a <a href=#/list>list</a>, or <a href=#/list/associations>associated</a> with a list item</li>
<li>Has a <a class=code href=#/datum/var/tag>tag</a>
<li>Is on the map (always true for <a href=#/turf>turfs</a>)</li>
<li>Inside another atom's <a class=code href=#/atom/var/contents>contents</a></li>
<li>Inside an atom's <a class=code href=#/atom/var/vis_contents>vis_contents</a></li>
<li>A temporary value in a still-running proc</li>
<li>Is a <a href=#/mob>mob</a> with a <a class=code href=#/mob/var/key>key</a></li>
<li>Is an <a href=#/image>image object</a> attached to an atom</li>
</ul>
<p><tt>del()</tt> will try to clear out the most obvious possible references
first, and bail out when it's done, but if there are still references it will
search everywhere for any references that remain.
</div>

<p>An object with running or sleeping procs is referenced by the
<code>src</code> variable of those procs and will therefore not be thrown out.

<p>Another note is that the <code>world.contents</code> list does not count as
a reference.  Otherwise, <tt>/mob</tt> and <tt>/obj</tt> objects would never
be deleted, which is not the case.  Note that objects which are contained by
another object or which contain objects themselves <em>are</em> referenced and
will not be deleted.  That means an object must be at <code>loc=null</code>
with no contents and, of course, no other references anywhere in order to get
deleted by the garbage collector.

<p>Mobs with a non-empty <tt>key</tt> and all objects with non-empty
<tt>tag</tt> are also immortal.

<p>Turfs and areas do not currently get garbage collected.

<p>When the world shuts down, all objects are destroyed, whether they are
referenced or not.  You don't have to worry about system memory getting
consumed by persistent objects.  That doesn't happen.

<p>In general, people who do not like reference counting garbage collection
should be happy that DM provides a <code>del</code> instruction, allowing you
to take charge and delete things whether they are referenced or not.  Another
nicety is that this automatically nulls out any existing references to the
object, so you don't end up with dangling references to a deleted object,
which can otherwise be a great source of instability and mysterious bugs.

<hr>

<a name=/DM/icon>
<h2>icons</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define/FILE_DIR>FILE_DIR definition</a>
<dd><a href=#/DM/cache>cache</a>
<dd><a href=#/proc/flick>flick proc</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/atom/var/icon_state>icon_state var (atom)</a>
<dd><a href=#/image>image objects</a>
</dl>

<p>An icon file may be referenced by putting single quotes around the
filename.  The file extension determines the type of icon.  Currently
supported icon types are <code>.dmi</code>, <code>.bmp</code>, <code>.png</code>,
<code>.jpg</code>, and <code>.gif</code>.  To create dmi icons, use the Dream
Maker icon editor.  This allows you to make animations, 4 or 8 directional icons,
and icons with different states (such as "live" and "dead").

<h3>Example:</h3>
<xmp>
  mob
    icon = 'monster.dmi'
</xmp>

<p>You can also load icons into memory at run-time and manipulate the
graphical data to produce new icons dynamically.  This is done by creating an
<a href=#/icon>/icon</a> object.

<hr>

<a name=/DM/icon/arithmetic>
<h2>icon arithmetic</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/icon>icon proc</a>
<dd><a href=#/proc/icon_states>icon_states proc</a>
<dd><a href=#/DM/icon>icons</a>
<dd><a href=#/proc/rgb>rgb proc</a>
<dd><a href=#/proc/turn/icon>turn proc (applied to an icon)</a>
<dd><a href=#/icon>icon object</a>
</dl>

<p class=performance>Note: The following "arithmetical" methods of icon
manipulation are being phased out in favor of the
<a class=code href=#/icon> /icon</a> object, which can be directly manipulated
and which provides a wider variety of operations. Many of those in turn have
been obviated by the <a class=code href=#/atom/var/color>color</a> and
<a class=code href=#/atom/var/transform>transform</a> vars.

<p>There are several ways in which icons can be manipulated at runtime.
They can be rotated, added together, and the colors components may be
altered.

<p>One purpose for such operations is to make players look different.  Other
interesting uses (and abuses) will undoubtedly follow.

<h3>Addition and Subtraction</h3>

<p>The result of adding two icons is an arithmetic combination of the color
components of each individual pixel.  At positions where either icon is
transparent, the result is also transparent.  Subtraction, instead of
increasing the intensity, decreases it by the amount in each pixel of the
icon being subtracted.

<p>Suppose you wanted to add together different bodies and heads.  You could
do that by making a few of each type with black backgrounds.  When these add
together, the black contributes nothing but prevents pixels in the other
icon from getting clipped.

<h3>Example:</h3>
<xmp>
mob/verb
   addicon(I as icon)
      icon += I
   subicon(I as icon)
      icon -= I
</xmp>

<p>If you need to add the same color to every pixel, you can do so using a
color value.  Color values have the same format as in HTML: "#RRGGBB" with
two hexadecimal digits for each color component.  That gives you a range in
color from 0 to FF (which is 255 in decimal).

<p>You can also specify a color value as "#RGB".  The single digit is
automatically repeated, so "#F00" is the same as "#FF0000", which is bright
red.  For certain pre-defined color values, you can also specify a name,
such as "red".  See <a href=#/{{appendix}}/html-colors>HTML colors</a> for a
list of color names.

<p>If you prefer base 10, you can create color values with the rgb(R,G,B)
instruction.  Each parameter is in the range 0 to 255.

<h3>Multiplication</h3>

<p>To increase (or decrease) the intensity of an icon multiplicatively, you
can use the '<code>*</code>' operator.

<h3>Example:</h3>
<xmp>
mob/verb/multicon(factor as num)
   icon *= factor
</xmp>

<hr>

<a name=/DM/mouse toc="mouse handling">
<h2>mouse handling</h2>

<p>Various mouse actions may be handled by defining procedures either on the
client object or on the atomic object being manipulated.  Any of the following
procedures may be defined:

<ul>
<li><a href=#/client/proc/MouseDown>MouseDown()</a>
<li><a href=#/client/proc/MouseUp>MouseUp()</a>
<li><a href=#/client/proc/MouseDrag>MouseDrag()</a>
<li><a href=#/client/proc/MouseDrop>MouseDrop()</a>
<li><a href=#/client/proc/MouseEntered>MouseEntered()</a>
<li><a href=#/client/proc/MouseExited>MouseExited()</a>
<li><a href=#/client/proc/MouseMove>MouseMove</a>
<li><a href=#/client/proc/MouseWheel>MouseWheel</a>
<li><a href=#/client/proc/Click>Click()</a>
<li><a href=#/client/proc/DblClick>DblClick()</a>
</ul>

<p>In general, define only the procedures you need, because extra
communication overhead may be avoided when the compiler detects that you do
not care about certain events.

<p>The arguments used in mouse procs generally follow one of these forms:

<dl>
<dt>For Click(), DblClick(), MouseDown(), MouseUp(), MouseEntered(), MouseExited(), and MouseMove():</dt>
  <dd>client/Click(object, location, control, params)<br/>
  atom/Click(location, control, params)</dd>
<dt>For MouseDrag() and MouseDrop():</dt>
  <dd>client/MouseDrag(src_object, over_object, src_location, over_location, src_control, over_control, params)<br/>
  atom/MouseDrag(over_object, src_location, over_location, src_control, over_control, params)</dd>
<dt>For MouseWheel():</dt>
  <dd>client/MouseWheel(object, delta_x, delta_y, location, control, params)<br/>
  atom/MouseWheel(delta_x, delta_y, location, control, params)</dd>
</dl>

<p>The <tt>location</tt> argument varies with the type of control. For the map, it
will be the turf where the mouse action happened. For info controls (statpanels),
it will be the name of the statpanel where the action happened. For grid controls,
it will be the cell where the action happened. For others controls it may vary,
but most will leave this blank.

<p>The <tt>control</tt> argument is the ID of the skin control where the
action happened, such as <tt>"mappane.map"</tt> or <tt>"mainwindow.banner"</tt>.

<p>The <tt>params</tt> argument is text, and can be converted to a list using
<a class=code href=#/proc/params2list>params2list()</a>. It may contain any of
the following properties, which will only be set if they are used:

<ul>
<li>icon-x, icon-y: Pixel coordinates within the icon, in the icon's coordinate space
<li>screen-loc: Pixel coordinates in screen_loc format ("[tile_x]:[pixel_x],[tile_y]:[pixel_y]")
<li>left, middle, right: Mouse buttons pressed, held, or released in this action (see compatibility note below)
<li byondver=514>button: Mouse button pressed or released in this action (see compatibility note below)
<li>ctrl, shift, alt: Keys held down during the mouse action
<li>drag-cell, drop-cell: Cells involved if using a Grid control
<li>drag: The button used for dragging (only sent for unrelated mouse up/down messages during a drag)
<li>link: If the mouse is over a link in maptext, or this event is related to clicking such a link
<li>vis-x, vis-y: Pixel coordinates relative to the icon's position on screen
</ul>

<p>The icon-x/y coordinates are integers, and try to point to the actual
pixel in the icon before any atom transforms are done; i.e. if the icon
were scaled up to 3 times its size using the transform var, then a
3&times;3 region of pixels would all have the same icon-x/y values. The lower
left pixel of the icon is 1,1. The vis-x/y parameters are screen-based, and
their origin (1,1) is wherever the lower left corner of the icon is rendered.

<p>Note: vis-x/y will not be included in the parameters if they are the same
as icon-x/y.

<p>If the mouse is over an overlay, icon-x/y and vis-x/y are relative to the
parent object, not the overlay icon itself, so it's possible to have value
outside of the normal range of 1,1 to [width],[height].

<p>The mouse pointer may be customized as well.  The following variables all
deal with the appearance of the pointer.  They do not control what actions may
be taken by the user, but they provide hints to the user about what actions
may work.

<ul>
<li><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon</a>
<li><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<li><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<li><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<li><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone</a>
<li><a href=#/atom/var/mouse_opacity>mouse_opacity</a>
</ul>

<p>When selecting a mouse pointer, you may provide your own custom icon or use
one of the <a href=#/DM/mouse/pointers>built-in pointers</a>.

<p class=compatibility>Note: Older games compiled prior to BYOND 4.0 had a
different format for the <tt>MouseDown()</tt> and <tt>MouseUp()</tt> procs.
These used <tt>icon_x</tt> and <tt>icon_y</tt> as arguments, but
<tt>control</tt> and <tt>params</tt> have replaced them.

<p class=compatibility>Note: Games compiled before version 514 did not have
the <tt>button</tt> parameter, so they handled the <tt>left</tt>,
<tt>middle</tt>, and <tt>right</tt> parameters differently. In old versions,
only the button used in the action (left, middle, right) was included as a
parameter; now all buttons being held or changed are included, and
<tt>button</tt> is the mouse button that changed.

<hr>

<a name=/DM/mouse/pointers>
<h2>mouse pointers</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/mouse>mouse handling</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
</dl>

<p>The following mouse pointers are built-in and may be assigned to any of the
mouse pointer variables.  Of course, you can also define your own custom mouse
pointers using an icon file.

<dl>
<dt>MOUSE_INACTIVE_POINTER (0)
<dt>MOUSE_ACTIVE_POINTER (1)
<dt>MOUSE_DRAG_POINTER
<dd>Same as mouse_drag_pointer = MOUSE_ACTIVE_POINTER.
<dt>MOUSE_DROP_POINTER
<dd>Same as mouse_drop_pointer = MOUSE_ACTIVE_POINTER.
<dt>MOUSE_ARROW_POINTER
<dd>Same as mouse_over_pointer = MOUSE_INACTIVE_POINTER.
<dt>MOUSE_CROSSHAIRS_POINTER
<dd>Same as mouse_over_pointer = MOUSE_ACTIVE_POINTER.
<dt>MOUSE_HAND_POINTER
</dl>

<hr>

<a name=/DM/null>
<h2>null</h2>

<p>Variables that are not initialized have the value null.  This value is
distinct from 0 and "".  If you compare it to these, using the <code>==</code>
operator, it is not equal.  However, in a numeric context (like a mathematical
operation), null evaluates to 0 and in a text context (like insertion into a
text expression), null evaluates to "".  In a logical expression, null, 0, and
"" evaluate to false and all other values are true.

<p>In an embedded text expression, null behaves like "".  That means, if you
are expecting a variable to display a 0, you should explicitly initialize it
to 0 rather than leaving it as null.

<hr>

<a name=/DM/preprocessor>
<h2>preprocessor</h2>

<p>The preprocessor performs various transformations on source code as the DM
compiler reads the file.  It may be used to define macros&mdash;that is words
which are replaced by other fragments of code.  It is also possible to insert
other source code files and to conditionally compile or not compile sections
of code.

<p>Preprocessor commands are called directives.  They are placed on a line by
themselves and always begin with a hash symbol <code>#</code>.  The
preprocessor directives recognized by DM are the same as standard C compilers:

<code><pre>
<a href=#/DM/preprocessor/define>#define</a>
<a href=#/DM/preprocessor/if>#if</a>
<a href=#/DM/preprocessor/elif>#elif</a>
<a href=#/DM/preprocessor/ifdef>#ifdef</a>
<a href=#/DM/preprocessor/ifndef>#ifndef</a>
<a href=#/DM/preprocessor/else>#else</a>
<a href=#/DM/preprocessor/endif>#endif</a>
<a href=#/DM/preprocessor/include>#include</a>
<a href=#/DM/preprocessor/pragma>#pragma</a>
<a href=#/DM/preprocessor/error>#error</a>
<a href=#/DM/preprocessor/warn>#warn</a>
</pre></code>

<hr>

<a name=/DM/preprocessor/DM_BUILD>
<h2>DM_BUILD macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/byond_build>byond_build var (world)</a>
<dd><a href=#/client/var/byond_build>byond_build var (client)</a>
<dd><a href=#/DM/preprocessor/DM_VERSION>DM_VERSION macro</a>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<p>This macro indicates the minor version of the compiler, which is useful
during BYOND beta testing. More often, you will want to use the
<tt>DM_VERSION</tt> macro instead, which is the major version.

<hr>

<a name=/DM/preprocessor/DM_VERSION>
<h2>DM_VERSION macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/client/var/byond_version>byond_version var (client)</a>
<dd><a href=#/DM/preprocessor/DM_BUILD>DM_BUILD macro</a>
<dd><a href=#/DM/preprocessor>preprocessor</a>
<dd><a href=#/DM/preprocessor/pragma/compatibility>#pragma compatibility directive</a>
</dl>

<p>This macro indicates the version of the compiler.  This could be useful when
distributing code that uses new language features that would not compile in
older compilers.

<h3>Example:</h3>
<xmp>
#if DM_VERSION < 230
#error This compiler is too far out of date!
#endif
</xmp>

<p>If you use <tt>#pragma compatibility</tt>, it will alter the value of this
macro (but never higher than the actual version being compiled). In this way
you can alter your code's behavior based on the pragma.

<hr>

<a name=/DM/preprocessor/__FILE__>
<h2>__FILE__ macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ASSERT>ASSERT proc</a>
<dd><a href=#/DM/preprocessor/define/DEBUG>DEBUG definition</a>
<dd><a href=#/DM/preprocessor/__LINE__>__LINE__ macro</a>
<dd><a href=#/DM/preprocessor/__MAIN__>__MAIN__ macro</a>
<dd><a href=#/DM/preprocessor/__PROC__>__PROC__ macro</a>
<dd><a href=#/DM/preprocessor/__TYPE__>__TYPE__ macro</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<p>The __FILE__ macro expands to a string containing the name of the current
source file.  This may be useful when generating debugging error messages.

<hr>

<a name=/DM/preprocessor/__IMPLIED_TYPE__>
<h2 byondver=515>__IMPLIED_TYPE__ macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/__FILE__>__FILE__ macro</a>
<dd><a href=#/DM/preprocessor/__LINE__>__LINE__ macro</a>
<dd><a href=#/DM/preprocessor/__PROC__>__PROC__ macro</a>
<dd><a href=#/DM/preprocessor/__TYPE__>__TYPE__ macro</a>
<dd><a href=#/proc/new>new proc</a>
<dd><a href=#/proc/locate>locate proc</a>
<dd><a href=#/proc/istype>istype proc</a>
<dd><a href=#/proc/astype>astype proc</a>
</dl>

<p>The <tt>__IMPLIED_TYPE__</tt> macro is replaced by a reference to the type
path implied at the current point in compilation. For instance, when using the
<a href=#/proc/new><tt>new</tt> proc</a> and assigning to a var, the type path
for <tt>new()</tt> is implied by the var's type. Implied types are also
automatically used in <a class=code href=#/proc/locate>locate()</a>, and are
used by default for the second argument in
<a class=code href=#/proc/istype>istype()</a> and
<a class=code href=#/proc/astype>astype()</a>.

<h3>Example:</h3>
<xmp>
proc/Factory(new_type)
    world.log << "Creating new [new_type]"
    return new new_type()

proc/CreateThing()
    // pass /thing to Factory
    var/thing/T = Factory(__IMPLIED_TYPE__)
</xmp>

<p><tt>__IMPLIED_TYPE__</tt> is valid in the following situations:

<ul>
<li>In an expression on the right-hand side of an assignment operator (this includes operators like <tt>+=</tt>), where the left-hand side is a var that has a defined type path.
<li>Within the second argument of <a class=code href=#/proc/istype>istype()</a>. The implied type is the first argument's var type.</li>
<li>Within the second argument of <a class=code href=#/proc/astype>astype()</a>. If the <a class=code href=#/proc/astype>astype()</a> call is on the right-hand side of an assignment, this is the type of the var being assigned to; otherwise it's the type of the first argument.</li>
</ul>

<p>This is actually a pseudo-macro; the preprocessor doesn't handle it
directly.

<hr>

<a name=/DM/preprocessor/__LINE__>
<h2>__LINE__ macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ASSERT>ASSERT proc</a>
<dd><a href=#/DM/preprocessor/define/DEBUG>DEBUG definition</a>
<dd><a href=#/DM/preprocessor/__FILE__>__FILE__ macro</a>
<dd><a href=#/DM/preprocessor/__PROC__>__PROC__ macro</a>
<dd><a href=#/DM/preprocessor/__TYPE__>__TYPE__ macro</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<p>The __LINE__ macro is replaced by the line number in the current source
file.  This may be useful when generating debugging error messages.

<hr>

<a name=/DM/preprocessor/__MAIN__>
<h2>__MAIN__ macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<p>The __MAIN__ macro is defined in the main <code>.dme</code> file being
compiled.  In all other files included by this file, __MAIN__ is not defined.

<p>The purpose of this is for library writers to package a small demo of their
library directly in the library source code.  When users compile the library
directly, the library's own <code>.dme</code> is the main file and can include
extra files that are not normally part of the library.

<h3>Example:</h3>
<xmp>
#ifdef __MAIN__
#include "demo.dm"
#include "demo.dmm"
#endif
</xmp>

<p>If the demo requires a lot of extra resources, it is probably better to
package the demo as a separate project.  Small demos, however, are nice and
convenient using this "auto-demo" technique&mdash;especially since Dream
Seeker automatically launches Dream Maker after installing a library
containing a <code>.dme</code> file.

<hr>

<a name=/DM/preprocessor/__PROC__>
<h2 byondver=515>__PROC__ macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/__FILE__>__FILE__ macro</a>
<dd><a href=#/DM/preprocessor/__LINE__>__LINE__ macro</a>
<dd><a href=#/DM/preprocessor/__TYPE__>__TYPE__ macro</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<p>The <tt>__PROC__</tt> macro is replaced by a reference to the current proc
being compiled. This may be useful when generating debugging error messages,
especially when wrapped in <tt>nameof</tt>, e.g. <tt>nameof(__PROC__)</tt>.

<p>This is actually a pseudo-macro; the preprocessor doesn't handle it
directly.

<hr>

<a name=/DM/preprocessor/__TYPE__>
<h2 byondver=515>__TYPE__ macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/__FILE__>__FILE__ macro</a>
<dd><a href=#/DM/preprocessor/__LINE__>__LINE__ macro</a>
<dd><a href=#/DM/preprocessor/__PROC__>__PROC__ macro</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<p>The <tt>__TYPE__</tt> macro is replaced by a reference to the type path
currently being compiled. This may be useful when generating debugging error
messages. If used in a global proc, the value will be null.

<p>This is actually a pseudo-macro; the preprocessor doesn't handle it
directly.

<hr>

<a name=/DM/preprocessor/define>
<h2>#define directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#define Name Value
<dd>#define Name(Parameters) Value
</dl>

<dl><dt><b>Args:</b>
<dd>Name:  A macro definition.
<dd>Value: The value to substitute for Name.
<dd>Parameters:  Arguments to pass into the macro.
</dl>

<p>The #define statement creates a macro that is substituted for Name.
Substitution only applies to whole words.  Text inside of double or single
quotes is not processed for substitution, so <code>"This is BIG."</code> would
not be modified even if a macro named BIG were defined.  That is different
from <code>"This is [BIG]."</code>, where BIG is an embedded expression, which
does get processed for macro substitution.

<h3>Example:</h3>
<xmp>
#define DAY   0
#define NIGHT 1
var/daytime = NIGHT  //daytime = 1
</xmp>

<h3>Example:</h3>
<xmp>
#define SQR(X) ((X)*(X))
var/x = SQR(2)       //x = ((2)*(2)) = 4
</xmp>

<p>Note that it's usually important to use parentheses around any arguments
you use in a macro. Otherwise strange results may occur if you use an
expression such as 2+3. In the SQR(X) example, if there were no parentheses
around each X then the expansion of the macro would be (2+3*2+3). Since the *
operator has a higher precedence than + the result is 11, not 25 as expected.
It's equally important to put parentheses around the entire macro for the
same reason.

<h3 byondver=511>Variadic macros</h3>

<p>The last parameter of a macro can end in <tt>...</tt> which means that it
and all other arguments following it count as a single argument. This is
called a variadic macro because it lets you use a variable number of
arguments. The last parameter will also become optional.

<h3>Example:</h3>
<xmp>
#define DEFAULT_LIST(n, items...) if(!n) n = list(items)
</xmp>

<h3><tt>#var</tt> to string</h3>

<p>In a macro's body, if you precede a parameter by <tt>#</tt>, the
replacement value will be turned into a string.  For instance, 2 would become
"2".

<h3>Example:</h3>
<xmp>
#define DEBUG_VAR(v) world.log << "[#v] = [v]"
DEBUG_VAR(usr.x)    // world.log << "usr.x = [usr.x]"
</xmp>

<h3><tt>##var</tt> concatenation</h3>

<p>A parameter preceded by <tt>##</tt> in the macro body is substituted
directly, without any spaces. If you use this with the last argument in a
variadic macro, any preceding spaces and a comma (if found) will be removed
if the replacement is empty.

<h3>Example:</h3>
<xmp>
#define MACROVAR(k) var/macro_state_##k
// MACROVAR(right) becomes var/macro_state_right

#define PREFIX_LIST(x, y...) list(x, src, ##y)
// PREFIX_LIST(1, 2, 3) becomes list(1, src, 2, 3)
// PREFIX_LIST(4) becomes list(4, src)
</xmp>

<h3><tt>n###var</tt> repeat</h3>

<p>Using <tt>###</tt> in the macro body, preceded by a number, will repeat the
replacement a certain number of times.

<h3>Example:</h3>
<xmp>
#define SAYTWICE(t) 2###t
#define TOTEXT(t) #t
world << "[TOTEXT(SAYTWICE(hi))]"   // world << "hihi"
</xmp>

<hr>

<a name=/DM/preprocessor/define/DEBUG>
<h2>DEBUG definition</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#define DEBUG
</dl>

<p>If <code>DEBUG</code> is defined, source file and line number information
will be stored in the compiled <code>.dmb</code> file.  If a proc crashes
during execution and <code>DEBUG</code> information is present, the current
source file name and line number will be indicated in the error output.

<p>This option increases the size of the <code>.dmb</code>, typically by about
10%.  Execution of the code may also be a tiny bit slower.

<p>If you are distributing the <code>.dmb</code> to players and you do not
want them to have debug access at runtime, you should <em>not</em> compile in
debug mode.

<p>If you want to use the run-time profiler (see the debugging options in
Dream Seeker), you must compile in debug mode.  Then you can get a report of
CPU usage by your various procs.

<hr>

<a name=/DM/preprocessor/define/FILE_DIR>
<h2>FILE_DIR definition</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/cache>cache</a>
<dd><a href=#/DM/icon>icons</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#define FILE_DIR Path
</dl>

<dl><dt><b>Args:</b>
<dd>Path: A search path on the current filesystem.
</dl>

<p>This macro defines a search path to be used in evaluating resource files
(icons and sounds).  First the current directory is searched, then the first
<code>FILE_DIR</code> path, then the next, etc.

<h3>Example:</h3>
<xmp>
#define FILE_DIR icons
#define FILE_DIR icons/mobs

mob/clown
  icon = 'clown.dmi'
</xmp>

<p>This searches for the file at the paths <code>"./clown.dmi"</code>,
<code>"./icons/clown.dmi"</code>, and <code>"./icons/sounds/clown.dmi"</code>,
where <code>"."</code> is the directory of the current source file.

<hr>

<a name=/DM/preprocessor/elif>
<h2>#elif directive</h2>

<dl><dt><b>See:</b>
<dd><a href=#/DM/preprocessor/if>#if directive</a>
</dl>

<hr>

<a name=/DM/preprocessor/else>
<h2>#else directive</h2>

<dl><dt><b>See:</b>
<dd><a href=#/DM/preprocessor/if>#if directive</a>
</dl>

<hr>

<a name=/DM/preprocessor/endif>
<h2>#endif directive</h2>

<dl><dt><b>See:</b>
<dd><a href=#/DM/preprocessor/if>#if directive</a>
</dl>

<hr>

<a name=/DM/preprocessor/error>
<h2>#error directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor>preprocessor</a>
<dd><a href=#/DM/preprocessor/warn>#warn directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#error Text
</dl>

<dl><dt><b>Args:</b>
<dd>Text: an error message to display
</dl>

<p>The #error directive halts compilation and displays the specified message.

<h3>Example:</h3>
<xmp>
#if DM_VERSION < 4
#error This compiler is too far out of date!
#endif
</xmp>

<hr>

<a name=/DM/preprocessor/if>
<h2>#if directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
<dd><a href=#/DM/preprocessor/ifdef>#ifdef directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#if Val
<dd>...
<dd>#elif Val2
<dd>...
<dd>#else
<dd>...
<dd>#endif
</dl>

<dl><dt><b>Args:</b>
<dd>Val: A logical expression.
</dl>

<p>The <code>#if</code> statement is used to conditionally compile code.  If
Val is true (non-zero), the code following the <code>#if</code> statement
will be compiled.  Otherwise, compilation skips to the next
<code>#elif</code>, <code>#else</code>, or <code>#endif</code> statement.

<p>The function <code>defined()</code> can be used in the conditional
expression.  It is true if its argument is a defined macro (with
<code>#define</code>) and false otherwise.

<h3>Example:</h3>
<xmp>
#if defined(DEBUG)
// This code will be compiled if DEBUG is
// defined
#else
// This code will be compiled if DEBUG is
// not defined
#endif
</xmp>

<p>You can also use <tt>fexists()</tt> in a conditional to check if a file
exists.

<hr>

<a name=/DM/preprocessor/ifdef>
<h2>#ifdef directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
<dd><a href=#/DM/preprocessor/if>#if directive</a>
<dd><a href=#/DM/preprocessor/ifndef>#ifndef directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#ifdef Name
</dl>

<dl><dt><b>Args:</b>
<dd>Name: A macro definition.
</dl>

<p>The <code>#ifdef</code> statement is used to conditionally compile code.  It
is equivalent to <code>#if defined(Name)</code>.

<hr>

<a name=/DM/preprocessor/ifndef>
<h2>#ifndef directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
<dd><a href=#/DM/preprocessor/if>#if directive</a>
<dd><a href=#/DM/preprocessor/ifdef>#ifdef directive</a>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#ifndef Name
</dl>

<dl><dt><b>Args:</b>
<dd>Name: A macro definition.
</dl>

<p>The <code>#ifndef</code> statement is used to conditionally compile code.
It is equivalent to <code>#if !defined(Name)</code>.

<hr>

<a name=/DM/preprocessor/include>
<h2>#include directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#include "Filename"
<dd>#include &lt;Filename&gt;
</dl>

<dl><dt><b>Args:</b>
<dd>"Filename": The path to the filename to include, from the current
    directory.
<dd>&lt;Filename&gt;: The path inside the BYOND lib directory.
</dl>

<p>The <code>#include</code> statement causes the compiler to process another
file before continuing in the current source file.

<p>If a file is included multiple times, only the first occurrence will be
processed. That is a convenient addition to the standard C preprocessor, which
DM otherwise emulates quite closely. If you want the file to be included more
than once, put the line <tt>#pragma multiple</tt> somewhere in the file.

<p>The file <code>&lt;stddef.dm&gt;</code> is automatically included before
all other source code. You can view the contents of that file by creating a
file with that name in Dream Maker.

<h3>Example:</h3>
<xmp>
#include "test.dm" // checks ./test.dm
#include <test.dm> // checks lib-path/test.dm
</xmp>

<p>The BYOND lib directory is called <code>"lib"</code> and is located in the
BYOND system directory (typically <code>"\Program Files\Byond\lib"</code>).
If the file is not found there, it also looks in the user lib directory, which
would typically be <code>"...\Byond\user\<i>login-name</i>\lib"</code>.

<p>Note that the compiler interface allows you to include files graphically by
simply clicking the checkbox next to the file.  This creates an include
statement for you in the <code>.dme</code> project environment file.  The only
time you would still want to manually include files is when you need to ensure
a certain order of processing.  For example, if file <code>"MyCode.dm"</code>
overrides procedure definitions of an object defined in
<code>"LibCode.dm"</code>, you should include <code>"LibCode.dm"</code> at the
top of <code>"MyCode.dm"</code>.  Most other DM code is independent of order,
but overriding procedure definitions is not.  The compiler will warn you in
such cases if you forget.

<p>Another case in which you should manually include files is if you are
writing a library to be used by other programmers.  Since the
<code>.dme</code> file is not distributed with a library, all necessary
inclusions must be made in the <code>.dm</code> files.

<hr>

<a name=/DM/preprocessor/pragma>
<h2 byondver=515>#pragma directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
<dd><a href=#/DM/preprocessor/include>#include directive</a>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<p>The <tt>#pragma</tt> directive alters the compiler's behavior in various
ways.

<dl class=codedt>
  <dt><a href=#/DM/preprocessor/pragma/multiple>#pragma multiple</a></dt>
  <dd>Include this file more than once.</dd>
  <dt><a href=#/DM/preprocessor/pragma/warn>#pragma ignore <i>Warning</i></a></dt>
  <dt><a href=#/DM/preprocessor/pragma/warn>#pragma warn <i>Warning</i></a></dt>
  <dt><a href=#/DM/preprocessor/pragma/warn>#pragma error <i>Warning</i></a></dt>
  <dd>Changes how the compiler handles certain warnings.
  <dt><a href=#/DM/preprocessor/pragma/push>#pragma push</a></dt>
  <dd>Save the current pragma state.</dd>
  <dt><a href=#/DM/preprocessor/pragma/push>#pragma pop</a></dt>
  <dd>Restore a previously saved warning state.</dd>
  <dt byondver=516><a href=#/DM/preprocessor/pragma/syntax>#pragma syntax</a></dt>
  <dd>Switch to a different syntax for parsing certain procs.</dd>
  <dt byondver=516><a href=#/DM/preprocessor/pragma/compatibility>#pragma compatibility</a></dt>
  <dd>Hint that the compiler should avoid using features higher than a given version.</dd>
  <dt byondver=516><a href=#/DM/preprocessor/pragma/math>#pragma math</a></dt>
  <dd>Choose faster (old) or more accurate (new default) trigonometry.</dd>
</dl>

<p>Pragmas will <i>not</i> be inherited by libraries included in your project.

<hr>

<a name=/DM/preprocessor/pragma/compatibility>
<h2 byondver=516>#pragma compatibility directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/DM/preprocessor/warn>warn/ignore/error directive</a>
<dd><a href=#/DM/preprocessor/DM_VERSION>DM_VERSION macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#pragma compatibility <span class=faded>&lt;</span>version<span class=faded>&gt;</span>
</dl>

<p>Hints that the compiler should avoid using features past a certain major
BYOND version. If it encounters a situation where you explicitly or implicitly
use a newer feature than requested, it will generate a warning.

<h3>Example:</h3>
<xmp>
#pragma compatibility 515
</xmp>

A value of 0 or anything negative will reset the compatibility version to the
default.

<hr>

<a name=/DM/preprocessor/pragma/math>
<h2 byondver=516>#pragma math directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/proc/sin>sin proc</a>
<dd><a href=#/proc/cos>cos proc</a>
<dd><a href=#/proc/tan>tan proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#pragma math <span class=faded>&lt;</span>fast<span class=faded>|</span>accurate<span class=faded>&gt;</span>
</dl>

<p>Chooses old-style fast math procs, or newer more accurate ones that
sacrifice a small amount of speed. This appplies to
<a class=code href=/proc/sin>sin()</a>, <a class=code href=/proc/cos>cos()</a>,
and <a class=code href=/proc/tan>tan()</a>.

<p>The reason this is necessary is because BYOND uses degrees for its angles,
but converting to radians (for the underlying math libraries) can't be done
with precision for many angles such as 90&deg;, which is &pi;/2 in radians.
When the result of the trig function is small, the angle being slightly off
from what the user intended will produce a small error in the result as well.

<p>The more-accurate procs use trigonometric identities to reduce the angle
to a more manageable range of 0 to 45&deg; (&pi;/4 radians).

<h3>Example:</h3>
<xmp>
var/angle = 90
#pragma math fast
usr << cos(angle)   // 6.12323e-17
#pragma math accurate
usr << cos(angle)   // 0
</xmp>

<p>Using <a class=code href=/DM/preprocessor/pragma/compatibility>#pragma compatibility 515</a>
will also force the fast math version.

<p>Note: For consistency, built-in compiler math for constant values uses the
same calculations that would be used for non-constant values runtime, so
<tt>cos(90)</tt> compiles as 6.12323e-17 with fast math and as 0 for accurate
math.

<hr>

<a name=/DM/preprocessor/pragma/multiple>
<h2 byondver=515>#pragma multiple directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/DM/preprocessor/include>#include directive</a>
</dl>

<p>Allows this file to be included more than once. Ordinarily the
<tt>#include</tt> directive only allows a file to be included once.

<hr>

<a name=/DM/preprocessor/pragma/push>
<h2 byondver=515>#pragma push/pop directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/DM/preprocessor/pragma/warn>#pragma warn/ignore/error directive</a>
</dl>

<p><tt>#pragma push</tt> saves the current state any pragma flags,
so for instance a warning's level can be temporarily changed to ignore, warn,
or error.

<p><tt>#pragma pop</tt> restores a previously saved pragma state.

<h3>Example:</h3>
<xmp>
// temporarily ignore the unused_var warning
#pragma push
#pragma ignore unused_var

proc/GNDN()
    var/nothing // var defined but not used

#pragma pop
</xmp>

<hr>

<a name=/DM/preprocessor/pragma/syntax>
<h2 byondver=516>#pragma syntax directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
<dd><a href=#/proc/switch>switch proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#pragma syntax <span class=faded>&lt;</span>C<span class=faded>|</span>DM<span class=faded>&gt;</span> <span class=faded>[</span>for<span class=faded>|</span>switch<span class=faded>]</span>
</dl>

<p>Changes the syntax used to parse certain statements. This can be more
natural for users who prefer non-DM style, and can sometimes do things that
regular DM syntax can't do.

<p>Changing the <a href=#/proc/for/loop><tt>for()</tt> loop</a> syntax to C
will use semicolons to separate the Init, Test, Inc sections instead of
commas. That means commas can be used to chain multiple statements together
instead.

<p>In <a class=code href=#/proc/switch>switch()</a>, C syntax changes the
if/else statements to use C's <tt>case</tt> and/or <tt>default</tt> keywords,
followed by a colon, and the <a href=#/proc/break><tt>break</tt> statement</a>
is required to skip to the end of the switch unless you want to fall through
to the next case. Fall-through behavior isn't possible in the default DM
syntax.

<h3>Example:</h3>
<xmp>
#pragma push
#pragma syntax C switch

switch(thing)
    case 1:
        usr << "This is case 1!"
        break
    case 2, 3:
        usr << "This is case 2 or 3."
        // no break, fall through
    case 4 to 6:
        usr << "This is case 4 through 6 (or maybe 2 or 3)."
        break
    default:
        usr << "This is a different case.

#pragma pop
</xmp>

<hr>

<a name=/DM/preprocessor/pragma/warn>
<h2 byondver=515>#pragma warn/ignore/error directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/pragma>#pragma directive</a>
<dd><a href=#/DM/preprocessor/warn>#warn directive</a>
<dd><a href=#/DM/preprocessor/error>#error directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#pragma <span class=faded>&lt;</span>warn<span class=faded>|</span>ignore<span class=faded>|</span>error<span class=faded>&gt;</span> WarningName
</dl>

<p>Changes the way the compiler responds to warnings (except those caused
by the <a href=#/DM/preprocessor/warn><tt>#warn</tt> directive</a>). The
warning name appears in the compiler output when the warning is generated.

<p>Multiple warning names can be used in the same pragma, separated by commas.

<h3>Example:</h3>
<xmp>
// temporarily ignore the unused_var warning
#pragma push
#pragma ignore unused_var

proc/GNDN()
    var/nothing // var defined but not used

#pragma pop
</xmp>

<p>Here is a list of warnings that are disabled by default, but can be
turned on for linting purposes:

<table>
<tr><th>Name</th><th>Description</th></tr>
<tr><td>init_proc</td><td>A var in a very commonly used type, like <tt>/turf</tt> or <tt>/atom</tt> or <tt>/datum</tt>, is being initialized with an init proc. An example is <tt>var/stuff[]</tt> or <tt>var/list/stuff = list(1,2,3)</tt> which creates a list in a special internal proc because calling <a class=code href=#/datum/proc/New>New()</a>. Best practice is to not initialize the list until it's needed.</td></tr>
<tr><td>frequent_call</td><td>A very commonly called proc such as <a class=code href=#/datum/proc/New>New()</a> or <a class=code href=#/datum/proc/Del>Del()</a> has been overridden on a type that gets created or destroyed frequently, such as <tt>/turf</tt>, <tt>/atom</tt>, or <tt>/datum</tt>.</td></tr>
</table>

<hr>

<a name=/DM/preprocessor/undef>
<h2>#undef directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define>#define directive</a>
<dd><a href=#/DM/preprocessor>preprocessor</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#undef Name
</dl>

<dl><dt><b>Args:</b>
<dd>Name: A macro definition.
</dl>

<p>The <code>#undef</code> statement removes a macro definition.

<hr>

<a name=/DM/preprocessor/warn>
<h2>#warn directive</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor>preprocessor</a>
<dd><a href=#/DM/preprocessor/error>#error directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#warn Text
</dl>

<dl><dt><b>Args:</b>
<dd>Text: a warning message to display
</dl>

<p>The #warn directive displays the specified message as a warning, but does
not prevent the project from compiling.

<h3>Example:</h3>
<xmp>
#ifdef USE_LIGHTING
#warn The lighting feature in MyLibrary is experimental.
#endif
</xmp>

<hr>

<a name=/DM/sound>
<h2>sounds</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/define/FILE_DIR>FILE_DIR definition</a>
<dd><a href=#/DM/cache>cache</a>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound>/sound datum</a>
<dd><a href=#/proc/load_resource>load_resource proc</a>
</dl>

<p>A sound stored in a file may be referenced by putting single quotes around
the filename.  The file extension determines the type of sound.  Currently
supported music types include MIDI (.mid or .midi), and module formats .mod, .it,
.s3m, .xm, and .oxm. Supported sound effect formats include .wav, .ogg, .mp3,
.raw, .wma, and .aiff.

<h3>Example:</h3>
<xmp>
world << sound('fugue.midi')
</xmp>

<p>This example plays the specified midi file to all players.

<hr>

<a name=/DM/text>
<h2>text</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/DM/text/entities>entities (text)</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/DM/text/tags>tags (text)</a>
<dd><a href=#/proc/text>text proc</a>
<dd><a href=#/{notes}/Unicode>Unicode</a>
</dl>

<p>Text consists of a string of characters enclosed in double quotes.  To
place a quote inside a string, escape it with a backslash <code>\</code>
character.  You will also need to escape a backslash if you want to use
one on purpose.


<h3>Example:</h3>
<xmp>
usr << "He said, \"Hi.\""
</xmp>

<p>This example sends some text to the usr:  <code>He said, "Hi."</code>

<p>Backslashes are also used for special <a href=#/DM/text/macros>macros</a>
and to escape other characters that would normally be hard to include in a
string.  A backslash at the end of a line will ignore the line break, and
continue the string on the next line after ignoring any leading spaces.

<p>To insert a variable expression into a string, enclose it in brackets
<code>[]</code>.  These are referred to as embedded text expressions.  An
object expression will display the object's name preceded by the text macro
<code>\the</code> or <code>\The</code> if no other article has been
specified.  Capitalization of the article is inferred from context.

<h3>Example:</h3>
<xmp>
mob/verb/shout(T as text)
  world << "[usr]: [T]"
</xmp>

<p>If this example is called by a mob named "Bill" with the text "hi
everybody!", it will display "Bill: hi everybody!".

<p>On the other hand, if it is called by a mob named "cat", it would display
"The cat: hi everybody!".

<p byondver=515>Via <a href=#/operator/overload>operator overloading</a> you
can define an <tt>operator""</tt> proc for an object to return different
text when it's embedded in a string.

<h3>Document strings</h3>

<p>For lengthy text strings, DM provides a special text <em>document</em>
syntax.  This begins with <code>{"</code> and ends with <code>"}</code>.  It
may include multiple lines and even un-escaped double quotes, but it still
parses escape characters and embedded expressions.

<h3>Example:</h3>
<xmp>
mob/verb/end()
  usr << {"
This is the way the world ends
This is the way the world ends
This is the way the world ends
Not with a bang but a whimper.

--T.S. Eliot "Hollow Men"
"}
  del world  //the end!
</xmp>

<h3 byondver=512>Raw strings</h3>

<p>DM also has a format for raw strings, which do not allow escape characters
or embedded expressions.  This can be useful for many situations, especially
<a href=#/{notes}/regex>regular expressions</a> which tend to use
characters that need escaping.  There are three ways to specify a raw string.
All of them begin with the <code>@</code> character.

<p>Simple raw strings follow <code>@</code> with a single-character
delimiter, usually <code>"</code> but it can be almost anything, and end when
that delimiter is seen again.  Line breaks are not allowed in simple raw
strings.

<h3>Examples:</h3>
<xmp>
world << @"I can say \ or [] without escaping anything!"
world << @#Here I can use "quotes" but not the pound sign.#

var/regex/R = new(@/(\d+)/)

// without raw strings
world << "I can say \\ or \[] without escaping anything!"   // lying
world << "I have to escape \"quotes\" to use them."

var/regex/R = new("(\\d+)")
</xmp>

<p>Complex raw strings use more complicated delimiters, but they let you
include line breaks.  There are two ways to do this: One starts with
<code>@{"</code> and ends with <code>"}</code>, so it looks like the familiar
document string format.  The other way starts with <code>@(XYZ)</code>, where
<code>XYZ</code> is any arbitrary text you want it to be, and ends when that
same text is encountered.

<p>With a complex raw string, a single leading and/or trailing line break will
be ignored.

<h3>Examples:</h3>
<xmp>
world << @{"
Now I have absolute freedom to use "quotes"
or [brackets] or line breaks, as long as I
don't follow a quote with a closing brace.
"}

world << @(~~~)
Until three tilde (~) characters are seen, this is a valid string.
~~~     // end of string

world << @(!!)You don't need a line break if you don't want one.!!
</xmp>

<hr>

<a name=/DM/text/entities>
<h2>entities (text)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/DM/text/tags>tags (text)</a>
<dd><a href=#/DM/text>text</a>
</dl>

<p>Special characters may be inserted into text using HTML syntax.  Such
characters are known as entities.  They start with an ampersand and end with a
semicolon.  The main reason for doing this is to insert characters that
otherwise have a special meaning.  The most common entities have names.  The
rest must be referred to by their Unicode character number (e.g.
<tt>&amp;#38;</tt> is the same as <tt>&amp;amp;</tt>).  The common ones are
listed in the following table. Note that the same effect may be achieved by
simply escaping the special character (like <code>\&lt;</code>).  The full
entity syntax is included for generality.

<table>
<thead><tr><th>Entity</th>       <th>Character</th></tr></thead>
<tbody class=code>
<tr><td>&amp;amp;</td>    <td>&amp;</td></tr>
<tr><td>&amp;lt;</td>     <td>&lt;</td></tr>
<tr><td>&amp;gt;</td>     <td>&gt;</td></tr>
<tr><td>&amp;quot;</td>   <td>&quot;</td></tr>
<tr><td>&amp;copy;</td>   <td>&copy;</td></tr>
</tbody>
</table>

<p>When using numbered entities, you can put an <tt>x</tt> in front of the
number to use hexadecimal. For instance <tt>&amp;#x26;</tt>, <tt>&amp;#38;</tt>,
and <tt>&amp;amp;</tt> are all equivalent.

<hr>

<a name=/DM/text/macros>
<h2>macros (text)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text/macros/icon>icon text macro</a>
<dd><a href=#/DM/text>text</a>
<dd><a href=#/proc/text>text proc</a>
</dl>

<p>Text macros start with '\' (a backslash) and end with a space or other
punctuation.

<xmp>
\the, \The // insert 'the' (if needed)
\a, \an,   // insert 'a(n)' or 'some' (if needed)
\A, \An

\he, \He   // insert 'he/she/they/it'
\she, \She // same
\his, \His // insert 'his/her/their/its'
\him       // insert 'him/her/them/it'
\himself   // insert 'himself/herself/themself/itself'
\herself   // same
\hers      // insert 'his/hers/theirs/its'

\proper    // used in an object name to force proper-noun behavior
\improper  // used in an object name to force improper-noun behavior

\th        // insert 1st, 2nd, 5th etc.
\s         // insert 's' if [] was plural
\icon      // insert icon of following []
\ref       // insert a unique id for following []
\roman     // insert following [] as a lower-case roman numeral
\Roman     // insert following [] as an upper-case roman numeral
\...       // suppress final new line
\t         // insert tab
\n         // insert new line
\"         // insert double quote
\\         // insert backslash
\<         // insert &amp;lt; (less than)
\>         // insert &amp;gt; (greater than)
\(space)   // skip a space
\(newline) // skip a newline (and following space)

\xNN       // insert a character by its ASCII/Unicode value
\uNNNN     // "
\UNNNNNN   // "
</xmp>

<h3>Example:</h3>
<xmp>
mob/verb/steal(M as mob,obj/O as obj in M)
  O.loc = usr
  view() << "[usr] finds \himself \an [O]."
</xmp>

<h3>Example:</h3>
<xmp>
var/DayCount
proc/NewDay()
  DayCount++
  world << "The [DayCount]\th day dawns."
</xmp>

<h3>Example:</h3>
<xmp>
obj/CPU
  name = "\improper CPU"  //prevent capitalization from causing proper-noun behavior
</xmp>

<hr>

<a name=/DM/text/macros/icon>
<h2>icon text macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon_state>icon_state var (atom)</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/DM/text/style>style sheets</a>
<dd><a href=#/DM/text/tags>tags (text)</a>
</dl>

<p>The </code>\icon</code> macro is used to treat the following embedded
expression (in []'s) as an icon rather than as text.  An object, for
example, would be replaced by its icon rather than by its name.

<h3>Example:</h3>
<xmp>
usr << "You look like this: \icon[usr]!"
</xmp>

<p>The <code>\icon</code> macro expands internally to the &lt;IMG&gt; tag.  The
above example, could be rewritten like this:

<xmp>
usr << "You look like this: \
  <IMG CLASS=icon SRC=\ref[usr.icon] ICONSTATE='[usr.icon_state]'>!"
</xmp>

<p>Note that the current icon state of the object is automatically used.
Also note that the image belongs to a class called <code>icon</code>.  That
allows you to configure the way icons are displayed by using a style sheet.
The following default style rule causes icons to be shrunk to 16 by 16
pixels so they fit in better with surrounding text:

<xmp>
IMG.icon {width: 16px; height: 16px}
</xmp>

<p>You could override this setting globally in your own style sheet.  You
could even define rules to allow individual icons to be formatted
differently from the rest.

<h3>Example:</h3>
<xmp>
BIG IMG.icon {width: 32px; height: 32px}
SMALL IMG.icon {width: 16px; height: 16px}
</xmp>

<p>With those rules in place, you could output a full sized icon by using
the &lt;BIG&gt; tag:

<xmp>
usr << "You look like this: <BIG>\icon[usr]</BIG>!"
</xmp>

<p>The one time that one might want to use the &lt;IMG&gt; tag directly is
to specify the ALT text to be displayed on clients which don't support
graphical icons.

<p>Specific states, directions, and frames of an icon can be displayed in lieu
of the default through use of the following tags:
<ul><li>ICONSTATE='[state]'
<li>ICONDIR=[dir], where dir is one of NORTH, SOUTH, EAST, WEST, NORTHEAST, NORTHWEST, SOUTHEAST, SOUTHWEST
<li>ICONFRAME=[frame], where frame is the animation frame, starting with 1</ul>

<h3>Example:</h3>
<xmp>
usr << "You look like this: \
  <IMG CLASS=icon SRC=\ref[usr.icon] ICONSTATE='glowing' ICONDIR=NORTH ICONFRAME=2>!"
</xmp>

<p>Note that the \icon macro does not work in the mini-browser; it is only
for text output. To make icons appear in an HTML document, use
<a href=#/proc/browse_rsc>browse_rsc()</a> to send an icon to the
client before using <a href=#/proc/browse>browse()</a> to display it.

<hr>

<a name=/DM/text/macros/ref>
<h2 byondver=513>ref text macro</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/DM/text/macros/icon>icon text macro</a>
<dd><a href=#/proc/locate>locate proc</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/datum/var/tag>tag var (datum)</a>
</dl>

<p>The <code>\ref</code> text macro inserts a unique identification number
or text string for the following embedded object (inside []'s).

<p>In older versions of BYOND, if an object had a tag, that was used instead.
However this has often proved to be problematic, so anything compiled from
version 512 onward should expect to output a reference number.  If you want
to use the tag, which stands a better chance of still being valid if the
object is deleted and recreated (like in a world reboot), you can output the
object's tag explicitly.

<p>The primary use for object references embedded in text is in topic links.
This allows you to encode a reference to an object in the href value of a
hyperlink.  (Just make sure the object does not get deleted before the user
executes the link.  See <a href=#/DM/garbage>garbage collection</a>.)

<p>Topic links that contain a parameter "src" assigned to an object reference
are treated somewhat specially.  Unless you override client.Topic() to do
otherwise, the default behavior is to call the referenced object's own Topic()
procedure.

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << "Click <a href=?src=\ref[src];action=start>here</a>!"
mob/Topic(href,href_list[])
   switch(href_list["action"])
      if("start")
         usr << "Starting the game..."
      else
         return ..()
</xmp>

<p>The above example uses an embedded reference to the player's own mob to
create a link to a topic handled by that mob's Topic() proc.  The
<code>href_list</code> parameter is simply the result of
<code>params2list(href)</code>.

<p>In that example, the embedded reference was automatically converted back
into an object (dereferenced) for you.  If you embed references to additional
objects in the href data, you would have to dereference those yourself using
the locate() instruction.

<h3>Browser images</h3>

<p>In output for browser controls, you can use <tt>\ref[object]</tt> as the src
parameter for an &lt;img&gt; tag. The object can be an
<a href=#/atom/var/appearance>appearance</a>, an icon, or an atom or image.

<p>If the ref string is for an icon, you can add an HTML query string after
the icon reference.

<h3>Example:</h3>
<xmp>
player << browse({"
    <html><body>
    <img src="\ref[icon]?state=hungry&dir=[EAST]">
    </body></html>"})
</xmp>

<p>The query string can include any of the following (separated by &amp; characters):

<dl class=codedt>
<dt>sheet</dt><dd>Display all matching frames as a sprite sheet; otherwise the first matching frame is used</dd>
<dt>state=<i>ICON_STATE</i></dt><dd>Use a specific icon state; be sure to <a class=code href=#/proc/url_encode>url_encode</a> it)</dd>
<dt>moving=<i>M</i></dt><dd>Specify whether to choose only moving (M=1) or non-moving (M=0) states</dd>
<dt>dir=<i>DIR</i></dt><dd>Choose only frames with a specific direction (this should be a number, not text, so for instance <tt>dir=[NORTH]</tt>)</dd>
<dt>frame=<i>N</i></dt><dd>Choose the Nth animation frame in an animated icon</dd>
</dl>

<hr>

<a name=/DM/text/style>
<h2>style sheets</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{{appendix}}/css>CSS attributes</a>
<dd><a href=#/DM/text/entities>entities (text)</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/client/var/script>script var (client)</a>
<dd><a href=#/DM/text/tags>tags (text)</a>
<dd><a href=#/DM/text>text</a>
</dl>

<p>HTML tags, such as <code>&lt;font&gt;</code> may be used to directly format
output text.  Another approach, however, is to use HTML tags to specify
purely structural information and use a style sheet to define how various
elements within that structure should be treated.  DM uses a
<a href=#/{{appendix}}/css>subset of the Cascading Style Sheet (CSS)
language</a>, which was introduced for this purpose in HTML documents.

<p>This section discusses the syntax of style sheets as an independent
element.  For information on how to include the style sheets in your DM
code, see the section on <a class=code href=#/client/var/script>client.script</a>.

<p>As an example of a style sheet, one might want combat and conversational
messages to appear differently&mdash;perhaps using different colors.  Instead
of using the <code>&lt;font&gt;</code> tag to color the text, you could use
<code>&lt;span&gt;</code> to mark the beginning and ending of the text and
to specify what kind of message it is.  The result might be text such as the
following:

<xmp>
"[usr] <span class=combat>spanks</span> [targ]!"
"[usr] says, '<span class=chat>[msg]</span>'"
</xmp>

<p>The <code>class</code> attribute may be used with any tag, but
<code>span</code> and <code>div</code> are often convenient because they
have no other side-effect but defining the style class.  <code>span</code>
is for text within a single paragraph and <code>div</code> is for whole
paragraphs.  The way text belonging to a particular class is formatted may be
controlled in a style sheet such as the following:

<xmp>
.combat {color: red}
.chat {color: green}
</xmp>

<p>This says that text in the <tt>combat</tt> class should be colored red and
text in the <tt>chat</tt> class should be colored green.  These classes are
not pre-defined; you can create whatever new style classes you need. (The
color names are predefined however. You can find a list of them in
<a href=#/{{appendix}}/html-colors>HTML colors</a>.

<p>The advantage of using style sheets instead of direct formatting tags is
that you can cleanly separate structural information (such as combat and
conversational messages) from formatting information (such as red and green
text).  By separating the two, you or the player can easily plug in
different formatting schemes without changing any of the actual content.

<p>A style sheet is composed of a list of rules, such as the two rules in the
preceding example.  Each rule contains one or more <EM>selectors</EM>
followed by a body of attribute assignments (in braces).  The selector
specifies the context of the rule and the body specifies the format.

<p>A selector may specify a container tag (such as <code>span</code>,
<code>body</code>, or <code>p</code>) and a class.  The above example could
have been written with a selector of <code>span.chat</code>.  However, by
leaving out the tag, it applies to any tag with <code>class=chat</code>.  It
is also possible to only specify the tag and not the class.  In that case,
the selector applies to any matching tag, regardless of class.

<p>To specify a <EM>nested</EM> context, several simple selectors may be listed
one after the other.  For example, emphasized text within a combat message
could be enlarged with the following rule:

<xmp>
.combat em {font-size: larger}
</xmp>

<p>It is also possible to list several selectors separated by commas in order
to make them all apply to the same body.  For example, this next rule is
equivalent to the two following ones:

<xmp>
.combat em, .chat em {font-size: larger}
.combat em {font-size: larger}
.chat em {font-size: larger}
</xmp>

<p>The style rule body contains a list of attribute assignments, delimited by
semicolons.  Each assignment takes the form of an attribute name, followed
by a colon, followed by the value of the attribute.  The following table
summarizes the recognized attributes and their possible values.

<table class="withborder">
<tr><td>color</td>           <td rowspan=2>#F00, #FF0000, red, rgb(255,0,0), rgb(100%,0%,0%)</td>
<tr><td>background</td>
<tr><td>font-size</td>       <td>10pt, 1.5em, 150%</td>
<tr><td>font-style</td>      <td>normal or italic</td>
<tr><td>font-weight</td>     <td>normal, bold, lighter, darker, or 100 to 900</td>
<tr><td>font-family</td>     <td>monospace, sans-serif, serif, cursive, ...</td>
<tr><td>font</td>            <td><i>style weight size family</i></td>
<tr><td>text-decoration</td> <td>none, underline</td>
<tr><td>text-align</td>      <td>right, left, or center</td>
<tr><td>vertical-align</td>  <td>top, middle, bottom</td>
<tr><td>text-indent</td>     <td rowspan=3>0.25in, 3em, 20pt</td>
<tr><td>margin-left</td>
<tr><td>margin-right</td>
<tr><td>width</td>           <td rowspan=2>16px, 32px, auto</td>
<tr><td>height</td>
<tr><td>line-height</td>     <td>1.2</td>
</table>

<h3>fonts</h3>

<p>The <code>font</code> attribute is a special short-hand for assigning
<code>font-size</code>, <code>font-style</code>, <code>font-weight</code>,
and <code>font-family</code> in one statement.  Any properties that are not
specified in the <code>font</code> statement are assigned to their default
values.

<p>The font family may be a specific font name or a more general category such
as monospace or sans-serif.  Since not all users necessarily have the same
fonts installed, it is a good idea to list alternate fonts.  The desired
font is placed first, followed by other possible fall-backs, each separated
by a comma.  Usually a general family such as monospace is listed last of
all.  Any font names containing a space should have quotes around them.

<p>The following example sets the font for the <code>&lt;body&gt;</code>
tag.  Even if you don't explicitly use <code>&lt;body&gt;</code> in output
text, it is applied implicitly.

<xmp>
body {font: 12pt 'Times New Roman', sans-serif}
</xmp>

<p>This sets the font to 12 point and selects <code>Times New Roman</code> if
it is available and otherwise falls back on a system-determined sans-serif
font.  This command also implicitly specifies not to use italics and to use a
normal font weight (not bold).

<p>Font sizes may be specified in points (1pt = 1/72 of an inch), picas (1pc
= 12pt), pixels (px), inches (in), centimeters (cm), and millimeters (mm).
There are also various levels corresponding to the old 1 to 7 HTML scale.
These are <tt>xx-small</tt>, <tt>x-small</tt>, <tt>small</tt>, <tt>medium</tt>,
<tt>large</tt>, <tt>x-large</tt>, and <tt>xx-large</tt>. In addition to these
absolute font sizes, it is possible to use a relative size, such as 150% or
equivalently 1.5em (1em = 100% of the current font size).  This scales the
font relative to the currently active font setting.

<p>In addition to regular classes, there are special pseudo-classes for
handling embedded hyperlinks.  These are specified in the selector with the
class starting with a colon rather than a dot.  They are <code>:link</code>,
<code>:visited</code>, and <code>:active</code>.  These only apply to the
<code>&lt;a&gt;</code> tag.  The <code>:link</code> class applies to
hyperlinks in their normal state.  Once a link has been clicked, it belongs
instead to the <code>:visited</code> class.  When the user holds the mouse
over a link, it temporarily belongs to the <code>:active</code> class.  The
only attribute that may change in an active or visited link is the text
color.

<h3>margins and indents</h3>

<p>Paragraphs can be given different margins according to your preferences.
The <code>margin-left</code> attribute controls the left margin, and
<code>margin-right</code> is the right margin. You can use specific sizes
like inches or points, or a relative size unit like em or ex. (A percentage
is interpreted so that 100% is 1em, not the width of the window.) Using the
<code>text-indent</code> attribute will indent the first line of a paragraph
from the left margin. It is possible to create a hanging indent by using a
negative value for <code>text-indent</code>, like so:

<xmp>
body {text-indent: -0.5in; margin-left: 0.5in}
</xmp>


<h3>background colors</h3>

<p>The background attribute is only relevant to the <tt>body</tt> context.  It
causes the entire terminal background to change color.  When doing this, it is
usually necessary to change the foreground colors of text or it may become
unreadable.  The various standard classes of output generated by DreamSeeker
are in the following table.

<h3>system colors</h3>

<table class="withborder">
<tr><td>system notice</td>             <td>general notices from the client</td>
<tr><td>system command echo</td>       <td>command echoing</td>
<tr><td>system command expansion</td> <td>command-line expansion list</td>
<tr><td>system pager</td>              <td>pager messages</td>
<tr><td>system irc</td>                <td>IRC command prefix</td>
</table>

<p>The value of the CLASS attribute may contain a list of classes separated by
spaces.  This permits client output to be in the 'system' class as well as
more specific ones.  That allows you to change all of these colors in one
shot if you are too lazy to change them each individually.  For example, if
you define a style sheet that changes the background color, you might need to
redefine the various foreground colors like this:

<xmp>
body {background: aqua; color: black}
.system {color: red; font-weight: bold}
.command {color: green}
</xmp>

<p>In this example, the background color of the terminal will be aqua, normal
text from the server will be black, and all output from the client will be
bold and red, except echoed commands and expansion lists, which will be bold
and green.  The more specific .command rule is placed after the general
.system rule so that its color takes precedence.  This is how style sheets
are composed&mdash;you write general rules first followed by any exceptions.

<h3>style rule precedence</h3>

<p>The order in which rules are specified is one of the factors that determines
precedence of style sheet commands.  The language is known as Cascading Style
Sheets because of its ability to handle several layers of stylistic rules,
intermingling the configurations of the user and the designer in an ordered
fashion.

<p>Rules are selected by first finding all matching candidates for a given
attribute in the current HTML tag being processed.  If there is more than
one, rules from a higher level style sheet take precedence over lower level
ones.  That means the basic user configurable settings in DreamSeeker are
the lowest priority, followed by a style sheet in the user's
<code>.dms</code> script file, followed by a style sheet from the designer's
<code>client.script</code> setting, because that is the order in which these
are read by the style sheet manager.

<p>Rules from the same style sheet are ordered by specificity.  The selector
<code>span.chat</code> is more specific than <code>.chat</code> and
<code>.chat em</code> is more specific than <code>em</code>.  In general,
the more classes referenced by a selector, the more specific it is.  When
that results in a tie, the selector with the greater number of tags takes
precedence.

<p>If two rules about the same attribute come from the same sheet and have the
same specificity, the final one to be defined takes precedence.

<p>In the rare event that a rule needs to break out of the normal order of
precedence, it can be flagged as important.  In this case it will take
precedence over all other "unimportant" rules.  However, if more than one
rule is important, the normal rules of precedence will be used to resolve
the conflict.

<p>The important flag is applied after the attribute assignment like this:

<xmp>
body {background: white ! important; font: serif}
</xmp>

<p>In the above example, only the background color is important, not the font
specification.

<h3><tt>style</tt> attribute</h3>

<p>Style commands may also be inserted directly in an html tag to control
its appearance.  This does not have the advantages of style sheets, which
separate content from presentation, but it does allow you to use the style
sheet syntax when formatting text.

<p>The following example uses the style attribute to color some text:

<xmp>
usr << "That <span style='color: red'>HURT</span>!"
</xmp>

<p>As you can see, the <code>style</code> attribute of any tag can be
assigned to a text string containing a list of attribute assignments.  Just
the body of the style rule is given, since no selector is needed to match
the current context.

<h3>Maptext options</h3>

<p>The <a class=code href=#/atom/var/maptext>atom.maptext</a> var supports
some additional CSS attributes.

<table class="withborder code">
<tr><td>vertical-align</td>  <td>top, middle, bottom</td>
<tr><td>text-shadow</td>     <td><i>x-offset y-offset blur color</i></td>
<tr><td>-dm-text-outline</td><td><i>width color style</i></td>
</table>

<p>Additionally, you can use the <tt>:hover</tt> pseudo-class to change
the color of a link. As with other link pseudo-classes, only the text color
can currently be changed.

<hr>

<a name=/DM/text/tags>
<h2>tags (text)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text/entities>entities (text)</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/DM/text/style>style sheets</a>
<dd><a href=#/DM/text>text</a>
</dl>

<p>Text tags (also known as <em>elements</em> by snooty HTML purists) control
how the text is formatted.  HTML syntax is used, so all tags start with
<code>&lt;</code> and end with <code>&gt;</code>.  The tags which are
currently supported by Dream Seeker, are listed below:

<pre>
&lt;A&gt;&lt;/A&gt;              // anchor (hyperlink)
&lt;ACRONYM&gt;&lt;/ACRONYM&gt;  // acronym or abbreviation
&lt;B&gt;&lt;/B&gt;              // bold text
&lt;BIG&gt;&lt;/BIG&gt;          // one size bigger text
&lt;BODY&gt;&lt;/BODY&gt;        // body of html document
&lt;BR&gt;                 // line break
&lt;CITE&gt;&lt;/CITE&gt;        // citation reference
&lt;CODE&gt;&lt;/CODE&gt;        // program source code
&lt;DFN&gt;&lt;/DFN&gt;          // definition
&lt;DIV&gt;&lt;/DIV&gt;          // used in conjunction with style sheets
&lt;EM&gt;&lt;/EM&gt;            // emphasized text
&lt;FONT&gt;&lt;/FONT&gt;        // font face, color, and size
&lt;H1&gt;&lt;/H1&gt;            // heading level
&lt;H2&gt;&lt;/H2&gt;
&lt;H3&gt;&lt;/H3&gt;
&lt;H4&gt;&lt;/H4&gt;
&lt;H5&gt;&lt;/H5&gt;
&lt;H6&gt;&lt;/H6&gt;
&lt;HEAD&gt;&lt;/HEAD&gt;        // document head section
&lt;HTML&gt;&lt;/HTML&gt;        // html document
&lt;I&gt;&lt;/I&gt;              // italic text
&lt;IMG&gt;&lt;/IMG&gt;          // display icons
&lt;KBD&gt;&lt;/KBD&gt;          // keyboard input
&lt;P&gt;&lt;/P&gt;              // paragraph
&lt;PRE&gt;&lt;/PRE&gt;          // pre-formatted text
&lt;S&gt;&lt;/S&gt;              // overstrike text
&lt;SAMP&gt;&lt;/SAMP&gt;        // sample output
&lt;SMALL&gt;&lt;/SMALL&gt;      // one size smaller text
&lt;SPAN&gt;&lt;/SPAN&gt;        // used in conjunction with style sheets
&lt;STRONG&gt;&lt;/STRONG&gt;    // strongly emphasized text
&lt;STYLE&gt;&lt;/STYLE&gt;      // contains a style sheet
&lt;TITLE&gt;&lt;/TITLE&gt;      // document title
&lt;TT&gt;&lt;/TT&gt;            // typewriter style
&lt;U&gt;&lt;/U&gt;              // underline
&lt;VAR&gt;&lt;/VAR&gt;          // variable name
&lt;XMP&gt;&lt;/XMP&gt;          // preformatted (tags ignored)
</pre>

<p>In addition to these, the <code>&lt;BEEP&gt;</code> tag, which is not
standard HTML, may be used to beep the terminal.

<p>Some tags take additional parameters, known as attributes.  The most common
ones are <code>&lt;FONT&gt;</code> and <code>&lt;A&gt;</code>.
The syntax for these is illustrated by the following two examples:

<xmp>
"How about <FONT FACE=Arial COLOR=red SIZE=+1>this</FONT>!"
"Click <A HREF=byond.com TITLE=BYOND!>here</A>!"
</xmp>

<p>As many attributes may be specified as desired.  The attribute value may
have quotes around it, but this is only necessary if the value contains
spaces.  It is usually more convenient to use single quotes so you don't have
to escape the double quotes, but you can also embed the HTML in a
<a href=#/DM/text>text document</a> to avoid the need for escaping quotes.

<p>When applying color to text, you can use hexadecimal RGB or you can use
one of the named <a href=#/{{appendix}}/html-colors>HTML colors</a>.

<p>Text sizes range from 1 to 7, 1 being the smallest and 7 being the largest.
In addition to absolute sizes, relative sizes may be specified (like +1 for
one size bigger or -1 for one size smaller).

<hr>

<a name=/DM/vars>
<h2 byondver=512>vars list var (global)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/var/vars>vars list var (datum)</a>
</dl>

<p>This is a list of all global variables.  The items in the list are the
variable names.  If the variable name is used as an index into the list,
the value of that variable is accessed.

<h3>Example:</h3>
<xmp>
mob/verb/dumpglobal()
   for(var/V in global.vars)
      usr << "[V] = [global.vars[V]]"
</xmp>

<p>This example displays all global variables.  The <code>global</code>
keyword is used here to distinguish it from <code>src.vars</code>, which in
this example would be the mob's vars.

<hr>

<a name=/area>
<h2>area</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom>atom</a>
<dd><a href=#/area/proc>procs (area)</a>
<dd><a href=#/area/room>rooms</a>
<dd><a href=#/area/var>vars (area)</a>
</dl>

<p>Areas are derived from <tt>/area</tt>, which derives from <tt>/atom</tt>.
Regions on the map may be assigned to an area by painting it onto the map.
Areas off the map serve as rooms that objects may enter and exit.

<p>For each area type defined, one area object is created at runtime.  So for
areas on the map, all squares with the same area type belong to the same
instance of the area.

<p>Additional instances of rooms may be created from the same type by
explicitly creating them with null as the initial location.  That is, the
first argument to <tt>new()</tt> should either be <tt>null</tt> or left
unspecified.

<p>The following example defines the area prototype
<tt>/area/outside</tt>.  It also defines an action to be taken when somebody
enters an area, namely to display its description.

<h3>Example:</h3>
<xmp>
area
  Entered(O)
    if(desc) O << desc
    return ..()

  outside
    desc = "Ah!  A breath of fresh air!"
</xmp>

<hr>

<a name=/area/proc>
<h2>procs (area)</h2>

<p>Built-in area procs:

<dl><dt>area/proc
<dd><a href=#/atom/proc/Click>Click</a>
<dd><a href=#/atom/proc/Cross>Cross proc</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc</a>
<dd><a href=#/atom/proc/DblClick>DblClick</a>
<dd><a href=#/datum/proc/Del>Del</a>
<dd><a href=#/atom/proc/Enter>Enter</a>
<dd><a href=#/atom/proc/Entered>Entered</a>
<dd><a href=#/atom/proc/Exit>Exit</a>
<dd><a href=#/atom/proc/Exited>Exited</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel</a>
<dd><a href=#/atom/proc/New>New</a>
<dd><a href=#/datum/proc/Read>Read</a>
<dd><a href=#/atom/proc/Stat>Stat</a>
<dd><a href=#/datum/proc/Topic>Topic</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc</a>
<dd><a href=#/datum/proc/Write>Write</a>
</dl>

<hr>

<a name=/area/room>
<h2>rooms</h2>

<p>Areas that are not located on the map are referred to as <em>rooms</em>.
When a player enters one, the map goes away and you have something like a text
MUD.  By default, there would be no way for players to move from one room to
another, so you have to handle movement yourself.

<p>You can check the variable <a href=#/atom/var/x>area.x</a> to see if a
given area is on the map or not.

<p>The following example puts players in a room when they log in and provides
a single exit.

<h3>Example:</h3>
<xmp>
mob/Login()
   if(!loc) Move(locate(/area/birthing_hut))
   return ..()

area/birthing_hut
   Entered(O)
      O << "Waaaaah!  You land in a pile of straw."
      return ..()
   verb/exit()
      if(Move(locate(1,1,1))) //jump to the map or whatever
         usr << "You crawl into the open air..."
      else
         usr << "The hut door is blocked.  You cannot get out."
</xmp>

<hr>

<a name=/area/var>
<h2>vars (area)</h2>

<p>Built-in area vars:

<dl><dt>area/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/contents>contents</a>
<dd><a href=#/atom/var/density>density</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>
<dd><a href=#/atom/var/maptext_height>maptext_height</a>
<dd><a href=#/atom/var/maptext_x>maptext_x</a>
<dd><a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/area/var/parent_type>parent_type</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/atom/var/verbs>verbs</a>
</dl>

<hr>

<a name=/area/var/parent_type>
<h2>parent_type var (area)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/var/parent_type>parent_type var</a>
</dl>

<p>The default parent_type of <a href=#/area>/area</a> is <a href=#/atom>/atom</a>.

<hr>

<a name=/atom>
<h2>atom</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/area>area</a>
<dd><a href=#/datum>datum</a>
<dd><a href=#/mob>mob</a>
<dd><a href=#/atom/movable>movable atoms</a>
<dd><a href=#/obj>obj</a>
<dd><a href=#/atom/proc>procs (atom)</a>
<dd><a href=#/turf>turf</a>
<dd><a href=#/atom/var>vars (atom)</a>
</dl>

<p>The /atom object type is the ancestor of all mappable objects in the
game.  The types /area, /turf, /obj, and /mob are all derived from /atom.
You should not create instances of /atom directly but should use /area,
/turf, /obj, and /mob for actual objects.  The /atom object type exists for
the purpose of defining variables or procedures that are shared by all of
the other "physical" objects.  These are also the only objects for which
verbs may be accessible to the user.

<p>/atom is derived from /datum, so it inherits the basic properties that
are shared by all DM objects.

<hr>

<a name=/atom/movable>
<h2>movable atoms</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom>atom</a>
<dd><a href=#/mob>mob</a>
<dd><a href=#/obj>obj</a>
<dd><a href=#/atom/movable/proc>procs (movable atoms)</a>
<dd><a href=#/atom/movable/var>vars (movable atoms)</a>
</dl>

<p>The /atom/movable object type is the ancestor of all mappable objects that
are capable of motion.  The types /obj and /mob are derived from
/atom/movable.  You should not create instances of /atom/movable but should
use /obj and /mob for actual objects.  This object definition exists solely
to define variables and procedures related to motion.

<hr>

<a name=/atom/movable/proc>
<h2>procs (movable atoms)</h2>

<p>Built-in movement procs:

<dl><dt>atom/movable/proc
<dd><a href=#/atom/movable/proc/Bump>Bump</a>
<dd><a href=#/atom/movable/proc/Move>Move</a>
</dl>

<hr>

<a name=/atom/movable/proc/Bump>
<h2>Bump proc (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Bump(atom/Obstacle)
</dl>

<dl><dt><b>When:</b>
<dd>Called when a movement fails due to a dense blockage.
</dl>

<dl><dt><b>Args:</b>
<dd>Obstacle: The blocking object.
</dl>

<dl><dt><b>Default action:</b>
<dd>If the obstacle is a mob and src is in its group, swap their positions.
This is only done if the mobs both move by full tiles and do not use pixel
movement, to preserve the behavior of older games.
</dl>

<hr>

<a name=/atom/proc/Cross>
<h2 byondver=490>Cross proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/mob/var/group>group var (mob)</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Cross(atom/movable/O)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 to permit; 0 to deny.
</dl>

<dl><dt><b>When:</b>
<dd>Called when another object attempts to overlap this one.
</dl>

<dl><dt><b>Args:</b>
<dd>O: the object attempting to overlap.
</dl>

<dl><dt><b>Default action:</b>
<dd>Allow overlap unless both atoms are dense. If both atoms are mobs, the
behavior depends partly on whether they are in the same group.
</dl>

<p class=note>The following behavior only applies to
<a class=code href=#/world/var/movement_mode>LEGACY_MOVEMENT_MODE</a>. In
other movement modes, src.Cross(O) returns 0 by default if src and O are both
mobs in the same group.

<p>If src completely covers the turf it is standing on, Cross() is called as
part of turf.Enter(). This is to preserve the behavior of older games, which
expect turf.Enter() to care about its contents.

<p>If src and O are both mobs, and O is in src's group, overlap is allowed
<i>unless</i> neither of them use pixel movement. Older games that do not use
pixel movement expect that Bump() will be called, and by default Bump() will
swap the mobs' positions. Swapping obviously only works in situations where a
mob takes up a whole tile and only moves by tiles; for all other situations,
allowing an overlap makes more sense.

<hr>

<a name=/atom/proc/Crossed>
<h2 byondver=490>Crossed proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/mob/var/group>group var (mob)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Crossed(atom/movable/O)
</dl>

<dl><dt><b>When:</b>
<dd>Called when an object has overlapped this one through Move(). Directly
setting the object's loc or step_x/y vars does not result in a call to
Crossed() or any other movement side-effects.  The same goes for creation
or deletion of an object at a location.
</dl>

<dl><dt><b>Args:</b>
<dd>O: the object that moved and is now overlapping.
</dl>

<dl><dt><b>Default action:</b>
<dd>none
</dl>

<h3>Example:</h3>
<xmp>
obj/landmine
   Crossed(O)
      O << "You stepped on a land mine!"
      Explode()
</xmp>

<hr>

<a name=/atom/movable/proc/Move>
<h2>Move proc (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/proc/Bump>Bump proc (movable atom)</a>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/proc/walk>walk proc</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Move(NewLoc,Dir=0,step_x=0,step_y=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>Success (jump): 1
<dd>Success (slide): Number of pixels moved
<dd>Failure: 0
</dl>

<dl><dt><b>When:</b>
<dd>Called to move the object.  By default, client.Move() calls this proc when
players use direction keys.  The automated movement functions (like walk())
also call this proc.  Directly setting the loc variable does
<strong>not</strong> call this procedure.
</dl>

<dl><dt><b>Args:</b>
<dd>NewLoc: The new location.
<dd>Dir: The direction of movement (or 0).
<dd><span byondver=490>step_x</span>: The new step_x value, relative to NewLoc
<dd><span byondver=490>step_y</span>: The new step_y value, relative to NewLoc
</dl>

<p>Any Move() is either a slide or a jump. Normal walking around is a slide;
it can be stopped partway. A jump is pass/fail. See more information below.

<p>This is what happens by default:

<ol><li><p>oldloc.Exit(src) is called for any turfs or areas being vacated, or
the container if moving out of an obj or mob. neighbor.Uncross(src) is called
for any atoms that will no longer be overlapping this object. If any of these
return 0 (failure), movement fails.</li>
<li><p>newloc.Enter(src) is called for any turfs or areas that may be entered
for the first time, or the container if moving into an obj or mob.
neighbor.Cross(src) is called for any atoms that may be in collision with this
object if the move fully succeeds. If any of these return 0 (failure), then a
slide can be cut short but a jump will fail completely.</li>
<li><p>If any obstacles were encountered via Enter() or Cross() failing, then
src.Bump(obstacle) will be called for each of them.</li>
<li><p>If movement did not fail completely, then loc and step_x/y, will be
changed, and the following calls will be made: oldloc.Exited() for any turfs,
areas, or other containers vacated; neighbor.Uncrossed() for any movable
atoms no longer overlapping; newloc.Entered() for any turfs, areas, or other
containers being entered for the first time; and neighbor.Crossed() for any
movable atoms now overlapping the object.</li>
</ol>

<p>A movement is considered a slide if src is moving from one turf to
another on the same z level, and the total pixel distance is less than either
src.step_size or a full tile size (whichever is largest). Any other movement
is a jump. Movement to the same turf with no step_x/y change is also
considered a jump.

<hr>

<a name=/atom/proc/Uncross>
<h2 byondver=490>Uncross proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/mob/var/group>group var (mob)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Uncross(atom/movable/O)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 to permit; 0 to deny.
</dl>

<dl><dt><b>When:</b>
<dd>Called when another object attempts to stop overlapping this one.
</dl>

<dl><dt><b>Args:</b>
<dd>O: the object attempting to get away.
</dl>

<dl><dt><b>Default action:</b>
<dd>Allow the object to get away (returning 1)
</dl>

<hr>

<a name=/atom/proc/Uncrossed>
<h2 byondver=490>Uncrossed proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/mob/var/group>group var (mob)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Uncrossed(atom/movable/O)
</dl>

<dl><dt><b>When:</b>
<dd>Called when an object has stopped overlapping this one through a call to
Move().  Directly setting the object's loc or step_x/y vars does not result
in a call to Uncrossed() or any other movement side-effects.  The same goes
for deletion of an object.
</dl>

<dl><dt><b>Args:</b>
<dd>O: the object that moved and is no longer overlapping.
</dl>

<dl><dt><b>Default action:</b>
<dd>none
</dl>

<h3>Example:</h3>
<xmp>
obj/pressure_plate
   Uncrossed(O)
      // if no other mobs are standing on it...
      if(!(locate(/mob) in bounds()))
         // do something
         Release()
</xmp>

<hr>

<a name=/atom/movable/var>
<h2>vars (movable atoms)</h2>

<p>Built-in movement vars:

<dl><dt>atom/movable/var
<dd><a href=#/atom/movable/var/animate_movement>animate_movement</a>
<dd><a href=#/atom/movable/var/bound_x>bound_x</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height</a>
<dd><a href=#/atom/movable/var/locs>locs</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size</a>
<dd><a href=#/atom/movable/var/particles>particles</a>
<dd><a href=#/atom/movable/var/step_size>step_size</a>
<dd><a href=#/atom/movable/var/step_x>step_x</a>
<dd><a href=#/atom/movable/var/step_y>step_y</a>
</dl>

<hr>

<a name=/atom/movable/var/animate_movement>
<h2>animate_movement var (movable atoms)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atoms)</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>FORWARD_STEPS (1)
</dl>

<dl><dt><b>Possible values:</b>
<dd>NO_STEPS (0)
<dd>FORWARD_STEPS (1)
<dd>SLIDE_STEPS (2)
<dd deprecated=1>SYNC_STEPS (3)
</dl>

<p>Setting this to 0 causes movement between two adjacent positions to be
displayed as a single discrete jump.  Otherwise, objects will be made to glide
from one position to another, using the movement animation defined in the icon
file if one is defined.

<p>By default, movement animation avoids cutting corners, since this can look
very bad in some games.  If you want objects to take the shortest (and
smoothest) visual path when moving around, use <tt>SLIDE_STEPS</tt> instead of
the default <tt>FORWARD_STEPS</tt>.  This also allows the object to be facing
in a different direction than it is moving, so make sure this is what you want.

<p><tt>SYNC_STEPS</tt> is intended for objects that move in unison as part of
a larger "conglomerate" object.  You should set the movement animation to
<tt>SYNC_STEPS</tt> on all but a single "head" object, which will serve as the
leader when choosing pixel step sizes.  If you do not use <tt>SYNC_STEPS</tt>,
there are cases where the pixel offsets of objects may get out of sync during
motion, causing the object to visually break up. Because of the advent of
features like big icons, this value is no longer of much use.

<p>Note: This setting has no impact when used with pixel movement, except in
special cases. See <a href=#/{notes}/gliding>Gliding</a> for more details.

<hr>

<a name=/atom/movable/var/bound_x>
<h2 byondver=490>bound_x var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p class=deprecated>Note: The bound_x/y vars aren't exactly deprecated, but
it's preferable to use icon_w/z or pixel_w/z instead. Best practice is to
avoid bound_x/y altogether, and use bound_width/height alone to define a
bounding box. New behavior simply subtracts bound_x/y from pixel_w/z to mimic
the old usage.

<p>This var defines the left side of the physical atom's bounding box, in
pixels. By default all atoms are assumed to be one tile in physical size.

<p>The left edge of the bounding box starts bound_x pixels inward from the
left edge of the atom's icon (as affected by step_x). A bound_x value of 4
means the atom has 4 pixels of empty space to its left.

<p>Example: A 16&times;16 smiley face centered in a 32&times;32 icon should
have a bound_x value of 8, since there are 8 pixels of empty space to the
left.

<hr>

<a name=/atom/movable/var/bound_y>
<h2 byondver=490>bound_y var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p class=deprecated>Note: The bound_x/y vars aren't exactly deprecated, but
it's preferable to use icon_w/z or pixel_w/z instead. Best practice is to
avoid bound_x/y altogether, and use bound_width/height alone to define a
bounding box. New behavior simply subtracts bound_x/y from pixel_w/z to mimic
the old usage.

<p>This var defines the bottom side of the physical atom's bounding box, in
pixels. By default all atoms are assumed to be one tile in physical size.

<p>The bottom edge of the bounding box starts bound_y pixels inward from the
bottom edge of the atom's icon (as affected by step_y). A bound_y value of 4
means the atom has 4 pixels of empty space below it.

<p>Example: A 16&times;16 smiley face centered in a 32&times;32 icon should
have a bound_y value of 8, since there are 8 pixels of empty space below.

<hr>

<a name=/atom/movable/var/bound_width>
<h2 byondver=490>bound_width var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>32 (width of default icon; depends on world.icon_size)
</dl>

<p>This var defines the width of the physical atom's bounding box, in
pixels. By default all atoms are assumed to be one tile in physical size.

<p>Example: A 16&times;16 smiley face centered in a 32&times;32 icon should
have a bound_width value of 16.

<hr>

<a name=/atom/movable/var/bound_height>
<h2 byondver=490>bound_height var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>32 (depends on world.icon_size)
</dl>

<p>This var defines the height of the physical atom's bounding box, in
pixels. By default all atoms are assumed to be one tile in physical size.

<p>Example: A 16&times;16 smiley face centered in a 32&times;32 icon should
have a bound_height value of 16.

<p>The default value depends on world.icon_size and world.map_format. In a
topdown or tiled map_format, the icon height specified in world.icon_size is
used. In other modes, height is irrelevant and tile "footprints" are square,
so the icon width is used.

<hr>

<a name=/atom/movable/var/glide_size>
<h2 byondver=490>glide_size var (movable atoms)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement var (movable atoms)</a>
<dd><a href=#/client/var/glide_size>glide_size var (client)</a>
<dd><a href=#/atom/var/pixel_x>pixel_x var (atom)</a>
<dd><a href=#/atom/var/pixel_y>pixel_y var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
<dd><a href=#/client/var/fps>fps var (client)</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Note: The way this setting is used depends on
<a href=#/world/var/movement_mode>world.movement_mode</a>. See
<a href=#/{notes}/gliding>Gliding</a> for more details.

<p>This controls the number of pixels an object is moved in each footstep
during animated movement.  The default value of 0 chooses automated control
over this value, which generally results in a minimum footstep of 4 pixels
that is increased when necessary to keep up with motion on the turf grid.

<p>Decimal values are allowed.

<p>Be careful about using small glide sizes.  Icons with high contrast
pixel-level detail can look pretty ugly when displaced by short distances.

<p>The glide size is measured in server ticks. If you use a different client
tick rate by altering <code>client.fps</code> or <code>client.tick_lag</code>,
the actual glide used will be scaled appropriately.  E.g., if your
<code>client.fps</code> is 4 times greater than <code>world.fps</code>, the
actual glide amount each client tick will be <code>glide_size/4</code>.

<p>This was renamed from <tt>pixel_step_size</tt>.

<hr>

<a name=/atom/movable/var/locs>
<h2 byondver=490>locs list var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
<dd><a href=#/atom/var/contents>contents list var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>list(src.loc)
</dl>

<p>This read-only var tells which turfs are being physically covered by the
atom's bounding box. The purpose of this is for cases where you set the
atom's bounds to change its physical size so that it ends up covering more
than one turf.

<p>This is different from the loc var in that every atom still has only one
"true" location. A movable atom may cover multiple turfs, but only one turf
is its loc. The loc var can be thought of as an anchor point, while the
actual physical footprint is in locs.

<p>For every turf in locs, this atom will also be in that turf's contents
list.

<p>If loc is not a turf, it will be the only item in the locs list. If loc
is null, locs will be empty.

<hr>

<a name=/atom/movable/var/particles>
<h2 byondver=514>particles var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/particles>Particle effects</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>A datum (not derived from /atom) containing information about a particle
set attached to this atom. See <a href=#/{notes}/particles>Particle
effects</a> for more information.

<p>Resetting this var to null after it has contained a particle set will
cause any existing particles on this object to immiediately disappear.

<hr>

<a name=/atom/movable/var/pixel_step_size>
<h2>pixel_step_size var (movable atoms)</h2>

<p>Renamed to <a href=#/atom/movable/var/glide_size>glide_size</a>.

<hr>

<a name=/atom/movable/var/screen_loc>
<h2>screen_loc var (movable atoms)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/HUD>HUD / screen objects</a>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/client/var/screen>screen var (client)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
</dl>

<p>This is a text string that controls where an object that is listed in
<var>client.screen</var> will appear on the user's screen.  The format is:

<xmp>
"x,y"
"x:px,y:py"
"x1,y1 to x2,y2"
</xmp>

<p>The bottom left corner of the map viewport (southwest) is <tt>"1,1"</tt>.
If the view is 11x11, then the top-right corner (northeast) is
<tt>"11,11"</tt>. (Changing <a href=#/world/var/map_format>world.map_format</a>
may change the range for screen_loc.)

<p>A range of coordinates (the second format above) causes a square region to
be filled with the object at each position.  The southwest and northeast
corners of the box are indicated in the screen_loc value.

<p>If you use a <tt>screen_loc</tt> outside of the normal map view, extra
tiles will be added to that side and the map will be clipped. For example, a
value of <tt>"0,1"</tt> adds an extra column of tiles to the left, but that
column will be blank except for any screen objects you show there. This is
used if you want screen objects to provide a border around the map.

<h3>Special keywords</h3>

<p>The edges of the map may also be referenced by using directions, such as
<code>"3,NORTH"</code>.  For convenience, the order of coordinates is arbitrary
when using directions, so one may specify <var>y</var> before <var>x</var> as
in <code>"NORTH,WEST"</code>.  In expressions such as the latter, you may also
leave out the comma.  Icon size is not taken into account, so a big icon with
a screen_loc of <code>"SOUTHEAST"</code> will extend further to the right and
may create a border (see "Outside the map" below).

<p byondver=471>The <tt>CENTER</tt> keyword can also be used. This can be used alone to
completely center the object, or as either the x or y component. If the map
covers an even number of tiles in either direction, pixel offsets will be
applied automatically.  Centering is relative to the regular map edges, and it
does not take the icon's size into account.

<p byondver=512>The <tt>LEFT</tt>, <tt>RIGHT</tt>, <tt>TOP</tt>, and <tt>BOTTOM</tt>
keywords (also <tt>TOPLEFT</tt>, <tt>TOPRIGHT</tt>, <tt>BOTTOMLEFT</tt>,
<tt>BOTTOMRIGHT</tt>) can be used to anchor a screen object to the edge of
the map control if the map is zoomed in so that some pixels are cut off. When
you use these edge-alignment keywords, the icon size <i>is</i> taken into
account, and the alignment of the icon  changes to fit whichever edge you use.
Because these keywords do not conform to the normal tile-based structure of
the HUD, they can't be used for a range of tiles with the <code>"to"</code>
format.

<p byondver=516>The equivalent to <tt>CENTER</tt> for the
<tt>LEFT</tt>/<tt>RIGHT</tt>/<tt>TOP</tt>/<tt>BOTTOM</tt> keywords is
<tt>MIDDLE</tt>. It acts the same as <tt>LEFT+50%</tt>, <tt>BOTTOM+50%</tt>,
or both.

<p>Note: <a href=#/{skin}/param/letterbox>Letterboxing</a>, the blank space to
either side of the map if it doesn't take up the whole map control, is not
considered usable space. HUD objects aligned to the control edge appear inside
any letterboxing, not on top of it.

<p byondver=516><tt>SCREEN_SOUTHWEST</tt>, <tt>SCREEN_EAST</tt>, and other
directions with <tt>SCREEN_</tt> in front will anchor a screen object relative
to the extent of all other screen objects. That is, if you extend the screen
beyond the map with another object that uses <tt>0,0</tt>, then
<tt>SCREEN_SOUTHWEST</tt> will refer to <tt>0,0</tt> instead of the normal
<tt>1,1</tt> that <tt>SOUTHWEST</tt> would do.

<p>This is especially useful if you're using a
<a class=code href=#/atom/var/render_source>render_source</a> to copy a plane
master. The object using <tt>render_source</tt> should be anchored at
<tt>SCREEN_SOUTHWEST</tt>, which is the corner of the plane.

<h3>Outside the map</h3>

<p>In addition to objects inside of the map view, one may create border
objects.  Borders are automatically created when screen objects are placed at
coordinates outside of the inner map view.  For example, objects placed at y=0
fall on a border directly below the map and y=-1 is one tile below that.  (The
<tt>CENTER</tt> keyword is based on normal viewport bounds and not any extra
borders.)

<p>A big icon placed towards the northeast end of the map, if it spills over
the edge, will create a border big enough for the whole icon to be shown. You
can avoid this by using the
<a href=#/atom/var/appearance_flags><tt>TILE_BOUND</tt> appearance flag</a>.
Transforms on this atom are not taken into account when determining whether to
add a border.

<h3>Offsets</h3>

<p>Offsets may be applied to screen_loc coordinates.  For example,
<code>"NORTH+1,WEST"</code> is in a border above the map.
<code>"CENTER+2,CENTER-1"</code> will appear 2 units right, 1 unit down from
the center of the map.

<p byondver=512>Non-integer offsets like 1.5 are allowed; the fractional part
will be counted towards a pixel offset.

<p byondver=512>Offsets may be specified in percentages as well. These effectively always
count as pixel offsets and will never be used to determine if a border should
be added. <code>"WEST+100%"</code> and <code>"100%"</code> are basically
identical to <code>"EAST"</code> in most respects, and <code>"WEST+50%"</code>
is basically the same as <code>"CENTER"</code>. If you're using the edge
keywords (<tt>LEFT</tt>, <tt>TOP</tt>, etc.), this percentage is relative to
the control edge and also factors in the icon size, so <code>"LEFT+100%"</code>
is equivalent to <code>"RIGHT"</code>.

<p>It is also possible to specify a pixel offset.  Screen objects do not use
<tt>pixel_x</tt> and <tt>pixel_y</tt> for this purpose, because it is intended
that an object could exist on the map and in the screen object list
simultaneously, so positioning must be independent. Pixel offsets are
specified after a colon like this: <tt>"1:16,1:16"</tt>. In this case the
object is shifted to the northeast by 16 pixels.

<h3>Layering</h3>

<p>Screen objects on a plane will appear above non-screen objects on the same
plane regardless of layer, except that <tt>BACKGROUND_LAYER</tt> or
<tt>EFFECTS_LAYER</tt> may be used to move the objects forward or back.

<h3>Secondary map controls</h3>

<p>You can use HUD objects in any additional <a href=#/{skin}/control/map>map
controls</a> that might appear in game's skin file. If you have a second map
named <tt>map2</tt> for instance, then you can use <tt>"map2:1,1"</tt> or
something similar as a <tt>screen_loc</tt>. If the map control is set to
automatically scale to fit its contents, it will try to show every object you
put there.

<p>Note: For secondary-map HUD items, you should not use the full
<tt>window.control</tt> ID, just the <a class=code href=#/{skin}/param/id>id</a>
of the control itself. Map controls should always have a unique <tt>id</tt>.

<hr>

<a name=/atom/movable/var/step_size>
<h2 byondver=490>step_size var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/world/var/fps>fps var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>32 (width of default icon; depends on world.icon_size)
</dl>

<p>This var defines how fast, in pixels, an atom will move by default.
If you use lower values of <tt>step_size</tt> for most items in your
world, you may want to consider raising <tt>world.fps</tt> (at higher
performance cost).

<p>When <tt>Move()</tt> is called by a step or walk, or by the built-in client
movement verbs, a change of <tt>step_size</tt> is applied to <tt>step_x</tt>
and/or <tt>step_y</tt>. Any movement within the speed of <tt>step_size</tt>,
or up to one tile in distance (whichever is greater), is considered a slide
and may partially succeed if an obstacle is bumped before reaching the final
position.

<hr>

<a name=/atom/movable/var/step_x>
<h2 byondver=490>step_x var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This var defines the position of the atom (in pixels) relative to its
tile, on the x axis. A step_x of 5 means the atom actually is shown 5 pixels
east of the tile's western edge.

<p>The atom's actual bounding box may not begin at step_x, but can be set
even further in via bound_x.

<p>Example: A 16&times;16 smiley face centered in a 32&times;32 icon should
have the following bounds:

<ul><li>bound_x = 8</li>
<li>bound_y = 8</li>
<li>bound_width = 16</li>
<li>bound_height = 16</li>
</ul>

<p>For the smiley to appear at the left edge of the tile it is standing on,
it would need a step_x value of -8. A step_x value of 8 takes it all the way
to the rightmost edge of the tile. Anything outside of the range -8 to 8 will
have the atom straddling multiple turfs.

<hr>

<a name=/atom/movable/var/step_y>
<h2 byondver=490>step_y var (movable atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_x>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This var defines the position of the atom (in pixels) relative to its
tile, on the y axis. A step_y of 5 means the atom actually is shown 5 pixels
north of the tile's southern edge.

<p>The atom's actual bounding box may not begin at step_y, but can be set
even further in via bound_y.

<p>Example: A 16&times;16 smiley face centered in a 32&times;32 icon should
have the following bounds:

<ul><li>bound_x = 8</li>
<li>bound_y = 8</li>
<li>bound_width = 16</li>
<li>bound_height = 16</li>
</ul>

<p>For the smiley to appear at the bottom edge of the tile it is standing on,
it would need a step_y value of -8. A step_y value of 8 takes it all the way
to the top edge of the tile. Anything outside of the range -8 to 8 will have
the atom straddling multiple turfs.

<hr>

<a name=/atom/proc>
<h2>procs (atom)</h2>

<p>Built-in atom procs:

<dl><dt>atom/proc
<dd><a href=#/atom/proc/Click>Click</a>
<dd><a href=#/atom/proc/Cross>Cross proc</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc</a>
<dd><a href=#/atom/proc/DblClick>DblClick</a>
<dd><a href=#/datum/proc/Del>Del</a>
<dd><a href=#/atom/proc/Enter>Enter</a>
<dd><a href=#/atom/proc/Entered>Entered</a>
<dd><a href=#/atom/proc/Exit>Exit</a>
<dd><a href=#/atom/proc/Exited>Exited</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel</a>
<dd><a href=#/atom/proc/New>New</a>
<dd><a href=#/datum/proc/Read>Read</a>
<dd><a href=#/atom/proc/Stat>Stat</a>
<dd><a href=#/datum/proc/Topic>Topic</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc</a>
<dd><a href=#/datum/proc/Write>Write</a>
</dl>

<hr>

<a name=/atom/proc/Click>
<h2>Click proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Click(location,control,params)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the object is clicked.
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. in which the object was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This proc is called by the default client.Click() procedure.

<p>The following example allows the player to walk to a position by clicking
it.

<h3>Example:</h3>
<xmp>
turf/Click()
  walk_to(usr,src)
</xmp>

<hr>

<a name=/atom/proc/DblClick>
<h2>DblClick proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>DblClick(location,control,params)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the object is double-clicked.
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. in which the object was double-clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This proc is called by the default client.DblClick() procedure.

<p>This example allows the player to teleport to a position by double
clicking it.

<h3>Example:</h3>
<xmp>
turf/DblClick()
  usr.Move(src)
</xmp>

<hr>

<a name=/atom/proc/Enter>
<h2>Enter proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Enter(atom/movable/O, atom/oldloc)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 to permit; 0 to deny.
</dl>

<dl><dt><b>When:</b>
<dd>Called when an object attempts to enter the contents list.
</dl>

<dl><dt><b>Args:</b>
<dd>O: the object attempting to enter.
<dd>oldloc: the old (current) loc of the object attempting to enter.
</dl>

<dl><dt><b>Default action:</b>
<dd>Explained below.
</dl>

<p>Areas, objs, and mobs will always permit anything to enter by default.

<p class=note>The following behavior only applies to
<a class=code href=#/world/var/movement_mode>LEGACY_MOVEMENT_MODE</a>. In all
other movement modes, the turf's contents are not taken into account. Only the
result of turf.Cross() matters.

<p>Turfs will return 1 (permit) or 0 (deny) based on density. In simple
terms, if the atom that is entering is dense, then the turf will deny entry
if the turf itself or its contents (any that take up the full tile) are
dense.

<p>What actually happens in turf.Enter() is more detailed: Cross() is called
for the turf, and if it succeeds (movement is permitted), then Cross() is
called for any atoms in turf.contents that cover the entire tile. If any
Cross() call fails, Enter() fails too and will return 0.

<p>If a mob is standing on a turf but its bounding box does not cover the
whole tile, it is ignored by Enter(). Instead, its Cross() proc is called if
there is a danger of the object overlapping it.

<hr>

<a name=/atom/proc/Entered>
<h2>Entered proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Entered(atom/movable/Obj,atom/OldLoc)
</dl>

<dl><dt><b>When:</b>
<dd>Called when an object has entered the contents list through Move().
Directly setting the object's loc or step_x/y vars does not result in a
call to Entered() or any other movement side-effects.  The same goes for
creation or deletion of an object at a location.
</dl>

<dl><dt><b>Args:</b>
<dd>Obj: the object that entered (a mob or obj).
<dd>OldLoc: the previous location of the object.
</dl>

<dl><dt><b>Default action:</b>
<dd>None for most atoms, but turfs will call Crossed().
</dl>

<h3>Example:</h3>
<xmp>
turf/pit
   Entered(O)
      O << "OUCH.  You fell in a pit!"
</xmp>

<p>The mob's Entered() and Exited() procs can be used to control what
happens when objects are added or removed from the mob's inventory.  Of
course that could all be done within get() and drop() verbs, but the
following code separates user interface from lower-level functions.

<h3>Example:</h3>
<xmp>
obj
   var
      weight = 10
   verb
      get()
         set src in oview(1)
         if(Move(usr))
            usr << "You pick up \a [src]."
         else
            usr << "You cannot pick up [src]."
      drop()
         set src in usr
         if(Move(usr.loc))
            usr << "You drop \a [src]."
mob
   var
      weight
      max_weight = 50

   Entered(obj/O)
      weight += O.weight
   Exited(obj/O)
      weight -= O.weight
   Enter(obj/O)
      //only allow entrance if weight is within the limit
      if(O.weight + weight <= max_weight)
         return ..()
</xmp>

<p>To see the advantages of this arrangement, imagine that there are certain
situations in which an object may be created directly within the mob's
inventory without the mob picking it up.  You can still run it through your
normal movement rules without calling get().

<h3>Example:</h3>
<xmp>
mob/verb/wish()
   var/obj/O = new() //create it with loc=null
   if(O.Move(usr))   //and then move it into inventory
      usr << "Your wish has been granted!"
   else
      usr << "You are too greedy!"
      del O
</xmp>

<hr>

<a name=/atom/proc/Exit>
<h2>Exit proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Exit(atom/movable/O, atom/newloc)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 to permit; 0 to deny.
</dl>

<dl><dt><b>When:</b>
<dd>Called when an object attempts to exit the contents list.
</dl>

<dl><dt><b>Args:</b>
<dd>O: the object attempting to exit.
<dd><span byondver=507>newloc</span>: the object's new location.
</dl>

<dl><dt><b>Default action:</b>
<dd>Turfs will call Uncross() and return that value (1 by default). All others allow the object to exit (returning 1).
</dl>

<p>By default, every atom returns 1 to allow exit, except for turfs which
call Uncross() to handle it for them.

<p class=note>The following behavior only applies to
<a class=code href=#/world/var/movement_mode>LEGACY_MOVEMENT_MODE</a>. In all
other movement modes, the turf's contents are not taken into account. Only the
result of turf.Uncross() matters.

<p>In the default Exit handler for turfs, Uncross() is called for the turf
itself and then Uncross() will also be called for any atoms in turf.contents
that cover the entire tile. If any Uncross() call fails, Exit() fails too and
will return 0. In games using pixel movement, Uncross() is usually called
separately, but this allows projects using tile-based movement instead to
benefit from Cross() and Uncross().

<hr>

<a name=/atom/proc/Exited>
<h2>Exited proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Exited(atom/movable/Obj, atom/newloc)
</dl>

<dl><dt><b>When:</b>
<dd>Called when an object has exited from the contents list through a call to
Move().  Directly setting the object's loc or step_x/y vars does not result
in a call to Exited() or any other movement side-effects.  The same goes for
deletion of an object.
</dl>

<dl><dt><b>Args:</b>
<dd>Obj: the object that exited (a mob or obj).
<dd><span byondver=507>newloc</span>: the object's new location.
</dl>

<dl><dt><b>Default action:</b>
<dd>None for most atoms, but turfs will call Uncrossed().
</dl>

<hr>

<a name=/atom/proc/MouseDown>
<h2>MouseDown proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseDown(location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. in which the object was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when a mouse button is pressed while pointing to this
object.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Most operations can be done through
<tt>Click()</tt>, <tt>DblClick()</tt>, and <tt>MouseDrop()</tt>. The other
procedures are simply available for completeness.

<p class=compatibility>Note: In BYOND 3.5 this procedure took three different
arguments: <tt>location</tt>, <tt>icon_x</tt>, and <tt>icon_y</tt>. Since
<tt>icon_x</tt> and <tt>icon_y</tt> have been replaced, old code will need to
be modified. Games compiled before this change will still work normally.

<hr>

<a name=/atom/proc/MouseDrag>
<h2>MouseDrag proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseDrag(over_object,src_location,over_location,src_control,over_control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>over_object: the object under the mouse pointer
<dd>src_location: the turf, stat panel, grid cell, etc. from where the src object was dragged
<dd>over_location: the turf, stat panel, grid cell, etc. containing the object under the mouse pointer
<dd>src_control: The id of the skin control the object was dragged from
<dd>over_control: The id of the skin control the object was dragged over
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called while dragging this object by pressing and holding the left
mouse button over the object and moving the mouse.  The over_object may be
null if dragging over a stat panel or over other empty space.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Most operations can be done through
<tt>Click()</tt>, <tt>DblClick()</tt>, and <tt>MouseDrop()</tt>.  The other
procedures are simply available for completeness.

<hr>

<a name=/atom/proc/MouseDrop>
<h2>MouseDrop proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseDrop(over_object,src_location,over_location,src_control,over_control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>over_object: the object under the mouse pointer
<dd>src_location: the turf, stat panel, grid cell, etc. from where the src object was dragged
<dd>over_location: the turf, stat panel, grid cell, etc. containing the object under the mouse pointer
<dd>src_control: The id of the skin control the object was dragged from
<dd>over_control: The id of the skin control the object was dropped onto
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when the a mouse button is released after dragging this
object.  The over_object may be null if dropping over a stat panel or over
other empty space.

<hr>

<a name=/atom/proc/MouseEntered>
<h2>MouseEntered proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseEntered(location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. containing the object
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when the mouse moves onto the object with no buttons
pressed.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<hr>

<a name=/atom/proc/MouseExited>
<h2>MouseExited proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseExited(location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. containing the object
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when the mouse moves off of an object with no buttons
pressed.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<hr>

<a name=/atom/proc/MouseMove>
<h2 byondver=500>MouseMove proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseMove(location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. containing the object
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when the mouse moves over the object with no buttons
pressed. When the mouse moves over for the first time, MouseEntered() is
called instead.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<hr>

<a name=/atom/proc/MouseUp>
<h2>MouseUp proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseUp(location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>location: the turf, stat panel, grid cell, etc. in which the object was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when a mouse button is released while pointing to
this object.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Most operations can be done through
<tt>Click()</tt>, <tt>DblClick()</tt>, and <tt>MouseDrop()</tt>. The other
procedures are simply available for completeness.

<p class=compatibility>Note: In BYOND 3.5 this procedure took three different
arguments: <tt>location</tt>, <tt>icon_x</tt>, and <tt>icon_y</tt>. Since
<tt>icon_x</tt> and <tt>icon_y</tt> have been replaced, old code will need to
be modified. Games compiled before this change will still work normally.

<hr>

<a name=/atom/proc/MouseWheel>
<h2 byondver=508>MouseWheel proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseWheel(delta_x,delta_y,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>delta_x,delta_y: amount of wheel movement
<dd>location: the turf, stat panel, grid cell, etc. containing the object
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<p>This is called when the mouse wheel is moved while over an object.

<p>Positive values of delta_x and delta_y refer to scrolling right or up,
respectively. Negative values are left and down, respectively.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<hr>

<a name=/atom/proc/New>
<h2>New proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/proc/New>New proc (datum)</a>
<dd><a href=#/proc/new>new proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New(loc)
<dd><small>(supports <a href=#/proc/arguments/named>named arguments</a>)</small>
</dl>

<dl><dt><b>When:</b>
<dd>Called when the object is created.
</dl>

<dl><dt><b>Args:</b>
<dd>loc: The initial location.
</dl>

<dl><dt><b>Default action:</b>
<dd>None.
</dl>

<p>By the time New() is called, the object has already been created at the
specified location and all of its variables have been initialized.  You can
perform additional initialization by overriding this procedure.

<p>Since the initial location parameter passed to <code>new()</code> is
applied before New() is even called, there is some special handling of the
<var>loc</var> variable when using named arguments in a call.  Normally, if a
procedure is overridden, named arguments in a call are matched against those
in the the overridden definition.  In this case, however, the <var>loc</var>
parameter name is hard-coded.  Regardless of what you call the first argument
in your definition of New(), the initial location will be taken from the first
positional argument, or from the argument named <var>loc</var> if there are no
positional arguments.

<p>The following example does some extra initialization that is not possible
in the variable definition section, because it requires a runtime evaluation.
This is a common reason to use New().

<h3>Example:</h3>
<xmp>
mob
   var
      birthdate //time stamp
   New()
      birthdate = world.realtime
      return ..()
   verb/look()
      set src in view()
      usr << "[src] was born on [time2text(birthdate,"DD-MMM-YYYY")]."
</xmp>

<hr>

<a name=/atom/proc/Stat>
<h2>Stat proc (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Stat>Stat proc (client)</a>
<dd><a href=#/proc/stat>stat proc</a>
<dd><a href=#/{skin}/control/info>Info control (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Stat()
</dl>

<dl><dt><b>When:</b>
<dd>Called periodically by the client to update the stat window.
</dl>

<dl><dt><b>Default action:</b>
<dd>none.
</dl>

<p>The following code could be used to display a player's current status.

<h3>Example:</h3>
<xmp>
mob/var
   health = 100
mob/Stat()
   stat("health",health)
   statpanel("Inventory",contents)
</xmp>

<hr>

<a name=/atom/var>
<h2>vars (atom)</h2>

<p>Built-in atom vars:

<dl><dt>atom/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/contents>contents</a>
<dd><a href=#/atom/var/density>density</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/infra_luminosity>infra_luminosity</a>
<dd><a href=#/atom/var/loc>loc</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>
<dd><a href=#/atom/var/maptext_height>maptext_height</a>
<dd><a href=#/atom/var/maptext_x>maptext_x</a>
<dd><a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/override>override</a> (images only)
<dd><a href=#/datum/var/parent_type>parent_type</a>
<dd><a href=#/atom/var/pixel_x>pixel_x</a>
<dd><a href=#/atom/var/pixel_y>pixel_y</a>
<dd><a href=#/atom/var/pixel_w>pixel_w</a>
<dd><a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/atom/var/verbs>verbs</a>
<dd><a href=#/atom/var/x>x</a>
<dd><a href=#/atom/var/y>y</a>
<dd><a href=#/atom/var/z>z</a>
</dl>

<hr>

<a name=/atom/var/alpha>
<h2 byondver=500>alpha var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/atom/var/blend_mode>blend_mode var (atom)</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>255 (opaque)
</dl>

<dl><dt><b>Possible values:</b>
<dd>0 (transparent) through 255 (opaque)
</dl>

<p>Controls the opacity of the icon displayed on players' screens. A value of
128 means the atom is half-transparent, so it will have a ghostly appearance.
This can be used to fade an atom in and out, especially when combined with
animation. Alpha is also applied to maptext.

<p>Overlays and images will also be affected by alpha, unless they use the
RESET_ALPHA value in appearance_flags.

<hr>

<a name=/atom/var/appearance>
<h2 byondver=508>appearance var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/mutable_appearance>mutable appearance</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<p>Every atom or image has an appearance, which controls all of the values
relating to how it appears on the map. (The overlays and underlays lists are
lists of appearances.) When read, this var provides a copy of the current
appearance.

<p>This value can also be used to change an atom's appearance, altering
multiple values at once. Setting atom.appearance to another appearance will
change all of the following values to match:

<dl>
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/infra_luminosity>infra_luminosity</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>, <a href=#/atom/var/maptext_height>maptext_height</a>, <a href=#/atom/var/maptext_x>maptext_x</a>, <a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>, <a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>, <a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/override>override</a> (images only)
<dd><a href=#/atom/var/pixel_x>pixel_x</a>, <a href=#/atom/var/pixel_y>pixel_y</a>, <a href=#/atom/var/pixel_w>pixel_w</a>, <a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>, <a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/vis_flags>vis_flags</a>
</dl>

<p>Other vars that are technically part of the appearance, but don't make any
sense to change when cloning, are not changed. These include <tt>density</tt>,
<tt>dir</tt>, <tt>screen_loc</tt>, and <tt>verbs</tt>. However, those vars ARE
copied when you assign a <tt>/mutable_appearance</tt>.

<p>If you set <tt>atom.appearance</tt> to another atom, the other atom's appearance
will be copied.

<hr>

<a name=/atom/var/appearance_flags>
<h2 byondver=509>appearance_flags var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/atom/var/alpha>alpha var (atom)</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/atom/var/transform>transform var (atom)</a>
<dd><a href=#/client/var/color>color var (client)</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<dl><dt><b>Possible values:</b>
<dd>Any combination of:
<dd><b>LONG_GLIDE</b>: Diagonal glides take as long as cardinal ones
<dd><b>RESET_COLOR</b>: If this is an overlay/image/etc., ignore the parent's color
<dd><b>RESET_ALPHA</b>: If this is an overlay/image/etc., ignore the parent's alpha value
<dd><b>RESET_TRANSFORM</b>: If this is an overlay/image/etc., ignore the parent's transform
<dd><b>NO_CLIENT_COLOR</b>: Ignore client.color
<dd byondver=510><b>KEEP_TOGETHER</b>: Draw this icon along with its overlays and underlays, as one unit
<dd byondver=510><b>KEEP_APART</b>: Detach from a parent icon that uses <tt>KEEP_TOGETHER</tt>
<dd byondver=510><b>PLANE_MASTER</b>: Groups all other icons in the same plane
<dd byondver=510><b>TILE_BOUND</b>: Avoids more accurate visibility calculations
<dd byondver=511><b>PIXEL_SCALE</b>: Use point sampling when transforming this icon
<dd byondver=513><b>PASS_MOUSE</b>: If this icon has a <tt>render_source</tt>, pass any mouse hits to the render source
<dd byondver=514><b>TILE_MOVER</b>: This atom is always locked to the grid
</dl>

<p>The appearance_flags value controls miscellaneous behavior of an atom or
appearance that doesn't make sense to handle in any other var.

<p>These values are bitflags, and can be combined with the <tt>+</tt> or
<tt>|</tt> operator.

<h3>LONG_GLIDE</h3>

<p>Gliding is normally done by Euclidean (straight-line) distance, so diagonal
gliding across a square tile takes about 41% longer, since the distance is
multiplied by sqrt(2). With <tt>LONG_GLIDE</tt>, the dominant X or Y direction
of the glide is used to adjust the glide size so it takes just as long as if
the object were gliding in a cardinal direction.

<h3>RESET_COLOR, RESET_ALPHA, RESET_TRANSFORM</h3>

<p>These flags cause this overlay not to inherit aspects of its parent object.
Ordinarily, transforms on a parent get applied to overlays too, as does color.

<p>All of these flags are ignored if <tt>KEEP_TOGETHER</tt> is used on the
parent (and this object does not override with <tt>KEEP_APART</tt>), since
then the parent icon along with all of its overlays get drawn to a single
surface and color, transform, etc. are applied afterward.

<h3>NO_CLIENT_COLOR</h3>

<p>The value of <a class=code href=#/client/var/color>client.color</a> is
normally applied to all icons. This flag says that the icon is an exception.
Generally <tt>client.color</tt> has been superseded by the use of plane
masters anyway.

<p>The <tt>NO_CLIENT_COLOR</tt> flag is inherited by overlays and images
automatically unless they have the <tt>RESET_COLOR</tt> flag. It is also
basically meaningless when used on an overlay that's inside of a
<tt>KEEP_TOGETHER</tt> group, since the client's color is applied to the
entire group.

<h3 byondver=510>KEEP_TOGETHER</h3>

<p>This flag is used to force the overlays and underlays of this icon (its
"children") to be drawn with it all at once, not each icon individually. One
reason you might want to do this is if your player's icon uses overlays for
hair and equipment, and you want to change the alpha value to make them fade
out. With regular drawing, changing the parent icon's alpha means that each
individual icon becomes translucent; with <tt>KEEP_TOGETHER</tt>, the whole
combination fades as one unit. Because this incurs some small overhead, it
should be avoided for atoms that do not need it.

<p>Any child appearances underneath <tt>KEEP_TOGETHER</tt> use
<tt>NO_CLIENT_COLOR</tt> automatically, and <tt>RESET_COLOR</tt>,
<tt>RESET_ALPHA</tt>, and <tt>RESET_TRANSFORM</tt> become meaningless. Use
<tt>KEEP_APART</tt> with them if you want to use those flags.

<p>Icons that are in a different plane from the parent icon will
automatically have <tt>KEEP_APART</tt> set and therefore won't be included.

<h3 byondver=510>KEEP_APART</h3>

<p>If this appearance is a child of something that uses <tt>KEEP_TOGETHER</tt>,
it will be separated out from the main icon and drawn separately.  This may be
useful for things such as health meters, for instance.

<p>This flag is automatically applied to icons that are on a different plane
from their parents.

<h3 byondver=510>PLANE_MASTER</h3>

<p>Use this flag to group all icons in the same plane and draw them on a
temporary surface the size of the whole screen, and then that image is drawn
over the existing scene.  This is useful for post-processing effects, like
lighting.  The plane master's icon is not drawn, but its color, transform, and
blend_mode are all taken into account when drawing.

<h3>Example</h3>
<xmp>
obj/lighting_plane
    screen_loc = "1,1"
    plane = 2
    blend_mode = BLEND_MULTIPLY
    appearance_flags = PLANE_MASTER | NO_CLIENT_COLOR
    // use 20% ambient lighting; be sure to add full alpha
    color = list(null,null,null,null,"#333f")
    mouse_opacity = 0    // nothing on this plane is mouse-visible

image/spotlight
    plane = 2
    blend_mode = BLEND_ADD
    icon = 'spotlight.dmi'  // a 96x96 white circle
    pixel_x = -32
    pixel_y = -32

mob/Login()
    ..()
    client.screen += new/obj/lighting_plane
    overlays += /image/spotlight
</xmp>

<p>In the example, all objects in plane 2 are lights.  They're added together,
and then the whole image is put through the color matrix, then multiplied over
the rest of the scene below.  This will darken everything that doesn't have a
spotlight overlay, but anywhere a spotlight exists will have a circle of
light.

<p>The example also makes a point of adding full alpha to the plane, because a
plane is fully transparent by default. However, it's usually a better idea not
to mess with the alpha color, and instead use another icon, scaled to the
appropriate size, as a backdrop.

<p>The <a class=code href=#/atom/var/mouse_opacity>mouse_opacity</a> set by
the plane master will determine how the mouse interacts with objects on the
plane. A value of 0 will mean everything in the plane is invisible to the
mouse; 1 means the plane is mouse-invisible but the objects in it use their
own <tt>mouse_opacity</tt>. 2 is the same except the plane itself is
mouse-visible.

<h3 byondver=510>TILE_BOUND</h3>

<p>There are many ways an object may be shifted out of the normal bounds of
the tile it's on: a large icon, pixel offsets, step offsets, and transform.
Ordinarily it's desirable to be able to see the object if it touches any
visible turf. However, in some cases it's more desirable to only show the
object if its actual loc is in view. The <tt>TILE_BOUND</tt> flag will
accomplish that. This flag is inherited by images and overlays. 

<h3 byondver=511>PIXEL_SCALE</h3>

<p>Normally if an icon is transformed via atom.transform, it uses bilinear
texture sampling which produces a nice smooth effect. If you want a granular
pixel-art effect instead, <tt>PIXEL_SCALE</tt> will do that for you by using
nearest-neighbor sampling.

<h3 byondver=513>PASS_MOUSE</h3>

<p>If this object has a <tt>render_source</tt> it will take on the rendered
appearance of another object (source). This is just a visual copy, so the
mouse still interacts with this object, not the source. The <tt>PASS_MOUSE</tt>
flag causes any mouse interaction to happen with the source instead of this
object.

<h3 byondver=514>TILE_MOVER</h3>

<p>This flag indicates this atom is locked to the tile grid as it would be in
<a class=code href=#/world/var/movement_mode>TILE_MOVEMENT_MODE</a>,
regardless of the setting of <tt>world.movement_mode</tt>. In this way, pixel
movers and tile movers can coexist.

<hr>

<a name=/atom/var/blend_mode>
<h2 byondver=501>blend_mode var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/atom/var/alpha>alpha var (atom)</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (none/overlay)
</dl>

<dl><dt><b>Possible values:</b>
<dd>BLEND_DEFAULT (0)
<dd>BLEND_OVERLAY
<dd>BLEND_ADD
<dd>BLEND_SUBTRACT<small>*</small>
<dd>BLEND_MULTIPLY<small>*&dagger;</small>
<dd byondver=513>BLEND_INSET_OVERLAY<small>*&dagger;</small>
</dl>

<p>[<small>*</small> This blend type appears only when using graphics
hardware mode. It is also not visible in the map editor.]<br/>
[<small>&dagger;</small> Since the alpha of the icon underneath is used for
alpha masking, mouse hits take it into account.]

<p>Controls the way the atom's icon is blended onto the icons behind it. The
blend mode used by an atom is inherited by any attached overlays, unless they
override it. <tt>BLEND_DEFAULT</tt> will use the main atom's blend mode; for
the atom itself, it's the same as <tt>BLEND_OVERLAY</tt>.

<p><tt>BLEND_OVERLAY</tt> will draw an icon the normal way.

<p><tt>BLEND_ADD</tt> will do additive blending, so that the colors in the
icon are added to whatever is behind it. Light effects like explosions will
tend to look better in this mode.

<p><tt>BLEND_SUBTRACT</tt> is for subtractive blending. This may be useful for
special effects.

<p><tt>BLEND_MULTIPLY</tt> will multiply the icon's colors by whatever is
behind it. This is typically only useful for applying a colored light effect;
for simply darkening, using a translucent black icon with normal overlay
blending is a better option.

<p><tt>BLEND_INSET_OVERLAY</tt> overlays the icon, but masks it by the
image being drawn on. This is pretty much not at all useful directly on the
map, but can be very useful for an overlay for an atom that uses
<tt>KEEP_TOGETHER</tt> (see <a class=code href=#/atom/var/appearance_flags>appearance_flags</a>),
or for the <a href=#/{notes}/filters/layer>layering filter</a>.

<hr>

<a name=/atom/var/color>
<h2 byondver=500>color var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/atom/var/alpha>alpha var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/atom/var/blend_mode>blend_mode var (atom)</a>
<dd><a href=#/client/var/color>color var (client)</a>
<dd><a href=#/proc/rgb>rgb proc</a>
<dd><a href=#/icon/proc/MapColors>MapColors proc (icon)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null (white)
</dl>

<dl><dt><b>Possible values:</b>
<dd>null (white)
<dd>any <a href=#/{{appendix}}/html-colors>color</a> generated by <tt>rgb()</tt> (e.g., <tt>"#00ff00"</tt> for green)
<dd>a <a href=#/{notes}/color-matrix>color matrix</a> (in list form)
</dl>

<p>Controls the color of the icon displayed on players' screens. This color
is multiplied by the icon, so that a white icon will become this color. The
color multiplier is also applied to <tt>maptext</tt>.

<p>If you include an alpha component in the color, the atom's alpha var will
be set at the same time.

<p>Overlays and images will also be multiplied by this color, unless they use
the <tt>RESET_COLOR</tt> value in <tt>appearance_flags</tt>.

<p>The color value can be set to a
<a href=#/{notes}/color-matrix>color matrix</a>, which is a list of values.
This allows for more complex transformations such as adding or subtracting
color, inverting the color, turning to grayscale, shifting hue, etc. Using an
RGB-only color matrix will include the existing alpha value in the matrix.

<p>When reading the <tt>color</tt> var, if it is a matrix it will be read out
as a list with 20 items (full RGBA format). That list is a copy, so if you
save it and make changes to that list later it will not impact the actual
color of the atom. This also means you can't use <tt>color[9] = 0.5</tt>; you
would have to grab the value of <tt>color</tt> first, make sure it's a list,
change it, and then assign the changed list back to the <tt>color</tt> var.

<hr>

<a name=/atom/var/contents>
<h2>contents list var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
<dd><a href=#/list>list</a>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>List of contained objects.
</dl>

<p>Except in the case of areas, this list is always restricted to objs and
mobs (ie movable objects).  Only direct contents are listed.  Items inside of
a bag object, for example, would not show up in the mob's contents list.

<p>The contents of areas are a little different.  The turfs contained in the
area are in the list along with any objs or mobs directly contained by those
turfs.

<p>If a movable atom uses the bound vars to change its physical size, or
<tt>step_x</tt> or <tt>step_y</tt> to change its position, it may cover more
than one turf. In that case, those turfs' contents won't just contain anything
directly in them, but also any atoms overhanging them. I.e., if a turf is in a
mob's <tt>locs</tt> list, then the mob is in that turf's contents list. (See
<a class=code href=#/atom/movable/var/locs>locs</a> for more information.)

<p class=performance>Note: Looping through all of the atoms, or even just
turfs, in a particular area actually loops through every turf in the world.
E.g., <tt>for(var/turf/T in area)</tt>. The engine will check each turf to see
if it belongs to that area, and then includes the turf and/or its contents in
the results depending on what the loop is looking for. This also applies to
any situation where you might grab area.contents as a list, e.g.
<tt>area.contents.Copy()</tt>. Therefore in a large world, it's advisable not
to loop through area contents at all.

<hr>

<a name=/atom/var/density>
<h2>density var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Entered>Entered proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Exited>Exited proc (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (1 for mobs)
</dl>

<p>This turns the object's density on or off (1 or 0).  Two dense objects may
not occupy the same space in the standard movement system.

<hr>

<a name=/atom/var/desc>
<h2>desc var (atom)</h2>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is the description of the object.

<h3>Example:</h3>
<xmp>
mob/verb/look(atom/O in view())
   if(O.desc) usr << O.desc
   else usr << "It's just \an [O]."
</xmp>

<hr>

<a name=/atom/var/dir>
<h2>dir var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/proc/turn>turn proc</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>SOUTH
</dl>

<dl><dt><b>Possible values:</b>
<dd>NORTH, SOUTH, EAST, WEST, NORTHEAST, NORTHWEST, SOUTHEAST, SOUTHWEST
</dl>

<p>This is the direction that the object is facing.  This has little effect
unless the object's icon is directional.  In the case of a directional icon,
this selects the corresponding orientation from the icon file.

<p>An icon file with only four (cardinal) directions makes the choice of
orientation ambiguous when the true direction is a diagonal.  In that case, of
the two possibilities, the one closest to the previous orientation is
displayed.  Sounds complicated, but it's what one would naturally expect.

<hr>

<a name=/atom/var/filters>
<h2 byondver=512>filters var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/proc/filter>filter proc</a>
<dd><a href=#/proc/animate>animate proc</a>
<dd><a href=#/{notes}/filters>Filter effects</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>empty list
</dl>

<p>This var is a list of graphical filters to use for post-processing effects,
applied in order. You can assign this value a list, an individual filter, or
null to empty it.

<h3>Example:</h3>
<xmp>
obj/blurry
    filters = filter(type="blur", size=1)
</xmp>

<p>Atoms with the <code>KEEP_TOGETHER</code> flag will apply their filters
after the composite image has been drawn. Filters will also apply to any
maptext the atom has.

<p>See the <a href=#/{notes}/filters>filters</a> section for more information
on individual filters.

<h3 byondver=516>Named Filters</h3>

<p>Filters can be created with a <tt>name</tt> argument. That name can be used
to access the filter in the list (e.g. <tt>filters["drunk_blur"]</tt> instead
of using a numeric index, which is helpful for managing animations and
updating multiple filters on an object.

<p>Adding a new filter with the same name as an existing filter will remove the
old one, since only one of a given filter name can be used on an appearance at
a time.

<p>You can also remove a named filter from the list simply by subtracting the
name instead of the filter itself. That is, <tt>filters -= filters["foo"]</tt>
and <tt>filters -= "foo"</tt> do the same thing.

<hr>

<a name=/atom/var/gender>
<h2>gender var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text/macros>macros (text)</a>
<dd><a href=#/atom/var/name>name var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>"neuter"
</dl>

<p>This sets the object's gender.  This influences text macros like
<code>\he</code>, which may expand to "it", "he", "she", or "they".  Valid
values are:

<xmp>
"neuter"
"male"
"female"
"plural"
</xmp>

These are also defined as constants, which may help prevent typos, since the
compiler will complain if it doesn't recognize what you type:

<xmp>
NEUTER
MALE
FEMALE
PLURAL
</xmp>

<hr>

<a name=/atom/var/icon>
<h2>icon var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/icon>icon proc</a>
<dd><a href=#/atom/var/icon_state>icon_state var (atom)</a>
<dd><a href=#/DM/icon>icons</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/atom/var/underlays>underlays var (atom)</a>
<dd><a href=#/proc/load_resource>load_resource proc</a>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is the icon file that will be used to represent the object on
graphical clients.

<h3>Example:</h3>
<xmp>
turf/wall
   icon = 'wall.dmi'
</xmp>

<p>You can also assign this to an external file at run-time with an expression
such as file("wall.dmi"), but you would only want to do that when the other
method is not possible, because it requires addition of the file to the
resource cache, which can take a little time.

<p>When this variable is set to any dynamically created icon object, that
object gets dumped into the world's resource cache (the <tt>.rsc</tt> file),
and a reference to that cached file is assigned to atom.icon.  In other words,
don't expect comparisons such as <code>usr.icon ==
MyDynamicallyCreatedIcon</code> to work unless you have used fcopy_rsc() to
get a cache reference to your dynamically created icon first.  This is almost
never an issue, so don't worry about it if none of that made any sense to you!

<hr>

<a name=/atom/var/icon_state>
<h2>icon_state var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/flick>flick proc</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/proc/icon_states>icon_states proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>Icons may appear differently depending on the icon state.  For example,
turf door icons could have "open" and "closed" states.  If a state is
specified that does not exist in the icon file, the default null state will
be displayed if it exists.

<h3>Example:</h3>
<xmp>
turf/door
   icon_state = "closed"
   density = 1
   verb
      open()
         set src in view(1)
         icon_state = "open"
         density = 0
      close()
         set src in view(1)
         icon_state = "closed"
         density = 1
</xmp>

<hr>

<a name=/atom/var/icon_w>
<h2 byondver=516>icon_w var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Defines the anchor point for this icon, from the bottom left. Higher values
of icon_w will offset this icon to the left; lower values offset it to the
right. It acts like a negative pixel_w except it's not inherited by any
<a href=#/atom/var/overlays>overlays</a>, <a href=#/image>images</a>, or
<a href=#/atom/var/vis_contents>visual contents</a>. It applies ONLY to this
icon.

<p>This var is meant to replace the <tt>bound_x</tt> var, which was applied
very inconsistently in old versions.

<hr>

<a name=/atom/var/icon_z>
<h2 byondver=516>icon_z var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Defines the anchor point for this icon, from the bottom left. Higher values
of icon_w will offset this icon downward; lower values offset it upward. It
acts like a negative pixel_z except it's not inherited by any
<a href=#/atom/var/overlays>overlays</a>, <a href=#/image>images</a>, or
<a href=#/atom/var/vis_contents>visual contents</a>. It applies ONLY to this
icon.

<p>This var is meant to replace the <tt>bound_y</tt> var, which was applied
very inconsistently in old versions.

<hr>

<a name=/atom/var/infra_luminosity>
<h2>infra_luminosity var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/luminosity>luminosity var (atom)</a>
<dd><a href=#/mob/var/see_infrared>see_infrared var (mob)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This causes the object to be visible in the dark to mobs that can see
infrared light.  Nothing but the object itself is lit up by the infrared
emission.  The scale is identical to luminosity: 1 makes it visible only from
the same location; 2 makes it visible from a neighboring position; and so on.

<hr>

<a name=/atom/var/invisibility>
<h2>invisibility var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/invisibility>invisibility setting (verb)</a>
<dd><a href=#/atom/var/opacity>opacity var (atom)</a>
<dd><a href=#/mob/var/see_invisible>see_invisible var (mob)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<dl><dt><b>Possible values:</b>
<dd>0 to 101
</dl>

<p>This determines the object's level of invisibility.  The corresponding mob
variable <code>see_invisible</code> controls the maximum level of invisibility
that the mob may see.

<p>A value of 101 is absolutely invisible, no matter what, and it is filtered
from all lists of possible values for verb arguments.  This is intended for
objects that exist purely for some internal purpose, such as "verb
containers".

<hr>

<a name=/atom/var/layer>
<h2>layer var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/atom/var/plane>plane var (atom)</a>
<dd><a href=#/atom/var/z>z var (atom)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{notes}/TOPDOWN_LAYER>TOPDOWN_LAYER</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1 (AREA_LAYER)
<dd>2 (TURF_LAYER)
<dd>3 (OBJ_LAYER)
<dd>4 (MOB_LAYER)
</dl>

<p>This numerical value determines the layer in which the object is drawn on
the map.  By default, the order is area, turf, obj, mob, followed by missiles
and images (in FLY_LAYER, which is 5).

<h3>Example:</h3>
<xmp>
turf
   archway
      layer = MOB_LAYER+1  //overhead
</xmp>

<p>When making objects to be used as graphical overlays, you should also be
aware of the special <tt>FLOAT_LAYER</tt> value.  This causes the overlay (or
underlay) to be in the same drawing layer as the base object, no matter how
that layer changes after the addition of the overlay.  Otherwise, the overlay
object's own drawing layer is used.

<p>The actual drawing order of icons may change depending on world.map_format.
An isometric map for instance has to display tiles that are "closer" to the
viewer in front of tiles that are in the back, so the layer var takes a
backseat to the needs of the map. If you use the <tt>TOPDOWN_MAP</tt> or
<tt>TILED_ICON_MAP</tt> map formats, the layer is more important.

<p>If you are using a <tt>world.map_format</tt> that does not display topdown,
such as <tt>ISOMETRIC_MAP</tt> or <tt>SIDE_MAP</tt>, then you can use a
special layer for showing certain portions of the map in topdown mode. For
those parts of the map, you can add <tt>TOPDOWN_LAYER</tt> to every atom's
 layer to make the atom appear in topdown mode. This is for special cases,
like for instance a battle map in an RPG, where a regular topdown view is
preferable to the special mapping used by the rest of the game. It is
recommended that you use <tt>TOPDOWN_LAYER</tt> with every atom in that
portion of the map, since topdown and isometric maps for instance don't mix.
If you use <tt>TOPDOWN_LAYER</tt>, it is best to use a square size in
<tt>world.icon_size</tt> if any of these atoms will be moving around.

<p>Another special layer, <tt>EFFECTS_LAYER</tt>, is also available. Icons
that use this layer will display above icons that don't.
<tt>TOPDOWN_LAYER</tt> will then display above that. This layer is useful for
situations such as using a floating name or health meter overlay on a mob in
isometric mode. When using <tt>EFFECTS_LAYER</tt>, other icons on the regular
map won't cover the overlay. (It is preferable to use atom.plane for this,
when possible.)

<p>Finally there is BACKGROUND_LAYER. Adding this to an atom's layer will make
it appear below any atoms that do not use BACKGROUND_LAYER.  (It is preferable
to use atom.plane when possible.)

<p>The <tt>atom.plane</tt> var takes priority over layer. This is the preferred
method of handling background and effects.

<hr>

<a name=/atom/var/loc>
<h2>loc var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/contents>contents list var (atom)</a>
<dd><a href=#/atom/var/x>x var (atom)</a>
<dd><a href=#/atom/var/y>y var (atom)</a>
<dd><a href=#/atom/var/z>z var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The location of the object or null if there is none.
</dl>

<p>The container is always an atom (or null).  For areas, this value is always
null, since an area may not be contained by any other object.

<hr>

<a name=/atom/var/luminosity>
<h2>luminosity var (atom)</h2>

<dl><dt><b>Default value:</b>
<dd>0
<dd>1 (areas)
</dl>

<p>This sets the object's luminosity (how far it casts light).  It must be an
integer in the range 0 to 6.

<p>Areas are a little different.  Any non-zero value in an area results in all
objects within the area being bathed in light.

<hr>

<a name=/atom/var/maptext>
<h2 byondver=494>maptext var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/maptext_width>maptext_width var (atom)</a>
<dd><a href=#/atom/var/maptext_height>maptext_height var (atom)</a>
<dd><a href=#/atom/var/maptext_x>maptext_x var (atom)</a>
<dd><a href=#/atom/var/maptext_y>maptext_y var (atom)</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/atom/var/pixel_x>pixel_x var (atom)</a>
<dd><a href=#/atom/var/pixel_y>pixel_y var (atom)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is optional text that will be displayed in the same position as the
atom. If an atom has both an icon and maptext, the text will be displayed in
front of the icon. Usually however, this is something that would be added to
an overlay or image object, which can then be positioned with pixel offsets.

<p>Map text is constrained to the bounds set by maptext_width and
maptext_height, which default to a single icon in size. It can be offset by
maptext_x and maptext_y.</p>

<p>Text can use HTML and CSS, mostly the same limited subset supported by
regular text output, and different styles can be used in the same block of
text. In addition, alpha colors can also be used, by specifying a color as
#rrggbbaa instead of just #rrggbb. (Alpha transparency will be ignored when
the map is drawn without hardware rendering, so anything below 50% opacity
is not displayed in those cases.)

<p>Maptext supports links with the <tt>&lt;a&gt;</tt> tag. Left-clicking on
a link will follow the link, but also generate other events such as
<tt>MouseDown</tt> or <tt>Click</tt>.

<hr>

<a name=/atom/var/maptext_width>
<h2 byondver=494>maptext_width var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/maptext>maptext var (atom)</a>
<dd><a href=#/atom/var/maptext_x>maptext_x var (atom)</a>
<dd><a href=#/atom/var/maptext_y>maptext_y var (atom)</a>
<dd><a href=#/atom/var/maptext_height>maptext_height var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>32 (depends on world.icon_size)
</dl>

<p>This is the width of the text shown in the maptext var. By default, it
uses the icon width provided in world.icon_size.

<hr>

<a name=/atom/var/maptext_height>
<h2 byondver=494>maptext_height var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/maptext>maptext var (atom)</a>
<dd><a href=#/atom/var/maptext_width>maptext_width var (atom)</a>
<dd><a href=#/atom/var/maptext_x>maptext_x var (atom)</a>
<dd><a href=#/atom/var/maptext_y>maptext_y var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>32 (depends on world.icon_size)
</dl>

<p>This is the height of the text shown in the maptext var. The default value
depends on world.icon_size and world.map_format. In a topdown (default) or
tiled map_format, the icon height is used. In other map views, tile
"footprints" are square and height is irrelevant, so the default will be the
icon width instead.)

<hr>

<a name=/atom/var/maptext_x>
<h2 byondver=508>maptext_x var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/maptext>maptext var (atom)</a>
<dd><a href=#/atom/var/maptext_width>maptext_width var (atom)</a>
<dd><a href=#/atom/var/maptext_height>maptext_height var (atom)</a>
<dd><a href=#/atom/var/maptext_y>maptext_y var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Maptext, if used, is offset by this many pixels to the right.

<hr>

<a name=/atom/var/maptext_y>
<h2 byondver=508>maptext_y var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/maptext>maptext var (atom)</a>
<dd><a href=#/atom/var/maptext_width>maptext_width var (atom)</a>
<dd><a href=#/atom/var/maptext_height>maptext_height var (atom)</a>
<dd><a href=#/atom/var/maptext_x>maptext_x var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Maptext, if used, is offset by this many pixels upward.

<hr>

<a name=/atom/var/mouse_drag_pointer>
<h2>mouse_drag_pointer var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>MOUSE_INACTIVE_POINTER (0)
</dl>

<p>This defines how the mouse looks when dragging this object.  Assigning this
to MOUSE_ACTIVE_POINTER (1) enables the default dragging indicator.

<p>This variable may also be set to any of the other
<a href=#/DM/mouse/pointers>built-in mouse pointers</a>, or a custom icon or
icon state.  If an icon state is specified, this is applied against the object's
main icon to find a custom pointer.

<p>Note that all mouse pointers are purely visual indicators.  They do not
effect what objects may actually be manipulated with the mouse.  You control
all of the real behavior in the associated procedures.

<hr>

<a name=/atom/var/mouse_drop_pointer>
<h2>mouse_drop_pointer var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>MOUSE_ACTIVE_POINTER (1)
</dl>

<p>This defines how the mouse looks when dragging this object over another
object that has <var>mouse_drop_zone</var> set.  The default value enables the
addition of a standard "droppable" indicator to whatever
<var>mouse_drag_pointer</var> is (unless <var>mouse_drag_pointer</var> is
turned off).

<p>This variable may also be set to any of the other
<a href=#/DM/mouse/pointers>built-in mouse pointers</a>, or a custom icon or
icon state.  If an icon state is specified, this is applied against the object's
main icon to find a custom pointer.

<p>Note that all mouse pointers are purely visual indicators.  They do not
effect what objects may actually be manipulated with the mouse.  You control
all of the real behavior in the associated procedures.

<hr>

<a name=/atom/var/mouse_drop_zone>
<h2>mouse_drop_zone var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Setting this to 1 indicates that this object is a valid site on which to
drop other objects.  While dragging, <var>mouse_drop_cursor</var> of the
object being dragged will become active in this case.  Note that this is a
purely visual effect.  It does not control what the user may do with the
mouse.  You control the real behavior with the associated procedures.

<hr>

<a name=/atom/var/mouse_opacity>
<h2>mouse_opacity var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/mouse>mouse handling</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/atom/var/underlays>underlays var (atom)</a>
<dd><a href=#/atom/var/vis_contents>vis_contents var (atom)</a>
<dd><a href=#/atom/var/render_source>render_source var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<dl><dt><b>Possible values:</b>
<dd>0  // transparent to mouse
<dd>1  // mouse-opaque where icon is also opaque
<dd>2  // completely mouse-opaque
</dl>

<p>This may be used to control how mouse operations on an object are
interpreted.  A click or mouse movement over an object's icon normally applies
to that object only if it is the topmost object that is not transparent at
the position of the mouse.  Setting <tt>mouse_opacity</tt> to 0 would cause
the object to be ignored completely, and setting it to 2 causes it to always
be chosen over any lower-level objects, regardless of the transparency of its
icon.

<p>Note that overlays and underlays are not distinct objects, so their
<tt>mouse_opacity</tt> is completely ignored in favor of the object they're
attached to. The same applies to <a href=#/image>image objects</a>, which act
like special overlays as well. <a href=#/atom/var/vis_contents>Visual
contents</a>, on the other hand, are separate objects that can act like
overlays in some ways, but because they're separate their
<tt>mouse_opacity</tt> <i>is</i> taken into account.

<p>When this is applied to a <tt>PLANE_MASTER</tt> object (see
<a href=#/atom/var/appearance_flags>appearance_flags</a>), a value of 0 means
everything on the plane is mouse-transparent.  1 means everything on the
plane is mouse-visible (using the objects' normal mouse_opacity), but the
plane master itself is not.  2 means everything on the plane is mouse-visible,
and so is the plane master.

<hr>

<a name=/atom/var/mouse_over_pointer>
<h2>mouse_over_pointer var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>MOUSE_INACTIVE_POINTER (0)
</dl>

<p>This defines how the mouse looks when no buttons are pressed and it is held
over this object.  Assigning this to MOUSE_ACTIVE_POINTER (1) enables the
default indicator that there is something special under the mouse
(crosshairs).

<p>This variable may also be set to any of the other
<a href=#/DM/mouse/pointers>built-in mouse pointers</a>, or a custom icon or
icon state.  If an icon state is specified, this is applied against the object's
main icon to find a custom pointer.

<p>Note that all mouse pointers are purely visual indicators.  They do not
effect what objects may actually be manipulated with the mouse.  You control
all of the real behavior in the associated procedures.

<hr>

<a name=/atom/var/name>
<h2>name var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/gender>gender var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The name of the object type with underscores converted to spaces.
</dl>

<hr>

<a name=/atom/var/opacity>
<h2>opacity var (atom)</h2>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This turns the object's opacity on or off (1 or 0).  Opaque objects block
light.

<hr>

<a name=/atom/var/overlays>
<h2>overlays var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/underlays>underlays var (atom)</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/list>list</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/atom/var/vis_contents>vis_contents var (atom)</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>empty list
</dl>

<div class="sidebar">
<p>Overlays are relatively static and cannot be altered on the fly, only
replaced. They're your best-performing option for very simple things that
won't change often. If you need something that allows dynamic changes you may
prefer to look into <a href=#/image>image objects</a> (which can also be
selectively shown to only certain players) or
<a href=#/atom/var/vis_contents>visual contents</a> which are more versatile.
</div>

<p>This is a list of simple icons which are displayed on top of the object's
main icon.

<p>The individual items in the list may not be directly accessed, since they
are stored in a <a href=#/atom/var/appearance>special internal format</a>.
However, the list operators <code>+=</code>, <code>-=</code>, and the
procedures <code>Add</code>, <code>Remove</code>, and <code>Cut</code> work
normally.

<h3>Example:</h3>
<xmp>
turf/verb/AddOverlay(I as icon)
   overlays += I
turf/verb/RemoveOverlay(I as icon)
   overlays -= I
</xmp>

<p>The data types that may be used as overlays are icons, icon states (text
strings), objects, and object types.  When an icon state is used, the
corresponding image in the object's icon is displayed.  When another object is
used as an overlay, a static "snapshot" of the object is taken at the time
when the overlay is created.  Future changes to the object will not change the
appearance of the overlay, except that in some cases the overlay may inherit
things from the base object like its icon (if left empty), direction, and
moving state.

<p>Overlays have their own independent drawing layer.  It is normally the
special value FLOAT_LAYER, which makes them float above the base object.  If
the overlay is a snapshot of another object, the drawing layer of that object
is used (and in that case, the overlay can appear beneath the object if its
layer is lower).  The important advantage of using FLOAT_LAYER is that if the
layer of the base object changes, the overlays will move with it into the new
layer.

<p>Any negative number may be used in place of FLOAT_LAYER (which happens to
be -1).  They all cause the same "floating" behavior.  However, the overlays
are ordered amongst themselves according to their own relative layer values
(-2 below -1 and so on).  This may be useful if you have several classes of
overlays that should always appear in a certain order, because you would not
have to worry about the order in which you add them to the list.

<h3>Example:</h3>
<xmp>
var/const
   ARMOR_LAYER = FLOAT_LAYER-1
   CLOTHES_LAYER = FLOAT_LAYER-2
obj/overlay
   armor
      icon = 'armor.dmi'
      layer = ARMOR_LAYER
   clothes
      icon = 'clothes.dmi'
      layer = CLOTHES_LAYER
mob/verb
   wear_clothes()
      overlays += /obj/overlay/clothes
   wear_armor()
      overlays += /obj/overlay/armor
   remove_clothes()
      overlays -= /obj/overlay/clothes
   remove_armor()
      overlays -= /obj/overlay/armor
</xmp>

<p>That example used object types, but you can use instances of objects as
well.  Rather than using different "float" layers, you can also just make your
own list of overlays with the order you want and assign that to the actual
overlays list.

<h3>Example:</h3>
<xmp>
mob/var
   boots
   clothes
	armor
mob/proc
   ShowOverlays()
      var/L[0]
      if(boots)   L += boots
      if(clothes) L += clothes
      if(armor)   L += armor
      overlays = L
</xmp>

<hr>

<a name=/atom/var/override>
<h2>override var (atom)</h2>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p><b>Currently this only applies to <a href=#/image>images</a>.</b>

<p>If you attach an image to an atom, normally it is seen only in addition to
the atom's regular icon. If the image's override var is 1, it will be seen
<i>in place of</i> the original atom (and its overlays).  It will inherit the
atom's color, alpha, transform, and appearance_flags, unless its own
appearance_flags say otherwise.

<p>If the image has a specific name and/or suffix value, those will override
the parent atom too. Leaving them blank will let the original atom take
precedence.

<hr>

<a name=/atom/var/pixel_x>
<h2>pixel_x var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement var (movable atoms)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atoms)</a>
<dd><a href=#/atom/var/pixel_y>pixel_y var (atom)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the object's icon on the x-axis by the specified number of
pixels. In a project with a standard 32x32 tile size, this can range from -32
to +32. (You can get away with larger displacements, but they are not
guaranteed to work for objects off the edge of the map.)

<p>Since overlays and images can each have their own additional displacements,
this makes it possible to create visual effects that extend beyond the
object's own cell in the turf grid, but which automatically move around with
the object.

<p>This effect is purely visual and does not influence such things as movement
bumping or view() range calculations.

<hr>

<a name=/atom/var/pixel_y>
<h2>pixel_y var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement var (movable atoms)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atoms)</a>
<dd><a href=#/atom/var/pixel_x>pixel_x var (atom)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the object's icon on the y-axis by the specified number of
pixels. In a project with a standard 32x32 tile size, this can range from -32
to +32. (You can get away with larger displacements, but they are not
guaranteed to work for objects off the edge of the map.)

<p>Since overlays and images can each have their own additional displacements,
this makes it possible to create visual effects that extend beyond the
object's own cell in the turf grid, but which automatically move around with
the object.

<p>This effect is purely visual and does not influence such things as movement
bumping or view() range calculations.

<hr>

<a name=/atom/var/pixel_w>
<h2 byondver=511>pixel_w var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement var (movable atoms)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atoms)</a>
<dd><a href=#/atom/var/pixel_x>pixel_x var (atom)</a>
<dd><a href=#/atom/var/pixel_y>pixel_y var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the object's icon horizontally by the specified number of pixels. This
is meant to be used in situations where world.map_format is used to display something
other than a top-down form, for instance in an isometric or side-view display. In a
top-down mode pixel_w behaves the same as pixel_x, except that it does not rotate with
changes to client.dir.

<p>This effect is purely visual and does not influence such things as movement
bumping or view() range calculations.

<hr>

<a name=/atom/var/pixel_z>
<h2>pixel_z var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement var (movable atoms)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atoms)</a>
<dd><a href=#/atom/var/pixel_x>pixel_x var (atom)</a>
<dd><a href=#/atom/var/pixel_y>pixel_y var (atom)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the object's icon vertically by the specified number of pixels. This
is meant to be used in situations where world.map_format is used to display something
other than a top-down form, for instance in an isometric or side-view display. In a
top-down mode pixel_z behaves the same as pixel_y, except that it does not rotate with
changes to client.dir.

<p>This effect is purely visual and does not influence such things as movement
bumping or view() range calculations.

<hr>

<a name=/atom/var/pixloc>
<h2 byondver=516>pixloc var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atoms)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atoms)</a>
<dd><a href=#/proc/pixloc>pixloc proc</a>
<dd><a href=#/proc/bound_pixloc>bound_pixloc proc</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<p>Returns a pixloc representing this atom's physical position. The position is
based on its <tt>loc</tt>, <tt>step_x</tt>, <tt>step_y</tt>, <tt>bound_x</tt>,
and <tt>bound_y</tt>. This var is read-only for areas and turfs, but writable
for movable atoms. When changed, it will alter the related vars. A movable's
pixloc is null if it isn't located on a turf.

<p>A pixloc can be used for calculating distances, or passed to various procs
such as <a class=code href=#/proc/get_dir>get_dir()</a> and
<a class=code href=#/atom/movable/proc/Move>Move()</a>.

<p>This pixloc is equivalent to
<a class=code href=#/proc/bound_pixloc>bound_pixloc(src,SOUTHWEST)</a>. You can
use the <tt>bound_pixloc()</tt> proc to get the pixloc of an atom's other
corners or center of bounds.

<p>The returned pixloc is not tied to this atom, so changing its vars will not
alter the atom's pixloc. The only exception is when using operators such as
<tt>+=</tt>, since <tt>a += b</tt> is just a shortcut for <tt>a = a + b</tt>.

<xmp>
// does not alter obj's position
var/pixloc/p = obj.pixloc
p.step_x += 12

// does alter obj's position, since a += b is just a = a + b
obj.pixloc += vector(12,0)
</xmp>

<hr>

<a name=/atom/var/plane>
<h2 byondver=509>plane var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/atom/var/vis_contents>vis_contents var (atom)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<dl><dt><b>Default value:</b>
<dd><tt>FLOAT_PLANE</tt>
</dl>

<dl><dt><b>Possible values:</b>
<dd>-10000 to 10000 (integers only), <tt>FLOAT_PLANE+p</tt>
</dl>

<p>The value of plane overrides layer, and is mainly used for non-topdown map
formats like isometric.  Positive values are drawn on top, and negative values
are drawn below.  This mostly deprecates <tt>EFFECTS_LAYER</tt> and
<tt>BACKGROUND_LAYER</tt>, but they can still be useful when using
<tt>PLANE_MASTER</tt> for effects
(see <a class=code href=#/atom/var/appearance_flags>appearance_flags</a>).

<p>The special value <tt>FLOAT_PLANE</tt> can be used for images and overlays,
to take on the plane of the parent atom. Whenever an icon or icon_state is
used directly as an overlay, this is its plane. If there is no parent atom,
the plane is 0.

<p byondver=513>You can also use <tt>FLOAT_PLANE</tt> as a relative value, so
<tt>FLOAT_PLANE+1</tt> adds 1 to the parent atom's plane. This may be useful
for some applications where an object is included in visual contents. The
added value should still be kept in the range of -10000 to 10000, or
preferably much smaller.

<hr>

<a name=/atom/var/render_source>
<h2>render_source var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/render_target>render_target var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<dl><dt><b>Possible values:</b>
<dd>Any non-empty text string
</dl>

<p>If any icon uses <tt>render_source</tt>, the renderer will look for another
icon with a matching <tt>render_target</tt> value on the visible map, and draw
that in place of the <tt>icon</tt>/<tt>icon_state</tt>/<tt>dir</tt> that it
normally would. The same render target might be used as a source multiple
times, and for a complex image this can save some rendering time. This is also
usable for special effects such as <a href=#/{notes}/filters>filters</a> that
might require copies of an image.

<p>Note: The corresponding <tt>render_target</tt> <i>must</i> be visible to the
player for a render source to be used.

<p>The replacement icon from the <tt>render_source</tt> will be anchored to the
bottom left of the icon it replaces.

<p>Other vars that would normally affect the appearance of this icon, such as
<tt>color</tt>, <tt>transform</tt>, <tt>filters</tt>, <tt>appearance_flags</tt>,
etc. are all applied. Additionally, if this object has overlays, underlays, or
visual contents, those will still be drawn as well.

<p>Note: Any mouse hits on this object belong to the object itself, not to the
object used in the <tt>render_source</tt> or its children. If you want mouse
clicks and other behavior to go to the source, use the <tt>PASS_MOUSE</tt>
<a href=#/atom/var/appearance_flags>appearance flag</a>.

<hr>

<a name=/atom/var/render_target>
<h2>render_target var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/render_source>render_source var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/atom/var/filters>filters var (atom)</a>
<dd><a href=#/atom/var/transform>transform var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<dl><dt><b>Possible values:</b>
<dd>Any non-empty text string
</dl>

<p>If any icon uses <tt>render_target</tt>, and another icon in the scene has
a matching <tt>render_source</tt>, this icon will be drawn to a temporary
image called a "slate", which can be reused mutiple times for faster drawing
and for special effects.

<p>If the <tt>render_target</tt> value starts with an asterisk (<tt>"*"</tt>),
it will not be drawn on the map, but will still be drawn to a slate for reuse.

<p>Other vars that would normally affect the appearance of this icon, such as
<tt>color</tt>, <tt>transform</tt>, <tt>filters</tt>, <tt>appearance_flags</tt>,
etc. are all applied when drawing to the slate. Additionally, if this object
has overlays, underlays, or visual contents and uses the
<a href=#/atom/var/appearance_flags><tt>KEEP_TOGETHER</tt></a> flag to group
all of the icons together, those will also be included in the slate.

<p>If the render target is a
<a href=#/atom/var/appearance_flags><tt>PLANE_MASTER</tt></a>, vars like
<tt>pixel_x/y/w/z</tt> will not apply when it is re-drawn as a
<tt>render_source</tt>.

<div class=note>
<p>To use a <tt>render_target</tt>, the object it belongs to must be
within the visible part of the map, or in the HUD, etc., so that it would be
visible to the user under normal circumstances. If not, it will not be
included in the render process and therefore it can't be reused as a
<tt>render_source</tt>.

<p>Additionally, if you use multiple map controls, a given render target can
only be used as a source on the same map control where it appears. This is
because each map is rendered separately.
</div>

<hr>

<a name=/atom/var/suffix>
<h2>suffix var (atom)</h2>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is an optional text string that follows the object's name in the stat
panels.  For example, items in an inventory list are displayed as an icon, a
name, and a suffix.

<hr>

<a name=/atom/var/text>
<h2>text var (atom)</h2>

<dl><dt><b>Default value:</b>
<dd>The first letter of the object's name.
</dl>

<p>This is the character used to represent the object on text clients.

<p>Entering several characters produces a text movie (the state of the art!).
In that case, each character is displayed for a 10th of a second.

<p>HTML tags in the text can be used to modify the colors of the text
characters.  As a convenience, the &lt;font&gt; tag may include a
<code>bgcolor</code> attribute, so you don't have to do a CSS style setting to
accomplish the same thing.

<h3>Example:</h3>
<xmp>
world
   maxx = 10
   maxy = 10
area
   text = "<font bgcolor=blue> "
turf
   text = "<font color=#F00>....<font color=#C00>.."
</xmp>

<p>The example above produces a map with a blue background (from the area) and
turfs (depicted by ".") that flash from bright red to a shorter span of light
red.

<p>Note that in order to see text icons, the user must switch to the text map
in Dream Seeker.  If your DM code never does anything with the icon variable,
then this is the default configuration.  Such applications are known as
<em>advanced</em> iconic text games:)

<hr>

<a name=/atom/var/transform>
<h2 byondver=500>transform var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/matrix>matrix</a>
</dl>

<p>An atom can be made to appear rotated, scaled, and/or translated (moved)
by using affine transforms. This takes a matrix and multiplies the x and y
positions of the icon's corners like so:

<pre>          a d 0
x y 1  *  b e 0  =  x' y' 1
          c f 1</pre>

<p>This is equivalent to:

<pre>x' = a*x + b*y + c
y' = d*x + e*y + f</pre>

<p>You do not need to understand matrix math to use transforms, because you
can use the <a href=#/matrix>matrix datum</a> to do this for you.

<p>Transformations are relative to the center of the icon. They do not apply
to maptext.</p>

<h3>Examples:</h3>
<xmp>
// Rotate the atom by 45° clockwise
src.transform = turn(src.transform, 45)

// OR
var/matrix/M = matrix()
M.Turn(45)
src.transform = M

// Scale the atom by 2x2
src.transform *= 2

// OR
var/matrix/M = matrix()
M.Scale(2,2)
src.transform = M
</xmp>

<p>Whenever you read the atom.transform var, you will get a <i>copy</i> of
the atom's current transformation. Whenever you assign a value to the var,
you will update the transformation.

<p>Assigning null to atom.transform will revert the atom to using no
transformation at all. It is also legal to assign a list with six values,
which is equivalent to using a matrix.

<hr>

<a name=/atom/var/underlays>
<h2>underlays var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/list>list</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>empty list
</dl>

<p>This is a list of icons which are displayed underneath the object's main
icon. Since these are basically the same as overlays, see
<a href=#/atom/var/overlays>overlays</a> for more detailed information.

<p>The only real differences between items in the underlays list vs. the
overlays list is that they're processed first, and if they use
<tt>FLOAT_LAYER</tt> (or any other negative layer value) they'll appear below
the object instead of above it. For this reason, the underlays list isn't
used nearly as much as overlays since it's easier to throw most things into
the overlays list.

<p>When multiple turfs are stacked on top of one another in the map editor,
there is actually only one turf (the topmost) and the rest are all underlays.

<hr>

<a name=/atom/var/verbs>
<h2>verbs list var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/proc/typesof>typesof proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The list of verbs defined for the object's prototype.
</dl>

<p>This is a list of the object's verbs.  Initially, it contains all of the
verbs defined in the prototype.  It may be used to add and remove verbs at
runtime.

<p>Note that this variable is not automatically saved when the object is
written to a savefile.  That behavior may change in the future.  In the mean
time, you must save any necessary changes yourself or they will not be
preserved when the object is loaded.

<h3>Example:</h3>
<xmp>
mob/proc/kazaam()
   usr << "Kazaam!"

mob/verb/add_kazaam()
   verbs += /mob/proc/kazaam
mob/verb/remove_kazaam()
   verbs -= /mob/proc/kazaam
</xmp>

<hr>

<a name=/atom/var/vis_contents>
<h2 byondver=512>vis_contents var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/vis_locs>vis_locs var (atom)</a>
<dd><a href=#/atom/var/vis_flags>vis_flags var (atom)</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/{notes}/HUD>HUD / screen objects</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>Empty list.
</dl>

<p>Turfs, movable atoms, and images can be given a list of atoms (limited to
turfs and movable atoms) that are attached to them visually, like an overlay
or image object, but act independently and have their own identity. These are
<b>visual contents</b>. The purpose of visual contents is to provide an
alternative system to overlays and images, with a little more flexibility for
various special effects.

<p>For example, a mob with an obj in its visual contents will show the obj
as if it's following the mob around like an overlay, but clicking on the obj
will not&mdash;unlike an overlay or an image object&mdash;count as a click
on the mob. Likewise, the obj will retain its own separate
<tt>mouse_opacity</tt> setting, which is not true of regular overlays.

<p>An atom that appears on the map normally can still be in the visual
contents of another atom. However it will not apply gliding and step offsets
here. Also, considerations like visibility will not apply.

<p>If a turf is in an atom's visual contents, the turf and all of that turf's
contents will be displayed. (In the case of big atoms, or movable atoms with
step offsets, only atoms that actually have that turf as their loc will
appear. "Overhangers" will not.) Gliding and step offsets <em>will</em> be
applied to that turf's contents normally; but again visibility, opacity, etc.
will not be considered. (If you have one or more turfs in visual contents,
an object gliding to a new turf outside of that list will not be shown because
it's already technically on the new turf.)

<p>If <i>multiple</i> turfs are present in visual contents, they will be
offset as needed (relative to the southwest-most turf) to appear in the
correct positions. That is, <tt>pixel_x</tt> and <tt>pixel_y</tt> offsets will
be applied automatically, so if you add an entire block to visual contents (be
aware this will impact performance), you don't have to do anything else to
make the block appear normal.

<p>You can alter some aspects of how an object behaves when in visual contents
by changing its <a class=code href=#/atom/var/vis_flags>vis_flags</a> var. In
particular this is useful if you want an object to behave more like an
overlay, inheriting aspects of its parent object or even acting like a part of
that object instead of an independent one. Also this can make an object act
like an underlay instead of an overlay when using a floating layer.

<p>Visual contents do not impact the results of <tt>view()</tt> or
<tt>range()</tt>, or verb availability, in any way. This is strictly a visual
effect.

<p>Being in a visual contents list counts as a <a href=#/DM/garbage>reference</a>
for anything in the list, the same way that being on the map or inside of a
movable counts as a reference.

<hr>

<a name=/atom/var/vis_flags>
<h2 byondver=513>vis_flags var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/vis_contents>vis_contents var (atom)</a>
<dd><a href=#/atom/var/vis_locs>vis_locs var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<dl><dt><b>Possible values:</b>
<dd>Any combination of:
<dd><b>VIS_INHERIT_ICON</b>: Use the parent object's icon.
<dd><b>VIS_INHERIT_ICON_STATE</b>: Use the parent object's icon_state.
<dd><b>VIS_INHERIT_DIR</b>: Use the parent object's dir.
<dd><b>VIS_INHERIT_LAYER</b>: Use the parent object's layer.
<dd><b>VIS_INHERIT_PLANE</b>: Use the parent object's plane.
<dd><b>VIS_INHERIT_ID</b>: Use the parent object's identity, so it acts like part of the same object.
<dd><b>VIS_UNDERLAY</b>: Act as if this is at the bottom of the parent's underlays list instead of overlays (only relevant if using <tt>VIS_INHERIT_LAYER</tt> or a <a class=code href=#/atom/var/layer>FLOAT_LAYER</a>).
<dd><b>VIS_HIDE</b>: Do not show this object in visual contents at all.
</dl>

<p>This is a set of flags that determine how this object will behave when it
is in another object's visual contents.

<p>Because only turfs, objs, and mobs can be in visual contents, this var
belongs only to those types.

<p>The <tt>VIS_INHERIT_ID</tt> flag effectively makes this object act like an
ordinary overlay when in visual contents. This means its
<a class=code href=#/atom/var/mouse_opacity>mouse_opacity</a> will be
meaningless, for example.

<p>Sometimes it's desirable for an object not to show up in visual contents,
so <tt>VIS_HIDE</tt> will prevent that. The flag applies even if this object
appears indirectly, like if it's in the contents of a turf that is in the
visual contents of something else.

<p>Note: Using any of the the flags <tt>VIS_INHERIT_ICON</tt>,
<TT>VIS_INHERIT_ICON_STATE</TT>, <tt>VIS_INHERIT_DIR</tt>, or
<tt>VIS_INHERIT_ID</tt> will cause movable atoms to inherit the "moving" flag
of their container that appears during gliding. E.g., if your mob is walking,
anything in its visual contents that uses these flags will use a moving icon
state instead of a non-moving icon state, when available.

<hr>

<a name=/atom/var/vis_locs>
<h2 byondver=512>vis_locs var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/vis_contents>vis_contents var (atom)</a>
<dd><a href=#/atom/var/vis_flags>vis_flags var (atom)</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/{notes}/HUD>HUD / screen objects</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>Empty list.
</dl>

<p>This list is the opposite of the <code>vis_contents</code> list. If this
atom is in any other atoms' visual contents, those parent atoms will appear
in this list.

<p>Because only turfs, objs, and mobs can be in visual contents, this var
belongs only to those types.

<p>Being in a visual locs list does not count as a <a href=#/DM/garbage>reference</a>,
the same way that being a movable's loc does not count as a reference. If
an object in this list otherwise runs out of references, it will be garbage
collected and therefore removed from this list.

<hr>

<a name=/atom/var/x>
<h2>x var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The x coordinate of the object on the map.
</dl>

<p>You may assign the coordinates of movable objects (mobs and objs), but this
is not advisable.  It is better to compute the new location (with
<code>locate()</code>) and move them to that.  Then you can use the normal
<code>Move()</code> procedure, which enables all the normal movement behavior.

<p>For areas that are on the map, this is the coordinate of the turf with the
lowest z, y, and x coordinate (in that order) that is contained by the area.

<hr>

<a name=/atom/var/y>
<h2>y var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The y coordinate of the object on the map.
</dl>

<p>You may assign the coordinates of movable objects (mobs and objs), but this
is not advisable.  It is better to compute the new location (with
<code>locate()</code>) and move them to that.  Then you can use the normal
<code>Move()</code> procedure, which enables all the normal movement behavior.

<p>For areas that are on the map, this is the coordinate of the turf with the
lowest z, y, and x coordinate (in that order) that is contained by the area.

<hr>

<a name=/atom/var/z>
<h2>z var (atom)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The z coordinate of the object on the map.
</dl>

<p>The z coordinate is how objects move between maps.  When you include
several maps in a project, they are placed on different z levels so that the
full map is a single 3-dimensional space.  It is also possible for a single
map file to contain multiple z levels.

<p>Do not confuse this with drawing layer.  The z coordinate moves an object
between different maps.  The layer variable determines the order in which an
object is drawn graphically relative to other objects at the same position on
the map.

<p>You may assign the coordinates of movable objects (mobs and objs), but this
is not advisable.  It is better to compute the new location (with
<code>locate()</code>) and move them to that.  Then you can use the normal
<code>Move()</code> procedure, which enables all the normal movement behavior.

<p>For areas that are on the map, this is the coordinate of the turf with the
lowest z, y, and x coordinate (in that order) that is contained by the area.

<hr>

<a name=/callee>
<h2 byondver=516>callee</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc>proc</a>
<dd><a href=#/proc/var>vars (proc)</a>
<dd><a href=#/proc/var/callee>callee var (proc)</a>
<dd><a href=#/proc/var/caller>caller var (proc)</a>
<dd><a href=#/world/proc/Error>Error proc (world)</a>
<dd><a href=#/proc/try>try and catch statements</a>
</dl>

<p>A primitive type representing a running or sleeping proc. This gives access
to the proc's information, and can be used to output a stack trace in
situations such as writing your own custom <tt>world.Error()</tt> handler.

<p>You can get a <tt>/callee</tt> for the current running proc with its
<a class=code href=#/proc/var/callee>callee</a> var, or its caller with the
<a class=code href=#/proc/var/caller>caller</a> var. You can follow callers up
the call chain.

<h3>Example:</h3>
<xmp>
world/Error(err)
    world.log << "Error [err]:"
    for(var/callee/p = caller, p, p = p.caller)
        world.log << "  [p.proc.type] (src=[p.src], usr=[p.usr])"
        if(p.file) world.log << "    at [p.file]:[p.line]"
</xmp>

<p>Built-in callee vars (read-only):

<dl class=codedd>
  <dd><a href=#/proc/var/args>args</a>
  <dd><a href=#/proc/var/caller>caller</a>
  <dd><a href=#/verb/set/category>category</a><small><sup>*</sup></small>
  <dd><a href=#/verb/set/desc>desc</a><small><sup>*</sup></small>
  <dd>file
  <dd><a href=#/verb/set/name>name</a><small><sup>*</sup></small>
  <dd>line
  <dd>proc
  <dd><a href=#/proc/var/src>src</a>
  <dd>type
  <dd><a href=#/proc/var/usr>usr</a>
</dl>
<p><small><sup>*</sup> These vars are quick aliases for <tt>proc.<i>varname</i></tt>. <tt>proc.type</tt> is excluded since <tt>/callee</tt> has its own type var.</small>

<p>The <tt>file</tt> and <tt>line</tt> vars are available if debugging
information was turned on when the world was compiled. The other vars are all
aliases for info about the running/sleeping proc or its prototype.

<p>Even though the <tt>args</tt> var itself is read-only, the list it returns
is mutable. Making changes to the list will affect the proc it belongs to.

<hr>

<a name=/client>
<h2>client</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/mob/var/client>client var (mob)</a>
<dd><a href=#/mob/var/key>key var (mob)</a>
<dd><a href=#/client/proc>procs (client)</a>
<dd><a href=#/client/var>vars (client)</a>
</dl>

<p>Each connected player has a corresponding client object.  It has
variables and procedures which control aspects of player input/output.  This
object is also responsible for linking the player up to a mob.

<p>The client can be reassigned from its original mob M to a new mob N by
setting N.client = M.client.  This process disconnects the player from M
(calling M.Logout()) and connects the player to N (calling N.Login()).
Setting the mob's key has the same effect.

<p>Additional vars, procs, and verbs may be added to the client in order to
give the player properties that are independent of the mob.

<hr>

<a name=/client/proc>
<h2>procs (client)</h2>

<p>Built-in client procs:

<dl><dt>client/proc
<dd><a href=#/client/proc/AllowUpload>AllowUpload</a>
<dd><a href=#/client/proc/Center>Center</a>
<dd><a href=#/client/proc/CheckPassport>CheckPassport</a>
<dd><a href=#/client/proc/Click>Click</a>
<dd><a href=#/client/proc/Command>Command</a>
<dd><a href=#/client/proc/DblClick>DblClick</a>
<dd><a href=#/client/proc/Del>Del</a>
<dd><a href=#/client/proc/East>East</a>
<dd><a href=#/client/proc/Export>Export</a>
<dd><a href=#/client/proc/GetAPI>GetAPI proc</a>
<dd><a href=#/client/proc/Import>Import</a>
<dd><a href=#/client/proc/IsByondMember>IsByondMember</a>
<dd><a href=#/client/proc/MeasureText>MeasureText</a>
<dd><a href=#/client/proc/MouseDown>MouseDown</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered</a>
<dd><a href=#/client/proc/MouseExited>MouseExited</a>
<dd><a href=#/client/proc/MouseMove>MouseMove</a>
<dd><a href=#/client/proc/MouseUp>MouseUp</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel</a>
<dd><a href=#/client/proc/Move>Move</a>
<dd><a href=#/client/proc/New>New</a>
<dd><a href=#/client/proc/North>North</a>
<dd><a href=#/client/proc/Northeast>Northeast</a>
<dd><a href=#/client/proc/Northwest>Northwest</a>
<dd><a href=#/client/proc/RenderIcon>RenderIcon</a>
<dd><a href=#/client/proc/SendPage>SendPage</a>
<dd><a href=#/client/proc/SetAPI>SetAPI proc</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery</a>
<dd><a href=#/client/proc/South>South</a>
<dd><a href=#/client/proc/Southeast>Southeast</a>
<dd><a href=#/client/proc/Southwest>Southwest</a>
<dd><a href=#/client/proc/Stat>Stat</a>
<dd><a href=#/client/proc/Topic>Topic</a>
<dd><a href=#/client/proc/West>West</a>
</dl>

<hr>

<a name=/client/proc/AllowUpload>
<h2>AllowUpload proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/input>input proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>AllowUpload(filename, filelength)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player attempts to upload a file to the server, through input() or a command.
</dl>

<dl><dt><b>Default action:</b>
<dd>Allows the upload by returning 1.
</dl>

<p>The client who owns this proc (src) is the one trying to upload the file.
If this proc returns a true value, the upload will be allowed. Otherwise, it
will be rejected.

<h3>Example:</h3>
<xmp>
client
   AllowUpload(filename, filelength)
      if(filelength >= 524288)  // 512K (0.5M)
         src << "[filename] is too big to upload!"
         return 0
      return 1
</xmp>

<hr>

<a name=/client/proc/Center>
<h2>Center proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/walk>walk proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Center()
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "center" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Cancels any automated movement by calling walk(usr,0).
</dl>

<hr>

<a name=/client/proc/CheckPassport>
<h2>CheckPassport proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/IsSubscribed>IsSubscribed proc (world)</a>
<dd><a href=#/client/proc/IsByondMember>IsByondMember proc (client)</a>
<dd><a href=#/client/proc/GetAPI>GetAPI proc (client)</a>
<dd><a href=#/client/proc/SetAPI>SetAPI proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>CheckPassport(passport_identifier)
</dl>

<dl><dt><b>Args:</b>
<dd>passport_identifier: a text string assigned to you by the BYOND hub (or an ID/token for a different API; see below).
</dl>

<p>This built-in procedure checks to see if the user is subscribed to a
particular BYOND hub entry. If the user is subscribed, the result is the
number of days left (rounded up) on their subscription, or -1 for lifetime
subscribers.

<h3>Example:</h3>
<xmp>
world
   hub = "My.Hub"  //change this to your own hub entry

mob/var
   full_access

mob/Login()
   if(client.CheckPassport("0123456789abcdef"))
      full_access = 1
   else
      src << "For full access, <a href=\
              'http://www.byond.com/hub/[world.hub]' >subscribe</a>!"
   return ..()
</xmp>

<p>Note that in general the value of world.hub has nothing to do with the
passport you happen to check.  This example assumes the passport number
belongs to world.hub just for the purpose of forwarding the user to the
appropriate subscription page.

<h3 byondver=514>Other APIs</h3>

<p>You can use this with other APIs that are supported by BYOND, which
currently only applies to Steam and only if the game is specially built for
Steam support.

<p>To check ownership of a Steam game or DLC (must be the current game's ID
or one of its DLCs), use <tt>"steam:<i>NNNNNN</i>"</tt> for the passport
string, where <i>NNNNNN</i> is a Steam app ID. Note that the user must be
logged into Steam for this to work.

<hr>

<a name=/client/proc/Click>
<h2>Click proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Click>Click proc (atom)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Click(object,location,control,params)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player clicks on the map or in the stat panels.
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object clicked
<dd>location: the client stat panel, location (turf) of object on map, grid cell, or other control-specific info
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.Click(location,control,params).
</dl>

<h3>Example:</h3>
<xmp>
client
  Click(O)
    usr << "You clicked [O]"
    ..() // do default action
</xmp>

<p>Note that due to network lag, it is possible when clicking on moving
objects for the location of those objects to have changed by the time the
Click() proc is executed.  That is the reason for the location argument.  It
tells you where the click originally took place.

<p>The argument format for this verb is:

<xmp>
Click(object as null|atom in usr.client,\
      location as null|turf|text in usr.client,\
      control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/Command>
<h2>Command proc (client)</h2>

<dl><dt><b>Format:</b>
<dd>Command(command as command_text)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player types in something that is not understood as a
valid command, or if the player is connected via telnet.
</dl>

<dl><dt><b>Default action:</b>
<dd>None.
</dl>

<p>If this proc is used, players will be able to connect to your world via
telnet. All telnet users' commands are routed through this proc instead of
being parsed into verbs. Players who join the world through Dream Seeker
will have their commands parsed as verbs first, and those commands will end
up here only if there is no applicable verb.

<p>Note that text received by this proc is not interpreted beforehand, so
quotes " and backslashes \ should come through unaltered.

<p>This proc is primarily useful if you want to handle parsing yourself (like
for a MUD), or if your world is a chat server and verbs are not used much.

<hr>

<a name=/client/proc/DblClick>
<h2>DblClick proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/atom/proc/DblClick>DblClick proc (atom)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>DblClick(object,location,control,params)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player double-clicks on the map or in the stat panels.
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object double-clicked
<dd>location: the client stat panel, location (turf) of object on map, grid cell, or other control-specific info
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.DblClick(location,control,params).
</dl>

<h3>Example:</h3>
<xmp>
client
  DblClick(O)
    usr << "You double-clicked [O]"
    ..() // do default action
</xmp>

<p>Note that due to network lag, it is possible when clicking on moving
objects for the location of those objects to have changed by the time the
DblClick() proc is executed.  That is the reason for the location argument.
It tells you where the click originally took place.

<xmp>
DblClick(object as null|atom in usr.client,\
         location as null|turf|text in usr.client,\
         control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/Del>
<h2>Del proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/mob/proc/Logout>Logout proc (mob)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Del()
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player disconnects from the world.
</dl>

<dl><dt><b>Default action:</b>
<dd>If the player is connected to a mob, call mob.Logout() to disconnect.
If the player's connection to the world is still not dead, kill it.
</dl>

<p>Note that this does not automatically delete the player's mob.  If you want
to do that, you could do so in mob.Logout().

<hr>

<a name=/client/proc/East>
<h2>East proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>East()
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "right" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the east.
</dl>

<hr>

<a name=/client/proc/Export>
<h2>Export proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Import>Import proc (client)</a>
<dd><a href=#/client/proc/New>New proc (client)</a>
<dd><a href=#/world/var/hub>hub var (world)</a>
<dd><a href=#/savefile>savefile</a>
</dl>

<dl><dt><b>Format:</b>
<dd>client.Export(file)
</dl>

<dl><dt><b>Args:</b>
<dd>file: file to send to client
</dl>

<p>This stores the file on the user's computer in a special location unique to 
each registered <a href=#/world/var/hub>world.hub</a> setting.  This is most 
useful for writing a client-side savefile, but any type of file may be stored.  
The purpose of this is to exchange information between different worlds running 
under the same hub path.

<p>When a file is exported to the player's computer, it replaces any
previous file stored by a game with the same <code>world.hub</code> value.
This should not be used for anything requiring high security, because any
other world could make use of the same hub path and access the file.  It
is also possible for the user to tinker with the file, since it resides on
their computer.

<p>To delete the client-side file completely, call
<code>client.Export()</code> with no argument at all.

<h3>Example:</h3>

<xmp>
mob/verb/save()
   var/savefile/F = new()
   F << usr     //write the player's mob
   usr.client.Export(F)

client/New()
   var/client_file = Import()
   if(client_file)
      var/savefile/F = new(client_file) //open it as a savefile
      F >> usr  //read the player's mob
   return ..()
</xmp>

<hr>

<a name=/client/proc/GetAPI>
<h2 byondver=514>GetAPI proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/SetAPI>SetAPI proc (client)</a>
<dd><a href=#/client/proc/CheckPassport>CheckPassport proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetAPI(Api, Name)
</dl>

<dl><dt><b>Args:</b>
<dd>Api: the name of the API (e.g. "steam")
<dd>Key: the name of the value to read
</dl>

<p>Interfaces with supported external APIs to read information. Currently this
only has meaning for Steam, for specially built games that have a Steam app ID.

<p>This proc returns null any time the call or its results are invalid: for
instance, trying to query a Steam stat from a user who isn't logged into
Steam.

<table class=api>
<thead><tr><th>Key</th><th class=nobr>Return type</th><th>Description</th></tr></thead>
<tbody>
<tr><th colspan=4><tt>"steam"</tt> API<br/>Requires that the server and client are using a valid Steam app ID, such as when a game is built for standalone distribution.</th></tr>
<tr><td>id</td><td>text</td><td>Returns the user's numeric Steam ID, if any. Because this number is too big to fit in BYOND's numbering system, it is returned as text.</td></tr>
<tr><td>name</td><td>text</td><td>Returns the user's persona name on Steam.</td></tr>
<tr><td>stat:<i>Name</i></td><td>num</td><td>Returns the value of the stat called <tt>Name</tt>.</td></tr>
<tr><td>achievement:<i>Name</i></td><td>num</td><td>Returns the date (for use with <a class=code href=#/proc/time2text>time2text</a>) the achievement called <tt>Name</tt>, or 0 if it hasn't been earned.</td></tr>
<tr><td>achievement-data:<i>Name</i></td><td>list</td><td>Returns information about the achievement called <tt>Name</tt>. The result is an associative list with named values <tt>name</tt> (display name), <tt>desc</tt> (description), and optionally <tt>hidden</tt> and <tt>icon</tt>. (This call is the same no matter which client you call it for.)</td></tr>
<tr><td>achievements</td><td>list</td><td>Returns a list of all possible achievements. Each item in the list is the internal name of the achievement, and it is associated with a list in the form described for <tt>achievement-data:<i>Name</i></tt>. (This call is the same no matter which client you call it for.)</td></tr>
</tbody>
</table>

<hr>

<a name=/client/proc/Import>
<h2>Import proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Export>Export proc (client)</a>
<dd><a href=#/client/proc/New>New proc (client)</a>
<dd><a href=#/savefile>savefile</a>
</dl>

<dl><dt><b>Format:</b>
<dd>client.Import(Query)
</dl>

<dl><dt><b>Args:</b>
<dd>Query: optional query parameters
</dl>

<p>When no query parameters are given, this returns the client-side file last
exported with <code>client.Export()</code>.  This comes as an entry in the
resource cache, which can be opened as a savefile among other things.  If
there is no file, null is returned.  For an example, see
<a href=#/client/proc/Export>client.Export</a>.

<p>When there are query parameters, these may be used to import a file from
some alternate source.  Currently this is not supported.

<hr>

<a name=/client/proc/IsByondMember>
<h2>IsByondMember proc (client)</h2>

<dl><dt><b>Format:</b>
<dd>IsByondMember()
</dl>

<dl><dt><b>Args:</b>
<dd>None.
</dl>

<p>This built-in procedure checks to see if the user is a BYOND Member.
Use it to give special in-game rewards to those who support BYOND.

<p>If the user is a Member, the result is the number of days left (rounded
up) on their Membership, or -1 for lifetime Members.

<h3>Example:</h3>
<xmp>
mob/var
   special_features

mob/Login()
   if(client.IsByondMember())
      special_features = 1
   else
      src << "For special features, <a href=\
              'http://members.byond.com/' >become a BYOND Member</a>!"
   return ..()
</xmp>

<hr>

<a name=/client/proc/MeasureText>
<h2 byondver=513>MeasureText proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/maptext>maptext var (atom)</a>
<dd><a href=#/atom/var/maptext_width>maptext_width var (atom)</a>
<dd><a href=#/atom/var/maptext_height>maptext_height var (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MeasureText(text, style, width=0)
</dl>

<dl><dt><b>Args:</b>
<dd>text: The text to be measured
<dd>style: Stylesheet to be used (leave blank to use the default map control's styles, if any)
<dd>width: Width limit, if you only want to measure height; 0 means no limit
</dl>

<dl><dt><b>Returns:</b>
<dd>A size value in <tt>"[width]x[height]"</tt> format, e.g. "60x16"
</dl>

<p>Because maptext rendering may vary by client, <tt>MeasureText</tt> lets
you get a measurement of how text will be laid out, so you can adjust
<tt>maptext_width</tt> and <tt>maptext_height</tt> accordingly.

<hr>

<a name=/client/proc/MouseDown>
<h2>MouseDown proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown proc (atom)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseDown(object,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object under the mouse pointer
<dd>location: the turf, stat panel, grid cell, etc. containing the object where it was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseDown(location,control,params).
</dl>

<p>This is called when the a mouse button is pressed while pointing to the
object.  Note that MouseUp() will always be called after MouseDown() is
called, even if over empty space.  That means <var>object</var> and
<var>location</var> may be null.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Most operations can be done through
<tt>Click()</tt>, <tt>DblClick()</tt>, and <tt>MouseDrop()</tt>. The other
procedures are simply available for completeness.

<p>The argument format for this verb is:

<xmp>
MouseDown(object as null|atom in usr.client,\
          location as null|turf|text in usr.client,\
          control as text, params as text)
</xmp>

<p class=compatibility>Note: In BYOND 3.5 this procedure took three different
arguments: <tt>location</tt>, <tt>icon_x</tt>, and <tt>icon_y</tt>. Since
<tt>icon_x</tt> and <tt>icon_y</tt> have been replaced, old code will need to
be modified. Games compiled before this change will still work normally.

<hr>

<a name=/client/proc/MouseDrag>
<h2>MouseDrag proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag proc (atom)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseDrag(src_object,over_object,src_location,over_location,src_control,over_control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>src_object: the object being dragged
<dd>over_object: the object under the mouse pointer
<dd>src_location: the turf, stat panel, grid cell, etc. from where the src object was dragged
<dd>over_location: the turf, stat panel, grid cell, etc. containing the object under the mouse pointer
<dd>src_control: The id of the skin control the object was dragged from
<dd>over_control: The id of the skin control the object was dragged over
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseDrag(over_object,src_location,over_location,src_control,over_control,params).
</dl>

<p>This is called while dragging an object by pressing and holding the left
mouse button over the object and moving the mouse.  The over_object may be
null if dragging over a stat panel or over other empty space.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Most operations can be done through
Click(), DblClick(), and MouseDrop().  The other procedures are simply
available for completeness.

<p>The argument format for this verb is:

<xmp>
MouseDrag(src_object as null|atom in usr.client,\
          over_object as null|atom in usr.client,\
          src_location as null|turf|text in usr.client,\
          over_location as null|turf|text in usr.client,\
          src_control as text, over_control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/MouseDrop>
<h2>MouseDrop proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop proc (atom)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseDrop(src_object,over_object,src_location,over_location,src_control,over_control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>src_object: the object being dropped
<dd>over_object: the object under the mouse pointer
<dd>src_location: the turf, stat panel, grid cell, etc. from where the src object was dragged
<dd>over_location: the turf, stat panel, grid cell, etc. containing the object under the mouse pointer
<dd>src_control: The id of the skin control the object was dragged from
<dd>over_control: The id of the skin control the object was dropped onto
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseDrop(over_object,src_location,over_location,src_control,over_control,params).
</dl>

<p>This is called when a mouse button is released after dragging an
object.  The over_object may be null if dropping over a stat panel or over
other empty space.

<p>The argument format for this verb is:

<xmp>
MouseDrag(src_object as null|atom in usr.client,\
          over_object as null|atom in usr.client,\
          src_location as null|turf|text in usr.client,\
          over_location as null|turf|text in usr.client,\
          src_control as text, over_control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/MouseEntered>
<h2>MouseEntered proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered proc (atom)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseEntered(object,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object under the mouse pointer
<dd>location: the turf, stat panel, grid cell, etc. containing the object where it was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseEntered(location,control,params).
</dl>

<p>This is called when no mouse buttons are pressed while pointing to the
object.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<p>The argument format for this verb is:

<xmp>
MouseEntered(object as null|atom in usr.client,\
             location as null|turf|text in usr.client,\
             control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/MouseExited>
<h2>MouseExited proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited proc (atom)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseExited(object,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object under the mouse pointer
<dd>location: the turf, stat panel, grid cell, etc. containing the object where it was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseExited(location,control,params).
</dl>

<p>This is called when the mouse moves off of an object.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<p>The argument format for this verb is:

<xmp>
MouseExited(object as null|atom in usr.client,\
            location as null|turf|text in usr.client,\
            control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/MouseMove>
<h2 byondver=500>MouseMove proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove proc (atom)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseMove(object,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object under the mouse pointer
<dd>location: the turf, stat panel, grid cell, etc. containing the object where it was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseMove(location,control,params).
</dl>

<p>This is called when no mouse buttons are pressed while pointing to the
object, and the mouse has moved. The first time the mouse moves over the
object, MouseEntered() is called instead.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Defining it on only the objects that
require it reduces overhead.

<p>The argument format for this verb is:

<xmp>
MouseMove(object as null|atom in usr.client,\
          location as null|turf|text in usr.client,\
          control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/MouseUp>
<h2>MouseUp proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp proc (atom)</a>
<dd><a href=#/client/proc/MouseWheel>MouseWheel proc (client)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseUp(object,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object under the mouse pointer
<dd>location: the turf, stat panel, grid cell, etc. containing the object where it was clicked
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseUp(location,control,params).
</dl>

<p>This is called when a mouse button is released while pointing to
an object.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  Most operations can be done through
<tt>Click()</tt>, <tt>DblClick()</tt>, and <tt>MouseDrop()</tt>. The other
procedures are simply available for completeness.

<p>The argument format for this verb is:

<xmp>
MouseUp(object as null|atom in usr.client,\
        location as null|turf|text in usr.client,\
        control as text, params as text)
</xmp>

<p class=compatibility>Note: In BYOND 3.5 this procedure took three different
arguments: <tt>location</tt>, <tt>icon_x</tt>, and <tt>icon_y</tt>. Since
<tt>icon_x</tt> and <tt>icon_y</tt> have been replaced, old code will need to
be modified. Games compiled before this change will still work normally.

<hr>

<a name=/client/proc/MouseWheel>
<h2 byondver=508>MouseWheel proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel proc (atom)</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var (atom)</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MouseWheel(object,delta_x,delta_y,location,control,params)
</dl>

<dl><dt><b>Args:</b>
<dd>object: the object under the mouse pointer
<dd>delta_x,delta_y: amount of wheel movement
<dd>location: the turf, stat panel, grid cell, etc. containing the object
<dd>control: the name of the skin control involved
<dd>params: other parameters including mouse/keyboard flags, icon offsets, etc.; see <a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Default action:</b>
<dd>Call object.MouseWheel(delta_x,delta_y,location,control,params).
</dl>

<p>This is called when the mouse wheel is moved while over an object or
control. It is NOT called if over a browser control, or any control that is
currently scrollable.

<p>Positive values of delta_x and delta_y refer to scrolling right or up,
respectively. Negative values are left and down, respectively.

<p>Don't define this unless you need it, because it generates extra
communication that is otherwise avoided.  If you only need wheel support on
specific objects, use atom.MouseWheel() instead which is more selective.

<p>The argument format for this verb is:

<xmp>
MouseWheel(object as null|atom in usr.client,\
           delta_x as num, delta_y as num,\
           location as null|turf|text in usr.client,\
           control as text, params as text)
</xmp>

<hr>

<a name=/client/proc/Move>
<h2>Move proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/East>East proc (client)</a>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/client/proc/North>North proc (client)</a>
<dd><a href=#/client/proc/Northeast>Northeast proc (client)</a>
<dd><a href=#/client/proc/Northwest>Northwest proc (client)</a>
<dd><a href=#/client/proc/South>South proc (client)</a>
<dd><a href=#/client/proc/Southeast>Southeast proc (client)</a>
<dd><a href=#/client/proc/Southwest>Southwest proc (client)</a>
<dd><a href=#/client/proc/West>West proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Move(loc,dir)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure
</dl>

<dl><dt><b>When:</b>
<dd>Called by the direction procs.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.mob.Move().  Also cancels any automated movement by
    calling walk(usr,0).
</dl>

<hr>

<a name=/client/proc/New>
<h2>New proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Export>Export proc (client)</a>
<dd><a href=#/client/proc/Import>Import proc (client)</a>
<dd><a href=#/mob/proc/Login>Login proc (mob)</a>
<dd><a href=#/datum/proc/New>New proc (datum)</a>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/world/var/mob>mob var (world)</a>
<dd><a href=#/savefile>savefile</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New(TopicData)
</dl>

<dl><dt><b>Returns:</b>
<dd>The newly connected mob, client.mob, or null to disallow the connection.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player first tries to connect to the world.
</dl>

<dl><dt><b>Args:</b>
<dd>usr: The mob in the world with the same key as the player, if it exists.
<dd>TopicData: If the player accessed the world with a "connection topic",
    this is the topic text.  Otherwise it is null.
</dl>

<dl><dt><b>Default action:</b>
<dd>Look for an existing mob with the same key as the player.  If found,
  connect the player to that mob (mob.Login()).  Otherwise, look for a
  prototype mob with the same key as the player.  If found, create a mob of
  that type and connect the player to it.  Otherwise, create a mob of type
  world.mob, give it the same name and gender as the player's key, and
  connect the player to it.  If TopicData is not null, call
  client.Topic(TopicData).  Finally, the player's mob is returned.
</dl>

<p>This is a fairly low-level procedure that you would only want to override
if you cannot accomplish the same thing in <code>mob/Login()</code> or
<code>mob/New()</code>.  One reason to override <code>client/New()</code> is
if player mobs are created from a savefile.  In that case, you don't need a
temporary mob to be created first.

<h3>Example:</h3>
<xmp>
client/New()
   if(usr) return ..() //reconnecting to existing mob
   else
      var/player_sav = "players/[ckey].sav"
      if(length(file(player_sav)))        //if player savefile exists
         var/savefile/F = new(player_sav) //open it
         F >> usr    //create saved mob
      return ..()    //creates a new mob if necessary
mob/Logout()
   var/player_sav = "players/[ckey].sav"
   var/savefile/F = new(player_sav)
   F << src
   del src
</xmp>

<p>If you want to do any user-interaction before loading the saved mob, you
will have to create a temporary mob first in order to interact with the
player.  In that case, you are better off doing things in
<code>mob/Login()</code>, rather than <code>client/New()</code>.

<p>Note that for the above example to work, you <strong>must</strong> make
proper use of the <a href=#/var/tmp>tmp</a> flag when defining new object
variables.  Otherwise, this can end up sucking large portions of your world
into each player savefile, which can have all sorts of unexpected
consequences!

<hr>

<a name=/client/proc/North>
<h2>North proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>North()
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "up" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the north.
</dl>

<hr>

<a name=/client/proc/Northeast>
<h2>Northeast proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Northeast()
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "up-right" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the northeast.
</dl>

<hr>

<a name=/client/proc/Northwest>
<h2>Northwest proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Northwest()
</dl>

<dl><dt><b>Returns:</b>
<dd>Returns 1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "up-left" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the northwest.
</dl>

<hr>

<a name=/client/proc/RenderIcon>
<h2 byondver=515>RenderIcon proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/vis_contents>vis_contents var (atom)</a>
<dd><a href=#/{notes}/filters>Filter effects</a>
</dl>

<dl><dt><b>Format:</b>
<dd>RenderIcon(object)
</dl>

<dl><dt><b>Args:</b>
<dd>object: An atom or appearance to render.</dd>
</dl>

<dl><dt><b>Returns:</b>
<dd>A single-image icon file in which the object is rendered with all its
overlays, visual contents, etc.
</dl>

<p>Use this proc to render an atom or an appearance as a single icon. This is
a client proc because the server is not capable of rendering anything on its
own.

<p>Any overlays, image objects known to this client that are attached to the
object, visual contents, maptext, and so on will be included in the render.
The returned icon is sized to fit all of the above, and to include room for
any expansion due to filter effects.

<h3>Example:</h3>
<xmp>
mob/proc/GetFlatIcon()
    return client?.RenderIcon(src)
</xmp>

<p>Important notes regarding this proc:

<ul>
<li>The returned icon is a cache file, <i>not</i> an <tt>/icon</tt> datum.</li>
<li>If <tt>object</tt> is an <a href=#/image><tt>/image</tt> object</a>, the
  image must be known to the client. Otherwise the return value is null.</li>
<li>If this object doesn't appear on the client's map, it will be sent to them
  on the next map tick, along with any visual contents. The server will hold a
  reference to the object until the map tick ends, so an object you create
  temporarily should remain valid long enough to be rendered.</li>
<li><a class=code href=#/atom/var/render_source>render_source</a> will not
  work unless the corresponding
  <a class=code href=#/atom/var/render_target>render_target</a> appears in the
  same render stack. That is, this object or appearance will be rendered in an
  isolated "scene" rather than as part of the map, so it won't be able to use
  other objects on the map as render sources.</li>
</ul>

<hr>

<a name=/client/proc/SendPage>
<h2>SendPage proc (client)</h2>

<dl><dt><b>Format:</b>
<dd>SendPage(msg,recipient,options)
</dl>

<dl><dt><b>Returns:</b>
<dd>Returns number of recipients successfully contacted.
</dl>

<dl><dt><b>Args:</b>
<dd>msg: text to send
<dd>recipient: key or list of keys to page
<dd>options: text string containing key=value options
</dl>

<p>The user is prompted to authorize sending of the pager message.  The
recipient may easily respond or jump to the sender's location by clicking on
the link in the pager message.  The effect is identical to that of the
sending a page through the Dream Seeker pager.

<p>The options are encoded in the same format read by text2params().  The
valid options are:

<dl>
<dt>summon (0/1)</dt>

<dd>If not included in the options, this is 0.  If included in the options
without assigning it to anything, it is 1.  A value of 1 sends the recipient
the sender's location so they can join by clicking on the message.

<dt>email (0/1)</dt>

<dd>If not included in the options, this is 0.  If included in the options
without assigning it to anything, it is 1.  A value of 1 sends causes the
message to be delivered as email.  If this is not possible, it is delivered as
a long-lived pager message.  Normally, pager messages expire within a short
time after being sent (half an hour).

<dt>subject</dt>

<dd>For email messages, this specifies the subject to use.

</dl>

<hr>

<a name=/client/proc/SetAPI>
<h2 byondver=514>SetAPI proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/GetAPI>GetAPI proc (client)</a>
<dd><a href=#/client/proc/CheckPassport>CheckPassport proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SetAPI(Api, Key, Value)
</dl>

<dl><dt><b>Args:</b>
<dd>Api: the name of the API (e.g. "steam")
<dd>Key: the name of the value to change
<dd>Value: the new value to set
</dl>

<p>Interfaces with supported external APIs to write information. Currently this
only has meaning for Steam, for specially built games that have a Steam app ID.

<p>This proc returns null any time the call or its results are invalid.

<table class=api>
<thead><tr><th>Key</th><th class=nobr>Return type</th><th>Description</th></tr></thead>
<tbody>
<tr><th colspan=4><tt>"steam"</tt> API<br/>Requires that the server and client are using a valid Steam app ID, such as when a game is built for standalone distribution.</th></tr>
<tr><td>stat:<i>Name</i></td><td>num</td><td>Changes the value of the stat called <tt>Name</tt>. Returns 1 on success. This may fail if the stat change is too much or is out of range.</td></tr>
<tr><td>achievement:<i>Name</i></td><td>num</td><td>Earns the achievement called <tt>Name</tt>, or clears it. Value is expected to be a number, or number in text form, where 0 will clear the achievement and 1 will earn it.</td></tr>
</tbody>
</table>

<hr>

<a name=/client/proc/SoundQuery>
<h2 byondver=513>SoundQuery proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound>/sound datum</a>
<dd><a href=#/proc/sound>sound proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SoundQuery()
</dl>

<dl><dt><b>Args:</b>
<dd>none
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of <tt>/sound</tt> datums with information about currently playing sounds.
</dl>

<p>This proc is used to ask a client about sounds that are playing. The
<tt>/sound</tt> datums in the returned list have the following vars set:

<ul>
  <li>file: Sound/music file, or null if none</li>
  <li>channel: Channel of sound, if one was set when the sound was played</li>
  <li>repeat: The <tt>repeat</tt> value of the sound</li>
  <li>status: Status flags active for this channel; currently only <tt>SOUND_PAUSED</tt> is supported</li>
  <li>offset: Current time index, in seconds, of the sound at the current frequency</li>
  <li>len: Total duration, in seconds, of the sound at the current frequency</li>
  <li>wait: Total duration of sounds queued to play later on this channel (does not apply to channel 0)</li>
</ul>

<p>Not all info about the sounds is retrieved, such as <tt>volume</tt>,
<tt>frequency</tt>, etc. If those are needed, it should be a simple matter to
keep track of them in your code. The main purpose of <tt>SoundQuery()</tt> is
to ascertain the current status of playing sounds.

<hr>

<a name=/client/proc/South>
<h2>South proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>South()
</dl>

<dl><dt><b>Returns:</b>
<dd>Returns 1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "down" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the south.
</dl>

<hr>

<a name=/client/proc/Southeast>
<h2>Southeast proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Southeast()
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "down-right" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the southeast.
</dl>

<hr>

<a name=/client/proc/Southwest>
<h2>Southwest proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Southwest()
</dl>

<dl><dt><b>Returns:</b>
<dd>Returns 1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "down-left" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the southwest.
</dl>

<hr>

<a name=/client/proc/Stat>
<h2>Stat proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Stat>Stat proc (atom)</a>
<dd><a href=#/proc/stat>stat proc</a>
<dd><a href=#/client/var/statobj>statobj var (client)</a>
<dd><a href=#/proc/statpanel>statpanel proc</a>
<dd><a href=#/client/var/statpanel>statpanel var (client)</a>
<dd><a href=#/{skin}/control/info>Info control (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Stat()
</dl>

<dl><dt><b>When:</b>
<dd>Called periodically by the client to update the stat window.
</dl>

<dl><dt><b>Default action:</b>
<dd>Call statobj.Stat().
</dl>

<p>If this procedure sleeps (or engages in some other waiting operation), it
will not be called again until it finally returns.  This allows you to
effectively decrease the frequency of calls to the proc.  You might want to
do that if it is a fairly lengthy procedure, and frequent calls are slowing
things down.

<p>To increase the frequency of stat updates, you can lower
<code>world.tick_lag</code>.

<p>Note: Typically only the currently viewed statpanel is updated, which
saves on some network activity and a little time.  If however the proc
sleeps, you need to be sure that any pending updates are displayed once
the right panel is available.  Therefore if you're resetting a var that
indicates the proc should sleep next time, it should not be reset unless
you know the player is looking at the right statpanel and has received
the updates.

<h3>Example</h3>
<xmp>
client/var/updategold = 1       // set to 1 if gold changes
client/var/updateinventory = 1  // set to 1 if inventory changes

client/Stat()
    // if not ready to update, Stat() won't be called again till sleep is done
    while(!updategold && !updateinventory)
        sleep(5)
    if(statpanel("Gold")) // switch to Gold panel and ask if player is looking at it
        stat("Gold", mob.gold)
        updategold = 0  // we updated, so turn this flag back off
    if(statpanel("Inventory"))
        stat(mob.contents)
        updateinventory = 0
</xmp>

<p>Because sleeping in Stat() requires more thinking through, it's best to do
so only in cases where Stat() has to do a lot of intensive calculations.

<hr>

<a name=/client/proc/Topic>
<h2>Topic proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/New>New proc (client)</a>
<dd><a href=#/datum/proc/Topic>Topic proc (datum)</a>
<dd><a href=#/proc/link>link proc</a>
<dd><a href=#/DM/text/macros/ref>ref text macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Topic(href,href_list[],hsrc)
</dl>

<dl><dt><b>When:</b>
<dd>Called when a player connects to a world with a "connection topic" or
    when the player runs a hyperlink in the current world by clicking one
    embedded in text or generated by the link() instruction.
</dl>

<dl><dt><b>Args:</b>
<dd>href: The topic text (everything after the '?' in the full href).
<dd>href_list: List of key/value pairs in href (produced from params2list(href)).
<dd>hsrc: The object referenced by the "src" parameter in href or null if none.
</dl>

<dl><dt><b>Default action:</b>
<dd>Call the hsrc object's own Topic() proc.
</dl>

<p>The following example uses a very simple href value.

<h3>Example:</h3>
<xmp>
mob/Login()
  src << "Click <a href=?source>here</a> to download the source code."
  return ..()

client/Topic(href)
  if(href == "source")
    usr << file("world.dm")
    usr << file("world.rsc")
  else ..()
</xmp>

<p>Be sure to call the default handler unless you want to prevent rerouting
of topics to other objects.

<p class="note security">Always validate the input in <tt>Topic()</tt> calls
to make sure it's correct and the query you're recieving is legitimate. For
security reasons, you will probably want to control which objects a player has
access to, since a player could spoof a topic link containing any arbitrary
object reference. (Never trust those sneaky players!)

<p>The next example demonstrates an href that gets handled by another object.
This is how you would normally want to do things.  It is best not to override
client/Topic() (as in the example above) unless you need to intervene in the
low-level details of routing the request to the right object.

<p>You specify the object that will handle the request by using a parameter
called "src".

<h3>Example:</h3>
<xmp>
mob/Login()
   src << "Click <a href='?src=\ref[src];action=startgame'>here</a> to start."
   return ..()

mob/Topic(href,href_list[])
   switch(href_list["action"])
      if("startgame")
         usr << "Starting game..."
      else
         return ..()
</xmp>

<p>Although it is slightly more complex, the use of the parameter list allows
you to easily include extra data and new functionality.  Just remember that
the data in the list is always stored as text, so if you are expecting a
number or an object, you must convert it yourself (with text2num(), locate(),
or whatever).

<hr>

<a name=/client/proc/West>
<h2>West proc (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Move>Move proc (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>West()
</dl>

<dl><dt><b>Returns:</b>
<dd>Returns 1 on success; 0 on failure.
</dl>

<dl><dt><b>When:</b>
<dd>Called when the player presses the "left" key or cursor.
</dl>

<dl><dt><b>Default action:</b>
<dd>Calls src.Move() towards the west.
</dl>

<hr>

<a name=/client/var>
<h2>vars (client)</h2>

<p>Built-in client vars:

<dl><dt>client/var
<dd><a href=#/client/var/address>address</a>
<dd><a href=#/client/var/authenticate>authenticate</a>
<dd><a href=#/client/var/bounds>bounds</a>
<dd><a href=#/client/var/byond_build>byond_build</a>
<dd><a href=#/client/var/byond_version>byond_version</a>
<dd><a href=#/client/var/CGI>CGI</a>
<dd><a href=#/client/var/ckey>ckey</a>
<dd><a href=#/client/var/color>color</a>
<dd><a href=#/client/var/command_text>command_text</a>
<dd><a href=#/client/var/connection>connection</a>
<dd><a href=#/client/var/control_freak>control_freak</a>
<dd><a href=#/client/var/computer_id>computer_id</a>
<dd><a href=#/client/var/default_verb_category>default_verb_category</a>
<dd><a href=#/client/var/dir>dir</a>
<dd><a href=#/client/var/edge_limit>edge_limit</a>
<dd><a href=#/client/var/eye>eye</a>
<dd><a href=#/client/var/fps>fps</a>
<dd><a href=#/client/var/gender>gender</a>
<dd><a href=#/client/var/glide_size>glide_size</a>
<dd><a href=#/client/var/images>images</a>
<dd><a href=#/client/var/inactivity>inactivity</a>
<dd><a href=#/client/var/key>key</a>
<dd><a href=#/client/var/lazy_eye>lazy_eye</a>
<dd><a href=#/client/var/mob>mob</a>
<dd><a href=#/client/var/mouse_pointer_icon>mouse_pointer_icon</a>
<dd><a href=#/client/var/perspective>perspective</a>
<dd><a href=#/client/var/pixel_x>pixel_x</a>
<dd><a href=#/client/var/pixel_y>pixel_y</a>
<dd><a href=#/client/var/pixel_w>pixel_w</a>
<dd><a href=#/client/var/pixel_z>pixel_z</a>
<dd><a href=#/client/var/preload_rsc>preload_rsc</a>
<dd><a href=#/client/var/screen>screen</a>
<dd><a href=#/client/var/script>script</a>
<dd><a href=#/client/var/show_map>show_map</a>
<dd><a href=#/client/var/show_popup_menus>show_popup_menus var</a>
<dd><a href=#/client/var/show_verb_panel>show_verb_panel</a>
<dd><a href=#/client/var/statobj>statobj</a>
<dd><a href=#/client/var/statpanel>statpanel</a>
<dd><a href=#/client/var/tick_lag>tick_lag</a>
<dd><a href=#/client/var/timezone>timezone</a>
<dd><a href=#/client/var/verbs>verbs</a>
<dd><a href=#/client/var/view>view</a>
<dd><a href=#/client/var/virtual_eye>virtual_eye</a>
</dl>

<hr>

<a name=/client/var/CGI>
<h2>CGI var (client)</h2>

<p>In CGI mode, DreamDaemon is normally being executed by a web server and
accessed by a web browser.  The CGI object is an add-on to the basic client
object for handling this case.

<p>The CGI object is defined and documented in a separate code library
<code>html/CGI.dm</code>.  You can find the current version at
<a href="http://www.byond.com/developer/Dantom/CGI">www.byond.com</a>.

<hr>

<a name=/client/var/address>
<h2>address var (client)</h2>

<dl><dt><b>Default value:</b>
<dd>The network address of the player's client.
</dl>

<p>This is a read-only value which contains the player's network address.

<hr>

<a name=/client/var/authenticate>
<h2>authenticate var (client)</h2>

<p>This value may be set to 0 at compile-time to disable BYOND hub-based
authentication of users.  The default value is 1, which enables
authentication.  Hub authentication provides an additional level of
assurance that the user is really the owner of the BYOND key in question.

<p>When a world requests certification, Dream Seeker generates a random
password and passes it through the hub (for certification) to the world.
The certificate is saved for faster access in the future and for protection
against possible hub outages.

<p>Some applications do not depend on the validity of the user's identity.
In that case, it would be more efficient to turn off the extra level of
authentication.  In other situations, the hub may not be available, such as
from behind a firewall or on a LAN without internet access.  In those cases,
all hub access (including authentication) can be disabled by entering the
command ".configuration hub-address none" in Dream Seeker.

<p>Connections to worlds on the same machine are not hub-authenticated to
allow for convenient offline testing.

<hr>

<a name=/client/var/bounds>
<h2 byondver=509>bounds var (client)</h2>

(Also <tt>bound_x</tt>, <tt>bound_y</tt>, <tt>bound_width</tt>, and
<tt>bound_height</tt>.)

<dl><dt><b>See also:</b>
<dd><a href=#/proc/bounds>bounds proc</a>
</dl>

<p>The read-only bounds var returns the map coordinates, in pixels, covered
by the client's viewport when accounting for pixel offsets, eye, step, etc.
(The coordinates are only relevant to the default <tt>client.dir</tt> value of
<tt>NORTH</tt>, and the <tt>TOPDOWN_MAP</tt> or <tt>SIDE_MAP</tt> map
formats.)

<p>If the viewport is not currently on the map (for instance, when the eye is
at a null location), the var reads as null.  Otherwise, it is a list with
five values (x, y, width, height, z) in the same form used by the bounds proc.

<p>The alias vars bound_x, bound_y, bound_width, and bound_height can also
be used to retrieve the individual values from the list.  They too will be
null if the viewport is not on the map.

<hr>

<a name=/client/var/byond_build>
<h2 byondver=512>byond_build var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/DM_VERSION>DM_VERSION macro</a>
<dd><a href=#/client/var/byond_version>byond_version var (client)</a>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
</dl>

<p>This is the build number (minor version) of BYOND being run by this client.
Typically this is not useful information, but it can come in handy when
diagnosing issues reported by players using a beta build.

<p>Clients running versions of BYOND prior to 512 (major version) will not
have this information. It is also not guaranteed to exist for non-Dream Seeker
connections. When not available, byond_build is 0.

<hr>

<a name=/client/var/byond_version>
<h2>byond_version var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/DM_VERSION>DM_VERSION macro</a>
<dd><a href=#/client/var/byond_build>byond_build var (client)</a>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/world/var/system_type>system_type var (world)</a>
</dl>

<p>This is the version of BYOND being run by this client.  A game designed to
work around known bugs in older versions could use this to adapt its behavior
accordingly.  It is also possible to prevent players with much older versions
from joining the game.

<hr>

<a name=/client/var/ckey>
<h2>ckey var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ckey>ckey proc</a>
<dd><a href=#/client/var/key>key var (client)</a>
</dl>

<p>This is a read-only value that is the canonical form of the player's key
(ie the value returned by ckey()).  Among other things, this could be used
as a unique directory name in a server-side save file for storing player
information.  See the ckey() proc for an example.

<hr>

<a name=/client/var/color>
<h2 byondver=509>color var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
</dl>

<p>Casts a color multiplication or <a href=#/{notes}/color-matrix>matrix</a>
effect over the entire main map.  This behaves exactly the same as
atom.color, and will be combined with atom.color (which comes first) where
present.  See <a href=#/atom/var/color>atom.color</a> for more information.

<p>If a matrix is used, the alpha column and row will have no effect.

<p>Icons that have the NO_CLIENT_COLOR value in appearance_flags will not be
subject to client.color.  This can be useful for HUD objects.

<p>This value can be animated.

<h3>Example:</h3>
<xmp>
mob/proc/DayNight(is_day)
    if(client)
        client.color = is_day ? \
            null : \
            list(0.2,0.05,0.05, 0.1,0.3,0.2, 0.1,0.1,0.4)
</xmp>

<hr>

<a name=/client/var/command_text>
<h2 deprecated=1>command_text (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/arguments>arguments (verb)</a>
<dd><a href=#/{skin}/param/command>command parameter</a>
<dd><a href=#/client/var/script/macro>macros (client script)</a>
<dd><a href=#/{skin}/control/input>Input control (skin)</a>
<dd><a href=#/{skin}/param/command>command parameter (skin)</a>
<dd><a href=#/{skin}/macros>macros (skin)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p class=compatibility>Note: In BYOND 4.0 this var is deprecated. The
<a class=code href=#/{skin}/param/command>command</a> parameter for an
<a href=#/{skin}/control/input>Input control</a> can be set to
<tt>!command</tt> (<tt>!</tt> in front of your default command) which does the
same thing.

<p>This text is placed onto the command line, to be followed by whatever the
user may type.  It is usually the name of a verb followed by a space, such
as <tt>"say "</tt>.  The user can clear this and enter a different command by
hitting backspace, escape, delete, or <tt>/</tt>.

<h3>Example:</h3>
<xmp>
client
   command_text = "say "

   verb/say(T as text)
      world << "[usr] says, '[T]'"
</xmp>

<p>It is also possible to turn on macro mode, in which each keypress
executes a <a href=#/client/var/script/macro>keyboard macro</a>, by setting
<code>command_text</code> to <tt>".alt "</tt>.  That stands for the <i>Alt</i>
key, which can be used to execute macros in normal mode.

<p>This variable could also be used to create a specialized command prompt.
For example, a traditional style MUD command-line could be implemented like
this:

<h3>Example:</h3>
<xmp>
client
   command_text = "> "
   verb/command(C as command_text)
      set name = ">"
      usr << "Your command: [C]"
</xmp>

<p>This example uses the <tt>command_text</tt> input type, which accepts raw
text, with no quoting, escaping, or translating, so that you can invent
whatever syntax you want.

<hr>

<a name=/client/var/computer_id>
<h2>computer_id var (client)</h2>

<dl><dt><b>Default value:</b>
<dd>A unique numerical identifier for the player's computer. The value is in text form.
</dl>

<p>This is a read-only text value which contains a unique numerical identifier for the player's computer. 
Its primary purpose is to detect if players are connecting to a server with multiple
accounts on the same machine, while still allowing for multiple accounts on the same network (eg, 
through a router).

<hr>

<a name=/client/var/connection>
<h2 byondver=487>connection var (client)</h2>

<p>This is a read-only var describing the type of client that is connected.

<dl><dt><b>Possible values:</b></dt>
<dd>"seeker" - The player is connected through Dream Seeker</dd>
<dd>"telnet" - The player is connected through telnet</dd>
<dd>"world" - The client is actually a world.Export() connection from another server</dd>
<dd>"cgi" - The client is connected via CGI (irrelevant to most worlds)</dd>
<dd>"web" - The client is connected via the Web client</dd>
<dd>"http" - The client is an HTTP connection (used by the Web client's virtual server)</dd>
</dl>

<p>Other values may be supported in the future.

<p>An empty value means the connection type is unknown because a full handshake hasn't been completed yet.

<hr>

<a name=/client/var/control_freak>
<h2>control_freak (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}>User interface skins</a>
<dd><a href=#/{skin}/macros>macros (skin)</a>
<dd><a href=#/client/var/script/macro>macros (client script)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This var lets you set flags to turn off options that are normally present
for the end user. You can combine these flags with the <tt>|</tt> operator.
The value 1 is equivalent to <tt>CONTROL_FREAK_ALL</tt> and will disable
everything.

<dl class=codedt>
<dt byondver=481>CONTROL_FREAK_ALL</dt>
<dd>If this value is used, it affects all the options below.
<ul>
  <li>User-defined macros may not be used.</li>
  <li>Only the world's skin or the default BYOND skin will be loaded, not a user-customized version.</li>
  <li>The Options &amp; Messages window in Dream Seeker is inaccessible. It will only come up while first connecting to a remotely hosted world, or if a world takes a long time to load. The .options command will not make it appear.</li>
  <li>The menu items from Options &amp; Messages are unavailable in Dream Seeker's system menu.</li>
  <li>The default F2 macro for the .screenshot command is turned off. The command is then only accessible through the skin you create.</li>
</ul></dd>

<dt byondver=481>CONTROL_FREAK_SKIN</dt>
<dd>Toggles the ability to create a custom version of the skin.</dd>

<dt byondver=481>CONTROL_FREAK_MACROS</dt>
<dd>Toggles the ability to use and define custom macros.</dd>
</dl>

<p>Using <tt>CONTROL_FREAK_ALL</tt> will default to disabling everything, and
the other flags will reenable only the features you want. For example,
<tt>CONTROL_FREAK_MACROS</tt> alone will disable the ability to use your own
macros but nothing else. <tt>CONTROL_FREAK_ALL | CONTROL_FREAK_MACROS</tt>
will disable everything <i>except</i> macros.

<p>This value can be changed at runtime.

<p>Note: If you define your own skin for the world, and disable the ability to
use a custom skin or user-defined macros, you must be sure to define any
macros your world may need. For instance, arrow keys may be needed for
movement.

<hr>

<a name=/client/var/default_verb_category>
<h2>default_verb_category var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/category>category setting (verb)</a>
<dd><a href=#/client/var/show_verb_panel>show_verb_panel var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>"Commands"
</dl>

<p>All verbs with category "" (the default value) are treated as though they
had this category setting instead.  In other words, this is the name of the
panel that contains them.  You could even turn that panel off by setting this
value to null.

<hr>

<a name=/client/var/dir>
<h2>dir var (client)</h2>

<dl><dt><b>Default value:</b>
<dd>NORTH
</dl>

<p>This defines the relationship between the world's coordinate system and the
player's screen.  The default means that the player sees the map exactly as it
was created (in the map-editor or at runtime).  Changing it to one of the
other directions causes the player to see the map as if it were rotated to
that direction.  This means that a player with client.dir = SOUTH would see
the map inverted relative to a person with client.dir = NORTH.  That's handy
in two-player board games where you want both players to see their side in the
same place.

<p>Note that this does not turn icons upside down!  The map is rotated, but
the icons on the map remain in their normal orientation.

<p>Movement keys are remapped so that a player with client.dir = SOUTH hitting
the up arrow will generate a call to client.South() rather than the usual
client.North().


<hr>

<a name=/client/var/edge_limit>
<h2>edge_limit var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/eye>eye var (client)</a>
<dd><a href=#/client/var/lazy_eye>lazy_eye var (client)</a>
<dd><a href=#/client/var/perspective>perspective var (client)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This value determines the limits that a client's eye will display.
If <code>client.perspective</code> uses the <code>EDGE_PERSPECTIVE</code> flag,
the view shouldn't scroll beyond the bounds set by <code>edge_limit</code>. If
the bounds of <code>edge_limit</code> are as big as or smaller than the
client's view, no scrolling will occur even if <code>EDGE_PERSPECTIVE</code>
is not used. Normally this value is null, which provides freedom for the eye
to move anywhere on the map. It may be changed to a text value describing the
limits in more detail.

<p>The format is similar to <code>atom.screen_loc</code> which uses
<code>"[x1],[y1]&nbsp;to&nbsp;[x2],[y2]"</code>. It can also use directions
such as <code>"SOUTHWEST&nbsp;to&nbsp;NORTHEAST"</code>, which refer to the
limits of the map.

<h3>Example:</h3>
<xmp>
area/house
  var/x1,x2,y1,y2

  Entered(mob/M)
    if(ismob(M) && M.client)
      M.client.edge_limit = "[x1],[y1] to [x2],[y2]"

  Exited(mob/M)
    if(ismob(M) && M.client)
      M.client.edge_limit = null
</xmp>

<hr>

<a name=/client/var/eye>
<h2>eye var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/edge_limit>edge_limit var (client)</a>
<dd><a href=#/client/var/lazy_eye>lazy_eye var (client)</a>
<dd><a href=#/client/var/mob>mob var (client)</a>
<dd><a href=#/client/var/perspective>perspective var (client)</a>
<dd><a href=#/client/var/glide_size>glide_size var (client)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/client/var/virtual_eye>virtual_eye var (client)</a>
<dd><a href=#/world/var/view>view var (world)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The connected mob, client.mob.
</dl>

<p>This value determines the center of the player's map.  The default value
simply means that the visible region is normally centered on the player's mob.
Effects such as setting <code>perspective</code> to
<code>EDGE_PERSPECTIVE</code> or using <code>lazy_eye</code> can move the map
off-center temporarily. The eye is the <i>ideal</i> center, not
necessarily the actual center; to find the actual center, use
<code>virtual_eye</code>.

<p>The eye's step_x/y vars, if present, are also used to allow smooth
scrolling of the map. These also obey lazy_eye and edge_limit.

<p>Note that the visibility of objects is still computed from the point of
view of the mob rather than the eye.  This allows the use of
<code>lazy_eye</code> or similar effects that control the panning of the map
while still having the player see only what the mob can see.  To determine
visibility from the eye, you can change the value of
<code>client.perspective</code>.

<p>If a player connects to a new mob M, client.eye automatically changes to M.

<h3>Example:</h3>
<xmp>
client
  eye = locate(5,5,1)
</xmp>

<p>This fixes the center of the player's map at the turf coordinate (5,5,1).
Since the eye is fixed, the map will not scroll even as the player's mob
moves out of the visible range.

<hr>

<a name=/client/var/fps>
<h2 byondver=511>fps var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/fps>fps var (world)</a>
<dd><a href=#/client/var/tick_lag>tick_lag var (client)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (uses world.fps value)
</dl>

<p>This is a client version of world.fps, so that the client can run at a
faster speed for animations.  For example, setting client.fps to 40 while
world.fps is the default 10 will mean that all animations and glides are
smoothed out and displayed at 40 FPS, even though the server still runs at
10 FPS.  The result is a nicer-looking game with no additional impact on the
server.

<p>When this value is 0, the client and server tick at the same rate.

<hr>

<a name=/client/var/gender>
<h2>gender var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/New>New proc (client)</a>
<dd><a href=#/atom/var/gender>gender var (atom)</a>
<dd><a href=#/client/var/key>key var (client)</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
</dl>

<p>This is the client's gender, which is an attribute of the player's key.
By default, when a new mob is made for a player (in client.New()), the new
mob gets the same name and gender as the player's key.  This influences text
macros like <code>\he</code>, which may expand to "it", "he", "she", or
"they".  Valid values are:

<xmp>
"neuter"
"male"
"female"
"plural"
</xmp>

<hr>

<a name=/client/var/glide_size>
<h2 byondver=490>glide_size var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/eye>eye var (client)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atoms)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Note: The way this setting is used depends on
<a href=#/world/var/movement_mode>world.movement_mode</a>. See
<a href=#/{notes}/gliding>Gliding</a> for more details.

<p>This controls the number of pixels the map is moved in each step during
scrolling of the map.  The default value of 0 chooses automated control over
this value, which generally results in a minimum step of 4 pixels that is
increased when necessary to keep up with motion of the map.

<p>Be careful about using small step sizes.  Icons with high contrast
pixel-level detail can look pretty ugly when displaced by short distances.

<p>This was renamed from <tt>pixel_step_size</tt>.

<hr>

<a name=/client/var/images>
<h2>images var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/image>image objects</a>
<dd><a href=#/proc/image>image proc</a>
</dl>

<p>This is a list of images that are displayed to the user.  The output
operator is one way to add entries to this list.  Deleting an image object
will automatically remove it from the display, but if you want to retain an
image (so other people can still see it), it can be removed by directly
modifying this list.

<h3>Example:</h3>

<xmp>
var/image/I = new('image.dmi',usr)
usr.client.images += I  //display it
sleep(50)
usr.client.images -= I  //remove it from the display
</xmp>

Displaying the image can also be achieved like this:

<xmp>
usr << I
</xmp>

<hr>

<a name=/client/var/inactivity>
<h2>inactivity var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
</dl>

<p>This is equal to the amount of time (in server ticks, which default to
1/10s) since the player's last action (such as executing a verb, moving,
clicking an object, or selecting a topic link).  This value is reset to 0
after each new action so you can use it to determine the time that has passed
since the last one.

<h3>Example:</h3>
<xmp>
mob/verb/inactivity()
  usr << "You have been inactive for [client.inactivity/10] seconds."
</xmp>

<hr>

<a name=/client/var/key>
<h2>key var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/mob/var/key>key var (mob)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The player's key identity.
</dl>

<p>This is a read-only value that contains the player's key.  Once the
player is attached to a mob M, M.key == M.client.key.

<hr>

<a name=/client/var/lazy_eye>
<h2>lazy_eye var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/world/var/view>view var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This is the maximum "lag" between client.eye and client.mob.  The mob can
stray up to this many tiles before the eye will move to keep it in view.  The
default value of 0 means that the eye always moves as the mob moves, keeping
the mob at the center of the player's map.

<p>Setting this value to a non-zero value automatically initializes client.eye
to client.mob.loc (or to the center of the full map if that is possible).
Thereafter, client.eye will stray from the mob as it moves about the map,
making one big jump to catch up whenever the mob gets out of range.

<h3>Example:</h3>
<xmp>
client
  lazy_eye = 5
</xmp>

<p>This setting allows client.mob to move onto the entire 11x11 visible
region without changing the value of client.eye.  The moment it steps out of
this region, the entire region will shift 5 tiles in the direction of motion.

<p>You can assign lazy_eye to any value valid as a view size, so, for example,
if you have a non-square setting for client.view, say, "17x11", you could
apply a similar setting to lazy_eye.  You can even make one dimension lazy and
the other one strictly centered: "0x5".

<hr>

<a name=/client/var/mob>
<h2>mob var (client)</h2>

<dl><dt><b>Default value:</b>
<dd>Determined in client.New(), by default world.mob.
</dl>

<p>This is the mob to which the client is connected.  The client and its
connected mob have the following symmetry:

<xmp>
client == mob.client
client.mob == mob
client.key == mob.key
</xmp>

<hr>

<a name=/client/var/mouse_pointer_icon>
<h2>mouse_pointer_icon var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer var (atom)</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var (atom)</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer var (atom)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is an icon file (.dmi) containing custom mouse cursors to use in place
of the standard ones.  The different possible mouse states are distinguished
by special icon state names:

<dl>
<dt>""
<dd>Activated when over empty space or an object with mouse_over_pointer = MOUSE_INACTIVE_POINTER.
<dt>"over"
<dd>Activated when over an object with mouse_over_pointer = MOUSE_ACTIVE_POINTER.
<dt>"drag"
<dd>Activated when dragging an object with mouse_drag_pointer = MOUSE_ACTIVE_POINTER.
<dt>"drop"
<dd>Activated when dragging an object over with mouse_drop_pointer = MOUSE_ACTIVE_POINTER and the object underneath has mouse_drop_zone set.
<dt>"all"
<dd>Always activated, no matter what the state of the mouse.
</dl>

<hr>

<a name=/client/var/perspective>
<h2>perspective var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/eye>eye var (client)</a>
<dd><a href=#/client/var/mob>mob var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>MOB_PERSPECTIVE
</dl>

<dl><dt><b>Possible values:</b>
<dd><ul>
<li>MOB_PERSPECTIVE
<li>EYE_PERSPECTIVE
<li>EDGE_PERSPECTIVE
</ul>
</dl>

<p>This controls the eye's apparent center and what can be seen by the client.

<p>EYE_PERSPECTIVE determines how visibility calculations are performed when
<code>client.eye</code> and <code>client.mob</code> are different.  Normally,
visibility is done from the position of the mob, rather than from the eye
(which is actually just the center of the map view). The alternative flag is
MOB_PERSPECTIVE, the default.

<p>EDGE_PERSPECTIVE limits scrolling to the bounds of the map (1,1 to
world.maxx,world.maxy), and does not keep the mob centered if it strays near
the edge.

<p>The above values can be used together via the | operator.

<hr>

<a name=/client/var/pixel_x>
<h2>pixel_x var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/glide_size>glide_size var (client)</a>
<dd><a href=#/client/var/pixel_y>pixel_y var (client)</a>
<dd><a href=#/client/var/pixel_w>pixel_w var (client)</a>
<dd><a href=#/client/var/pixel_z>pixel_z var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the player's viewpoint on the x-axis by the specified number of
pixels.  Can be animated with the animate() proc.

<hr>

<a name=/client/var/pixel_y>
<h2>pixel_y var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/glide_size>glide_size var (client)</a>
<dd><a href=#/client/var/pixel_x>pixel_x var (client)</a>
<dd><a href=#/client/var/pixel_w>pixel_w var (client)</a>
<dd><a href=#/client/var/pixel_z>pixel_z var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the player's viewpoint on the y-axis by the specified number of
pixels.  Can be animated with the animate() proc.

<hr>

<a name=/client/var/pixel_w>
<h2>pixel_w var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/glide_size>glide_size var (client)</a>
<dd><a href=#/client/var/pixel_x>pixel_x var (client)</a>
<dd><a href=#/client/var/pixel_y>pixel_y var (client)</a>
<dd><a href=#/client/var/pixel_z>pixel_z var (client)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the player's viewpoint horizontally by the specified number
of pixels. This value is meant to be used when world.map_format is not set to
a default top-down view.  Can be animated with the animate() proc.

<hr>

<a name=/client/var/pixel_z>
<h2>pixel_z var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/glide_size>glide_size var (client)</a>
<dd><a href=#/client/var/pixel_x>pixel_x var (client)</a>
<dd><a href=#/client/var/pixel_y>pixel_y var (client)</a>
<dd><a href=#/client/var/pixel_w>pixel_w var (client)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This displaces the player's viewpoint vertically by the specified number of
pixels. This value is meant to be used when world.map_format is not set to a
default top-down view.  Can be animated with the animate() proc.

<hr>

<a name=/client/var/pixel_step_size>
<h2>pixel_step_size var (client)</h2>

<p>Renamed to <a href=#/atom/movable/var/glide_size>glide_size</a>.

<hr>

<a name=/client/var/preload_rsc>
<h2>preload_rsc var (client)</h2>

<dl><dt><b>Default value:</b>
<dd>1.
</dl>

<p>This variable controls whether resource files (icons and sounds) are
automatically downloaded by Dream Seeker when first connecting, or whether
they should be downloaded as needed.  Resource files are cached (in
byond.rsc) for future use, so this should only affect people who have not
played the game before or who have not played it for some time.

<p>The three possible settings are:
<dl compact>
<dt>0<dd>do not preload any resources
<dt>1<dd>preload compiled-in resources only
<dt>2<dd>preload all resources including those uploaded by players
<dt>URL<dd>preload resources from specified file
</dl>

<p>Preloading resource files will eliminate delays later on, but may cause
a very long initial delay when logging in.

<p>Resources may also be distributed from a website to save bandwidth on the
machine hosting the game.  Simply zip up the .rsc file, upload it to a web
site, and put the URL here.

<h3>Example:</h3>
<xmp>
client/preload_rsc = "http://dan.byond.com/mygame_rsc.zip"
</xmp>

<p>Instead of putting the .rsc file in the .zip, you can also put the
individual resource files there.  This would allow you to select specific
files that you would like to be preloaded.  For example, you could create a
different resource package for different parts of the game world and assign
client.preload_rsc dynamically as the player moves into each different area.

<p>Once Dream Seeker has downloaded a resource package, it caches it and will
not download it again, even if you upload a new version of the file.  This
allows you to make small changes without forcing a complete refresh.  Any
files which are not found in the preload package are simply downloaded from
the game server directly.

<p>If you want to force a complete refresh, simply change the name of the
resource package.  For example, you could put a version number in the name of
the file: <tt>mygame_rsc_01.zip</tt>, <tt>mygame_rsc_02.zip</tt>, and so on.

<hr>

<a name=/client/var/screen>
<h2>screen var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/HUD>HUD / screen objects</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
</dl>

<p>This is a list of objects that are displayed on the user's screen.  The
object's screen_loc variable controls where it appears (if it appears at all).
This allows one to create the elements of a graphical user interface, with
such features as buttons, drag/drop areas, and stat monitors.

<p>Screen objects (visible or otherwise) may also be used to make verbs
available to users.  To make them accessible, define verbs on the screen
object like this:

<xmp>
set src in usr.client.screen
</xmp>

<hr>

<a name=/client/var/script>
<h2>script var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/include>#include directive</a>
<dd><a href=#/client/var/script/PASSWORD_TRIGGER>PASSWORD_TRIGGER (client script)</a>
<dd><a href=#/client/var/script/URL>URL (client script)</a>
<dd><a href=#/client/var/script/alias>aliases (client script)</a>
<dd><a href=#/client/var/script/URL/browser>browser configuration</a>
<dd><a href=#/client/var/command_text>command_text (client)</a>
<dd><a href=#/client/var/script/macro>macros (client script)</a>
<dd><a href=#/{skin}/macros>macros (skin)</a>
<dd><a href=#/DM/text/style>style sheets</a>
<dd><a href=#/client/var/script/style>style sheets (in scripts)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>none
</dl>

<p>Client scripts are mini-programs used to configure the client.  The
language they use is called DM Script, and will undoubtedly expand in the
future.  Currently, client scripts can be used to define style sheets,
command aliases, and macros.  When executed directly by a player, they can
also be used to specify an initial URL to open and a password trigger (for
some ancient telnet worlds that don't suppress password echo).

<p>For the specific syntax of DM Script, see the relevant reference sections
listed above.

<p>The <code>client.script</code> variable may be assigned to script code in
a text string (double quotes) or in a file (single quotes).  You can also
simply include the file in your project or explicitly use the
<code>#include</code> statement.  Files containing DM Script should have the
extension <code>.dms</code>.

<p><h3>Example:</h3>
<xmp>
client/script = "<STYLE>BODY {font: monospace}</STYLE>"
</xmp>

<p>This example selects a default monospace font for all output to the
terminal.

<p>In addition to scripts loaded via <code>client.script</code>, the player
may have <em>client-side</em> scripts.  These are either called
<em>connection</em> scripts or <em>post-connection</em> scripts depending on
whether they are used to automatically connect to a world or whether they
are executed automatically after connecting to a world.  In either case, the
player's scripts are always executed before the designer's
<code>client.script</code> script, so style sheets from the designer have
higher precedence by default.

<p>There are three post-connection client-side scripts for the three types
of worlds the client can connect to: <code>byond.dms</code>,
<code>telnet.dms</code>, and <code>irc.dms</code>.  These are automatically
executed if the player connects directly to a world without using a
connection script to do so.  The intention is to load any standard
configurations such as style sheets and command aliases.

<hr>

<a name=/client/var/script/PASSWORD_TRIGGER>
<h2>PASSWORD_TRIGGER (client script)</h2>

<dl><dt><b>Format:</b>
<dd>#define PASSWORD_TRIGGER "assword:"
</dl>

<p>This defines a special text <em>trigger</em> used to detect when the user
is being prompted for a password in telnet mode.  Most MUDs automatically
suppress password echo, but if they do not, it is necessary to use this
setting to hide it.  Multiple triggers may be defined as necessary.

<p>The example above is more robust than the more polite version because it
works whether they capitalize the 'P' or not...

<hr>

<a name=/client/var/script/URL>
<h2>URL (client script)</h2>

<dl><dt><b>Format:</b>
<dd>#define URL "byond://byond.com:6000"
</dl>

<p>Defining a URL in a script, specifies the world to connect to when the
script is executed by the player.  This is referred to as a connection
script, because the player uses it to connect to a world.  Other
post-connection scripts such as <code>byond.dms</code> or a script loaded
through <code>client.script</code> are only used to configure the client
after it has connected to a world.  In those cases, the URL setting has no
effect.

<p>It is important to enclose the URL in double quotes.  Otherwise, the
<code>//</code> symbol would be mistaken for a comment.

<hr>

<a name=/client/var/script/URL/browser>
<h2>browser configuration</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/script/URL>URL (client script)</a>
</dl>

<p>DM Script can be used to effectively make a hyperlink in a web document
to a BYOND world.  This is done by making a DM Script file that defines the
desired URL.  It need do nothing more than that.  When a user clicks on the
link in a web browser, DreamSeeker will pop up, execute the script, and
connect to the specified URL.

<p>Some browsers may need to be configured to know what to do with a DM
Script file.  For example, in Netscape, you can add an entry to the list of
helper applications.  You should add a MIME type called
'<code>application/x-dms</code>' with the description 'DM Script' and the
extension <code>dms</code>.  Have this execute DreamSeeker with the
<code>.dms</code> file as an argument.

<h3>Example:</h3>

<h3>myworld.dms</h3>
<xmp>
/*If your browser shows you this, you either need
  to install BYOND (it's free!) from www.byond.com,
  or you need to configure your browser to execute
  DreamSeeker with DM Script (.dms) files.
*/
#define URL "byond://myworld"
</xmp>

<h3>myworld.html</h3>
<xmp>
<html>

<head><title>
Welcome to My World
</title></head>

<body>

<p>You can connect to my world
<a href=myworld.dms>here</a>.

</body>
</html>
</xmp>

<hr>

<a name=/client/var/script/alias>
<h2>aliases (client script)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/script/macro>macros (client script)</a>
<dd><a href=#/client/var/script>script var (client)</a>
<dd><a href=#/verb>verbs</a>
</dl>

<p>Command aliases have a syntax similar to verbs.  They define a command
and a series of arguments which can then be used to execute a new command.
The most common use for this is in a telnet world like a MUD.  By defining
aliases corresponding to the MUD commands, the player can have primitive
command expansion and help.

<p>The syntax of an alias definition is best illustrated by the following
example:

<xmp>
alias/say(msg as text)
   set desc = "speak your mind"
   return "say [msg]"
</xmp>

<p>As you can see, it is just like a verb.  Alias have all the same
properties as verbs, except the <code>src</code> setting is always equal to
the player.

<p>The value returned by an alias is executed as a command.  In telnet mode,
the command to execute is often simply the same as the command that was
entered (since the alias was only defined to provide command expansion and
help).  Since that is such a common case, the return value defaults to the
alias name followed by each of the arguments.  The example above, for
instance, would have the same effect without an explicit return statement.

<p>Note that commands executed via an alias are never interpreted as
aliases.  Otherwise, examples such as the one above would result in an
infinite loop.

<hr>

<a name=/client/var/script/macro>
<h2>macros (client script)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/macros>macros (skin)</a>
<dd><a href=#/client/var/script/alias>aliases (client script)</a>
<dd><a href=#/client/var/command_text>command_text (client)</a>
<dd><a href=#/client/var/script>script var (client)</a>
<dd><a href=#/verb>verbs</a>
</dl>

<p>Macros are just like aliases, except that they are triggered by a single
key (or combination of keys) instead of a full command.  When a macro is
executed, it returns a text string which is then executed as a command.  So
a macro is just a short-cut for entering a command.

<p>The following example illustrates the syntax for entering a typical set
of macros.

<h3>Example;</h3>
<xmp>
macro
   ALT+I return "inventory"
   ALT+SHIFT+I return "inventory\nequipment" //multiple commands
   ALT+s return "say \..."             //command to be edited
</xmp>

<p class=compatibility>Note: In old versions of BYOND, character keys required
the Alt key to be pressed to trigger the macro, and did not include
<tt>"ALT+"</tt> to do so. This behavior has changed, and the name of the macro
is just like the format used in skin files. You can now use a key name, and
modifiers like <tt>SHIFT+</tt>, <tt>CTRL+</tt>, <tt>ALT+</tt>, <tt>+REP</tt>,
and <tt>+UP</tt>. Old .dms and
<a class=code href=#/client/var/script>client.script</a> files (prior to
version 507) should be updated accordingly when recompiling in a newer
version.

<hr>

<a name=/client/var/script/style>
<h2>style sheets (in scripts)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/script>script var (client)</a>
<dd><a href=#/DM/text/style>style sheets</a>
</dl>

<p>Style sheets may be included in DM Script by putting the style sheet
inside the HTML tags <code>&lt;STYLE&gt;</code> and
<code>&lt;/STYLE&gt;</code>.  In general, any text enclosed in start
and end tags will be sent to the player's terminal, so you could use
<code>client.script</code> to output a welcome message as well as loading a
style sheet.

<p><h3>Example:</h3>
<xmp>
client/script = "<STYLE>BODY {background: black; color: aqua}</STYLE>"
</xmp>

<p>This example style sheet makes the player's terminal have a black
background and aqua colored text.  When changing the background color, it is
important to change the color of system and link text as well.  See the
section on <a href=#/DM/text/style>style sheets</a> for an example.

<hr>

<a name=/client/var/show_map>
<h2>show_map var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/show_verb_panel>show_verb_panel var (client)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/world/var/view>view var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<p>This variable may be used to turn off the view of the map in Dream Seeker.
This could be useful for making text MUDs where the rooms are turfs (ie most
rooms can be laid out on a grid but you don't want the user interface to show
the map in any way).

<p>The following example shows one useful combination of settings.  Note that
setting <code>world.view=-1</code> also disables the map, but it also sets
the default value of the <code>view()</code> depth in such a way as to always
return an empty list.

<h3>Example:</h3>
<xmp>
client
   show_map = 0 //Text is best!
world
   view = 0     //You can interact only with objects in same turf.
mob
   density = 0  //Allow multiple mobs in a room.
</xmp>

<hr>

<a name=/client/var/show_popup_menus>
<h2>show_popup_menus var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/right-click>right-click parameter (skin)</a>
<dd><a href=#/client/proc/Click>Click proc (client)</a>
<dd><a href=#/client/proc/DblClick>DblClick proc (client)</a>
<dd><a href=#/client/proc/MouseDown>MouseDown proc (client)</a>
<dd><a href=#/client/proc/MouseDrag>MouseDrag proc (client)</a>
<dd><a href=#/client/proc/MouseDrop>MouseDrop proc (client)</a>
<dd><a href=#/client/proc/MouseEntered>MouseEntered proc (client)</a>
<dd><a href=#/client/proc/MouseExited>MouseExited proc (client)</a>
<dd><a href=#/client/proc/MouseMove>MouseMove proc (client)</a>
<dd><a href=#/client/proc/MouseUp>MouseUp proc (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<p>This variable may be used to turn off the popup "context" menus that are displayed by default when
an object on the map or stat panels is right-clicked.  If client.show_popup_menus==0, then right-clicks
will instead be passed to the various mouse functions. 

<hr>

<a name=/client/var/show_verb_panel>
<h2>show_verb_panel var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/category>category setting (verb)</a>
<dd><a href=#/client/var/default_verb_category>default_verb_category var (client)</a>
<dd><a href=#/client/var/show_map>show_map var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<p>Setting this to 0 turns off the verb panel in Dream Seeker.  You might
want to do that, for instance, if you've only got one verb (like "say") and
the panel looks stupid with just one verb in it.

<h3>Example:</h3>
<xmp>
client
   show_verb_panel = 0
</xmp>

<hr>

<a name=/client/var/statobj>
<h2>statobj var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Stat>Stat proc (client)</a>
<dd><a href=#/proc/stat>stat proc</a>
<dd><a href=#/proc/statpanel>statpanel proc</a>
<dd><a href=#/client/var/statpanel>statpanel var (client)</a>
<dd><a href=#/{skin}/control/info>Info control (skin)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>client.mob (the player's mob).
</dl>

<p>This value indicates which object the player currently has loaded in the
stat panels.

<hr>

<a name=/client/var/statpanel>
<h2>statpanel var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Stat>Stat proc (client)</a>
<dd><a href=#/proc/stat>stat proc</a>
<dd><a href=#/client/var/statobj>statobj var (client)</a>
<dd><a href=#/proc/statpanel>statpanel proc</a>
<dd><a href=#/{skin}/control/info>Info control (skin)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This value indicates which stat panel is currently visible to the player.
You can assign it to force a different panel to become the top panel.  The
special value "verbs" activates the panel of commands.

<hr>

<a name=/client/var/tick_lag>
<h2 byondver=511>tick_lag var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
<dd><a href=#/client/var/fps>fps var (client)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (uses world.tick_lag value)
</dl>

<p>This is a client version of world.tick_lag, so that the client can run at
a faster speed for animations.  For example, setting client.tick_lag to 0.25
while world.tick_lag is the default 1 will mean that all animations and
glides are smoothed out and displayed at 40 FPS, even though the server still
runs at 10 FPS.  The result is a nicer-looking game with no additional impact
on the server.

<p>When this value is 0, the client and server tick at the same rate.

<hr>

<a name=/client/var/timezone>
<h2 byondver=514>timezone var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/realtime>realtime var (world)</a>
<dd><a href=#/world/var/timeofday>timeofday var (world)</a>
<dd><a href=#/world/var/timezone>timezone var (world)</a>
<dd><a href=#/proc/time2text>time2text proc</a>
</dl>

<p>This is the time offset from UTC, in hours, for the client's time zone. It
can be used in the <tt>time2text()</tt> proc.

<hr>

<a name=/client/var/verbs>
<h2>verbs list var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>The list of verbs defined for the client.
</dl>

<p>This is a list of the client's verbs.  Initially, it contains all of the
verbs defined for the client.  It may be used to add and remove verbs at
runtime.

<hr>

<a name=/client/var/view>
<h2>view var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/lazy_eye>lazy_eye var (client)</a>
<dd><a href=#/client/var/show_map>show_map var (client)</a>
<dd><a href=#/proc/view>view proc</a>
<dd><a href=#/world/var/view>view var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>world.view (which is 5 by default)
</dl>

<dl><dt><b>Possible values:</b>
<dd>-1 to 34 or "WIDTHxHEIGHT"
</dl>

<p>This controls the size of the map window in Dream Seeker.  Normally, you
would simply compile with world/view assigned to whatever you want, but in
some cases, you might want to customize the map size for different players,
such as admins or subscribed users.

<p>Like all other view sizes in DM, this may either be a <em>view depth</em>
or an absolute size.  A view depth is a single number that determines how far
from a center point the edges of a square viewable region extend.  A value of
5 creates edges which are 2*5+1 = 11 tiles long.

<p>The newer, more flexible syntax is a text string of the form
"WIDTHxHEIGHT".  For example, a view depth of 5 corresponds to "11x11".  Using
this syntax, you can create non-square views as well.

<p>The maximum view size is about 5000 tiles, or roughly 70x70.

<hr>

<a name=/client/var/virtual_eye>
<h2>virtual_eye var (client)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/edge_limit>edge_limit var (client)</a>
<dd><a href=#/client/var/eye>eye var (client)</a>
<dd><a href=#/client/var/lazy_eye>lazy_eye var (client)</a>
<dd><a href=#/client/var/mob>mob var (client)</a>
<dd><a href=#/client/var/perspective>perspective var (client)</a>
<dd><a href=#/client/var/view>view var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>client.eye
</dl>

<p>This value determines the actual center of the player's map display. It is
based on <code>client.eye</code> and whenever possible matches it; however it
may instead be a turf, or null, when the eye is off-center.

<p>The value of <code>virtual_eye</code> is read-only.

<hr>

<a name=/database>
<h2 byondver=506>database datum</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/proc>procs (database)</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>A /database datum gives you the ability to create or access a database
using SQLite, which allows you to run complex database queries on any
platform.

<p>Creating a /database/query datum will let you put together a query, and
once it's ready you can call its Execute() proc to run it.

<p>SQLite databases in BYOND support numerical values (such as INTEGER or
FLOAT), text (TEXT), and cache files such as icons (BLOB). Null values are
also allowed.

<h3>Example:</h3>
<xmp>
var/database/db = new("mydb.db")
var/database/query/q = new("SELECT * FROM my_table WHERE name=?", usr.key)

if(q.Execute(db) && q.NextRow())
    // returns a list such as list(name="MyName", score=123)
    return q.GetRowData()
// no data found
return null
</xmp>

<hr>

<a name=/database/proc>
<h2 byondver=506>procs (database)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc>procs (database query)</a>
</dl>

<p>Built-in database procs:

<dl><dt>database/proc
<dd><a href=#/database/proc/Close>Close</a>
<dd><a href=#/database/proc/Error>Error</a>
<dd><a href=#/database/proc/ErrorMsg>ErrorMsg</a>
<dd><a href=#/database/proc/New>New</a>
<dd><a href=#/database/proc/Open>Open</a>
</dl>

<hr>

<a name=/database/proc/Close>
<h2 byondver=506>Close proc (database)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/proc/Open>Open proc (database)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Close()
</dl>

<p>If a database is currently open, this will close the database and any
queries currently running in it. Usually you don't need to call this
directly, because deleting the datum will do it for you.

<hr>

<a name=/database/proc/Error>
<h2 byondver=506>Error proc (database)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/proc/ErrorMsg>ErrorMsg proc (database)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Error()
</dl>

<p>Returns the error code last received by the database.

<hr>

<a name=/database/proc/ErrorMsg>
<h2 byondver=506>ErrorMsg proc (database)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/proc/Error>Error proc (database)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ErrorMsg()
</dl>

<p>Returns the error message last received by the database.

<hr>

<a name=/database/proc/Open>
<h2 byondver=506>Open proc (database)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/proc/Close>Close proc (database)</a>
<dd><a href=#/database/proc/New>New proc (database)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Open(filename)
</dl>

<dl><dt><b>Args:</b>
<dd>filename: The database filename to open
</dl>

<p>Opens a database file. If another database was already open, it is
closed automatically. It is more common to simply open the database in New().

<hr>

<a name=/database/proc/New>
<h2 byondver=506>New proc (database)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/proc/Open>Open proc (database)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New(filename)
</dl>

<dl><dt><b>Args:</b>
<dd>filename: The database filename to open (optional)
</dl>

<p>Creates a new database datum, and opens the file if a filename is provided.

<hr>

<a name=/database/query>
<h2 byondver=506>database query datum</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query/proc>procs (database query)</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>This datum lets you create a query for a database, which can be run with
the Execute() proc. The datum can be reused after a query is run by calling
Clear() and adding new text with Add().

<hr>

<a name=/database/query/proc>
<h2 byondver=506>procs (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/proc>procs (database)</a>
</dl>

<p>Built-in database query procs:

<dl><dt>database/query/proc
<dd><a href=#/database/query/proc/Add>Add</a>
<dd><a href=#/database/query/proc/Clear>Clear</a>
<dd><a href=#/database/query/proc/Close>Close</a>
<dd><a href=#/database/query/proc/Columns>Columns</a>
<dd><a href=#/database/query/proc/Error>Error</a>
<dd><a href=#/database/query/proc/ErrorMsg>ErrorMsg</a>
<dd><a href=#/database/query/proc/Execute>Execute</a>
<dd><a href=#/database/query/proc/GetColumn>GetColumn</a>
<dd><a href=#/database/query/proc/GetRowData>GetRowData</a>
<dd><a href=#/database/query/proc/New>New</a>
<dd><a href=#/database/query/proc/NextRow>NextRow</a>
<dd><a href=#/database/query/proc/Reset>Reset</a>
<dd><a href=#/database/query/proc/RowsAffected>RowsAffected</a>
</dl>

<hr>

<a name=/database/query/proc/Add>
<h2 byondver=506>Add proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Clear>Clear proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Add(text, item1, item2, ...)
</dl>

<dl><dt><b>Args:</b>
<dd>text: Text to add to the query
<dd>item1, item2, etc.: Items that will replace question marks in text
</dl>

<p>Adds text to a database query. If this datum was already used to run a
query, Clear() will be called automatically.

<p>If your text includes question marks, they will be replaced with the other
items listed in the proc arguments. If that item is a string, quotes will be
put around it for the query text. Files in the cache (such as icons) will be
added as BLOB values.

<p>After the query has been built, call Execute() to run it.

<h3>Example:</h3>
<xmp>
var/database/db = new("mydb.db")
var/database/query/q = new
q.Add("INSERT INTO quests (name, quest, complete) VALUES (?,?,?)", usr.key, quest_name, 1)
q.Execute(db)
</xmp>

<p>In the example above, the query text might look like this:

<p><tt>INSERT INTO quests (name, quest, complete) VALUES ('Tom','Save the Dog',1)</tt>

<hr>

<a name=/database/query/proc/Clear>
<h2 byondver=506>Clear proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Add>Add proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Clear()
</dl>

<p>Clears the query text so you can begin creating a new query. This is
called automatically if you already called Execute() for the last query used
by this datum.

<hr>

<a name=/database/query/proc/Close>
<h2 byondver=506>Close proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Clear>Clear proc (database query)</a>
<dd><a href=#/database/query/proc/Reset>Reset proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Close()
</dl>

<p>Ends a query that is in progress. This is usually done automatically and
shouldn't be necessary to call in most cases.

<hr>

<a name=/database/query/proc/Columns>
<h2 byondver=506>Columns proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Execute>Execute proc (database query)</a>
<dd><a href=#/database/query/proc/GetColumn>GetColumn proc (database query)</a>
<dd><a href=#/database/query/proc/GetRowData>GetRowData proc (database query)</a>
<dd><a href=#/database/query/proc/NextRow>NextRow proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Columns()
<br/><i>or</i><br/>
Columns(column)
</dl>

<dl><dt><b>Args:</b>
<dd>column: The Nth column whose name should be read
</dl>

<p>Returns a list of column names for the current query, or the name of the
Nth column.

<p>You must call Execute() before calling Columns().

<hr>

<a name=/database/query/proc/Error>
<h2 byondver=506>Error proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/ErrorMsg>ErrorMsg proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Error()
</dl>

<p>Returns the error code last received for this query.

<hr>

<a name=/database/query/proc/ErrorMsg>
<h2 byondver=506>ErrorMsg proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Error>Error proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ErrorMsg()
</dl>

<p>Returns the error message last received for this query.

<hr>

<a name=/database/query/proc/Execute>
<h2 byondver=506>Execute proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Add>Add proc (database query)</a>
<dd><a href=#/database/query/proc/Close>Close proc (database query)</a>
<dd><a href=#/database/query/proc/GetColumn>GetColumn proc (database query)</a>
<dd><a href=#/database/query/proc/GetRowData>GetRowData proc (database query)</a>
<dd><a href=#/database/query/proc/NextRow>NextRow proc (database query)</a>
<dd><a href=#/database/query/proc/Reset>Reset proc (database query)</a>
<dd><a href=#/database/query/proc/RowsAffected>RowsAffected proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Execute(database)
</dl>

<dl><dt><b>Args:</b>
<dd>database: A /database datum with the database to be queried, or the name of the database file
</dl>

<p>Runs a database query. Once the query is run, if the query is supposed
to returns any rows you can call NextRow() until finished, and then GetColumn() or
GetRowData() to get the information from each row. For queries that cause changes,
RowsAffected() is also a useful call.

<p>The database argument is optional after the first time you use it.

<p>You can use a filename instead of a /database datum, as a shortcut; the datum
will be created for you.

<p>After a query is executed, calling Add() to create new query text will
clear out the old query text automatically.

<h3>Example:</h3>
<xmp>
var/database/db = new("mydb.db")
var/database/query/q = new("SELECT quest,complete FROM quests WHERE name=?", usr.key)

if(!q.Execute(db)) return null

var/list/completed_quests = new
while(q.NextRow())
    var/row = q.GetRowData()
    if(row["complete"]) completed_quests[row["quest"]] = 1
return completed_quests
</xmp>


<hr>

<a name=/database/query/proc/GetColumn>
<h2 byondver=506>GetColumn proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Columns>Columns proc (database query)</a>
<dd><a href=#/database/query/proc/Execute>Execute proc (database query)</a>
<dd><a href=#/database/query/proc/GetRowData>GetRowData proc (database query)</a>
<dd><a href=#/database/query/proc/NextRow>NextRow proc (database query)</a>
<dd><a href=#/database/query/proc/Reset>Reset proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetColumn(column)
</dl>

<dl><dt><b>Args:</b>
<dd>column: The column number whose value should be retrieved
</dl>

<p>Gets the value from the Nth column in this row of results. If you haven't
already called Execute() and NextRow(), you should do that first.

<p>To get the name of the column, not the value for this row, call
Columns(column) instead.

<p>The value returned depends on what type the database table thinks it is.
For instance if you defined a column as INTEGER or FLOAT, the value should
be a number. TEXT is still text, and null values are returned as null. If an
icon was saved into a BLOB field, the result is an icon file.

<hr>

<a name=/database/query/proc/GetRowData>
<h2 byondver=506>GetRowData proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Columns>Columns proc (database query)</a>
<dd><a href=#/database/query/proc/Execute>Execute proc (database query)</a>
<dd><a href=#/database/query/proc/GetColumn>GetColumn proc (database query)</a>
<dd><a href=#/database/query/proc/NextRow>NextRow proc (database query)</a>
<dd><a href=#/database/query/proc/Reset>Reset proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetRowData()
</dl>

<p>Returns a list with the current result row for this query. If you
haven't already called Execute() and NextRow(), you should do that
first.

<p>The list returned is an associative list with name=value pairs. A
typical result might look like this:

<p><tt>list("name" = "Tom", "quest" = "Save a Dog", complete = 1)</tt>

<p>The values returned depend on what type the database table thinks they
are. For instance if you defined a column as INTEGER or FLOAT, the value
should be a number. TEXT is still text, and null values are returned as null.
If an icon was saved into a BLOB field, the result is an icon file.

<hr>

<a name=/database/query/proc/New>
<h2 byondver=506>New proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Add>Add proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New(text, item1, item2, ...)
</dl>

<dl><dt><b>Args:</b>
<dd>text: Text to add to the query
<dd>item1, item2, etc.: Items that will replace question marks in text
</dl>

<p>Creates a new query and adds text by automatically calling Add(). See
the <a href=#/database/query/proc/Add>Add proc</a> for more information.

<p>Call Execute() to run the query.

<hr>

<a name=/database/query/proc/NextRow>
<h2 byondver=506>NextRow proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Execute>Execute proc (database query)</a>
<dd><a href=#/database/query/proc/GetColumn>GetColumn proc (database query)</a>
<dd><a href=#/database/query/proc/GetRowData>GetRowData proc (database query)</a>
<dd><a href=#/database/query/proc/Reset>Reset proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>NextRow()
</dl>

<p>If there are result rows in this query (Execute() must be called to run
the query first), NextRow() will retrieve the next row and return 1 if it
found a row, or 0 if the results are all finished. NextRow() is typically
called in a while() loop.

<p>After calling NextRow(), you can call GetColumn() or GetRowData() to get
information about the results in this row.

<p>Call Reset() if you want to rewind the query to the beginning.

<hr>

<a name=/database/query/proc/Reset>
<h2 byondver=506>Reset proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Execute>Execute proc (database query)</a>
<dd><a href=#/database/query/proc/NextRow>NextRow proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Reset()
</dl>

<p>If a query returns any rows of results, Reset() will go back to the
beginning just after Execute() was called. This is useful if you have
called NextRow() repeatedly to retrieve a number of rows, but need to
go back to the start of the query for some other reason. This can also be
used to count the total number of result rows if needed, but for best
performance that isn't recommended.

<hr>

<a name=/database/query/proc/RowsAffected>
<h2 byondver=506>RowsAffected proc (database query)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/database>database datum</a>
<dd><a href=#/database/query>database query datum</a>
<dd><a href=#/database/query/proc/Execute>Execute proc (database query)</a>
<dd><a href=#/database/query/proc/RowsAffected>RowsAffected proc (database query)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>RowsAffected()
</dl>

<p>After running Execute() on a query that changes rows in the database (for
instance, an UPDATE query), this proc returns the number of rows that were
changed. This can be useful if you need to know whether a query actually did
anything.

<hr>

<a name=/datum>
<h2>datum</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom>atom</a>
<dd><a href=#/datum/proc>procs (datum)</a>
<dd><a href=#/datum/var>vars (datum)</a>
</dl>

<p>The datum object is the ancestor of all other data types in DM, with
only a few exception called primitives. That means that the variables
and procedures of /datum are inherited by almost all other types of objects.

<p>When you define a new "top level" object, if you do not specify a
parent_type, it defaults to /datum.

<h3>Example:</h3>

<xmp>
datum
   //definitions to be shared by all object types
   proc/DebugMe()
      world.log << "/datum properties:"
      world.log << "type: [type]"
      world.log << "parent_type: [parent_type]"
      return ..()

MyType
   var
      myvar = "test"
   DebugMe()
      world.log << "/MyType properties:"
      world.log << "myvar: [myvar]"
      return ..() //this calls /datum/proc/DebugMe()
</xmp>

<h3>Primitives</h3>

<p>Primitive types do not descend from /datum. These have no subtypes, and may
or may not be able to allow var and proc overrides.

<table class="withborder">
<tr><th>Type</th><th>User-defined</th><th>Can override</th><th>Notes</th></tr>
<tr><td><a class=code href=#/world>/world</a></td><td>procs only</td><td>vars and procs</td><td></td></tr>
<tr><td><a class=code href=#/client>/client</a></td><td>vars and procs</td><td>vars and procs</td><td>can manually set <tt>parent_type=/datum</tt><br/>can't be created in <a class=code href=#/proc/new>new</a></td></tr>
<tr><td><a class=code href=#/list>/list</a></td><td>-</td><td>-</td><td></td></tr>
<tr><td><a class=code href=#/savefile>/savefile</a></td><td>-</td><td><a class=code href=#/savefile/var/byond_version>byond_version</a><br/><a class=code href=#/savefile/var/byond_build>byond_build</a></td><td></td></tr>
<tr><td><a class=code href=#/alist>/alist</a></td><td>-</td><td>-</td><td></td></tr>
<tr><td><a class=code href=#/pixloc>/pixloc</a></td><td>-</td><td>-</td><td></td></tr>
<tr><td><a class=code href=#/vector>/vector</a></td><td>-</td><td>-</td><td></td></tr>
<tr><td><a class=code href=#/pixloc>/callee</a></td><td>-</td><td>-</td><td>can't be created in <a class=code href=#/proc/new>new</a></td></tr>
</table>

<hr>

<a name=/datum/proc>
<h2>procs (datum)</h2>

<p>Built-in datum procs:

<dl><dt>datum/proc
<dd><a href=#/datum/proc/New>New</a>
<dd><a href=#/datum/proc/Del>Del</a>
<dd><a href=#/datum/proc/Write>Write</a>
<dd><a href=#/datum/proc/Read>Read</a>
<dd><a href=#/datum/proc/Topic>Topic</a>
</dl>

<hr>

<a name=/datum/proc/Del>
<h2>Del proc (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/del>del proc</a>
<dd><a href=#/DM/garbage>garbage collection</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Del()
</dl>

<dl><dt><b>When:</b>
<dd>Called when the object is destroyed, for example by using the
<code>del</code> instruction.
</dl>

<dl><dt><b>Default action:</b>
<dd>Delete the object.  The contents of atomic objects are also destroyed at
this time, as though <code>del</code> were called on each one of them.
</dl>

<p>When the world is destroyed, the <tt>Del()</tt> proc is not automatically
called. The only object for which it is called is <a href=#/world>/world</a>.
If you need the <tt>Del()</tt> proc for a particular object to be called at
that time, you should explicitly call it from <tt>world/Del()</tt>.

<p>Note: <b>Always</b> call <tt>..()</tt> at the end of the proc if you
override it.

<hr>

<a name=/datum/proc/New>
<h2>New proc (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/New>New proc (atom)</a>
<dd><a href=#/client/proc/New>New proc (client)</a>
<dd><a href=#/proc/new>new proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New()
</dl>

<dl><dt><b>When:</b>
<dd>Called when the datum is created, for example by using <code>new</code>,
when reading an object that was stored in a <a href=#/savefile>savefile</a>,
or when the world is initially created.
</dl>

<dl><dt><b>Default action:</b>
<dd>None.
</dl>

<p>You can use the New() procedure to do more complicated initializations
than are possible in the object definition where you assign the initial
value of variables to constants.

<p>The following example makes use of the "Location" parameter that is passed
to objects of type <a href=#/atom>/atom</a>.  You can pass any number of
additional arguments to New() by passing them to the <code>new</code>
instruction which creates the object.

<h3>Example:</h3>
<xmp>
mob/night
   var/mob/squire/my_squire
   New(Location)
      my_squire = new(Location)
      return ..()
</xmp>

<p>Also note that the type of object being created in this case was
automatically inferred from the variable type on the left-hand side of the
assignment.  That's a handy little DM short-cut.

<hr>

<a name=/datum/proc/Read>
<h2>Read proc (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3e%3e>&gt;&gt; operator (savefile)</a>
<dd><a href=#/datum/proc/Write>Write proc (datum)</a>
<dd><a href=#/var/tmp>tmp vars</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Read(savefile/F)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the object is read from a save file.
</dl>

<dl><dt><b>Args:</b>
<dd>F: the save file being read
</dl>

<dl><dt><b>Default action:</b>
<dd>Read the value of each variable from a directory by the same name as the
    variable.  Variables marked tmp, global, or const and variables for
    which there is no directory are skipped.
</dl>

<hr>

<a name=/datum/proc/Topic>
<h2>Topic proc (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/DM/text/macros/ref>ref text macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Topic(href,href_list[])
</dl>

<dl><dt><b>Args:</b>
<dd>href: the hyperlink data (following ? in the URL).
<dd>href_list: key/value list (from params2list(href)).
</dl>

<p>This procedure is called by the default <tt>client.Topic()</tt> proc when
the href contains a parameter called "src" containing an object reference.

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << "Click <a href='?src=\ref[src];action=startgame'>here</a>!"
mob/Topic(href,href_list[])
   switch(href_list["action"])
      if("startgame")
         usr << "Starting game..."
</xmp>

<p>The above example uses an embedded reference to the player's own mob to
create a hyperlink to that mob's <tt>Topic()</tt> proc.  You can easily add
different actions, parameters, and so forth.  Just remember that the parameter
values are always stored as text, so you need to convert those to whatever
data format you need using procedures such as <tt>text2num()</tt>,
<tt>locate()</tt>, etc.

<p class="note security">Always validate the input in <tt>Topic()</tt> calls
to make sure it's correct and the query you're recieving is legitimate.

<hr>

<a name=/datum/proc/Write>
<h2>Write proc (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3c%3c>&lt;&lt; operator (savefile)</a>
<dd><a href=#/datum/proc/Read>Read proc (datum)</a>
<dd><a href=#/proc/initial>initial proc</a>
<dd><a href=#/proc/issaved>issaved proc</a>
<dd><a href=#/var/tmp>tmp vars</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Write(savefile/F)
</dl>

<dl><dt><b>When:</b>
<dd>Called when the object is written to a save file.
</dl>

<dl><dt><b>Args:</b>
<dd>F: the save file being written to
</dl>

<dl><dt><b>Default action:</b>
<dd>Write the value of each variable to a directory by the same name as the
    variable.  Variables marked tmp, global, or const and variables which
    are equal to their initial value are skipped.
</dl>

<hr>

<a name=/datum/var>
<h2>vars (datum)</h2>

<p>Built-in datum vars:

<dl><dt>datum/var
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/parent_type>parent_type</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/datum/var/vars>vars</a>
</dl>

<hr>

<a name=/datum/var/parent_type>
<h2>parent_type var</h2>

<dl><dt><b>Default value:</b>
<dd>The path of the object definition that contains this one.
</dl>

<p>This variable is set at compile-time to specify the inheritance of an
object type.  Normally, a new type of object inherits its variables and
procedures from the object type that contains it.  For example:

<xmp>
obj
   var
      weight
      color
   sword //parent type of 'sword' defaults to /obj
      weight = 30
      color = "black"
</xmp>

<p>Explicitly setting the parent type allows you to put the object
definition any place you want.  That often means putting it at the top
"root" level.  Example:

<xmp>
Armor
   parent_type = /obj
   var
      strength
   plate //parent type is /Armor, which in turn inherits from /obj
      weight = 100
      color = "rusty"
      strength = 10
</xmp>

<p>If you don't specify the parent_type for an object defined at the top
level, it defaults to <a href=#/datum>/datum</a>, which (with just a couple
exceptions) is the ultimate ancestor of all object types.  You could use
that fact to define procedures or variables that you need all of your
objects to share.

<h3>Example:</h3>
<xmp>
datum
   proc/Copy(datum/O)

MyType
   var
      foo
   Copy(MyType/O)
      foo = O.foo
      return ..()
</xmp>

<hr>

<a name=/datum/var/tag>
<h2>tag var (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/locate>locate proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This may be assigned to a unique text string identifying a particular
object.  A reference to the object can then be obtained by using locate().

<p>One reason to use tags is when making references in the code to objects and
locations that will be created on the map.  You can simply edit the object in
the map editor, set its tag, and then use that in the code relating to the
object.

<p>The following example demonstrates how to set a tag and use it to obtain a
reference to an object.

<h3>Example:</h3>
<xmp>
mob/verb/test()
	var/obj/O = new()
	O.tag = "My Object"

	var/obj/O2 = locate("My Object")

	ASSERT(O == O2) //this should always be true
</xmp>

<p>Setting a tag to "" or null removes it.  Any object with a non-empty tag is
immune to garbage collection, since the tag is treated as an implicit
reference to that object.

<hr>

<a name=/datum/var/type>
<h2>type var (datum)</h2>

<dl><dt><b>Default value:</b>
<dd>The "type path" of the object definition.
</dl>

<p>This variable is read-only.

<xmp>
mob/verb/test()
   usr << type //displays "/mob"
</xmp>

<hr>

<a name=/datum/var/vars>
<h2>vars list var (datum)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/initial>initial proc</a>
<dd><a href=#/proc/issaved>issaved proc</a>
<dd><a href=#/list>list</a>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/DM/vars>vars list var (global)</a>
</dl>

<p>This is a list of all the variables belonging to an object.  The items in
the list are the variable names.  If the variable name is used as an index
into the list, the value of that variable is accessed.

<h3>Example:</h3>
<xmp>
mob/verb/dump()
   var/V
   for(V in vars)
      usr << "[V] = [vars[V]]"
</xmp>

<p>This example displays all the variables belonging to your mob.

<hr>

<a name=/exception>
<h2 byondver=508>exception</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/try>try and catch statements</a>
<dd><a href=#/world/proc/Error>Error proc (world)</a>
<dd><a href=#/proc/throw>throw statement</a>
<dd><a href=#/proc/EXCEPTION>EXCEPTION proc</a>
<dd><a href=#/proc/var/caller>caller var (proc)</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<dl><dt><b>Vars:</b>
<dd>name: A text string (such as an error message) or other value
<dd>file: The filename where the error occurred, if debugging info is present
<dd>line: The line where the error occurred, if debugging info is present
<dd>desc: Detailed error info including call stack, only used when sent to world.Error()
</dl>

<p>This datum is created automatically when a runtime error is encountered,
<b>if</b> it happens within a try/catch block or you have defined a global
error handler with <tt>world.Error()</tt>. (The New() proc is not called when
this happens.) This provides a convenient package for getting file and line
number info associated with an error.

<p>If you throw your own exceptions, you do not have to use this, but the
<tt>EXCEPTION</tt> macro is provided to easily create one with the current
file and line number.

<p>The <tt>desc</tt> value is only filled in when you have a world.Error()
handler and there is no try/catch handling this error. Just like when no
handler is present, less detail will be provided after multiple runtime errors
have occurred. This only exists as a convenience feature for logging errors if
you want to use something other than world.log.

<hr>

<a name=/icon>
<h2>icon object</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/DM/icon>icons</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>An <tt>/icon</tt> object is created by loading an icon file into memory for
direct access and manipulation.  In order to be displayed, an <tt>/icon</tt>
object always gets converted back into an icon file; this happens
automatically when you assign atom.icon to an <tt>/icon</tt> object, since
that variable may only refer to a static icon file, rather than a dynamic
memory object.

<p>To create an <tt>/icon</tt> object, simply use <tt>new/icon()</tt>, or the
short-cut <tt>icon()</tt> proc.  The following example loads an icon file,
reddens it, and then assigns it back to the player's icon, which implicitly
creates a new icon file.

<h3>Example:</h3>
<xmp>
mob/verb/test()
   var/icon/I = new('player.dmi')
   I.Blend(rgb(40,0,0))
   usr.icon = I
</xmp>

<p>Note that merely displaying different icon states or directions can
generally be achieved without any icon manipulation, which saves quite a bit
of overhead.  For example, the variables <tt>atom.icon_state</tt> and
<tt>atom.dir</tt> can be used to control how <tt>atom.icon</tt> is displayed,
without any need for generating a new icon file.

<p>Many things that used to require icon manipulation may not need you to do
so anymore, as DM has evolved new capabilities.

<table class=withborder>
<tr><th>Operation</th><th><tt>/icon</tt> proc</th><th>New method</th></tr>
<tr><td>Multiplying by color</td><td><a class=code href=#/icon/proc/Blend><tt>Blend</tt></a> or <a class=code href=#/icon/proc/SetIntensity>SetIntensity</a> procs</td><td><a class=code href=#/atom/var/color>color</a> var</td></tr>
<tr><td>Adding color</td><td><a class=code href=#/icon/proc/Blend>Blend</a> proc</td><td rowspan=2><a class=code href=#/atom/var/color>color</a> var (using <a href=#/{notes}/color-matrix>color matrix</a>)</td></tr>
<tr><td>Applying color matrix</td><td><a class=code href=#/icon/proc/MapColors>MapColors</a> proc</td></tr>
<tr><td>Rotation</td><td><a class=code href=#/icon/proc/Turn>Turn</a> proc</td><td rowspan=3><a class=code href=#/atom/var/transform>transform</a> var</td></tr>
<tr><td>Flipping horizontal/vertical</td><td><a class=code href=#/icon/proc/Flip>Flip</a> proc</td></tr>
<tr><td>Scaling</td><td><a class=code href=#/icon/proc/Scale>Scale</a> proc</td></tr>
<tr><td>Overlaying/underlaying another icon</td><td><a class=code href=#/icon/proc/Blend>Blend</a> proc + <tt>ICON_OVERLAY</tt></td><td>Overlay/underlay + <a class=code href=#/atom/var/appearance_flags>KEEP_TOGETHER</a><br/><a href=#/{notes}/filters/layer>Layering filter</a></td></tr>
</table>

<p class=performance>Note: Anything you can do with an atom var instead of
using icon manipulation procs will usually perform much better. Games that use
the new methods use fewer resources, use less memory, and also usually look
better too.

<hr>

<a name=/icon/proc>
<h2>procs (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
</dl>

<dl><dt>icon/proc
<dd><a href=#/icon/proc/New>New</a>
<dd><a href=#/icon/proc/IconStates>IconStates</a>
<dd><a href=#/icon/proc/Turn>Turn</a>
<dd><a href=#/icon/proc/Flip>Flip</a>
<dd><a href=#/icon/proc/Shift>Shift</a>
<dd><a href=#/icon/proc/SetIntensity>SetIntensity</a>
<dd><a href=#/icon/proc/Blend>Blend</a>
<dd><a href=#/icon/proc/SwapColor>SwapColor</a>
<dd><a href=#/icon/proc/DrawBox>DrawBox</a>
<dd><a href=#/icon/proc/Insert>Insert</a>
<dd><a href=#/icon/proc/MapColors>MapColors</a>
<dd><a href=#/icon/proc/Scale>Scale</a>
<dd><a href=#/icon/proc/Crop>Crop</a>
<dd><a href=#/icon/proc/GetPixel>GetPixel</a>
<dd><a href=#/icon/proc/Width>Width</a>
<dd><a href=#/icon/proc/Height>Height</a>
</dl>

<hr>

<a name=/icon/proc/Blend>
<h2>Blend proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/proc/rgb>rgb proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Blend(icon,function=ICON_ADD,x=1,y=1)
</dl>

<dl><dt><b>Args:</b>
<dd>icon: an icon file, /icon object, or color
<dd>function: the blending operation to use
<dd>x, y: the position to blend the icon
</dl>

<div class="sidebar embed-image image-only">
<img src="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAQQAAADeCAIAAABUuOmgAAAYv0lEQVR4XuyXSyisYRjHdUysXGrkGqGhCIlS7jVRiLIkC5dIDaFmyGUxMyiFBVk4sxi3yC2JjbJjoUhYjCJsJLnkWkiDc37HW9PXfB0L2c33rP79n2/e55n6P+//ed3+fIYS4+PjZ2dncn55edlisVit1uPjYwcZERHx7ULZ2dnn5+cCHx4e7u7u3t7e/v6MpaWlp6cn+B+Pr9ve2tri3ykacAMosbe3p1KpWltb5an09PTy8nKDwRATE9PR0SFId3f3b9cKDw8/PT0FfHx8ZGVlgW02m7e3t8lkopCXl9fJycmPC+Drto+OjrRarSKDX26Ey8fIyEh3d/fo6CgClWerq6v7+voWFxcHBwfl2ff3d65zOfny8iJlOPnu7k7KzMzM4BKhoaHgoKAgo9E4NjZWUVExMTHxRasI4PHxUeDX11e73e5U5fr6mm+k5NvbGz+Rd/j8/CywRqNJTEycn593cRkow/BPUuiyrq4uKSlpZWVFLj4CsL6+npeX55RluQoODoavqqp6eHiASUhIMJvN+ElUVFR/f78oMTs7y91fUFCQk5PjGJLJyUmsQFoLdW5vbzMhYHngS5WVlWTZdnQ63dDQUGZmJjqenp4WVQYGBjCWoqIiarHdCbK3txeSutJazFtISEh+fj4HirYdQ+jSoZjj3NxcaWkpgKuxuLjYKZuWlhYWFqZWq1HP1dWVdN84ODjw8/Pj0gXr9fqpqSlAfHx8fX094ObmxtfXF4u4uLjw9PQUS/nGxgYCEGsSOiYL2N/f58DY2FhWtebm5v/12d7enpKSwjWPEfFlbW0tJMOTnJwsTg4MDLy8vATv7Ox4eHjc39+T9ff3F16B7VBFPFRomxkAt7S0MJMATCY6Olp5M7h65ObmdnZ2rq2tra6uIjIU7zQMvGuRMmLy8fFBQ45hGB4eRkCNjY1NTU2FhYVlZWWQOMPm5iaAiIuLYx1fWFjIyMhwlAsICGAYMAHGRjC8GSIjI5kZBF1SUtLQ0AApj7a2tq6uLoFTU1PpFsCaRM9sRzw5pD+kNFbW09NTU1MjGBxJtM1LHdeibQIbERcBAcmkubISVH/ZM3+WhMIwinstQcUCB+kP1FCNlTjctCLSaAlKQVydpDkcA6G+Qm4NRUFQLQ6tuolDObTUVpOR0RCUUkT058d94MHUb3B9Bnl9fF/vGc6955znOuxdTJAqlYrf74eRhmHgOnAv2Wy2dQ+/TlqFISmVSslkUm03jp+vEICzbBOlxZbIBq/XC1ndbje+RY80Gg0WNFtDBYQesgrTFQwGu4YT4Pl8Plm7XC7WclAIgNmj+c8BO50ej0fBcF3NFZ2wKaAiHb3MYN/C9GcymXOrSA77VtFHASCHUFB2crdUq9VYLKZnEQ1EgGcwPh5BgMo09YgWg5pyuVyv11lj5dEEWCjMbjabbekF/UmlUqzxToyVumLWq+hCrgJ+prSsGdfWajUgkR8KhQJGToYEEn7IM8BGl4DNp8BGDwOBQC9A2zovQf10Oq0dIikEhfQ0ebcgexKJBIzBVNDR5ygVCoWwLjh17hBsEm8P9G91j4hAPp+PRqN4m2KxSAIR+obDYQb8sgcbhiagS5glDA8dhkuQuBOwqkTbVYjIOCKmUpFIhGRMgEYTcF80wUnYQCg4JRE/l8uhQsCOx+MCGySmaTpsXn/s2DEKwjAUgGEHzyROvV02DyKuOVFwzSSKWNH4oCBCEEVQl++bC31Df16a1mE6Ycdxor1hHMf4atsr0w1se1BKGYbh2Vvi8/1g7NhmtdZ+wtg5/ZMx9n22SCiWiR/ovyGllHNundhOceb55X1a3AK3LxADiAHEAGIAMYAYQAwgBhADiAHEAGIA5jd27mDHQRiGoigezX8jvvzN0iNFbRBLc+4y8uvuyqYOHDcAqtb7zscwNjIAVd/Ok7e+3AMmrAVkABO6zJhk5mVCFydzZZjf5qtYgc2YpM2j6kFkjAzaPHQGJnQEZGBCB0EGJnyOgwwAGYDkQWSADGYkkxJc1MO1iH+mm0PVO9qCMYkGV23Ok/kmkIEJdwuS+SaQgQn3fViU6PPhzwxgQhf3I0TsGeb+I7j/EdgzQFvYR8gAzJfBpNRxkIEPHQQZ3K0BGeb6wASQYfWBCWeeRKZg6Zbc/FQMUEmOF2LboC3YM+AMEz7JAD4wwUU9PlxFg3/8sXfHNBCEQBiFr1gpZ4IEBVAgAzTghFFDyPToQAEd3OW6axCw+75qDLxM+W8ALPcAxPAHIAaAGABiaK2p6j6CqpZSRKT3Tgz3tNZ6/+wjpJS89zlnY0wIgRhuqNbqnLPWnp8DYowi8j3mnNd1jTH2M3zYNUMUCEAgii4bbCZhmsUqeAzPIaY9gNcxa/AaFhEMggfRsHFX2O4Bdnzph19+mRn4g6iB9t4bY6y1W5ydl9/HWq1VCAEAaGLjYM7JGNujbgtK6VrrYL5nEgBwzgkhvfd/i3c3Q4xRKVVKaa1JKVNKB/PFOZdzDiForccYWGJ/2bFDGwaBOA6j9RgcLMAGJ5igpr4r1JMm4NmBhE6FQSCZg4QrOVXTDkDfW+HyXfL7x/8QQjhG4T05Hriu6/idzTCOY0yOKvq+N6DPY57noij2fY/Jtm15ni/LEn8yoNd1rapqmiYxnEX63tq2jR+apum6Ln4hhizLyrIMIQzD4LR6MiAGEAOIAcQAYgAxgBhADCAGEAOIAcQAYgAxgBhADCAGEAOIAcQAYgAxgBhADCAGEAOIAcQAYgAxgBhADMCbXTvYQRAGoig6r+G/0S9/boy1Epo26SCLe5fDruGEEdkiKUXN0YukOrDjPNLXWXn1WW1xQRpWQdK4CmCsVVEiIw3PSRqck6T+PB9DvhPK8YCTeQx4wAMe3hjwgAc8VAx4wAMeShBRIgbHaGTHWGT7CgxsSmxKbErb4rv5Q9fNVXpIvxO7Phy+rtLzIH+3Pw8HpZ2VbC9gcEZCLFQHBmckJBaqHwZnJCRlLFSF7y/uQsUOGqNiO+s3Q7aHlkR3joeWRGeOhwOJOv/LmsQWNL8m9fcl7vWB9ns9GRw1WnSX0/7Xsyo3ennKsjQcy1IiBiIq/M3MpsSm1GDAAx7wUPgMCQ94aDDgAQ94KLEkT8zxMD7Hw5VOtliVJ16n4mH2dSoenlJk92Ln3k0YhqEwCmcZzeARNI5qg3uXbjWBKmNcuPAD9yo0gkALeAMjbroUSgwJBJLifOWvTnDaK98GcFEPIAaAGABiAIgBIAaAGABiAIhh27YQgrxyHEdVVcWYc1ZKPYbiyTknT7z3+77L21JKWmv5Y+d5zvPctu00TXJhHMe6ruXHfv9R1toYY7EPwxBCkAtN0/R9X4xd1y3LIheMMeu6yifu3J1pSJZZFMcbl3BrwQUMxUIbDa2ItnEvbBnXJdDApXWhDRsFMSZGo7CmDxqugftWo8U0jYU2C2h7Y9FCIWgNjloh6CiuS43jzA8OPLw8T9bL9OV9536Q0+Hce5977jn/8z8P8bzqDwK8e/cuISHh0KFDyNoxPT3d1dWl1ROs77VvbGxsbm7W6vfv379jxw5SBVmfgQdfvXplyF96W7p06fXr1y0sLMrLy2cyGxkZAU20+n379v23fScmJpKTkxGMaLx9+/bgwYOAgq6yu7s7NjYWsJhpFn4bHR1FePr0aVFRkSjXrFnj7u4+05S+vr6xsbFP+jrG1atXQ0JChoaGXrx4oToDT8Otq2J0eHj4A6ufO3dOm1ecx9raeuXKlaS1yp6nZwvVfY+Pjxv4BTc1Ndnb2+fk5BCaly9f/qi93KsyKioqtH4QAbzAA6rpg4ODgiN45sKFCwjGNfDVgwcPdNEtNzfX29tbn+/kPX/+/MmTJ6Lx8/NbtGjRBxxLLH1SMpSUlOzcuXPPnj1lZWWKMi0tjQOsW7cuNTVV2eDMmTNz587duHHjrl275EFVo7Ozc2BgYMWKFSo9K+/evZtd2Es0PT09zs7Ohw8f3rx5M4zr9u3bUoWAEEdHRx8fn5MnTxry7fLMz549a2trUzRQpi1btoh88+ZNZKU4gDU4jUPdunWLOkxJIbL5W1VVde/evfXr12O8YcMGjHHs6tWr165dq8A/9NLNzY3prq6ujx8/9vf3x8PMra+vN6JvP5LeR44cAShFA55euXIlPDxcDDIyMrKzs0U+ffr02bNnlbkADaF4/vz5ZcuW9ff3U1EFC5gLQV2+fDkZtX37dt3yyy5EmshwM25K3/+o9/r1aycnJ6IQwc7ODuBHSfVfsmQJtQKZBCA6EchsBCoRMsFtZmamZWDHjh2rqalRKScnJ1kZbKPUzJ8/v7e3F+WbN284kjA8eoxt27aJQBxIOTp69Kinp6chU+GLFy/OmzcPjoQsTouOjhb5xo0bInOLOApERCZbuDkxMDU1FeHu3bvI+Fb0Dx8+5C5IFQcHByn6uI7VpBmbmpri1gEp4+oZuFArKyvCacGCBVQ2NFlZWZmZmSQAjQEG6enpaMT41KlT6BEOHDhQWVmJUF1dDceWpfbu3YtLEUJDQ4ODg4ko3AXO5ufno4yPj6cPIdIIM9IPzfHjx0ktfXsGwIn+GGAmh/AyNyoxGhMTQxFAjouLE0ua7KioKGwUpZbl0/EwUUvDQDWYEiAH7HEY0c+ZMwfAQwgMDLxz547su3XrVggVMm2MgQMej0rsUu65qg/8KCVlgRqIsGnTptbWVnBdhZouLi5QYVHgcwAlIiKC0MH40aNHUp+xNDExIW1kF2McHI2wIbJJ6cLCQigAZxFHzeQ9lDMxH+wpCLNnz0ZgWeqkWKIHocLCwohkASPM9KJJWEtrwsNRXAD+0tJS9DSFNjY2SkUTwdLSkvAVmavSrkszFBkZyVyVvri4mOdjfQYry47y0PyVlXGQCOyr2sLAyVJLS8ulS5fgh1wMQK4lshxTBCokBtoqrZBgSBeZExQUxBWCUDgHe6Dhf/OVbN725OXlgZhwY1tbW84uenGdwipVP+mp/FOVIUo0UkIpm7qWwBMM5f79+6tWraK06pUMFATyFVpGxWc0NDTQ4EJjiGkuWAqN0uoBV1jyrMhwg/e2zpQ2lRL2RUFgZdavq6u7du0aywKo2uMx2BczWDW1T/Y12PHy5UtJV1yED/E4RY/EIOLRcFLlOnGaAEptba2XlxdBgGxubq7q/BhQJt4mU0BwETJzuUulfcQtDPCCifjHGL8XTw2E+tM8pKSk6Br4+voKFYT2EHiqyoB76Ra0a0KqZQpdBJRJ9zuTAQEBIEtBQQEBqW8DDfWnY1MMACFKPykFLEFg6E64DMirGCxevJgmm+YYWs9dqhZtb2+HHNPqqfTQvsTERFJf0UD72Fc5qu4ZAEWcRcTw3glmZcgX3NHRAaLjDfwO5QWlGElJSfQ5ZIWQSTkjBvAcTnTixAl8K3os6R+EMSoDFko/jT1+xsnMxfkEBxqMuQsgkGSAGSMDK8b4gyO8j8E/Hh4euga8FcB7vBUgKxiqFCIqeFfB6wcYpu5qkAimLFy4kMAjwVQ1hB4a7s3LiY8c4F927R4ngSiK46iFa3EzNm7FltLGtVhQkNi6BJeCCajhw4/rP07D5FJQaIyTc1qohvy4efdNnSZjPceAGtt9qyatZ79RPyETM1PvX9wl5eepscy9/tCifzMzto7JwKmxzIEsUupARk1NRX8gpzyWnApyh5tROaxbumwjs276m9cxslrJwah+DfQYatD+j/JOQO7m0s/0302C7NyyaqtmOKRlr90+FQNMKQYQA4gBxABiADGAGEAMIAYQA4gBxABiADGAGEAMIAYQA4gBxABiADGAGEAMIAbg/ItdM1hxEAiC6HTjf8t8ee1hYRsS1qgzbYt5dQoDQvFqKoVgu0RmrydSQ7diBSuTdKFdYr4vK1h5keOIH92EFay8wDEZ35IVrExSjlnFQfss6XuDtbYzAliFgts8VssFhVW4R6zhxHtl0YoZ8hzH+sc91yNYHQ0SVtutGGflF//PiU1AKfdqAli/Pl2R7oBgldcHL0lXpDsgWCX1wavSFemilHtlA2VACCWWYXc7+dZAsDqiVFZeuPti91HKvToJfJl9ny1+NDELf+pvNNZmf+FZGStmIeQDNdCncyPd3xr0pu1zpbCiCfll6LZ/Mezbm2B7F0OwspImhDzNcfThrRJxTrovfXipRJzDKl9LpmNFDTazJN3eFK8QsCqSn3SfMGYIVr2pkJUn13evLUa/w6pa3hBCg2Xo7P6AYJW1kFLNMvQCxzSBPmSx8lHfN0mXJtAHqf6doZenSxPog3TpO8OqE32w70x31fFHYHWkDxmslmk9jlDne2UN2Ie1WTYrk5T0Acn6xFgfzApWPjBqpPsoVrDyAd+k+yhWsDJJA9NGtA9iBasf9u7QCGAQCoJoeqEEWqMFKIIZBBV8BO38FhgkYC42kkFEJPd6WL14FRHPPUSMgYgxEDEGIsYw5yylhBBijKqKX1LVlJL3XkTWWjjSe7fW4ltaayKCh5zzGAMbjDHY4JyrteLUTc6Zh1SZhWF8JrXQ/hD3rQXEBXdrFHEL1FBUNFxCxTDcl8Il0EAt3GYKFANRo4ERx70QZ5BBNDBcCFwR3EIFd8MtGm2BGbWZHxz4uNxrQwwjce+cP+I97znfte857/s+z3vk+p99uWd9fZ3za2lp0dPT29nZuXLlCq+K/3816urq3N3dV1dXjYyMOjo6XFxcXr9+/S8A+PTp0/LysoqBAxQlJSWynoyMjPfv33/Js1+IBoH34cOHr/9Nt7S0tOjo6KdPn6akpOTn54+MjGRlZa2srEgb4A3OWIUzYX5+/s6dO+Pj40VFRYmJiQ0NDVFRUdnZ2f/wyLt37xSdivEBwzBUACIIQOEv6H0rGyEHBweyq0wVITo6Ovr48aOck2cPDw8V4f0KybC1tfXixYu8vDzJY2pqevPmzfb2dmxra+uHDx/a2NiwR4WTob6+/tatW+fOnZM85AbCYH9/X0dHZ3d3VzivXr3a39+/t7cXFBTk7e3t6ekJneIfHBz08/O7du2av7+/FDQYbPPy8nJyckJ6icc7OzvF6qNHj+7evass+BD3jGPT4/Tp0w8ePOD1zc3Nnz17JpbKy8u1tbVxEkjS/sbGRjMzs8DAwPj4eMQknkuXLqHMbW1tu7u7Jdyam5sdHR0DAgLc3NwIzufPn4OzVGv09fVJp5P6pdvLly8vX74s56yurk5OTsawtLS8ffs2CY2twuP69eucgZzz4sWLMzMzJEltbS3TjY0NzhsDQOBPDGidPXDmwMCAmpra2NgYzjdv3qA2BQCjo6NiG5EBPxArkZGRYsnBwWFhYUFZ8JmennZ2dpb1nD17lhqBoaGhQbRg8PqiWYJgDQ0Nt7e3sRGfIIMxNzcHLBQX7NzcXBIDg89MSkoS0RUXF4c2wZidnQUxjMzMzCdPnrBqYmKCfMXDU+np6SfYM2hpaSmSOxXRwMBA2ATKqVOwkCoPTU1NRRDevn3L+VHGmpqamLa2tnISGPR5aMicnJyCggJIf2JiAid5QijIiQd1dXUYJjw8HIR5BOogbbCJLQjHwsJCiZhBTskQo0S54IfY2FgMSurU1BSlgVrOm4r4iYmJEYD09fUB5v379xGfr1696urqEhBRHaToEjthD4ga3c6NDtiympqa2tbWJggcJY9xUszA2ZDcIvOk4ePjQxOJYWVltbi4iKHao7KykpyX9cAJMLKwUYngg9qBtZmiprhzQy8xOGOoAJmEBGJJlhl6e3uJD6IfWXXhwgXBA+QG5Y3SSGopET6QAEGJjhdTElvUe8EM5IlEF9goQCqF8MAPYmdNTY2vry9wCdAmJydxAik4i50IKsEMdnZ2jx8/5kdAyHSzeAAf4SSueU72NokXoMJBUhRCSc5ik9ySLlT5Qe0haik8Yrq5uQkgFRUVYkpLXVxcTCGH/ZlSKWi46Rm4duPqSVdX91iUyJCIiAi2LS0tcZzCiSogGeCWsLAwJcKH9KYsEqO0xeg9akFwcPDnGuvQ0FDaLdEBc1UtnB4eHsPDw8Q0oPEvuMmxqJhSONbW1ij/VBy6VrHh/Pnz7L937x7+E/+mGz/mzJkz9DEcLTWA/zdVDXqSmEvlB1pxaGgoISEBHkffcyRlZWXkg1i9ceMG3E2TJ6bcKISEhKCLuGmwt7dH1x4LAAqBiO/p6UHyslk4IRkkKH02gCsXRPRUSJrS0lJs7p2FdDx2gAw5Tz9ACsG3wsm0sLDQ2NiY6II9qqqqqCwkkpzMAXzQ5vPxuLq64pGqFXjy1GcB+LtdM7aBEIah6K2SDW6JbHHV9bSMxBJZABagZQLuJEBIIJB5ogMk5IKG4DeC5fz/bUeuBovH5uTBIHu4ovIOpdkr0PqyhbZgRrzv9Y0xSXnGhWN5cQxNdN/Vlq0dUhXPdwyDPmCFjfKJGoMXRb5yzpE243kMRrKCuIoag/jqvQ8hyCkLeZhbPog5eksAAAAASUVORK5CYII=">
</div>

<p>The valid blending operations are:

<ul>
<li>ICON_ADD
<li>ICON_SUBTRACT
<li>ICON_MULTIPLY
<li>ICON_OVERLAY
<li>ICON_AND
<li>ICON_OR
<li>ICON_UNDERLAY
</ul>

<p>The result is a combination of each corresponding pixel in the two icons.
In all but ICON_OVERLAY, ICON_UNDERLAY, and ICON_OR, the transparent regions of
the two icons are ORed together.  That means if either icon is transparent on a
given pixel, the result will be transparent.  With ICON_OVERLAY or ICON_UNDERLAY,
on the other hand, the original icon shows through wherever the top icon is
transparent, giving the same effect as an overlay object, but resulting in only a
single icon. In ICON_OR, the transparent regions are ANDed together; solid pixels
are added together where they exist in both icons, or just pass through if the
other icon is transparent at that pixel.

<p>In addition to blending with an icon, an rgb() value may also be specified.
This is treated identically to an icon of that same solid color, except that the
x and y arguments will be ignored. Blending with a color blends the whole icon.

<p>By default, the icons will line up at their lower left corners. If you want
to position the second icon in a different place for blending, use the x and y
arguments to specify where its lower left corner will be. 1,1 is the default,
which is the lower left. 11,1 for instance would be 10 pixels to the right,
and 1,21 would be 20 pixels up.

<hr>

<a name=/icon/proc/Crop>
<h2>Crop proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/icon_size>map_format var (world)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Crop(x1,y1,x2,y2)
</dl>

<dl><dt><b>Args:</b>
<dd>x1,y1: Coordinates of one corner of the rectangle (1,1 is the lower left)
<dd>x2,y2: Coordinates of the other corner
</dl>

<p>A portion of the current icon is cropped (cut). If the crop region extends
outside the icon, it will be padded with transparent pixels.

<p>If using the TILED_ICON_MAP value for map_format, all icons must be even
multiples of world.tile_size, so the icon will be padded with transparent
pixels to the top and right as needed.

<h3>Example:</h3>
<xmp>
// start with a simple icon
var/icon/I = new('circle.dmi')
// take the upper right 16x16 chunk
I.Crop(17,17,32,32)
// that chunk now appears in the lower left corner
icon = I
</xmp>

<hr>

<a name=/icon/proc/DrawBox>
<h2>DrawBox proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/proc/rgb>rgb proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>DrawBox(rgb,x1,y1,x2=x1,y2=y1)
</dl>

<dl><dt><b>Args:</b>
<dd>rgb: <tt>rgb(red,green,blue)</tt> or <tt>null</tt>
<dd>x1,y1: Coordinates of one corner of the rectangle (1,1 is the lower left)
<dd>x2,y2: (optional) Coordinates of the other corner
</dl>

<p>A rectangle (filled) of the given color is drawn over every frame in the
icon. If x2 and/or y2 are omitted, a line or a single pixel is drawn. To draw
a transparent box instead of an opaque color, use null as the color.

<hr>

<a name=/icon/proc/Flip>
<h2>Flip proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon/proc/Turn>Turn proc (icon)</a>
<dd><a href=#/atom/var/dir>dir var (atom)</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Flip(dir)
</dl>

<dl><dt><b>Args:</b>
<dd>dir: direction in which to flip over the icon
</dl>

<p>This flips the icon over in the specified direction.  For example,
Flip(NORTH) would be like turning the icon upside down by grabbing the bottom
edge and flipping it up over the top edge.  You would get the same result by
doing Flip(SOUTH).  In general, this is not the same as turning the icon by
180 degrees, because it produces a mirror image.

<p>If an icon is square, it may be flipped diagonally.

<hr>

<a name=/icon/proc/GetPixel>
<h2>GetPixel proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/proc/rgb>rgb proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetPixel(x, y, icon_state, dir=0, frame=0, moving=-1)
</dl>

<dl><dt><b>Args:</b>
<dd>x,y: coordinates of the pixel to grab; 1,1 is the lower left corner
<dd>icon_state: a specific icon_state to use (may be null)
<dd>dir: a specific direction of this icon to use
<dd>frame: a specific animation frame to use (1 is the 1st frame)
<dd>moving: non-zero for only movement states, 0 for non-movement states,
  or null (default) for either
</dl>

<p>This finds the icon_state and the right animation/direction frame of your
choosing (it will pick the first one available if you don't specify) and
returns the rgb() value of a pixel at that location, in "#RRGGBB" form.
If the pixel is totally transparent, it returns null. If the pixel is
partially transparent, an alpha component is also returned in "#RRGGBBAA"
form.

<hr>

<a name=/icon/proc/Width>
<h2>Width proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/icon/proc/Height>Height proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Width()
</dl>

<p>This finds the width, in pixels, of the icon.

<hr>

<a name=/icon/proc/IconStates>
<h2>IconStates proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/proc/icon_states>icon_states proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>IconStates(mode=0)
</dl>

<dl><dt><b>Args:</b>
<dd>mode: see <a href=#/proc/icon_states>icon_states proc</a>
</dl>

<p>This returns a list of all icon state text strings that exist in the /icon
object. This works in exactly the same way as icon_states(icon).

<hr>

<a name=/icon/proc/Insert>
<h2>Insert proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/icon/proc/New>New proc</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Insert(new_icon,icon_state,dir,frame,moving,delay)
<dd><small>(supports <a href=#/proc/arguments/named>named arguments</a>)</small>
</dl>

<dl><dt><b>Args:</b>
<dd>new_icon: an icon file or /icon object to insert
<dd>icon_state: an optional text string, specifying a single icon state to
  change or add to this icon
<dd>dir: an optional direction; the inserted icon will only be added for this
  direction
<dd>frame: an optional animation frame (starting at 1); the inserted icon will
  only be added for this frame
<dd>moving: Non-zero to insert as a movement state, 0 for a regular non-movement
  state
<dd>delay: 0 or null to leave unchanged; positive to set delay for a frame and turn
  rewind off; negative to set delay and rewind
</dl>

<p>This adds additional states or images to an existing icon, allowing you to
build directional, animated, and multi-state icons on the fly. If the state
you wish to insert already exists in the file, it will be altered; otherwise
it will be added. An animation may be built a piece at a time, for example by
inserting an icon into the NORTH direction for animation frame 3.

<h3>Example:</h3>
<xmp>
// start with a non-animated arrow icon
var/icon/I = new('arrow.dmi')
// make a new state called "blink"
var/icon/J = new('arrow.dmi')
I.Insert(J, "blink", delay=-1)  // set rewind flag
// create darker shades of the arrow
var/n = 2
for(var/light=9, light>=5, light--)
   J = new('arrow.dmi')
   J.SetIntensity(light/10)
   I.Insert(J, "blink", frame=n++)
// congratulations, you have a pulsating arrow
icon = I
</xmp>

<p>The icon resulting from this example has two states: The original arrow,
and a new state called "blink" that pulsates between full and &frac12;
luminance. To use the blinking state after that, set the atom's icon_state to
"blink".

<p>(Note for animations: When building an animated icon_state from scratch,
you can only add 16 new animation frames at a time; i.e., frame&lt;=total_frames+16.
Higher values for frame will be ignored. This is a safety precaution.)

<p>If you insert an icon of a different size, the src icon will be resized to
match the size of new_icon. (The only exception is if you are using the TILED_ICON_MAP
map_format, and new_icon is a single tile being inserted as a chunk into a larger icon.
If icon_state, such as "2,0" or "open 0,0", already exists in src as one of its smaller
pieces, then new_icon will be inserted in its place.)

<p>When inserting an individual animation frame, you can change the delay for
just that frame only. If you don't specify a delay, the nearest frame's delay
will be used. If this is the first frame being inserted into an icon, then
the delay will default to 1 tick. Remember, if your delay is positive, it will
turn off the rewind flag for that entire icon state; negative will turn it on.

<hr>

<a name=/icon/proc/MapColors>
<h2>MapColors proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/proc/rgb>rgb proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>MapColors(rr, rg, rb, gr, gg, gb, br, bg, bb, r0=0, g0=0, b0=0)
  <br/><i>or</i><br/>
  MapColors(r_rgb, g_rgb, b_rgb, rgb0=rgb(0,0,0))
  <br/><i>or</i><br/>
  MapColors(rr, rg, rb, ra, gr, gg, gb, ga, br, bg, bb, ba, ar, ag, ab, aa, r0=0, g0=0, b0=0, a0=0)
  <br/><i>or</i><br/>
  MapColors(r_rgba, g_rgba, b_rgba, a_rgba, rgba0)
</dl>

<dl><dt><b>Args:</b>
<dd>rr: portion of old red component -&gt; new red component
<dd>rg: portion of old red component -&gt; new green component
<dd>rb: portion of old red component -&gt; new blue component
<dd>ra: portion of old red component -&gt; new alpha component
<dd>r0: new base red component
<dd>...
<dt><i>or</i>
<dd>r_rgb: red component is converted to this color
<dd>g_rgb: green component is converted to this color
<dd>b_rgb: blue component is converted to this color
<dd>rgb0: this color is added to the result
</dl>

<p>This is used for complex color mapping that can be used for many special
effects. For the number form, values usually range from 0 to 1, but you can
use anything you like, including negative numbers. 1 means 100% of the
original color will be used. If rg=1, for example, then the amount of red in
the original icon becomes the same amount of green in the new icon's colors.

<p>There is also an alternate form that can use <tt>rgb()</tt> values
instead, though it is less flexible. r_rgb is the color that will be used in
place of 100% red; any darker shades of red will become a darker shade of
that color. g_rgb converts green to another color, and b_rgb converts blue to
still another color, and all of them are added together.

<p>Either of these calls change the icon to grayscale:

<xmp>icon.MapColors(0.3,0.3,0.3, 0.59,0.59,0.59, 0.11,0.11,0.11, 0,0,0)
// or...
icon.MapColors(rgb(77,77,77), rgb(150,150,150), rgb(28,28,28), rgb(0,0,0))</xmp>

<p>The calculations are as follows:

<ul>
  <li>For any red in the original icon, add 30% gray to the output.</li>
  <li>For any green in the original icon, add 59% gray to the output.</li>
  <li>For any blue in the original icon, add 11% gray to the output.</li>
  <li>Add an additional 0% (nothing).</li>
</ul>

<p>Or this will make a nice moonlight effect:

<xmp>icon.MapColors(0.2,0.05,0.05, 0.1,0.3,0.2, 0.1,0.1,0.4, 0,0,0)
// or...
icon.MapColors(rgb(51,13,13), rgb(26,77,51), rgb(26,26,102), rgb(0,0,0))
</xmp>

<ul>
  <li>For any red in the original icon, add rgb(51,12.75,12.75) (dark pink) to the output.</li>
  <li>For any green in the original icon, add rgb(25.5,76.5,51) (dark bluish green) to the output.</li>
  <li>For any blue in the original icon, add rgb(25.5,25.5,102) (dark grayish blue) to the output.</li>
  <li>Add an additional 0% (nothing).</li>
</ul>

<p>Or a negative icon (invert all colors):

<xmp>MapColors(-1,0,0, 0,-1,0, 0,0,-1, 1,1,1)</xmp>

<p>The longer formats of MapColors() will allow you to also change alpha colors.

<hr>

<a name=/icon/proc/New>
<h2>New proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/proc/image>image proc</a>
<dd><a href=#/proc/new>new proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New(icon,icon_state,dir,frame,moving)
<dd><small>(supports <a href=#/proc/arguments/named>named arguments</a>)</small>
</dl>

<dl><dt><b>Args:</b>
<dd>icon: an icon file or /icon object
<dd>icon_state: an optional text string, specifying a single icon state to load
<dd>dir: an optional direction to extract
<dd>frame: an optional animation frame to extract
<dd>moving: Non-zero to extract only movement states, 0 for non-movement states,
  or null (default) for both
</dl>

<p>You generally don't call this directly but via new().  The specified icon
file is loaded into memory for direct access and manipulation.

<p>If the icon state is not specified, all icon states are loaded.  Ditto for
the direction, animation frame, or preference for movement states.  Animation
frames are numbered from 1 and up, so frame=4 is the 4th frame.

<p>(Movement states are special versions of an existing icon_state with the
same name, but appear in the Dream Maker editor with an "M" indicator. These
states are used for animation when the atom using the icon_state moves from
one tile to the next; otherwise only the normal non-moving state is displayed.)

<p>The following contrived example, loads the EAST facing default icon state
"" from the user's icon file, rotates that a bit, and then creates a new icon
file for the user.

<h3>Example:</h3>
<xmp>
mob/verb/test()
   var/icon/I = new(usr.icon,icon_state = "",dir = EAST)
   I.Turn(90)   //rotate clockwise 90 degrees
   usr.icon = I
</xmp>

<p>Note that merely displaying different icon states or directions can
generally be achieved without any icon manipulation, which is good, because it
saves quite a bit of overhead.  For example, the variables atom.icon_state and
atom.dir can be used to control how atom.icon is displayed, without any need
for generating a new icon file.

<hr>

<a name=/icon/proc/Scale>
<h2>Scale proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>

</dl>

<dl><dt><b>Format:</b>
<dd>Scale(width, height)
</dl>

<dl><dt><b>Args:</b>
<dd>width,height: size of the new icon
</dl>

<p>The current icon is scaled to a new size.

<p>If world.map_format is set to TILED_ICON_MAP and the new size is not in
multiples of world.icon_size, the icon will be padded with transparent pixels
to the top and right as needed. See map_format for more information.

<p>Scale() automatically performs antialiasing to avoid unwanted artifacts.


<hr>

<a name=/icon/proc/SetIntensity>
<h2>SetIntensity proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/icon/proc/MapColors>MapColors() proc (icon)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SetIntensity(r,g=r,b=r)
</dl>

<dl><dt><b>Args:</b>
<dd>r: red component
<dd>g: green component
<dd>b: blue component
</dl>

<p>This multiplies the pixel intensities by the specified amounts.  A value
greater than 1.0 increases the intensity and a value less than 1.0 decreases
the intensity.

<hr>

<a name=/icon/proc/Shift>
<h2>Shift proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/dir>dir var (atom)</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Shift(dir,offset,wrap=0)
</dl>

<dl><dt><b>Args:</b>
<dd>dir: direction in which to shift the icon
<dd>offset: distance to shift the pixels
<dd>wrap: if true, causes shifted pixels to wrap around to the other side
</dl>

<p>This moves all of the pixels by the specified amount in a direction.  For
example, Shift(NORTH,1) would move everything one pixel to the north.

<p>By default, pixels that move off the edge are not wrapped around;
transparent pixels are shifted onto the other side.  Calling with wrap=1
causes it to shift the pixels around to the other side.

<hr>

<a name=/icon/proc/SwapColor>
<h2>SwapColor proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/proc/rgb>rgb proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SwapColor(old_rgb,new_rgb)
  <br/><i>or</i><br/>
  SwapColor(old_rgba,new_rgba)
</dl>

<dl><dt><b>Args:</b>
<dd>old_rgba: the old rgba value to be replaced
<dd>new_rgba: the new rgba value to use in its place
</dl>

<p>This causes a color value in the icon's palette to be changed. You can use
null in place of an RGB or RGBA value.

<p>If the old color is a full RGBA color with an alpha value, such as
rgb(1,2,3,4) or "#01020304", then that exact color is the only one changed.

<p>If the old color is an RGB value with no alpha specified, such as
rgb(1,2,3) or "#010203", then that color will change to the new one
regardless of its alpha value, and the original icon's alpha will be kept
intact. (If the new color is totally transparent, however, then the old color
will be replaced with full transparency.)

<hr>

<a name=/icon/proc/Turn>
<h2>Turn proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon/proc/Flip>Flip proc (icon)</a>
<dd><a href=#/atom/var/dir>dir var (atom)</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Turn(angle)
</dl>

<dl><dt><b>Args:</b>
<dd>angle: an angle in degrees
</dl>

<p>This rotates the icon clockwise by the specified amount.

<h3>Example:</h3>
<xmp>
mob/verb/drink()
   //this effect is very confusing!
   var/icon/I = new(usr.icon)
   I.Turn(90)
   usr.icon = I
   usr << "You feel a little tipsy!"

   sleep(200)

   I.Turn(-90)  //turn it back
   usr.icon = I //should have just saved original value
</xmp>

<p>If an icon is not square, it cannot be turned.

<hr>

<a name=/icon/proc/Height>
<h2>Height proc (icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/icon/proc/Width>Width proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Height()
</dl>

<p>This finds the height, in pixels, of the icon.

<hr>

<a name=/image>
<h2>image objects</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/proc/image>image proc</a>
<dd><a href=#/image/var>vars (image)</a>
<dd><a href=#/client/var/images>images var (client)</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
<dd><a href=#/atom/var/override>override var (atom)</a>
</dl>

<p>The /image type contains data used to create a virtual image.  Unlike other
atomic objects, this object is a purely visual effect.  It always appears
attached to some other object and it behaves in every way as though it were
part of that object (e.g. if the user clicks on it, this counts as a click on
the atomic object, not the image).

<p>One reason for creating images is player-by-player control over visibility.
Images only become visible when they are explicitly output to players:

<h3>Example:</h3>
<xmp>
var/image/I = image('icon.dmi',usr)  //make an image attached to usr
usr << I    //allow usr to see it
</xmp>

<p>Images are also useful in the creation of overlays.  Overlays are like
images, since they are always attached to another object, but overlays obey
the normal rules of visibility, so they are more convenient when you do not
want to hide the effect from anybody.  An overlay can be created directly from
an icon file (or icon state), but when one wishes to override some additional
parameter, the image() instruction is a convenient way to do it.

<h3>Example:</h3>
<xmp>
usr.overlays += image('shirt.dmi',icon_state = "red")
</xmp>

<p>In the above example, the icon state of an overlay was set by creating the
overlay from an image with the desired icon state.  Note that after the
creation of an overlay, no link remains between the overlay and the object
that was used to create it.  If you change the image after that time, it will
not change the overlay, which is simply a "snapshot" of the original image.

<hr>

<a name=/image/var>
<h2>vars (image)</h2>

<dl><dt>/image/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/image/var/loc>loc</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>
<dd><a href=#/atom/var/maptext_height>maptext_height</a>
<dd><a href=#/atom/var/maptext_x>maptext_x</a>
<dd><a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/override>override</a>
<dd><a href=#/atom/var/pixel_x>pixel_x</a>
<dd><a href=#/atom/var/pixel_y>pixel_y</a>
<dd><a href=#/atom/var/pixel_w>pixel_w</a>
<dd><a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/vis_contents>vis_contents</a>
<dd><a href=#/atom/var/x>x</a>
<dd><a href=#/atom/var/y>y</a>
<dd><a href=#/atom/var/z>z</a>
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/datum/var/parent_type>parent_type</a>
</dl>

<hr>

<a name=/image/var/loc>
<h2>loc var (image)</h2>

<p>The location of an image specifies the object to which the image is
attached.  Unless the image drawing layer is specified, the default will make
it appear above this object, as though it were an overlay.

<p>Note that the image is not <em>inside</em> the specified location.  In
other words, this loc variable does not behave like /atom/movable/var/loc
which specifies the container object.  It is more like the image is on top of
the specified object.  If the object moves, the image will automatically move
around with it.

<hr>

<a name=/list>
<h2>list</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/list>list proc</a>
<dd><a href=#/proc/islist>islist proc</a>
<dd><a href=#/list/proc>procs (list)</a>
<dd><a href=#/list/var>vars (list)</a>
</dl>

<p>Lists are used to represent groups of objects.  Like objects, they have
vars and procs associated with them.  In order to access these attributes,
list vars must be declared of type /list.  These may then be assigned to
existing lists, or used to create new lists.

<h3>Example:</h3>
<xmp>
var/list/L         // list reference
L = world.contents // assign to existing list
L = new/list()     // make a new list
L = new()          // make a new list (implicit type)
L.Add("futz")      // L contains: "futz"
del(L)             // delete L
</xmp>

<p>Lists created with 'new()' have a default length of 0; this can be
overridden by specifying the size; that is, new/list(size) creates a list
with size (null) elements.

<p>The 'list()' proc may be used to more easily initialize list data.

<h3>Example:</h3>
<xmp>
var/list/L
L = list("futz",3)   // L contains: ("futz", 3)
</xmp>

<p>Alternatively, lists may be declared by using brackets, '[]'.  Empty
brackets indicate a list reference, exactly as /list does, so list/L is
equivalent to L[].  Setting an initial size within the brackets, for
instance, L[10], creates a list of that initial size.

<h3>Example:</h3>
<xmp>
var/L[]   // same as var/list/L: list reference
var/M[10] // initially empty list of size 10
L = M     // L is now an empty list of size 10
</xmp>

<p>Once a list L is declared, a specific item can be accessed by putting its
index in the brackets: L[index].

<p>Indices range from 1 to len.  If the length of the list is changed,
existing elements in the list will be preserved if they are less than the
new length.  New elements in the list will be given the initial value of
null.

<h3>Example:</h3>
<xmp>
var/L[5]  // initial length of 5
var/i

for(i=1, i<=L.len, i++)
  L[i] = i
// L contains: (1,2,3,4,5)

L.len = 7           // expand list
// L contains: (1,2,3,4,5,null,null)

del(L)          // destroy list
</xmp>

<p>Multi-dimensional lists may be created by making a list of lists.

<h3>Example:</h3>
<xmp>
var/grid[10][5]
grid[1][1] = 1
grid[1][2] = 2
...
</xmp>

<p>Such a list may also be created by using new().  As in the previous
example, the next one creates a list of 10 lists each having 5 elements.

<h3>Example:</h3>
<xmp>
var/grid = new/list(10,5)
</xmp>

<hr>

<a name=/list/associations>
<h2>list associations</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/proc/list>list proc</a>
<dd><a href=#/proc/alist>list proc</a>
<dd><a href=#/proc/list2params>list2params proc</a>
<dd><a href=#/world/var/params>params var (world)</a>
<dd><a href=#/proc/params2list>params2list proc</a>
<dd><a href=#/datum/var/vars>vars list var (datum)</a>
<dd><a href=#/proc/values_sum>values_sum proc</a>
<dd><a href=#/proc/values_product>values_product proc</a>
<dd><a href=#/proc/values_dot>values_dot proc</a>
<dd><a href=#/proc/values_cut_over>values_cut_over proc</a>
<dd><a href=#/proc/values_cut_under>values_cut_under proc</a>
</dl>

<p>Each unique text string or object in a list may be associated with another
value.  This is done by using the item as an index into the list.

<h3>Example:</h3>
<xmp>
var/params[0]

params["player"] = "James Byond"
params["score"] = 2000

//List now contains ("player","score")
//These are associated with ("James Byond",2000)

usr << "Looping through list items:"
var/p
for(p in params)
   usr << "[p] = [params[p]]"

usr << "Looping through array indices:"
var/i
for(i=1,i<=params.len,i++)
   p = params[i]
   usr << "[p] = [params[p]]"
</xmp>

<p>The above example illustrates the typical way in which list associations
are managed.  Note that an item in the list may be added by assigning its
associated value.  The example could have started by doing
<code>params.Add("player","score")</code>, but that would have been
redundant.

<p>Both <code>for</code> loops in the example have the same effect.  The
first one loops through each item in the list, and displays it along with
its associated value.  The second loop achieves the same thing by looping
through the numerical indices (referred to as <em>array</em> indices as
opposed to <em>associative</em> indices).

<p>Since numeric indices are treated differently, accessing the Nth item
in the list, you may not assign an associated value to a numeric list
item. Associations must have a text string or object reference as the index
item. (<tt>alist()</tt> is an exception to this, and can use numeric
associations. See <a class=code href=#/list/alist>alist()</a> for more
information.)

<p>Associated values default to null if none is assigned.  This is also the
value returned when the supplied index item does not exist in the list.  The
list defined above, for example, would return null for
<code>params["time"]</code>.

<p>The <a class=code href=#/proc/list>list()</a> or
<a class=code href=#/proc/alist>alist()</a> instructions may also be used to
create associative lists.

<h3>Example:</h3>
<xmp>
var/list/lst = list("player" = "James Byond", "score" = 2000)
</xmp>

<p>When the index values happen to be text strings that satisfy all the
requirements for variable names, this may also be written in a convenient
short-hand:

<xmp>
var/list/lst = list(player = "James Byond", score = 2000)
</xmp>

<p>In other words, this is exactly the same syntax as for
<a href=#/proc/arguments/named>named arguments</a>.

<p>The <a href=#/proc/alist><tt>alist</tt> proc</a> creates lists that are
<i>strictly</i> associative. This means that list items are treated as "keys"
in key,value pairs. Unlike a regular list, each "key" is unique.

<hr>

<a name=/list/operators>
<h2 short="operators">list operators</h2>

<p>These operators are used for accessing list items.

<dl>
<dd><a href=#/operator/[]>[] operator</a>
<dd><a href=#/operator/%3F[]>?[] operator</a>
</dl>

<p>These operators all have special meaning when applied to lists.

<dl>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator/|>| operator</a>
<dd><a href=#/operator/|=>|= operator</a>
<dd><a href=#/operator/&>&amp; operator</a>
<dd><a href=#/operator/&=>&amp;= operator</a>
<dd><a href=#/operator/^>^ operator</a>
<dd><a href=#/operator/^=>^= operator</a>
<dd><a href=#/operator/in>in operator</a>
</dl>

<hr>

<a name=/list/proc>
<h2>procs (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/list/operators>list operators</a>
</dl>

<p>Built-in list procs:

<dl><dt>list/proc
<dd><a href=#/list/proc/Add>Add</a>
<dd><a href=#/list/proc/Copy>Copy</a>
<dd><a href=#/list/proc/Cut>Cut</a>
<dd><a href=#/list/proc/Find>Find</a>
<dd><a href=#/list/proc/Insert>Insert</a>
<dd><a href=#/list/proc/Join>Join</a>
<dd><a href=#/list/proc/Remove>Remove</a>
<dd><a href=#/list/proc/RemoveAll>RemoveAll</a>
<dd><a href=#/list/proc/Splice>Splice</a>
<dd><a href=#/list/proc/Swap>Swap</a>
</dl>

<hr>

<a name=/list/proc/Add>
<h2>Add proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/list/proc/Remove>Remove proc (list)</a>
<dd><a href=#/list/proc/RemoveAll>RemoveAll proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Add(Item1,Item2,...)
</dl>

<dl><dt><b>Args:</b>
<dd>One or more items to add to the list.
</dl>

<p>Appends the specified items to the list.  If an argument is itself a
list, each item in the list will be added.

<hr>

<a name=/list/proc/Copy>
<h2>Copy proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/proc/Cut>Cut proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Copy(Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new list.
</dl>

<dl><dt><b>Args:</b>
<dd>Start: The list position in which to begin the copy.
<dd>End: The list position immediately following the last element to be
     copied.
</dl>

<p>Copy list[Start] through list[End-1] into a new list. The default end
position of 0 stands for the position immediately after the end of the list,
so by default the entire list is copied.

<hr>

<a name=/list/proc/Cut>
<h2>Cut proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/proc/Copy>Copy proc (list)</a>
<dd><a href=#/list/proc/Insert>Insert proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Cut(Start=1,End=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Start: The list position in which to begin the cut.
<dd>End: The list position immediately following the last element to be
     removed.
</dl>

<p>Remove the elements between list[Start] and list[End-1], decreasing the
size of the list appropriately.  The default end position of 0 stands for
the position immediately after the end of the list, so by default the entire
list is deleted.

<hr>

<a name=/list/proc/Find>
<h2>Find proc (list)</h2>

<dl><dt><b>Format:</b>
<dd>list.Find(Elem,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The first position of elem in list, or 0 if not found.
</dl>

<dl><dt><b>Args:</b>
<dd>Elem: The element to find.
<dd>Start: The list position in which to begin the search.
<dd>End: The list position immediately following the end of the search.
</dl>

<p>Find the first position of Elem in the list.  Elements between Start and
End are searched.  The default end position of 0 stands for the position
immediately after the end of the list, so by default the entire list is
searched.

<hr>

<a name=/list/proc/Insert>
<h2>Insert proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/proc/Cut>Cut proc (list)</a>
<dd><a href=#/list/proc/Copy>Copy proc (list)</a>
<dd><a href=#/list/proc/Swap>Swap proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Insert(Index,Item1,Item2...)
</dl>

<dl><dt><b>Returns:</b>
<dd>The index following the inserted items.
</dl>

<dl><dt><b>Args:</b>
<dd>Index: The index where the new item will be inserted. Any value
  already at that index will be pushed forward.
<dd>Item1: A value or list of values to insert.
<dd>Item2...: (optional) Additional items to insert, immediately after the
  previous item(s).
</dl>

<p>Insert values into a list at a specific point. Using Index=0 or
Index=list.len+1 is the same as adding to the list.

<p>If any of the items you insert is itself a list, its elements will be
inserted instead of the list itself.

<p>Note: This proc doesn't work with many special lists such as
<code>contents</code> or <code>overlays</code>.

<hr>

<a name=/list/proc/Join>
<h2 byondver=510>Join proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/jointext>jointext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Join(Glue,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A text string made up of the items in this list, joined together by Glue.
</dl>

<dl><dt><b>Args:</b>
<dd>Glue: The text that will go between each item.
<dd>Start: The list item on which to begin.
<dd>End: The list item immediately following the last item to be joined.
</dl>

<p>This is exactly the same as calling jointext(List,Glue,Start,End), and
is provided for convenience.

<hr>

<a name=/list/proc/Remove>
<h2>Remove proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/list/proc/Add>Add proc (list)</a>
<dd><a href=#/list/proc/RemoveAll>RemoveAll proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Remove(Item1,Item2,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if any items removed, 0 if not.
</dl>

<dl><dt><b>Args:</b>
<dd>One or more items to remove from the list.
</dl>

<p>Removes the specified items from the list.  If an argument is itself a
list, each item contained in it will be removed.  Removal starts at the end
of the list (highest index) so that this operation is an exact reversal of
Add().

<hr>

<a name=/list/proc/RemoveAll>
<h2 byondver=515>RemoveAll proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/proc/Add>Add proc (list)</a>
<dd><a href=#/list/proc/Remove>Remove proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.RemoveAll(Item1,Item2,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>Number of items removed.
</dl>

<dl><dt><b>Args:</b>
<dd>One or more items to remove entirely from the list.
</dl>

<p>Removes all copies of the specified items from the list. If an argument is
itself a list, each item contained in it will be removed.

<p>This is basically a faster version of the statement
<tt>while(list.Remove(Item1,Item2,...))</tt> with an empty code block. For
large lists this might be a big improvement because the list doesn't have to
be traversed every time.

<hr>

<a name=/list/proc/Splice>
<h2 byondver=514>Splice proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/proc/Copy>Copy proc (list)</a>
<dd><a href=#/list/proc/Cut>Cut proc (list)</a>
<dd><a href=#/list/proc/Insert>Insert proc (list)</a>
<dd><a href=#/proc/splicetext>splicetext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Splice(Start=1,End=0,Item1,Item2...)
</dl>

<dl><dt><b>Args:</b>
<dd>Start: The list index where the splice will begin.
<dd>End: The index immediately following the last item to be cut from the list. 0 is the end of the list.
<dd>Item1, Item2...: Items to be inserted.
</dl>

<p>Cuts out items from a list, and inserts new items in their place.
This is basically equivalent to calling <tt>list.Cut(Start,End)</tt> and then
calling <tt>list.Insert(Start,Item1,Item2...)</tt>, but faster.

<h3>Example:</h3>
<xmp>
var/list/L = list("apple","banana","orange","pear")

// cuts "banana" and "orange" and inserts four new items
L.Splice(2,4,"firetruck","camel","joystick","balloon")

// prints apple, firetruck, camel, joystick, balloon, pear
for(var/item in L)
    usr << item
</xmp>

<p>As with <tt>Insert()</tt>, any items that are lists will insert their
contents instead of themselves.

<p>The <tt>Start</tt> and <tt>End</tt> index values can be negative, which
count backwards from the end of the list. If the index values are out of
range, there will be no error; they will simply be clamped to the beginning
or end of the list. If <tt>End</tt> comes before <tt>Start</tt>, the two
values are swapped.

<p>Note: This proc doesn't work with many special lists such as
<code>contents</code> or <code>overlays</code>.

<hr>

<a name=/list/proc/Swap>
<h2>Swap proc (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/proc/Cut>Cut proc (list)</a>
<dd><a href=#/list/proc/Copy>Copy proc (list)</a>
<dd><a href=#/list/proc/Insert>Insert proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list.Swap(Index1,Index2)
</dl>

<dl><dt><b>Returns:</b>
<dd>Nothing.
</dl>

<dl><dt><b>Args:</b>
<dd>Index1: The index (1 to list.len) of one of the items to swap.
<dd>Index2: The index of the other item.
</dl>

<p>Swap two items in a list. If the list has associated values, they
will be preserved. This is most useful for user-defined sorting routines.

<h3>Example:</h3>
<xmp>
var/item
var/list/L = list("orange" = 3, "green" = 2, "blue" = 5)
for(item in L) world << "[item] -> [L[item]]"
world << ""
L.Swap(1, 3)
for(item in L) world << "[item] -> [L[item]]"
</xmp>

<h3>Result:</h3>
<xmp>
orange -> 3
green -> 2
blue -> 5

blue -> 5
green -> 2
orange -> 3
</xmp>

<p>Note: This proc doesn't work with many special lists such as
<code>contents</code> or <code>overlays</code>.

<hr>

<a name=/list/var>
<h2>vars (list)</h2>

<p>Built-in list vars:

<dl><dt>list/var
<dd><a href=#/list/var/len>len</a>
</dl>

<hr>

<a name=/list/var/len>
<h2>len var (list)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator/-=>-= operator</a>
</dl>

<p>This is the length of the list. Increasing it expands the list,
initializing all new elements with null.  Decreasing it contracts the list,
making old elements inaccessible.

<hr>

<a name=/map>
<h2>map</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/include>#include directive</a>
<dd><a href=#/world/var/area>area var (world)</a>
<dd><a href=#/world/var/maxx>maxx var (world)</a>
<dd><a href=#/world/var/turf>turf var (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>#include "mapname.dmm"
</dl>

<p>One or more map files may be loaded into the world's map.  These are
loaded into successive z-levels.  If no map files are specified, the default
project map file will be used.  This file has the same name as the project
but has the extension .dmm.

<p>If no map files are loaded, the world's map size is determined by the
world variables maxx, maxy, and maxz.  The default content of this map is
determined by the world variables turf and area.

<h3>Example:</h3>
<xmp>
#include "level1.dmm"
#include "level2.dmm"
#include "level3.dmm"
</xmp>

<hr>

<a name=/matrix>
<h2 byondver=500>matrix</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/matrix>matrix proc</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
<dd><a href=#/atom/var/transform>transform var (atom)</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>To display rotation, scaling, and other transformations on atoms, DM uses
2D matrices. The /matrix datum is a convenient way of handling the numbers
involved, as it can be easily manipulated. There are six vars, a through f,
laid out like so:

<pre>          a d 0
x y 1  *  b e 0  =  x' y' 1
          c f 1</pre>

<p>When an x,y point is multiplied by the matrix, it becomes the new point
x',y'. This is equivalent to:

<pre>x' = a*x + b*y + c
y' = d*x + e*y + f</pre>

<p>The default matrix is:

<pre>1 0 0
0 1 0
0 0 1</pre>

<p>Matrices are created with the matrix() proc, or by calling new/matrix().
(See the matrix() proc for examples.) They are also created as needed
whenever you read from atom.transform or use certain operators.

<p>Manipulation of matrices can be done with operators, or with procs. You
can do the following with them:

<ul>
<li><b>Multiply:</b> Multiplying two matrices together will chain together
the transformations they represent. For instance, a scaling matrix
multiplied by a rotation matrix says: Scale, then rotate. Multiplication of
two matrices is sensitive to the order you use.</li>
<li><b>Scale:</b> A simple scale matrix uses only the a and e values, to
scale x and y by a certain amount.</li>
<li><b>Rotate:</b> A rotation matrix can rotate an atom by whatever amount
you like.</li>
<li><b>Translate:</b> Translation is like a pixel offset, changing the atom's
position.</li>
<li><b>Interpolate:</b> You can calculate a matrix that lies somewhere
between two other matrices, which can be helpful for animation.</li>
</ul>

<p>When you've built your matrix, you can assign it to atom.transform to
change the way that atom is displayed.

<p>The matrices supported by this datum are <b>not</b> the same kind used to
transform colors, as in the atom.color var and icon.MapColors() proc.  For
color matrices, see <a href=#/{notes}/color-matrix>color matrix</a>.

<hr>

<a name=/matrix/operators>
<h2 byondver=500 short="operators">matrix operators</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/proc>matrix procs</a>
</dl>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator/*>* operator</a>
<dd><a href=#/operator/*=>*= operator</a>
<dd><a href=#/operator//>/ operator</a>
<dd><a href=#/operator//=>/= operator</a>
<dd><a href=#/operator/~>~ operator</a>
</dl>

<p>The operators listed above have special meaning when applied to matrices.

<p>The assignment operators will modify an existing matrix, and can also be
used directly with atom.transform. Other operators will create a new matrix.

<hr>

<a name=/matrix/proc>
<h2 byondver=500>matrix procs</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/proc/turn/matrix>turn proc (applied to a matrix)</a>
</dl>

<dl><dt>matrix/proc
<dd><a href=#/proc/matrix>New</a>
<dd><a href=#/matrix/proc/Add>Add</a>
<dd><a href=#/matrix/proc/Interpolate>Interpolate</a>
<dd><a href=#/matrix/proc/Invert>Invert</a>
<dd><a href=#/matrix/proc/Multiply>Multiply</a>
<dd><a href=#/matrix/proc/Scale>Scale</a>
<dd><a href=#/matrix/proc/Subtract>Subtract</a>
<dd><a href=#/matrix/proc/Translate>Translate</a>
<dd><a href=#/matrix/proc/Turn>Turn</a>
</dl>

<hr>

<a name=/matrix/proc/Add>
<h2>Add proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
<dd><a href=#/operator/+=>+= operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Add(Matrix2)
</dl>

<dl><dt><b>Args:</b>
<dd>Matrix2: another matrix
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>This adds Matrix2 to the current matrix.

<hr>

<a name=/matrix/proc/Interpolate>
<h2>Interpolate proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Interpolate(Matrix2, t)
</dl>

<dl><dt><b>Args:</b>
<dd>Matrix2: Another matrix
<dd>t: The interpolation factor: from 0 (src) to 1 (Matrix2). Usually this is a value between 0 and 1.
</dl>

<p>Calculates and returns a new matrix between src and Matrix2. If t is 0.5,
then the result will be exactly halfway between both matrices.

<p>There are many ways to interpolate matrices. Whenever possible, DM will
interpolate by doing scaling and/or shearing first, then rotation, then
translation. This is done by trying to find the angle of rotation of each
matrix first; a rotation of 180° is counted as a flip rather than a rotation.

<p>It is not strictly necessary for t to be between 0 and 1. Using a value
out of bounds will extrapolate a matrix, continuing the change as far as t.

<hr>

<a name=/matrix/proc/Invert>
<h2>Invert proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
<dd><a href=#/operator/~>~ operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Invert()
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>This inverts the current matrix, if possible.

<p>Not all matrices can be inverted. If it's not possible, the matrix is said
to be degenerate. This happens if, for example, all of the values in the
matrix are zero. A degenerate matrix will not be changed by this proc.

<hr>

<a name=/matrix/proc/Multiply>
<h2>Multiply proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
<dd><a href=#/operator/*>*= operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Multiply(Matrix2)<br/><i>or</i>
<dd>Multiply(n)
</dl>

<dl><dt><b>Args:</b>
<dd>Matrix2: another matrix
<dd>n: a number
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>This multiplies the current matrix by Matrix2 or n. If the n format is
used, this is just like scaling the whole matrix. If another matrix is
multiplied, then it is like doing the two transformations in order: src,
then Matrix2.

<p>Multiplication of one matrix by another depends on the order. You may
get a different result multiplying A * B vs. B * A.

<hr>

<a name=/matrix/proc/Scale>
<h2>Scale proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Scale(x,y)
</dl>

<dl><dt><b>Args:</b>
<dd>x: The amount of scaling to do in the x direction
<dd>y: The amount of scaling to do in the y direction
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>The matrix is scaled by the appropriate amounts.

<p>If y is omitted, x is used for both. E.g., Scale(2) is equivalent to
Scale(2,2).

<hr>

<a name=/matrix/proc/Subtract>
<h2>Subtract proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
<dd><a href=#/operator/+=>-= operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Subtract(Matrix2)
</dl>

<dl><dt><b>Args:</b>
<dd>Matrix2: another matrix
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>This subtracts Matrix2 from the current matrix.

<hr>

<a name=/matrix/proc/Translate>
<h2>Translate proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Translate(x,y)
</dl>

<dl><dt><b>Args:</b>
<dd>x: The amount of scaling to do in the x direction
<dd>y: The amount of scaling to do in the y direction
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>The matrix is translated (moved) by the appropriate amounts. The x and y
offsets applied by translation are in pixels.

<p>If y is omitted, x is used for both. E.g., Translate(2) is equivalent to
Translate(2,2).

<hr>

<a name=/matrix/proc/Turn>
<h2>Turn proc (matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/matrix/operators>matrix operators</a>
<dd><a href=#/matrix/proc>matrix procs</a>
<dd><a href=#/proc/turn/matrix>turn proc (applied to a matrix)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Turn(angle)
</dl>

<dl><dt><b>Args:</b>
<dd>angle: The angle of clockwise rotation, in degrees
</dl>

<dl><dt><b>Returns:</b>
<dd>src
</dl>

<p>The matrix is rotated clockwise, by the angle given.

<hr>

<a name=/mutable_appearance>
<h2 byondver=511>mutable appearance</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/appearance>appearance var (atom)</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/mutable_appearance/var>vars (mutable appearance)</a>
</dl>

<p>All atoms and images have an appearance, which is an immutable object
that can be shared by many atoms.  Making changes to an object's appearance
generates new appearances, many of which may be temporary. For
high-performance games, this can be a drawback. The
<tt>/mutable_appearance</tt> type exists so that you can make multiple changes
to an appearance without creating all the temporary objects, then turn it into
a regular immutable appearance when finished.

<p>A new mutable appearance is created via <tt>new/mutable_appearance</tt>,
and giving it an atom, image, or appearance as a source object.  Assigning it
to an object's appearance var will create a new immutable appearance.

<h3>Example:</h3>
<xmp>
mob/proc/GetAngry()
    var/mutable_appearance/ma = new(src)
    ma.color = rgb(51,255,51)   // green
    ma.transform = matrix(2,0,0,0,2,0)  // scale x2
    appearance = ma
</xmp>

<p>Reading certain vars, such as <tt>overlays</tt>, will create a temporary
list object that can be modified easily. With regular appearances, making
many changes to the <tt>overlays</tt> list results in a lot of churn.

<p>The <tt>/mutable_appearance</tt> datum is technically a descendant of
<tt>/image</tt>, but this is only for convenience, and should not be relied
on for any other purpose as it is subject to change in future versions.

<hr>

<a name=/mutable_appearance/var>
<h2 byondver=511>vars (mutable appearance)</h2>

<p>Built-in mutable appearance vars:

<dl><dt>mob/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/density>density</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>
<dd><a href=#/atom/var/maptext_height>maptext_height</a>
<dd><a href=#/atom/var/maptext_x>maptext_x</a>
<dd><a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/atom/var/pixel_x>pixel_x</a>
<dd><a href=#/atom/var/pixel_y>pixel_y</a>
<dd><a href=#/atom/var/pixel_w>pixel_w</a>
<dd><a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/atom/var/verbs>verbs</a>
<dd><a href=#/atom/var/vis_flags>vis_flags</a>
</dl>

<hr>

<a name=/mob>
<h2>mob</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom>atom</a>
<dd><a href=#/atom/movable>movable atoms</a>
<dd><a href=#/mob/proc>procs (mob)</a>
<dd><a href=#/mob/var>vars (mob)</a>
<dd><a href=#/client>client</a>
</dl>

<p>Mobs are "mobile objects" derived from <tt>/mob</tt>, which derives from
<tt>/atom/movable</tt>. Human players are associated with a mob when they log
on. Mobs are typically used for other "creature" types as well such as NPCs.
This type is slightly more complex than objs since it can be attached to a
client.

<p>This example defines the mob type <tt>/mob/guzzler</tt>.

<h3>Example:</h3>
<xmp>
mob
  guzzler
    desc = "Mean, mad, and wicked bad."
</xmp>

<hr>

<a name=/mob/proc>
<h2>procs (mob)</h2>

<p>Built-in mob procs:

<dl><dt>mob/proc
<dd><a href=#/atom/movable/proc/Bump>Bump</a>
<dd><a href=#/atom/proc/Click>Click</a>
<dd><a href=#/atom/proc/Cross>Cross proc</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc</a>
<dd><a href=#/atom/proc/DblClick>DblClick</a>
<dd><a href=#/datum/proc/Del>Del</a>
<dd><a href=#/atom/proc/Enter>Enter</a>
<dd><a href=#/atom/proc/Entered>Entered</a>
<dd><a href=#/atom/proc/Exit>Exit</a>
<dd><a href=#/atom/proc/Exited>Exited</a>
<dd><a href=#/mob/proc/Login>Login</a>
<dd><a href=#/mob/proc/Logout>Logout</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel</a>
<dd><a href=#/atom/movable/proc/Move>Move</a>
<dd><a href=#/atom/proc/New>New</a>
<dd><a href=#/datum/proc/Read>Read</a>
<dd><a href=#/atom/proc/Stat>Stat</a>
<dd><a href=#/datum/proc/Topic>Topic</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc</a>
<dd><a href=#/datum/proc/Write>Write</a>
</dl>

<hr>

<a name=/mob/proc/Login>
<h2>Login proc (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/mob/proc/Logout>Logout proc (mob)</a>
<dd><a href=#/mob/var/client>client var (mob)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Login()
</dl>

<dl><dt><b>When:</b>
<dd>Called when a player's client tries to connect to a mob.  This is called
    by default from client.New(), when the player logs into the world.
</dl>

<dl><dt><b>Default action:</b>
<dd>If the mob has no location, place it near (1,1,1) if possible.  Change
     the player's stat object (client.statobj) to the mob.
</dl>

<p>One can typically tell if a player is connecting to a fresh mob versus
reconnecting to an existing one by testing if the mob's location is null.

<hr>

<a name=/mob/proc/Logout>
<h2>Logout proc (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/mob/proc/Login>Login proc (mob)</a>
<dd><a href=#/mob/var/client>client var (mob)</a>
<dd><a href=#/mob/var/key>key var (mob)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Logout()
</dl>

<dl><dt><b>When:</b>
<dd>Called when a player's client has disconnected from a mob.  This happens
    in client.Del() when the player logs out of the world.  It may also
    happen when the player switches from one mob to another.
</dl>

<dl><dt><b>Default action:</b>
<dd>None.
</dl>

<p>One may wish to distinguish between a player who has disconnected from
the game and one who is simply switching from one mob to another.  In the
case of a player switching to another mob, by the time <code>Logout()</code>
is called, the original mob's key will be null, whereas the key will still
be non-null in the case of a player disconnecting from the game.

<hr>

<a name=/mob/var>
<h2>vars (mob)</h2>

<p>Built-in mob vars:

<dl><dt>mob/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/mob/var/ckey>ckey</a>
<dd><a href=#/mob/var/client>client</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/contents>contents</a>
<dd><a href=#/atom/var/density>density</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/mob/var/group>group</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/mob/var/key>key</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>
<dd><a href=#/atom/var/maptext_height>maptext_height</a>
<dd><a href=#/atom/var/maptext_x>maptext_x</a>
<dd><a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement</a>
<dd><a href=#/atom/var/loc>loc</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/mob/var/parent_type>parent_type</a>
<dd><a href=#/atom/var/pixel_x>pixel_x</a>
<dd><a href=#/atom/var/pixel_y>pixel_y</a>
<dd><a href=#/atom/var/pixel_w>pixel_w</a>
<dd><a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/mob/var/see_infrared>see_infrared</a>
<dd><a href=#/mob/var/see_invisible>see_invisible</a>
<dd><a href=#/mob/var/see_in_dark>see_in_dark</a>
<dd><a href=#/mob/var/sight>sight</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/atom/var/verbs>verbs</a>
<dd><a href=#/atom/var/vis_contents>vis_contents</a>
<dd><a href=#/atom/var/vis_flags>vis_flags</a>
<dd><a href=#/atom/var/vis_locs>vis_locs</a>
<dd><a href=#/atom/var/x>x</a>
<dd><a href=#/atom/var/y>y</a>
<dd><a href=#/atom/var/z>z</a>
</dl>

<hr>

<a name=/mob/var/ckey>
<h2>ckey var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ckey>ckey proc</a>
<dd><a href=#/mob/var/key>key var (mob)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is the value of mob.key converted to canonical form (ie the form
returned by the ckey() proc).  Among other things, this could be used as a
unique directory name in a server-side save file for storing player
information.  See the ckey() proc for an example.

<hr>

<a name=/mob/var/client>
<h2>client var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client>client</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is a reference to a set of properties specific to the player.
Therefore non-player mobs (NPCs) do not have a client (client = null).

<p>Setting a mob's client connects that player's client to the mob.

<hr>

<a name=/mob/var/group>
<h2>group list var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/proc/Bump>Bump proc (movable atom)</a>
<dd><a href=#/list>list</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>(empty list)
</dl>

<p>This is a list of mobs in the same group.  By default, a mob will swap
positions with another mob in its group if bumped.  It is also possible to
make verbs that are accessible only to members of the group.

<p>The following example handles addition of somebody else to your group.

<h3>Example:</h3>
<xmp>
mob/verb/join(mob/M)
   usr.group.Add(M)    // add M to usr's group
   view() << "[usr] joins [M]."
mob/verb/disband(mob/M)
   usr.group.Remove(M) // remove M from group
   view() << "[usr] disbands [M]."
</xmp>

<p>Note that group lists may be asymmetric.  Mob A may have mob B in his group
list, but mob B may or may not.  It is up to you to define whether mobs are
added into both lists or not.

<p>Here is an example of a verb accessible to a group:

<h3>Example:</h3>
<xmp>
mob/verb/summon()
   set src in usr.group
   loc = usr.loc
   view() << "[usr] summons [src]."
</xmp>

<hr>

<a name=/mob/var/key>
<h2>key var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/mob/var/ckey>ckey var (mob)</a>
<dd><a href=#/client>client</a>
<dd><a href=#/client/var/key>key var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>For player mobs (PCs) this is the value of the player's key.  For
non-player mobs (NPCs), this is the value of the "desired" key.  This means
that if a player with that key logs into the world, he will be connected to
that mob (as opposed to a new one of type world.mob).

<p>Setting the mob's key will cause a client with the same key to connect to
the mob.  Any other mob with the same key will lose it.

<p>Key values are always compared in canonical form (ie the form returned by
ckey()) so setting a mob's key to "Dan", "dan" are equivalent as far as
controlling player linkage.

<hr>

<a name=/mob/var/parent_type>
<h2>parent_type var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/var/parent_type>parent_type var</a>
</dl>

<p>The default parent_type of <a href=#/mob>/mob</a> is
<a href=#/atom/movable>/atom/movable</a>.

<hr>

<a name=/mob/var/see_in_dark>
<h2>see_in_dark var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/luminosity>luminosity var (atom)</a>
<dd><a href=#/mob/var/see_infrared>see_infrared var (mob)</a>
<dd><a href=#/mob/var/see_invisible>see_invisible var (mob)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>2
</dl>

<p>This determines how far the mob can see in the dark.  The scale is just
like luminosity: a value of 1 illuminates the mob and its location; 2
illuminates the immediate surrounds; and so on.

<hr>

<a name=/mob/var/see_infrared>
<h2>see_infrared var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/infra_luminosity>infra_luminosity var (atom)</a>
<dd><a href=#/mob/var/see_in_dark>see_in_dark var (mob)</a>
<dd><a href=#/mob/var/see_invisible>see_invisible var (mob)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Setting this to 1 enables infravision, allowing the mob to see infrared
objects in the dark.

<hr>

<a name=/mob/var/see_invisible>
<h2>see_invisible var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/invisibility>invisibility var (atom)</a>
<dd><a href=#/mob/var/see_in_dark>see_in_dark var (mob)</a>
<dd><a href=#/mob/var/see_infrared>see_infrared var (mob)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This is the maximum level of invisibility that the mob can see.

<hr>

<a name=/mob/var/sight>
<h2>sight var (mob)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/invisibility>invisibility setting (verb)</a>
<dd><a href=#/atom/var/invisibility>invisibility var (atom)</a>
<dd><a href=#/mob/var/see_in_dark>see_in_dark var (mob)</a>
<dd><a href=#/mob/var/see_infrared>see_infrared var (mob)</a>
<dd><a href=#/mob/var/see_invisible>see_invisible var (mob)</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>This controls which objects on the map the mob can see.  The default
value of 0 means that the mob can see all objects that are visible and lit.
Different flags in this var can be set to extend or limit this range.

<p>The following bit flags are encoded in mob.sight:

<xmp>
SEE_INFRA // can see infra-red objects
SEE_SELF  // can see self, no matter what
SEE_MOBS  // can see all mobs, no matter what
SEE_OBJS  // can see all objs, no matter what
SEE_TURFS // can see all turfs (and areas), no matter what
SEE_PIXELS// if an object is located on an unlit area, but some of its pixels are
          // in a lit area (via pixel_x,y or smooth movement), can see those pixels
SEE_THRU  // can see through opaque objects
SEE_BLACKNESS // render dark tiles as blackness
BLIND     // can't see anything
</xmp>

<h3>Example:</h3>
<xmp>
usr.sight |= BLIND     // turn on the blind bit
usr.sight &= ~BLIND    // turn off the blind bit
usr.sight |= (SEE_MOBS|SEE_OBJS|SEE_TURFS)  // turn on several bits at once
usr.sight &= ~(SEE_MOBS|SEE_OBJS|SEE_TURFS) // turn off several bits at once
</xmp>

<p><tt>SEE_PIXELS</tt> draws everything and then covers hidden turfs with
blackness. It is supported in topdown maps only, not in other map formats. It
does not mix well with other flags.  In practice, <tt>SEE_PIXELS</tt> acts as
if <tt>SEE_BLACKNESS</tt>, <tt>SEE_TURFS</tt>, <tt>SEE_OBJS</tt>, and
<tt>SEE_MOBS</tt> are all turned on. That is, all atoms are drawn even on
hidden tiles, and black squares are also drawn to cover them.

<p>The black tiles rendered by <tt>SEE_BLACKNESS</tt> and <tt>SEE_PIXELS</tt>
are drawn on the default plane 0.

<hr>

<a name=/obj>
<h2>obj</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom>atom</a>
<dd><a href=#/atom/movable>movable atoms</a>
<dd><a href=#/obj/proc>procs (obj)</a>
<dd><a href=#/obj/var>vars (obj)</a>
</dl>

<p>There are two types of movable atoms: objs and mobs. The difference between
them is that a mob can be attached to a human player, and is also typically
used for NPCs and creatures. The obj type is a little bit simpler and is
typically used for objects in the environment, items in inventory, etc.

<p>Objects are derived from <tt>/obj</tt>, which derives from
<tt>/atom/movable</tt>.

<p>The following example defines the obj type <tt>/obj/scooper</tt>.

<h3>Example:</h3>
<xmp>
obj
  scooper
    desc = "Super pooper scooper."
</xmp>

<hr>

<a name=/obj/proc>
<h2>procs (obj)</h2>

<p>Built-in obj procs:

<dl><dt>obj/proc
<dd><a href=#/atom/movable/proc/Bump>Bump</a>
<dd><a href=#/atom/proc/Click>Click</a>
<dd><a href=#/atom/proc/Cross>Cross proc</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc</a>
<dd><a href=#/atom/proc/DblClick>DblClick</a>
<dd><a href=#/datum/proc/Del>Del</a>
<dd><a href=#/atom/proc/Enter>Enter</a>
<dd><a href=#/atom/proc/Entered>Entered</a>
<dd><a href=#/atom/proc/Exit>Exit</a>
<dd><a href=#/atom/proc/Exited>Exited</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel</a>
<dd><a href=#/atom/movable/proc/Move>Move</a>
<dd><a href=#/atom/proc/New>New</a>
<dd><a href=#/datum/proc/Read>Read</a>
<dd><a href=#/atom/proc/Stat>Stat</a>
<dd><a href=#/datum/proc/Topic>Topic</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc</a>
<dd><a href=#/datum/proc/Write>Write</a>
</dl>

<hr>

<a name=/obj/var>
<h2>vars (obj)</h2>

<p>Built-in obj vars:

<dl><dt>obj/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/contents>contents</a>
<dd><a href=#/atom/var/density>density</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/maptext>maptext</a>
<dd><a href=#/atom/var/maptext_width>maptext_width</a>
<dd><a href=#/atom/var/maptext_height>maptext_height</a>
<dd><a href=#/atom/var/maptext_x>maptext_x</a>
<dd><a href=#/atom/var/maptext_y>maptext_y</a>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement</a>
<dd><a href=#/atom/var/loc>loc</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/obj/var/parent_type>parent_type</a>
<dd><a href=#/atom/var/pixel_x>pixel_x</a>
<dd><a href=#/atom/var/pixel_y>pixel_y</a>
<dd><a href=#/atom/var/pixel_w>pixel_w</a>
<dd><a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/atom/var/verbs>verbs</a>
<dd><a href=#/atom/var/vis_contents>vis_contents</a>
<dd><a href=#/atom/var/vis_flags>vis_flags</a>
<dd><a href=#/atom/var/vis_locs>vis_locs</a>
<dd><a href=#/atom/var/x>x</a>
<dd><a href=#/atom/var/y>y</a>
<dd><a href=#/atom/var/z>z</a>
</dl>

<hr>

<a name=/obj/var/parent_type>
<h2>parent_type var (obj)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/var/parent_type>parent_type var</a>
</dl>

<p>The default parent_type of <a href=#/obj>/obj</a> is
<a href=#/atom/movable>/atom/movable</a>.

<hr>

<a name=/operator>
<h2>operators</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/overload>operator overloading</a>
</dl>

<p>Operators are used extensively in DM to compute numerical values.

<p>The DM operators are:

<pre class=dmcode>
<a href="#/operator/()">()</a> <a href="#/operator/path/%2e">.</a> <a href="#/operator/path/:">:</a> <a href="#/operator/path//">/</a> <a href="#/operator/::">::</a>     <span class=DMc>// here . : / are path operators</span>
<a href="#/operator/[]">[]</a> <a href="#/operator/%2e">.</a> <a href="#/operator/:">:</a>
<a href="#/operator/%3f[]">?[]</a> <a href="#/operator/%3f%2e">?.</a> <a href="#/operator/%3f:">?:</a>
<a href="#/operator/~">~</a> <a href="#/operator/!">!</a> <a href="#/operator/-">-</a> <a href="#/operator/++">++</a> <a href="#/operator/--">--</a> <a href="#/operator/*/pointer">*</a> <a href="#/operator/&/pointer">&amp;</a>     <span class=DMc>// unary operators (* and &amp; here are pointer operators)</span>
<a href="#/operator/**">**</a>
<a href="#/operator/*">*</a> <a href="#/operator//">/</a> <a href="#/operator/%">%</a> <a href="#/operator/%25%25">%%</a>
<a href="#/operator/+">+</a> <a href="#/operator/-">-</a>
<a href="#/operator/%3c">&lt;</a> <a href="#/operator/%3c=">&lt;=</a> <a href="#/operator/%3e">&gt;</a> <a href="#/operator/%3e=">&gt;=</a> <a href="#/operator/%3c=%3e">&lt;=&gt;</a>
<a href="#/operator/%3c%3c">&lt;&lt;</a> <a href="#/operator/%3e%3e">&gt;&gt;</a>
<a href="#/operator/==">==</a> <a href="#/operator/!=">!=</a> <a href="#/operator/%3c%3e">&lt;&gt;</a> <a href="#/operator/~=">~=</a> <a href="#/operator/~!">~!</a>
<a href="#/operator/&">&amp;</a>
<a href="#/operator/^">^</a>
<a href="#/operator/|">|</a>
<a href="#/operator/&&">&amp;&amp;</a>
<a href="#/operator/||">||</a>
<a href="#/operator/%3f">?</a>               <span class=DMc>// ternary a ? b : c</span>
<a href="#/operator/=">=</a> <a href="#/operator/+=">+=</a> <a href="#/operator/-=">-=</a> <a href="#/operator/-=">-=</a> <a href="#/operator/*=">*=</a> <a href="#/operator//=">/=</a> <a href="#/operator/%=">%=</a> <a href="#/operator/%25%25=">%%=</a> <a href="#/operator/&=">&amp;=</a> <a href="#/operator/|=">|=</a> <a href="#/operator/^=">^=</a> <a href="#/operator/%3c%3c=">&lt;&lt;=</a> <a href="#/operator/%3e%3e=">&gt;&gt;=</a> <a href="#/operator/:=">:=</a> <a href="#/operator/&&=">&amp;&amp;=</a> <a href="#/operator/||=">||=</a>
<a href="#/operator/in">in</a>
</pre>

<p>Each line has higher order of operations than the next.  Operators within
a line have equal precedence and therefore are processed from left to right
as they occur in an expression. (Assignment, or operate-and-assign, are
processed from right to left.)

<p>Expressions of the form <tt>A #= B</tt> are shorthand for
<tt>A = A # B</tt> except for <tt>~=</tt> and <tt>:=</tt>.

<h3>Example:</h3>
<xmp>
var/N
N = 0                          // 0
N += 1+1*2                     // 3
if(1 + 1 == 2) N = 2           // 2
if(N==2 && 1/2==0.5) N = 0.5   // 0.5
</xmp>

<hr>

<a name=/operator/!>
<h2>! operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&&>&amp;&amp; operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/||>|| operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>!A
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is a false value (zero, an empty string, or null); 0 otherwise.
</dl>

<p>This operator inverts the truthiness of the value after it.

<p>The number 0, an empty string, or null are all false values. Everything
else is true.

<hr>

<a name=/operator/!=>
<h2>!= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/operator/%3c%3e>&lt;&gt; operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator/~=>~= operator</a>
<dd><a href=#/operator/~!>~! operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A != B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is not equal to B; 0 otherwise
</dl>

<p>This is identical to the &lt;&gt; operator.

<p>To check if A and B are not equivalent, use the ~! operator.

<hr>

<a name=/operator/%>
<h2>% operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%=>%= operator</a>
<dd><a href=#/operator/%25%25>%% operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A % B
</dl>

<dl><dt><b>Returns:</b>
<dd>The remainder of A / B, where both A and B are integers.
</dl>

<p><tt>A % B</tt> is read "A modulo B", which stands for the remainder of A
divided by B.

<p>This operator only works with integer values, for legacy reasons. A and
B are truncated to integers before the modulo operation. There are uses for
the integer truncation, but if you don't want that and want the fractional
modulo instead, you can now use the <tt>%%</tt> operator.

<p>If A is a vector, its components are treated as integers; B can also be
a vector in this case, and its components are also treated as integers. The
result is a new vector.

<p>If A is a pixloc, it's treated like a 2D vector and the modulo operation
is done with that instead.

<hr>

<a name=/operator/%25%25>
<h2 byondver=515>%% operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%>% operator</a>
<dd><a href=#/operator/%25%25=>%%= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A %% B
</dl>

<dl><dt><b>Returns:</b>
<dd>The remainder of A / B.
</dl>

<p><tt>A %% B</tt> is read "A modulo B", which stands for the remainder of A
divided by B.

<p>This is a newer version of the <tt>%</tt> operator that supports all
numbers, not just integers. It is equivalent to <tt>B * fract(A / B)</tt>.
The <tt>%</tt> operator does the same thing, but truncates A and B to integers
first.

<p>A can be a vector instead of a number; B can also be a vector in this case.

<p>If A is a pixloc, it's treated like a 2D vector and the modulo operation
is done with that instead.

<hr>

<a name=/operator/%25%25=>
<h2 byondver=515>%%= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%25%25>%% operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A %%= B
</dl>

<p>Set A equal to <tt>A %% B</tt>.  It is shorthand for <tt>A = A %% B</tt>.

<p><tt>A %% B</tt> is read "A modulo B", which stands for the remainder of A divided
by B. This version of the operator works with fractional values for A and B.

<p>If A is a vector, it will be modified by this operation.

<hr>

<a name=/operator/%=>
<h2>%= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%>% operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A %= B
</dl>

<p>Set A equal to <tt>A % B</tt>.  It is shorthand for <tt>A = A % B</tt>.

<p><tt>A % B</tt> is read "A modulo B", which stands for the remainder of A divided
by B. A and B are truncated to integers before the modulo; use <tt>%%=</tt> instead
to work with fractional values.

<p>If A is a vector, it will be modified by this operation.

<hr>

<a name=/operator/&>
<h2>&amp; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&=>&amp;= operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/|>| operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A & B
</dl>

<dl><dt><b>Returns:</b>
<dd>The binary "and" of A and B.
</dl>

<p>A and B must be between 0 and 2**24 - 1, giving an effective
width of 24 bits.

<p>If A and B are lists, the result is a list that contains only items that
were in both lists, in the order of list A.

<p>If A is an icon or /icon datum, it is blended with B which can be either
a color or another icon. This is identical to the + operator. Transparent
areas in either icon will be transparent in the result.

<hr>

<a name=/operator/&/pointer toc="&amp; operator (pointers)">
<h2 byondver=515>&amp; pointer operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*/prefix>* operator (pointers)</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/ispointer>ispointer proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>&A
</dl>

<dl><dt><b>Returns:</b>
<dd>A pointer to the var or list item A.
</dl>

<p class="sidebar didyouknow">This operator is also called the reference operator,
since it creates a reference to a var that you can use elsewhere.)

<p>Sometimes it is desirable to have easy access to a var without knowing its
name, or send multiple items back from a proc. To do this, you can create a
pointer to that var. Then you can use the <tt>*</tt> operator to refer to the
value inside the pointer, or even to assign a value to it.

<h3>Example:</h3>
<xmp>
var/a=3, b=4
var/p = &a
world << *p   // same as world << a
*p = 5    // same as a = 5

var/list/L = list(1, 2, 3)
var/list/pl = &L[2]
*pl *= 10 // same as L[2] *= 10
</xmp>

<p>If you want the compiler to recognize that the item in your pointer var
should be a certain type, you can give the pointer var that same type. Hence
in the example above, <tt>pl</tt> is defined as a <tt>/list</tt>.

<p>You can also call procs this way. You can either wrap the pointer and the
<tt>*</tt> operator in paretheses, like <tt>(*p).MyProc()</tt>, or you can
skip the operator and just call <tt>p.MyProc()</tt> directly.

<p>The same also applies to the list index operator <tt>[]</tt>. If
<tt>p = &list</tt> then you can use <tt>(*p)[index]</tt> or <tt>p[index]</tt>
interchangeably.

<p>Pointers can be made for any of these kinds of vars:

<ul>
  <li>Vars belonging to an object</li>
  <li>Local vars in a proc, including <tt>src</tt>, <tt>usr</tt>, and the <tt>.</tt> var</li>
  <li>Arguments in a proc</li>
  <li>Global vars</li>
  <li>An item in a list, including values in <a href=#/list/associations>associative lists</a></li>
</ul>

<p>One advantage of pointers is that you can use them to alter a value in a
suspended (sleeping) proc.

<p>Note: When <a class=code href=#/proc/spawn>spawn()</a> is used, the current
proc is forked, where one keeps running and a copy is scheduled to run later.
If any pointers to proc vars were created, they belong to the original proc
(the one that keeps running), not to the fork.

<hr>

<a name=/operator/&&>
<h2>&amp;&amp; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/!>! operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/||>|| operator</a>
<dd><a href=#/operator/&&=>&amp;&amp;= operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A && B
</dl>

<dl><dt><b>Returns:</b>
<dd>First false value of either A or B; last true value otherwise
</dl>

<p class="sidebar didyouknow">The only false values in DM are the number 0, an
empty text string, or null. All other values are considered true.

<p>The first false value from left to right completes the evaluation (a
practice known as short-circuiting), meaning that any expressions after the
first false value are skipped. The return value is equal to the last operand
to be evaluated.

<h3>Example:</h3>
<xmp>if(jumping && CanDoubleJump())
    DoubleJump()
</xmp>

<p>In this example, the <tt>CanDoubleJump()</tt> call is not performed if
<tt>jumping</tt> is false.

<p>Although logical short-circuit operators are used most often in blocks such
as <tt>if</tt> or <tt>while</tt>, they can be used elsewhere.

<h3>Example:</h3>
<xmp>
// check if current target is valid, if it exists at all
// but don't call the proc if we don't have to
var/target = current_target && TargetIsValid(current_target)
</xmp>

<hr>

<a name=/operator/&&=>
<h2 byondver=514>&amp;&amp;= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&&>&amp;&amp; operator</a>
<dd><a href=#/operator/||>|| operator</a>
<dd><a href=#/operator/||=>||= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &amp;&amp;= B
</dl>

<dl><dt><b>Returns:</b>
<dd>Value of <tt>(A &amp;&amp; B)</tt> after it has been assigned to A. This
expression can stand by itself; its result does not need to be assigned to
anything else.
</dl>

<p>First A is evaluated. If its value is true, B will be evaluated and
assigned to A. If A is false, B will not be evaluated and A will remain
unchanged.

<p>Note that this is slightly different from <tt>if(A) A = B</tt> if A is
a complex expression such as <tt>list[index++]</tt>, because the expression
is only evaluated once.

<p>This operator cannot be overloaded.

<hr>

<a name=/operator/&=>
<h2>&amp;= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&>&amp; operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/|=>|= operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &= B
</dl>

<p>Set A equal to A & B.  It is shorthand for A = A & B.

<p>This is commonly used to turn off certain bitfields in a word.

<h3>Example:</h3>
<xmp>
usr.sight &= ~BLIND // turn off the blind bit
</xmp>

<p>If A and B are lists, items in A that are not in B are removed.

<p>If A is an /icon or /matrix datum, the datum will be changed rather than
creating a new one and re-assigning it to A.

<hr>

<a name=/operator/%3e>
<h2>&gt; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e=>&gt;= operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/operator/%3c=%3e>&lt;=&gt; operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &gt; B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is greater than B; 0 otherwise.
</dl>

<p>If A and B are text strings, a case sensitive comparison is performed
(like sorttextEx()).

<hr>

<a name=/operator/%3e%3e>
<h2>&gt;&gt; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e%3e/input>&gt;&gt; input operator</a>
<dd><a href=#/savefile/operator/%3e%3e>&gt;&gt; operator (savefile)</a>
<dd><a href=#/operator/%3e%3e/shift>&gt;&gt; shift operator</a>
</dl>

<hr>

<a name=/operator/%3e%3e/input>
<h2>&gt;&gt; input operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3e%3e>&gt;&gt; operator (savefile)</a>
<dd><a href=#/proc/file>file proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>F &gt;&gt; Var
</dl>

<p>Cause input to be read from a file into a variable.  The file may be a
savefile or a file object corresponding to a text file.

<hr>

<a name=/operator/%3e%3e/shift>
<h2>&gt;&gt; shift operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e%3e=>&gt;&gt;= operator</a>
<dd><a href=#/operator/%3c%3c/shift>&lt;&lt; shift operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &gt;&gt; B
</dl>

<dl><dt><b>Returns:</b>
<dd>The bits of A shifted right B times.
</dl>

<p>A and B must be between 0 and 2**24 - 1, giving an effective
width of 24 bits.

<p>Bits shifted below the 24 low bits are lost.

<hr>

<a name=/operator/%3e%3e=>
<h2>&gt;&gt;= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e%3e/shift>&gt;&gt; shift operator</a>
<dd><a href=#/operator/%3c%3c=>&lt;&lt;= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &gt;&gt;= B
</dl>

<p>Set A equal to A >> B.  It is shorthand for A = A >> B.

<hr>

<a name=/operator/%3e=>
<h2>&gt;= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/operator/%3c=%3e>&lt;=&gt; operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &gt;= B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is greater or equal to B; 0 otherwise.
</dl>

<p>If A and B are text strings, a case sensitive comparison is performed
(like sorttextEx()).

<hr>

<a name=/operator/%3c>
<h2>&lt; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c=>&lt;= operator</a>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator/%3c=%3e>&lt;=&gt; operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt; B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is less than B; 0 otherwise.
</dl>

<p>If A and B are text strings, a case sensitive comparison is performed
(like sorttextEx()).

<hr>

<a name=/operator/%3c%3e>
<h2>&lt;&gt; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/!=>!= operator</a>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt;&gt; B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is not equal to B; 0 otherwise
</dl>

<p>This is identical to the != operator.

<hr>

<a name=/operator/%3c%3c>
<h2>&lt;&lt; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3c%3c>&lt;&lt; operator (savefile)</a>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/operator/%3c%3c/shift>&lt;&lt; shift operator</a>
</dl>

<hr>

<a name=/operator/%3c%3c/output>
<h2>&lt;&lt; output operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3c%3c>&lt;&lt; operator (savefile)</a>
<dd><a href=#/proc/output>output proc</a>
<dd><a href=#/proc/browse>browse proc</a>
<dd><a href=#/proc/browse_rsc>browse_rsc proc</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/ftp>ftp proc</a>
<dd><a href=#/proc/image>image proc</a>
<dd><a href=#/proc/link>link proc</a>
<dd><a href=#/proc/load_resource>load_resource proc</a>
<dd><a href=#/proc/run>run proc</a>
<dd><a href=#/proc/sound>sound proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt;&lt; B
</dl>

<p>Cause the value B to be output to any players connected to mobs specified
in A.

<p>B may be an image, sound, or text.  A may be a mob, the whole world, or
any list containing mobs.

<h3>Example:</h3>
<xmp>
usr << "Hi, [usr.name]"
view() << "To all in view"
world << "Hi everybody!"

usr << 'giggle.wav'
view() << image(/obj/Fireball,usr)
</xmp>

<hr>

<a name=/operator/%3c%3c/shift>
<h2>&lt;&lt; shift operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e%3e>&gt;&gt; operator</a>
<dd><a href=#/operator/%3c%3c=>&lt;&lt;= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt;&lt; B
</dl>

<dl><dt><b>Returns:</b>
<dd>The bits of A shifted left B times.
</dl>

<p>A and B must be between 0 and 2**24 - 1, giving an effective
width of 24 bits.

<p>Bits shifted beyond the 24 low bits are lost.

<hr>

<a name=/operator/%3c%3c=>
<h2>&lt;&lt;= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e%3e=>&gt;&gt;= operator</a>
<dd><a href=#/operator/%3c%3c/shift>&lt;&lt; shift operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt;&lt;= B
</dl>

<p>Set A equal to A << B.  It is shorthand for A = A << B.

<hr>

<a name=/operator/%3c=>
<h2>&lt;= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/operator/%3c=%3e>&lt;=&gt; operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt;= B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A is less than or equal to B; 0 otherwise.
</dl>

<p>If A and B are text strings, a case sensitive comparison is performed
(like sorttextEx()).

<hr>

<a name=/operator/%3c=%3e>
<h2 byondver=516>&lt;=&gt; operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c=>&lt;= operator</a>
<dd><a href=#/operator/%3e=>&gt;= operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A &lt;=&gt; B
</dl>

<dl><dt><b>Returns:</b>
<dd>-1 if A is less B; 1 if A is greater than B; 0 otherwise.
</dl>

<p>If A and B are text strings, a case sensitive comparison is performed
(like sorttextEx()).

<p>If either value is the special number NaN (not a number), the result is
currently 0 but should be considered ambiguous.

<hr>

<a name=/operator/()>
<h2>() operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc>procs</a>
<dd><a href=#/verb>verbs</a>
</dl>

<p>Parentheses may be used in expressions to change the order of operations.
Whatever is inside a pair of parentheses will be evaluated first.

<h3>Example:</h3>
<xmp>
usr << 2 + 3 * 2     // 8
usr << (2 + 3) * 2   // 10
</xmp>

<p>They are also used for calling procs or verbs, by placing the parentheses
after the name of the proc. Any arguments that will be sent to the proc go
inside the parentheses; multiple arguments are separated by commas, or the
parentheses can be left empty if no arguments are sent. For the same reason,
parentheses are also used when defining a new proc or verb and the arguments
(if any) that will be used.

<h3>Example:</h3>
<xmp>
// Defining a new proc
proc/Distance(x, y)
    // return straight-line distance from 0,0
    return sqrt(x*x + y*y)
</xmp>

<hr>

<a name=/operator/*>
<h2>* operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*=>*= operator</a>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator//>/ operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A * B
</dl>

<dl><dt><b>Returns:</b>
<dd>The product of A and B.
</dl>

<p>Multiplies A and B. The result of the operation depends on the types of values
being multiplied, mostly on A.

<table>
<tr><th>A type</th><th>B type</th><th>Result</th></tr>
<tr><td>num or null (0)</td><td>num or null (0)</td><td>Numeric product</td></tr>
<tr><td>icon or /icon</td><td>icon or num or color</td><td>New blended icon via ICON_MULTIPLY</td></tr>
<tr><td rowspan=3>matrix</td><td>matrix</td><td>New matrix, product of A and B</td></tr>
<tr><td>num</td><td>New matrix scaling A by B</td></tr>
<tr><td>vector</td><td>New matrix scaling A by B.x and B.y</td></tr>
<tr><td rowspan=3>vector</td><td>vector</td><td>New vector with components multiplied together</td></tr>
<tr><td>matrix</td><td>New vector with 2D transformation applied</td></tr>
<tr><td>num</td><td>New vector scaling A by B</td></tr>
</table>

<hr>

<a name=/operator/*/pointer toc="* operator (pointers)">
<h2 byondver=515>* pointer operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&/pointer>&amp; pointer operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/ispointer>ispointer proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>*A
</dl>

<dl><dt><b>Returns:</b>
<dd>The value pointed at by a pointer stored in A
</dl>

<p class="sidebar didyouknow">This operator is also called the dereference
operator, since it takes a pointer reference and gives you the value within.)

<p>When using the <tt>&amp;</tt> operator to get a reference pointer, you can
access the value it points to with this version of the <tt>*</tt> operator.
This can also be used on the left-hand side of assignment operations, for
instance <tt>*A = B</tt> or <tt>*X += Y</tt>, to store the result in the place
the pointer indicates.

<h3>Example:</h3>
<xmp>
atom/proc/PixelPos(px, py)  // get an exact step position
    *px = (x-1) * 32    // this code assumes a 32x32 icon size
    *py = (y-1) * 32

atom/movable/PixelPos(px, py)  // get an exact step position
    ..()
    *px += step_x   // this code assumes a 32x32 icon size
    *py += step_y

mob/verb/WhereAmI()
    var/X, Y
    PixelPos(&X, &Y)
    usr << "You are at [X],[Y] on level [z]"
</xmp>

<p>Note: If you try to read to or write from a pointer reference that is
no longer valid, such as to a var inside a proc that has ended, the read or
write will fail silently; reading will return a null value. (An exception is
pointers to list items. If the index is out of bounds, you will get the
expected error.)

<hr>

<a name=/operator/**>
<h2>** operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/log>log proc</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A ** B
</dl>

<dl><dt><b>Returns:</b>
<dd>A to the power of B.
</dl>

<h3>Example:</h3>
<xmp>
usr << 2 ** 3 // outputs 8
</xmp>

<hr>

<a name=/operator/*=>
<h2>*= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*>* operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator//=>/= operator</a>
<dd><a href=#/operator/=>= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A *= B
</dl>

<p>Set A equal to A * B.  It is shorthand for A = A * B.

<p>If A is an /icon, /matrix, or vector, it will be changed rather than
creating a new value and re-assigning it to A.

<hr>

<a name=/operator/+>
<h2>+ operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*>* operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator//>/ operator</a>
<dd><a href=#/list/proc/Add>Add proc (list)</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/vector>vector</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A + B
</dl>

<dl><dt><b>Returns:</b>
<dd>The sum of A and B.
</dl>

<p>Adds A and B. The result of the operation depends on the types of values
being added, mostly on A.

<table>
<tr><th>A type</th><th>B type</th><th>Result</th></tr>
<tr><td>num or null (0)</td><td>num or null (0)</td><td>Numeric sum</td></tr>
<tr><td>text</td><td>text</td><td>New string concatenating A and B, in order</td></tr>
<tr><td>icon or /icon</td><td>icon or color</td><td>New blended icon via ICON_ADD</td></tr>
<tr><td>matrix</td><td>matrix</td><td>New matrix with components added together</td></tr>
<tr><td>turf or pixloc</td><td>vector</td><td>New pixloc offset by B</td></tr>
<tr><td rowspan=2>vector</td><td>vector</td><td>New vector with components added together</td></tr>
<tr><td>turf or pixloc</td><td>New pixloc offset by A</td></tr>
</table>

<hr>

<a name=/operator/++>
<h2>++ operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/-->-- operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>++A   // pre-increment
<dd>A++   // post-increment
</dl>

<p>The pre-increment has the value (A+1) and the effect of adding 1 to A.

<p>The post-increment has the value (A) and has the effect of adding 1 to A.

<h3>Example:</h3>
<xmp>
var/A = 0
world << "A++ = [A++]" // outputs "A++ = 0"
world << "++A = [++A]" // outputs "++A = 2"
</xmp>

<hr>

<a name=/operator/+=>
<h2>+= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*=>*= operator</a>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator//=>/= operator</a>
<dd><a href=#/operator/=>= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A += B
</dl>

<p>Set A equal to A + B.  It is shorthand for A = A + B.

<p>If A is an /icon, /matrix, pixloc, or vector, it will be changed rather
than creating a new value and re-assigning it to A.

<hr>

<a name=/operator/->
<h2>- operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*>* operator</a>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator//>/ operator</a>
<dd><a href=#/list/proc/Remove>Remove proc (list)</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/vector>vector</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A - B
<dd>-B
</dl>

<dl><dt><b>Returns:</b>
<dd>The subtraction of B from A.
</dl>

<p>Subtracts B from A. The result of the operation depends on the types of values
being subtracted, mostly on A.

<table>
<tr><th>A type</th><th>B type</th><th>Result</th></tr>
<tr><td>num or null (0)</td><td>num or null (0)</td><td>Numeric subtraction</td></tr>
<tr><td>icon or /icon</td><td>icon or color</td><td>New blended icon via ICON_SUBTRACT</td></tr>
<tr><td>matrix</td><td>matrix</td><td>New matrix with components subtracted</td></tr>
<tr><td>turf or pixloc</td><td>vector</td><td>New pixloc offset by -B</td></tr>
<tr><td>pixloc</td><td>turf or pixloc</td><td>New vector from A to B</td></tr>
<tr><td>vector</td><td>vector</td><td>New vector with components subtracted</td></tr>
</table>

<hr>

<a name=/operator/-->
<h2>-- operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/++>++ operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>--A   // pre-decrement
<dd>A--   // post-decrement
</dl>

<p>The pre-decrement has the value (A-1) and the effect of subtracting 1
from A.

<p>The post-decrement has the value (A) and has the effect of subtracting 1
from A.

<h3>Example:</h3>
<xmp>
var/A = 0
world << "A-- = [A--]" // outputs "A = 0"
world << "--A = [--A]" // outputs "A = -2"
</xmp>

<hr>

<a name=/operator/-=>
<h2>-= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*=>*= operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator//=>/= operator</a>
<dd><a href=#/operator/=>= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A -= B
</dl>

<p>Set A equal to A - B.  It is shorthand for A = A - B.

<p>If A is an /icon, /matrix, pixloc, or vector, it will be changed rather
than creating a new value and re-assigning it to A.

<hr>

<a name=/operator//>
<h2>/ operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*>* operator</a>
<dd><a href=#/operator/+>+ operator</a>
<dd><a href=#/operator/->- operator</a>
<dd><a href=#/operator/path//>/ path operator</a>
<dd><a href=#/operator//=>/= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A / B
</dl>

<dl><dt><b>Returns:</b>
<dd>A divided by B.
</dl>

<p>Divides A and B. The result of the operation depends on the types of values
being multiplied, mostly on A.

<table>
<tr><th>A type</th><th>B type</th><th>Result</th></tr>
<tr><td>num or null (0)</td><td>num or null (0)</td><td>Numeric division; crashes if B is equivalent to 0</td></tr>
<tr><td>icon or /icon</td><td>num or color</td><td>New icon dividing RGB components by color</td></tr>
<tr><td rowspan=3>matrix</td><td>matrix</td><td>New matrix, product of A and the inverse of B</td></tr>
<tr><td>num</td><td>New matrix scaling A by 1/B</td></tr>
<tr><td>vector</td><td>New matrix scaling A by 1/B.x and 1/B.y</td></tr>
<tr><td>pixloc</td><td>num or vector</td><td>Creates a 2D vector from pixloc's x,y and divides that by the rules below</td></tr>
<tr><td>vector</td><td>2D vector dividing x,y components by the divisor's x,y</td></tr>
<tr><td rowspan=3>vector</td><td>vector</td><td>New vector with components divided</td></tr>
<tr><td>matrix</td><td>New vector with 2D transformation applied in reverse</td></tr>
<tr><td>num</td><td>New vector scaling A by 1/B</td></tr>
</table>

<hr>

<a name=/operator//=>
<h2>/= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*=>*= operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator//>/ operator</a>
<dd><a href=#/operator/=>= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A /= B
</dl>

<p>Set A equal to A / B.  It is shorthand for A = A / B.

<p>If A is an /icon, /matrix, or vector, it will be changed rather than
creating a new value and re-assigning it to A.

<hr>

<a name=/operator/:>
<h2>: operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%2e>. operator</a>
<dd><a href=#/operator/%3f%2e>?. operator</a>
<dd><a href=#/operator/%3f:>?: operator</a>
<dd><a href=#/operator/path/:>: path operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<p>This is the runtime search operator.  It is used to access a property (var
or proc) of a var that is not explicitly prototyped.  If the variable doesn't
have the specified variable or proc, a runtime error occurs.

<h3>Example:</h3>
<xmp>
var/M
M = usr
M:name = "futz"  // access a mob property from a non-mob var
</xmp>

<p>The <tt>.</tt> operator behaves the same way, but it checks at compile time
whether the property is available.  If the var is assigned a value that isn't
the correct type and doesn't have this property, a runtime error will still
occur.

<p class=tip>Note: You should prefer the <tt>.</tt> operator in most
situations, because it's better to catch a problem in the compiler instead of
at runtime.

<hr>

<a name=/operator/::>
<h2 byondver=515>:: operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/path/%2e>. path operator</a>
<dd><a href=#/operator/path//>/ path operator</a>
<dd><a href=#/operator/path/:>: path operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/proc/call>call proc</a>
<dd><a href=#/proc/initial>initial proc</a>
<dd><a href=#/proc/nameof>nameof proc</a>
<dd><a href=#/proc/istype>istype proc</a>
<dd><a href=#/proc/istype>astype proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>::A
<dd>::A()
<dd>A::B
<dd>A::B() (proc reference, not a call; see below)
</dl>

<p>This is the scope operator. It has multiple uses.

<h3>Global var and proc disambiguation</h3>

<p><tt>::A</tt> is a shorthand for <tt>global.A</tt>, so if you have a local
or object var with the same name this disambiguates to the global var. The
same is true of <tt>:A()</tt> which will call <tt>global.A()</tt> with the
arguments you give it.

<h3>Static var disambiguation</h3>

<p>If <tt>A</tt> is a constant type and <tt>B</tt> is a static var,
<tt>A::B</tt> refers to the static var. If you have a local var with the same
name, this disambiguates to the static var. This is also the only case where
<tt>A::B</tt> can be used as an Lvalue (modifiable expression).

<h3>Initial value</h3>

<p>The most common use of the scope operator is to get the initial value for a
var. If <tt>A::B</tt> isn't a static var, then it's equivalent to
<tt>initial(A:B)</tt>. If <tt>A</tt> is a constant type path, the compiler
will go even further by compiling this expression as the actual initial value
instead of doing a runtime lookup.

<p>This can also be used when defining a var that overrides its parent, by
using the <tt>parent_type</tt> keyword for <tt>A</tt>. Multiple
<tt>parent_type</tt> levels can be chained together. Similarly, in a static var
definition, <tt>type</tt> can be used for <tt>A</tt> the same way.

<h3>Example:</h3>
<xmp>
thing
    var/price = 60
    better
        price = parent_type::price + 40
</xmp>

<h3>Proc reference</h3>

<p>If <tt>B</tt> is a proc, then <tt>A::B()</tt> is a reference to the proc
for type <tt>A</tt>, which can be used in <tt>call()</tt>. In this case the
parentheses are just a cue for the compiler to know this is a proc reference;
it doesn't actually call the proc. Currently, <tt>A</tt> must be a constant
type for this usage.

<h3>Example:</h3>
<xmp>
thing
    proc/DoSomething()
        world << "Did a thing"
    better
        DoSomething()
            world << "Did a better thing"

proc/Downgrade()
    var/thing/better/T = new

    // will print "Did a better thing" because T is /thing/better
    T.DoSomething()

    // deliberately calls /thing's original version; will print "Did a thing"
    call(T, /thing::DoSomething())()
</xmp>

<hr>

<a name=/operator/:=>
<h2 byondver=514>:= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/=>= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A := B
</dl>

<p>This is the "assign into" operator. The value of B is evaluated, then A. If
A is a datum that has an <tt>operator:=</tt> proc overloading this operator,
then that proc will be called with A as its src and B as its only argument.
The return value of the proc (which defaults to its src, the old value of A)
is assigned into the var that holds A.

<p>If A was not a datum, then B is assigned into the var as if this were an
ordinary A = B assignment.

<p>A common use of this operator might be to copy another datum. This is
basically just "syntactic sugar" to make certain datums easier to work with,
and is intended mainly for situations where you've overloaded the operator.

<hr>

<a name=/operator/=>
<h2>= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*=>*= operator</a>
<dd><a href=#/operator/+=>+= operator</a>
<dd><a href=#/operator/-=>-= operator</a>
<dd><a href=#/operator//=>/= operator</a>
<dd><a href=#/operator/%=>%= operator</a>
<dd><a href=#/operator/|=>|= operator</a>
<dd><a href=#/operator/&=>&amp;= operator</a>
<dd><a href=#/operator/^=>^= operator</a>
<dd><a href=#/operator/%3c%3c=>&lt;&lt;= operator</a>
<dd><a href=#/operator/%3e%3e=>&gt;&gt;= operator</a>
<dd><a href=#/operator/:=>:= operator</a>
<dd><a href=#/operator/||=>||= operator</a>
<dd><a href=#/operator/&&=>&amp;&amp;= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A = B
</dl>

<p>Set A equal to B.

<p>Note that this is not the same as the equality test (==), which tests if
A is equal to B.

<p>All assignment operators, including calculate-and-assign (such as the +=
operator), can be chained together, and they are evaluated in right-to-left
order.  Therefore, a = b += c is a legal statement.  It is equivalent to
adding b and c, storing the result in b, then setting a to use the new value
of b.  (a = b) += c will, on the other hand, set a to equal b, then add c to
a and store the result in a; b is never changed.

<hr>

<a name=/operator/==>
<h2>== operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/!=>!= operator</a>
<dd><a href=#/operator/%3e=>&gt;= operator</a>
<dd><a href=#/operator/%3c=>&lt;= operator</a>
<dd><a href=#/operator/%3c=%3e>&lt;=&gt; operator</a>
<dd><a href=#/operator/~=>~= operator</a>
<dd><a href=#/operator/~!>~! operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A == B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A and B are equal; 0 otherwise
</dl>

<p>Note that this is not the same as the assignment operator (=), which sets
A equal to B.

<p>To check if A and B are equivalent, use the ~= operator.

<hr>

<a name=/operator/%2e toc=".">
<h2>. operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/:>: operator</a>
<dd><a href=#/operator/%3f%2e>?. operator</a>
<dd><a href=#/operator/%3f:>?: operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<p>This is used to access the procs and vars of a prototyped object.  The
variable need not actually contain a value with the specified type, but must
at least be a type with the specified variable or a runtime error will
occur, causing the proc to crash.

<h3>Example:</h3>
<xmp>
var/mob/M = new
M.name = "futz"  // assign 'name' mob var
M.Move(0)        // call 'Move()' mob proc
</xmp>

<p>This is the same as the <tt>:</tt> operator, except that the compiler
checks to see if the var type has this property, and throws a compiler error
if not. It is good practice to use the <tt>.</tt> operator whenever possible,
so more potential problems can be caught during compilation.

<p>If <tt>.</tt> follows a proc call, a list lookup, or a complex expression
where the type can't be known, it will act like <tt>:</tt> instead.

<hr>

<a name=/operator/%3f toc="?">
<h2>? operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Expr ? TrueExpr : FalseExpr
</dl>

<p>If Expr is true, this evaluates and returns TrueExpr.  Otherwise, it
evaluates and returns FalseExpr.

<hr>

<a name=/operator/%3f%2e toc="?.">
<h2 byondver=512>?. operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%2e>. operator</a>
<dd><a href=#/operator/:>: operator</a>
<dd><a href=#/operator/%3f:>?: operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<p>This is used to access the procs and vars of a prototyped object.  It is
just like the . operator, but if the object is null, the access does not
happen and there will be no runtime error.  (A runtime error can still happen
if the object is valid but is a different type that doesn't have the property
available.)

<p>When used in an expression to read a value or call a proc from a null
object, the result of the expression is null.  When used for assignment,
the assignment will not happen, and the expression being assigned will not be
evaluated, if the object is null.

<h3>Example:</h3>
<xmp>
var/mob/M           // M is null by default
M?.name = "futz"    // assignment is skipped because M is null
world << M?.name    // M?.name reads as null because M is null
M?.Move(loc)        // call Move() mob proc; again nothing happens

M = new
M?.name = "futz"    // assignment is made because M is valid now
world << M?.name    // outputs "futz"
M?.Move(loc)        // call Move() mob proc for M
</xmp>

<p>When reading <code>A?.B</code>, it's roughly equivalent to <code>A &amp;&amp; A.B</code>
except that <code>A</code> is only evalulated once, even if it's a complex
expression like a proc call. Making an assignment to <code>A?.B</code> is
the same: A is evalulated only once, and if it's not null then an assignment
is made to its B var.

<p>For a version of this operator that doesn't check at compile time if the
property is available, use the ?: operator instead.

<p>If ?. is used after a proc call, a list lookup, or a complex expression
where the type can't be known, it will act like ?: instead.

<hr>

<a name=/operator/%3f: toc="?:">
<h2 byondver=512>?: operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%2e>. operator</a>
<dd><a href=#/operator/:>: operator</a>
<dd><a href=#/operator/%3f%2e>?. operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<p>This is used to access the procs and vars of an object.  It is just like
the : operator, but if the object is null, the access does not happen and
there will be no runtime error.  (A runtime error can still happen if the
object is valid but the property is not available.)

<p>When used in an expression to read a value or call a proc from a null
object, the result of the expression is null.  When used for assignment,
the assignment will not happen, and the expression being assigned will not be
evaluated, if the object is null.

<h3>Example:</h3>
<xmp>
var/mob/M           // M is null by default
M?:name = "futz"    // assignment is skipped because M is null
world << M?:name    // M?:name reads as null because M is null
M?:Move(loc)        // call Move() mob proc; again nothing happens

M = new
M?:name = "futz"    // assignment is made because M is valid now
world << M?:name    // outputs "futz"
M?:Move(loc)        // call Move() mob proc for M
</xmp>

<p>When reading <code>A?:B</code>, it's roughly equivalent to <code>A &amp;&amp; A:B</code>
except that <code>A</code> is only evalulated once, even if it's a complex
expression like a proc call.  Making an assignment to <code>A?:B</code> is
the same: A is evalulated only once, and if it's not null then an assignment
is made to its B var.

<p>This is identical to the ?. operator, except that ?. will check at compile
time if the property is valid for the object type (if known).  For this
reason ?. is usually safer.

<hr>

<a name=/operator/%3f[]>
<h2 byondver=514>?[] operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/[]>[] operator</a>
<dd><a href=#/operator/%3f%2e>?. operator</a>
<dd><a href=#/operator/%3f:>?: operator</a>
</dl>

<p>This is the null-conditional list index operator. It is used to access an
element of a list, IF that list is not null. If the list is null, then the
access will not happen and the index expression inside the brackets won't be
evaluated. If this is the left-hand side of an assignment operator, such as
<tt>list?[index] = rhs</tt>, then <tt>rhs</tt> is also not evaluated when the
list is null.

<h3>Example:</h3>
<xmp>
var/list/good = list(5,6,7)
var/list/bad
var/idx = 1

// prints null because bad is null; idx is not changed
world << json_encode(bad?[idx++])
// prints 5 because good is not null, and good[1] is 5; idx changes to 2
world << json_encode(good?[1])

idx = 1 // reset idx

// bad is null, so idx does not advance and myproc() is not called
bad?[idx++] = myproc()
// good is not null, so idx advances after read, and myproc() is called
good?[idx++] = myproc()
</xmp>

<p>This operator cannot be overloaded, but overloads to the <tt>[]</tt>
operator will apply to this operator as well.

<p>

<hr>

<a name=/operator/[]>
<h2>[] operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/%3f[]>?[] operator</a>
</dl>

<p>This is used to access an element of a list.

<h3>Example:</h3>
<xmp>
var/L[2]  // declares list of size 2
L[1] = 10 // assign first element
</xmp>

<p>If you want to use a datum like a list, you can <a href=#/operator/overload>overload</a>
the operator by defining an <tt>operator[]</tt> proc for reading a value, and
<tt>operator[]=</tt> for writing a value. Those overloads also apply if you use the
null-conditional <tt>?[]</tt> operator.

<hr>

<a name=/operator/^>
<h2>^ operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/^=>^= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A ^ B
</dl>

<dl><dt><b>Returns:</b>
<dd>The binary "xor" of A and B.
</dl>

<p>A and B must be between 0 and 2**24 - 1, giving an effective
width of 24 bits.

<p>If A and B are lists, the result is a list containing items that are in
either list but not both. list(1,2) ^ list(2,3) is equivalent to list(1,3).
The items found only in A come first in the result, followed by any items
found only in B.

<hr>

<a name=/operator/^=>
<h2>^= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/^>^ operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A ^= B
</dl>

<p>Set A equal to A ^ B.  It is shorthand for A = A ^ B.

<p>If A and B are lists, any items that are found in both lists are removed
from A, and then any items found only in B are added to A.

<hr>

<a name=/operator/in>
<h2>in operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/!>! operator</a>
<dd><a href=#/proc/locate>locate proc</a>
<dd><a href=#/proc/input>input proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A in List
</dl>
<dl><dt><b>Returns:</b>
<dt><b> 1 if A exists in List; 0 if not</b>
</dl>

<p>This is a relatively safe way to check if an item is in a list, because
the value of <tt>List</tt> is allowed to be a non-list value, such as null.
Compare to <tt>List.Find(A)</tt> which will fail if <tt>List</tt> is not an
actual list.

<p><tt>List</tt> can also be an atom, in which case <tt>A in List</tt> is
equivalent to <tt>A in List.contents</tt>.

<div class=note>
<p>The <tt>in</tt> operator has a lower precedence than
<tt>!</tt>, which can be a point of confusion. If you want to check if
something is <i>not</i> in a list, it's a common mistake to try <tt>if(!A in
List)</tt>. Unfortunately the <tt>!A</tt> part is evaluated first and becomes
0 or 1, so you're really asking if 0 or 1 is in the list. The correct way to
check if something is not in a list is to wrap the <tt>in</tt> operator and
its operands with parentheses, as in <tt>if(!(A in List))</tt>.

<p>Similarly, the assignment operators also have higher precedence than
<tt>in</tt>, so <tt>has_thing = thing in src</tt> will not be interpreted as
you might expect. Again the solution is to use parentheses, e.g. <tt>has_thing
= (thing in src)</tt>.</div>

<p>The <tt>in</tt> operator is also a modifier for some procs such as
<a class=code href=#/proc/locate>locate()</a> and
<a class=code href=#/proc/input>input()</a>.

<p class=performance>Note: For <a href=#/list/associations>associative
lists</a> there's a faster way to see if an item is in that list. The
lookup of <tt>List[A]</tt> in an associative list is relatively fast, so if
the associated value is always expected to be true (not null, 0, or an empty
string), you can use <tt>List[A]</tt> instead of <tt>A in List</tt> in those
situations.

<hr>

<a name=/operator/path>
<h2>path operators</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/path/%2e>. path operator</a>
<dd><a href=#/operator/path//>/ path operator</a>
<dd><a href=#/operator/path/:>: path operator</a>
<dd><a href=#/proc>procs</a>
<dd><a href=#/var>vars</a>
</dl>

<p>A "path" in DM is a constant value that identifies a particular definition
in the code tree (i.e. an object, procedure, or variable definition).  An
example of this is the default mob type for new players <code>/mob</code>.

<p>Paths are used in two contexts.  One is to "get to" a particular point in
the code tree in order to modify the definition.  The other is to reference a
particular definition made elsewhere in the code tree.  The syntax of a path
is similar in both cases.

<p>When you are making a definition, you simply put the path at the beginning
of a line like this:

<xmp>
obj/clothes/gloves
</xmp>

<p>That automatically creates that path in the code tree if it does not
already exist.  When starting at the beginning of the line (no indentation)
there is no need to begin the path with '/', but that is perfectly acceptable.

<p>When making definitions, DM equates the path separator '/' with
indentation, so the above example is really just a more compact way of
writing:

<xmp>
obj
   clothing
      gloves
</xmp>

<p>One generally uses indentation when you have several things to define with
a common parent path:

<xmp>
obj
   clothing
      gloves
      sandals
</xmp>

<p>An important element of DM is that you can get to the same path in the
code tree from multiple places in the source code.  For example, given the
above definition of <code>gloves</code> and <code>sandals</code>, you could
modify a property of one of them from somewhere else using any path syntax you
like:

<xmp>
obj/clothing/sandals
   name = "Winged Sandals"
</xmp>

<p>While that was not a useful thing to do in this case, it can be a very
powerful tool when organizing source code in large projects.  Also note that
the use of "/" can save your source code from getting too deeply indented,
which may sound mundane, but which is quite important!

<p>The above examples used paths to make definitions.  The other time when you
use paths is when you need to refer to a particular definition.  Creation of
an object is one example:

<xmp>
mob/Login()
   if(length(contents) == 0) //poor fellow has nothing
      //create sandals in his contents list
      new /obj/clothing/sandals (src)
   return ..()
</xmp>

<p>Another common use of paths is to declare the data type of a variable.  In
DM, variable types do not affect what type of data the variable may
contain&mdash;variables that you define may contain any type of value.
Instead, the variable type affects what properties of the data you can attempt
to access.

<p>The following example defines variables for clothing that is occupying
various positions on the body.

<xmp>
mob
   var/clothing
      feet
      hands
      torso
</xmp>

<p>Since there were several variables of the same type, they were grouped
under <code>var/clothing</code>.  It can be done any number of ways, depending
on the situation.  The same path syntax applies to variable definitions as
it does to anything else.  This example produces the same effect:

<xmp>
mob/var/clothing/feet
mob/var
   clothing
      hands
      torso
</xmp>

<h3>Provisos</h3>

<p>Just do not make a mistake like the following:

<xmp>
mob/var
   /clothing/feet
</xmp>

<p>Beginning a path with '/' effectively ignores whatever indentation may
precede it.  That is why it is called an <em>absolute</em> path.  The above
example would therefore be the same as the following, which is not what you
want:

<xmp>
mob/var        //empty variable definition
clothing/feet  //definition of object type /clothing/feet
</xmp>

<p>On a related note, parameter definitions in procedures should not begin
with a "/".

<xmp>
mob/Move(atom/Dest)     //correct
   src << "Moving to [Dest.x],[Dest.y]."
   return ..()

mob/Move(var/atom/Dest) //ok
mob/Move(/atom/Dest)    //WRONG
</xmp>

<p>Essentially, "var/" is prepended to each entry in the parameter list.

<hr>

<a name=/operator/path//>
<h2>/ path operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/path/%2e>. path operator</a>
<dd><a href=#/operator/path/:>: path operator</a>
</dl>

<p>This is used to delimit paths in the DM code tree.  A path beginning with
'/' is an absolute path (which is independent of where in the code it is
used).  Otherwise, a path is relative, meaning it starts from the current
position in the code.

<p>The following example uses a path in the code tree to define the type of
object to create when leaving a corpse behind.

<h3>Example:</h3>
<xmp>
obj
   var
      poison
      nutrition

   corpse
      frog
         nutrition = 10
      spider
         nutrition = 6
         poison = 5
mob
   var
      corpse = /obj/corpse
   Die()
      new corpse(src.loc) //create the corpse here
      del src

   spider
      corpse = /obj/corpse/spider
   frog
      corpse = /obj/corpse/frog
</xmp>

<hr>

<a name=/operator/path/:>
<h2>: path operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/path/%2e>. path operator</a>
<dd><a href=#/operator/path//>/ path operator</a>
</dl>

<p>The colon operator may be used as a short-cut when specifying a path in the
DM code tree.  Instead of specifying the full path, you can insert a colon and
the compiler will search down in the tree with the node you specify.  This is
known as a "downward" search.  You should only use it when the target node is
unique.

<p>The following example demonstrates the principle but it obviously doesn't
save much typing!

<h3>Example:</h3>
<xmp>
world
   mob = :player  //short-cut to /mob/player

mob/player
   Login()
      src << "Welcome, [name]."
</xmp>

<hr>

<a name=/operator/path/%2e toc=".">
<h2>. path operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/path//>/ path operator</a>
<dd><a href=#/operator/path/:>: path operator</a>
</dl>

<p>The dot operator may be used as a short-cut when specifying a path in the
DM code tree.  Instead of specifying the full path, you can start a path with
a dot and the compiler will search up in the code tree for the following node.
This is known as a relative path with an "upward" search.

<p>Here are the beginnings of a text MUD that allows you to walk around
between rooms using the arrow keys.  The links between rooms are created in
this example by referencing the object type of the destination room.  Since
there could potentially be a lot of rooms, they are grouped into sub-classes,
and to avoid lengthy type paths such as /area/Village/Square, they are
referenced using a relative path from the point of reference.

<h3>Example:</h3>
<xmp>
area
   var/area
      north_exit
      south_exit
      east_exit
      west_exit

   Entered(O)
      O << name
      return ..()

   Castle
      Main_Gate
         north_exit = .Castle_Entryway
         south_exit = .Moat_Bridge
      Castle_Entryway
         south_exit = .Main_Gate
      Moat_Bridge
         north_exit = .Main_Gate
         south_exit = .Village/Guard_Post
   Village
      Guard_Post
         north_exit = .Castle/Moat_Bridge
         south_exit = .Square
      Square
         north_exit = .Guard_Post

//handle movement
client/Move(Dest,Dir)
   var/area/room = usr.loc
   if(istype(room)) //in a room
      switch(Dir)
         if(NORTH) Dest = room.north_exit
         if(SOUTH) Dest = room.south_exit
         if(EAST)  Dest = room.east_exit
         if(WEST)  Dest = room.west_exit
   return ..()

//set the starting position for new logins
mob/Login()
   if(!loc) Move(locate(/area/Castle/Main_Gate))
   return ..()
</xmp>

<hr>

<a name=/operator/|>
<h2>| operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&>&amp; operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/|=>|= operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A | B
</dl>

<dl><dt><b>Returns:</b>
<dd>The binary "or" of A and B.
</dl>

<p>A and B must be between 0 and 2**24 - 1, giving an effective
width of 24 bits.

<p>If A and B are lists, the result is a list containing items that are in
either list. list(1,2) | list(2,3) is equivalent to list(1,2,3). The items
from A come first in the result, followed by any extra items from B.

<p>If A is an icon or /icon datum, it is blended with B which can be either
a color or another icon. Unlike the + or &amp; operation, the result is
transparent only in places where both icons were transparent.

<hr>

<a name=/operator/|=>
<h2>|= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/&=>&amp;= operator</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/operator/|>| operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A |= B
</dl>

<p>Set A equal to A | B.  It is shorthand for A = A | B.

<p>This is commonly used to turn on certain bitfields in a word.

<h3>Example:</h3>
<xmp>
usr.sight |= BLIND // turn on the blind bit
</xmp>

<p>If A and B are lists, any items in B that are not already in A are added
to A.

<p>If A is an /icon or /matrix datum, the datum will be changed rather than
creating a new one and re-assigning it to A.

<hr>

<a name=/operator/||>
<h2>|| operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/!>! operator</a>
<dd><a href=#/operator/&&>&amp;&amp; operator</a>
<dd><a href=#/operator/||=>||= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A || B
</dl>

<dl><dt><b>Returns:</b>
<dd>First true value of either A or B; last false value otherwise
</dl>

<p class="sidebar didyouknow">The only false values in DM are the number 0, an
empty text string, or null. All other values are considered true.

<p>The first true value from left to right completes the evaluation (a
practice known as short-circuiting)), meaning that any expressions after the
first true value are skipped. The return value is equal to the last operand
to be evaluated.

<h3>Example:</h3>
<xmp>mob/verb/Fly()
    if(swimming || IsStuck())
        src << "You can't fly right now!"
        return
</xmp>

<p>In this example, the <tt>IsStuck()</tt> call is not performed if
<tt>swimming</tt> is true.

<p>Although logical short-circuit operators are used most often in blocks such
as <tt>if</tt> or <tt>while</tt>, they can be used elsewhere.

<h3>Example:</h3>
<xmp>
// if current_target is null, pick a new one
var/target = current_target || PickTarget()
</xmp>

<hr>

<a name=/operator/||=>
<h2 byondver=514>||= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/||>|| operator</a>
<dd><a href=#/operator/&&>&amp;&amp; operator</a>
<dd><a href=#/operator/&&=>&amp;&amp;= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A ||= B
</dl>

<dl><dt><b>Returns:</b>
<dd>Value of <tt>(A || B)</tt> after it has been assigned to A. This
expression can stand by itself; its result does not need to be assigned to
anything else.
</dl>

<p>First A is evaluated. If its value is false, B will be evaluated and
assigned to A. If A is true, B will not be evaluated and A will remain
unchanged.

<p>Note that this is slightly different from <tt>if(!A) A = B</tt> if A is
a complex expression such as <tt>list[index++]</tt>, because the expression
is only evaluated once.

<p>This operator cannot be overloaded.

<hr>

<a name=/operator/~>
<h2>~ operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>~ A
</dl>

<dl><dt><b>Returns:</b>
<dd>The binary "not" of A.
</dl>

<p>A must be between 0 and 2**24 - 1, giving an effective width of
24 bits.

<p>If A is a /matrix datum, the result is a new matrix which is the inverse
of A.

<hr>

<a name=/operator/~=>
<h2 byondver=512>~= operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/~!>~! operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator/!=>!= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A ~= B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A and B are equivalent; 0 otherwise
</dl>

<p>Equivalence is a looser version of equality:

<ul>
<li>Two lists are equivalent if their contents are the same. (This is a
shallow comparison, so it doesn't check if the Nth items are also
equivalent, only equal.)</li>
<li>Two <a href=#/matrix>/matrix</a> values are equivalent if their components
are the same.</li>
<li>Datums A and B are equivalent if A <dd><a href=#/operator/overload>overloads</a>
the ~= operator with a proc that returns true for B. Without an overload,
they are only equivalent if they're the same object.</li>
</ul>

<p>To check if A and B are equal, use the == operator.

<p>Note: For code compiled in version 516 or later,
<a href=#/list/assoc>associated values</a> in lists are also checked for
equality. This was not the case for older versions.

<hr>

<a name=/operator/~!>
<h2 byondver=512>~! operator</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/~=>~= operator</a>
<dd><a href=#/operator/==>== operator</a>
<dd><a href=#/operator/!=>!= operator</a>
<dd><a href=#/operator>operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A ~! B
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A and B are not equivalent; 0 otherwise
</dl>

<p>Equivalence is a looser version of equality. See the <a href=#/operator/~=>~= operator</a>
for more information.

<p>To check if A and B are not equal, use the != operator.

<hr>

<a name=/operator/overload>
<h2 byondver=512 short="overloading">operator overloading</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum>datum</a>
<dd><a href=#/operator>operators</a>
</dl>

<p>DM allows you to overload most of the operators it uses when working with
datums and other objects. This means that A + B can call a proc defined under
A instead, with B as an argument, and the return value of that proc would be
the result.

<p>The proc name for an overloaded operator is "operator" followed
immediately by the operator itself, such as <code>operator*</code> to override
the multiplication operator. <tt>A * B</tt> will call <tt>A.operator*(B)</tt> if the proc is
available.

<h3>Example:</h3>
<xmp>
complex     // complex number a+bi
    var/a as num
    var/b as num

    New(_a,_b)
        a = _a
        b = _b

    proc/operator+(complex/C)
        if(istype(C)) return new/complex(a+C.a, b+C.b)
        if(isnum(C)) return new/complex(a+C, b)
        return src

    proc/operator+=(complex/C)
        if(istype(C))
            a += C.a
            b += C.b
        else if(isnum(C)) a += C
</xmp>

<p>The following operators may be overloaded:

<table class="overload">
<tr><th>Operators</th><th>Proc</th><th>Notes</th></tr>
<tr><th colspan=3>Arithmetic and binary (return new value)</th></tr>
<tr><td>A + B</td><td>A.operator+(B)</td><td></td></tr>
<tr><td>A - B</td><td>A.operator-(B)</td><td></td></tr>
<tr><td>-A</td><td>A.operator-()</td><td>Same proc as subtraction, but has no arguments</td></tr>
<tr><td>A * B</td><td>A.operator*(B)</td><td></td></tr>
<tr><td>A / B</td><td>A.operator/(B)</td><td></td></tr>
<tr><td>A % B</td><td>A.operator%(B)</td><td></td></tr>
<tr><td byondver=515>A %% B</td><td>A.operator%%(B)</td><td></td></tr>
<tr><td>A ** B</td><td>A.operator**(B)</td><td></td></tr>
<tr><td>A | B</td><td>A.operator|(B)</td><td></td></tr>
<tr><td>A &amp; B</td><td>A.operator&amp;(B)</td><td></td></tr>
<tr><td>A ^ B</td><td>A.operator^(B)</td><td></td></tr>
<tr><td>~A</td><td>A.operator~()</td><td></td></tr>
<tr><td>A &lt;&lt; B (shift)</td><td>A.operator&lt;&lt;(B)</td><td></td></tr>
<tr><td>A &gt;&gt; B (shift)</td><td>A.operator&gt;&gt;(B)</td><td></td></tr>
<tr><td>A &lt;&lt; B (output)</td><td>A.operator&lt;&lt;(B,A,window)<br/>world.operator&lt;&lt;(B,target,window)</td><td>Ignores return value<br/>..() falls back on world proc, then default behavior</i></td></tr>
<tr><td>A &gt;&gt; B (input)</td><td>A.operator&gt;&gt;(null,A)<br/>world.operator&gt;&gt;(null,source)</td><td>Return value is assigned to B<br/>..() falls back on world proc, then default behavior</td></tr>
<tr><th colspan=3>Comparisons (return true or false)</th></tr>
<tr><td>A ~= B</td><td>A.operator~=(B)</td><td></td></tr>
<tr><td>A ~! B</td><td>A.operator~!(B)</td><td></td></tr>
<tr><td>A &lt; B</td><td>A.operator&lt;(B)</td><td></td></tr>
<tr><td>A &gt;= B</td><td>A.operator&gt;=(B)</td><td></td></tr>
<tr><td>A &gt; B</td><td>A.operator&gt;(B)</td><td></td></tr>
<tr><td>A &lt;= B</td><td>A.operator&lt;=(B)</td><td></td></tr>
<tr><td byondver=516>A &lt;=&gt; B</td><td>A.operator&lt;=&gt;(B)</td><td></td></tr>
<tr><th colspan=3>Assignments with side effects (return value defaults to src)</th></tr>
<tr><td>A += B</td><td>A.operator+=(B)</td><td></td></tr>
<tr><td>A -= B</td><td>A.operator--(B)</td><td></td></tr>
<tr><td>A *= B</td><td>A.operator*=(B)</td><td></td></tr>
<tr><td>A /= B</td><td>A.operator/=(B)</td><td></td></tr>
<tr><td>A %= B</td><td>A.operator%=(B)</td><td></td></tr>
<tr><td byondver=515>A %%= B</td><td>A.operator%%=(B)</td><td></td></tr>
<tr><td>A |= B</td><td>A.operator|=(B)</td><td></td></tr>
<tr><td>A &amp;= B</td><td>A.operator&amp;=(B)</td><td></td></tr>
<tr><td>A ^= B</td><td>A.operator^=(B)</td><td></td></tr>
<tr><td>A &lt;&lt;= B</td><td>A.operator&lt;&lt;=(B)</td><td></td></tr>
<tr><td>A &gt;&gt;= B</td><td>A.operator&gt;&gt;=(B)</td><td></td></tr>
<tr><td>A := B</td><td>A.operator:=(B)</td><td></td></tr>
<tr><td>++A</td><td>A.operator++()</td><td></td></tr>
<tr><td>--A</td><td>A.operator--()</td><td></td></tr>
<tr><td>A++</td><td>A.operator++(1)</td><td></td></tr>
<tr><td>A--</td><td>A.operator--(1)</td><td></td></tr>
<tr><th colspan=3>List access</th></tr>
<tr><td>A[idx]</td><td>A.operator[](idx)</td><td>Used for reading a list value</td></tr>
<tr><td>A[idx] = B</td><td>A.operator[]=(idx, B)</td><td>Used for writing a list value; ignores return value</tr>
<tr><th colspan=3>Other</th></tr>
<tr><td byondver=514>turn(A, B)</td><td>A.operator_turn(B)</td><td></td></tr>
<tr><td byondver=515>"[A]"</td><td>A.operator""()</td><td>Specifies a custom way for converting A to text (see notes below)</td></tr>
</table>

<p>Some operators cannot be overloaded. The <tt>=</tt> operator for direct
assignment is one. The <tt>!</tt> operator is another. The <tt>==</tt> and
<tt>!=</tt> operators measure equality and can't be overloaded, but <tt>~=</tt>
and <tt>~!</tt> for equivalence can be. It would also be meaningless to
override the ternary <tt>? :</tt> operator pair, and the <tt>.</tt> and
<tt>:</tt> family of operators for accessing vars and procs.

<p>Comparison operators come in opposing pairs: <tt>~=</tt> vs. <tt>~!</tt>,
<tt>&lt;</tt> vs. <tt>&gt;=</tt>, <tt>&gt;</tt> vs. <tt>&lt;=</tt>. You only
need to override one operator from each pair; DM is smart enough to know that
<code>!(A ~= B)</code> is the same as <code>A ~! B</code>.

<p>By the same logic, you don't have to define the assign-with-side-effect
operators like <tt>+=</tt> if you don't want to. For instance if you override <tt>+</tt> but not
<tt>+=</tt>, then <tt>A += B</tt> will be handled internally as <tt>A = A + B</tt>, which means the value
of <tt>A</tt> after the statement may be a different datum than <tt>A</tt> was before. The value
of <tt>A</tt> can also change if you <i>do</i> overload <tt>+=</tt> but the proc returns a value
other than null; its return value will be the new <tt>A</tt>.

<p>If an overloaded proc is not available for an operator you try to use on
a datum, a runtime error may result.

<p>The output and input operators are given special treatment. If no overload
is defined for the current left-hand-side value, the overload proc is looked
up under <code>world</code> instead. The world overload proc is also a
fallback if <tt>..()</tt> is called, and after that <tt>..()</tt> does the
default behavior. These procs are always called with multiple arguments, to
distinguish them from bitwise shift operators. The output version gets a
third argument when the result <tt>output()</tt> is sent, since that can
include a window reference.

<h3>Example:</h3>
<xmp>
// Send an effect to a player or list of players
proc/DoEffect(target, effect/E)
    if(istype(target, /list))
        for(var/i in target) DoEffect(i, E)
        return
    if(target == world || target == world.contents)
        for(var/client/C) DoEffect(C, E)
    if(istype(target, /client))
        DoEffect(target:mob)
    if(istype(target, /mob))
        if(target:client)
            ... // do something here to show the effect

world/proc/operator<<(out, target)
    if(istype(target,/savefile)) return ..()    // always save normally
    if(istype(out, /effect)) DoEffect(target, out)
    else ..()
</xmp>

<p>The list access operators are a special case as well, because reading
to a list and writing to it are different things, so there are two procs
for the purpose. The <tt>[]</tt> overload is for reading, and <tt>[]=</tt>
is for writing.

<p>There is also now an overload for converting a datum to text. By having
<tt>operator""</tt> return a text string, that text will automatically
appear anywhere you embed the datum in a string, use <tt>json_encode()</tt>
on the datum, or many other situations. It won't work for atoms being sent
directly to output (e.g., <tt>world &lt;&lt; obj</tt>) or other skin
controls because the client has special handling for these situations and
the client isn't given any info about the overloaded text. Likewise, the
overloaded text won't appear for objects in an <tt>input()</tt> prompt
list, which is also handled mainly on the client. Despite these limitations,
the text overload offers greater flexibility.

<hr>

<a name=/pixloc>
<h2 byondver=516>pixloc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc/var>vars (pixloc)</a>
<dd><a href=#/atom/var/pixloc>pixloc var (atom)</a>
<dd><a href=#/proc/pixloc>pixloc proc</a>
<dd><a href=#/proc/bound_pixloc>bound_pixloc proc</a>
</dl>

<p>A primitive type that encapsulates position information for an atom, with
pixel movement included. I.e., it contains a turf (loc) and step_x and step_y
offsets. Pixlocs can also be built from absolute world coordinates.

<p>The pixloc of an atom is taken from its loc and step_x/y vars only. If you
want the pixloc of its bounds edges or its center, use the
<a href=#/proc/bound_pixloc><tt>bound_pixloc()</tt> proc</a> for that.

<p>Pixlocs support some math operations. A <a href=#/vector>vector</a> can be
added or subtracted to a pixloc, and subtracting one pixloc from another will
produce a vector. The <a class=code href=#/operator/%>%</a> and
<a class=code href=#/operator/%%>%%</a> operators are supported, returning a
vector.

<p>Other supported procs for pixlocs include:

<dl>
  <dt><a class=code href=#/proc/min>min()</a>
  <dt><a class=code href=#/proc/max>max()</a>
  <dt><a class=code href=#/proc/clamp>clamp()</a>
  <dt><a class=code href=#/proc/round>round()</a>
  <dt><a class=code href=#/proc/floor>floor()</a>
  <dt><a class=code href=#/proc/ceil>ceil()</a>
  <dt><a class=code href=#/proc/trunc>trunc()</a>
  <dt><a class=code href=#/proc/fract>fract()</a> (returns a vector)
</dl>

<hr>

<a name=/pixloc/var>
<h2 byondver=516>vars (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
</dl>

<p>Built-in pixloc vars:

<dl><dt>pixloc/var
  <dd><a href=#/pixloc/var/loc>loc</a>
  <dd><a href=#/pixloc/var/step_x>step_x</a>
  <dd><a href=#/pixloc/var/step_y>step_y</a>
  <dd><a href=#/pixloc/var/x>x</a>
  <dd><a href=#/pixloc/var/y>y</a>
  <dd><a href=#/pixloc/var/z>z</a>
</dl>

<hr>

<a name=/pixloc/var/loc>
<h2 byondver=516>loc var (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/pixloc/var/step_x>step_x var (pixloc)</a>
<dd><a href=#/pixloc/var/step_y>step_y var (pixloc)</a>
<dd><a href=#/atom/var/loc>loc var (atom)</a>
</dl>

<p>The turf that this pixloc belongs to. If the map has resized so that this
pixloc is no longer valid, this will be null.

<hr>

<a name=/pixloc/var/step_x>
<h2 byondver=516>step_x var (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/pixloc/var/loc>loc var (pixloc)</a>
<dd><a href=#/pixloc/var/step_y>step_y var (pixloc)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
</dl>

<p>The step_x offset of this pixloc, relative to its loc. For instance a value
of 4 means this is 4 pixels east from the southwest corner of the turf.

<hr>

<a name=/pixloc/var/step_y>
<h2 byondver=516>step_y var (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/pixloc/var/loc>loc var (pixloc)</a>
<dd><a href=#/pixloc/var/step_x>step_x var (pixloc)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
</dl>

<p>The step_y offset of this pixloc, relative to its loc. For instance a value
of 4 means this is 4 pixels north from the southwest corner of the turf.

<hr>

<a name=/pixloc/var/x>
<h2 byondver=516>x var (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/pixloc/var/y>y var (pixloc)</a>
<dd><a href=#/pixloc/var/z>z var (pixloc)</a>
</dl>

<p>The x value of this pixloc in world pixel coordinates, which start at 1. A
value of x=1 means this is lined up to the western edge of the map. On a
100x100 tile map with a 32x32 icon size, x=3200 would be a pixel on the
eastern edge of the map.

<p>Setting x will alter the loc and step_x values automatically. Out-of-bounds
values are allowed.

<hr>

<a name=/pixloc/var/y>
<h2 byondver=516>y var (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/pixloc/var/x>x var (pixloc)</a>
<dd><a href=#/pixloc/var/z>z var (pixloc)</a>
</dl>

<p>The y value of this pixloc in world pixel coordinates, which start at 1. A
value of y=1 means this is lined up to the southern edge of the map. On a
100x100 tile map with a 32x32 icon size, y=3200 would be a pixel on the
northern edge of the map.

<p>Setting y will alter the loc and step_y values automatically. Out-of-bounds
values are allowed.

<hr>

<a name=/pixloc/var/z>
<h2 byondver=516>z var (pixloc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/pixloc/var/x>x var (pixloc)</a>
<dd><a href=#/pixloc/var/y>y var (pixloc)</a>
</dl>

<p>The z value of this pixloc's turf (<tt>loc</tt>). It must be in the range
of 1 to <a class=code href=#/world/var/maxz>world.maxz</a>.

<hr>

<a name=/proc>
<h2>procs</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var>vars (procs)</a>
<dd><a href=#/proc/arguments>arguments (proc)</a>
<dd><a href=#/area/proc>procs (area)</a>
<dd><a href=#/mob/proc>procs (mob)</a>
<dd><a href=#/obj/proc>procs (obj)</a>
<dd><a href=#/turf/proc>procs (turf)</a>
</dl>

<p>Procs may be derived from /proc.  These procs are "global", in that they
can be called anywhere in the code.

<h3>Example:</h3>
<xmp>
proc/poof()
    world << "POOF!"
</xmp>

<p>The proc <tt>poof()</tt> may now be called anywhere in the code.

<p>Procs may also be attached to objects by defining them under the
appropriate <tt>object/proc</tt> subnode.  Currently DM allows procs to be
defined or overridden for <tt>/mob</tt>, <tt>/obj</tt>, <tt>/turf</tt>,
<tt>/area</tt>, <tt>world</tt>, and <tt>/client</tt>, as well as for
<a href=#/datum>datum objects</a> derived from <tt>/</tt>. Predefined procs
are discussed under the "procs" entry for the object type.

<h3>Example:</h3>
<xmp>
mob/proc/poof()
    world << "POOF!"
</xmp>

<p>This can be called by a mob var M, using <tt>M.poof()</tt>.

<h3>Return types</h3>

<p>It is possible to define what type of value a proc is expected to return,
by following its definition with an <tt>as</tt> clause. This can be a type
path, such as <tt>as /mob/player</tt>, or a more intrinsic type like <tt>as
num</tt> or <tt>as list</tt>.

<h3>Example:</h3>
<xmp>
mob/monster
    var/mob/player/target

    proc/GetTarget() as /mob/player
        if(!target)
            // find a /mob/player in view
            target = locate() in view(src)
        return target
</xmp>

<p>Currently the only purpose for using the <tt>as</tt> clause is for
situations where the compiler needs to infer the type of an expression.
Mainly this applies to the <a class=code href=#/operator/%2e>.</a> and
<a class=code href=#/operator/%3f%2e>?.</a> operators in an expression
such as <tt>GetTarget()?.Attack(src)</tt>. Giving <tt>GetTarget()</tt>
a return type allows the compiler to check if <tt>Attack()</tt> is a
valid proc for <tt>/mob/player</tt>. Otherwise, the <tt>.</tt> and
<tt>?.</tt> operators act like <tt>:</tt> and <tt>?:</tt>,
respectively; the compiler won't do any checking to see if
<tt>Attack()</tt> is valid.

<hr>

<a name=/proc/%2e toc=".">
<h2>. proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/%2e%2e>.. proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>.(Args)
</dl>

<dl><dt><b>Returns:</b>
<dd>The return value of the current proc.
</dl>

<dl><dt><b>Args:</b>
<dd>The arguments to pass to the new invocation of the current proc.  This
     defaults to current arguments.
</dl>

<p>Call the current proc.  A proc that calls itself is said to be recursive.

<h3>Example:</h3>
<xmp>
proc/factorial(N as num)
  if(N<=0) return 1
  return .(N-1)*N
</xmp>

<p>This computes the factorial N! by calling itself recursively.

<hr>

<a name=/proc/%2e%2e toc="..">
<h2>.. proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/%2e>. proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>..(Args)
</dl>

<dl><dt><b>Returns:</b>
<dd>The return value of the parent proc.
</dl>

<dl><dt><b>Args:</b>
<dd>The arguments to pass to the parent proc.  This defaults to the
     arguments to the current proc.
</dl>

<p>If object O is derived from object P, P is called the parent of O.  If a
proc (or verb) is defined in both O and P, O can call P's version by using
..().

<h3>Example:</h3>
<xmp>
mob
  P
    verb/history()
      world << "P"

    O
      history()
        world << "O"
        ..()          // call P.history()
</xmp>

<p>Here O is derived from P.  When P calls "history", his name is
displayed.  When O calls "history", his name is displayed, followed by the
name of his parent, P.

<p>If O overrides the same proc more than once, ..() will search for the
previous version and use that.  For instance, you could have two O.history()
procs; the second overrides the first, but the original could still be called
via ..(). The original in turn could call ..() to reach P.history().
Overriding the same proc more than once in the same type should be avoided
wherever possible, because it incurs extra overhead, it makes the code
harder to read, and it isn't always clear which one gets called first.
(Usually, the only time you'll want this to happen is when using libraries.)

<p>..() can also be used for predefined procs.

<h3>Example:</h3>
<xmp>
mob/Move()            // override proc
  world << "moving..."
  return ..()         // call default
</xmp>

<p>This proc will print "moving..." whenever
the mob moves.

<hr>

<a name=/proc/ASSERT>
<h2>ASSERT proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/CRASH>CRASH proc</a>
<dd><a href=#/DM/preprocessor/define/DEBUG>DEBUG definition</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ASSERT(expression)
</dl>

<dl><dt><b>Args:</b>
<dd>expression: an expression which should always be true
</dl>

<p>This is used to make a sanity check.  If the given expression is false, the
current procedure crashes, generating diagnostic debugging output, which
includes the expression, a stack dump, and so forth.

<hr>

<a name=/proc/CRASH>
<h2>CRASH proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ASSERT>ASSERT proc</a>
<dd><a href=#/DM/preprocessor/define/DEBUG>DEBUG definition</a>
</dl>

<dl><dt><b>Format:</b>
<dd>CRASH(msg)
</dl>

<p>Crashes the current procedure, displaying the specified message and
generating diagnostic debugging output, such as a stack dump.

<hr>

<a name=/proc/abs>
<h2>abs proc</h2>

<dl><dt><b>Format:</b>
<dd>abs(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>The absolute value of A.
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number.
</dl>

<h3>Example:</h3>
<xmp>
usr << abs(1)  // outputs 1
usr << abs(-1) // outputs 1
</xmp>

<hr>

<a name=/proc/addtext>
<h2>addtext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/+>+ operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>addtext(Arg1,Arg2,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>A text string with the arguments concatenated.
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of text strings.
</dl>

<p>This instruction returns text containing the first argument followed by
the second, followed by the third, etc.  The arguments may be constants or
variables containing text.

<h3>Example:</h3>
<xmp>
var/T
T = "1"
T = addtext(T,"*1 = ",T)  // T = "1*1 = 1"
world << "The answer is: [T]"
</xmp>

<p>This instruction exists primarily for backwards-compatibility.  You can
accomplish the same thing with the + operator or by using embedded
expressions.

<hr>

<a name=/proc/alert>
<h2>alert proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/input>input proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>alert(Usr=usr,Message,Title,Button1="Ok",Button2,Button3)
</dl>

<dl><dt><b>Returns:</b>
<dd>Selected button
</dl>

<p>This sleeps the current proc until the user clicks one of the named
buttons.  As with input(), the first argument may be entirely left out.

<h3>Example:</h3>
<xmp>
mob/verb/self_destruct()
   alert("Prepare to die.")
   del usr
</xmp>

<p>A slightly more complicated example provides the user with a choice in
the matter:

<h3>Example:</h3>
<xmp>
mob/verb/self_destruct()
   switch(alert("Would you like to die?",,"Yes","No","Maybe"))
      if("Yes")
         del usr
      if("No")
         usr << "You have second thoughts."
      if("Maybe")
         usr << "You flip a coin..."
         if(rand(0,1))
            usr << "Heads -- you lose."
            del usr
         else
            usr << "Tails -- you win!"
</xmp>

<hr>

<a name=/proc/alist>
<h2 byondver=516>alist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/list>list</a>
<dd><a href=#/proc/list>list proc</a>
<dd><a href=#/proc/values_sum>values_sum proc</a>
<dd><a href=#/proc/values_product>values_product proc</a>
<dd><a href=#/proc/values_dot>values_dot proc</a>
<dd><a href=#/proc/values_cut_over>values_cut_over proc</a>
<dd><a href=#/proc/values_cut_under>values_cut_under proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>alist(A=a,B=b,C=c,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new associative list with contents (keys) A, B, C, and associated values a, b, c.
</dl>

<dl><dt><b>Args:</b>
<dd>Arbitrary number of elements to be inserted into the associative list.
</dl>

<p>Creates a strictly associative list with key,value pairs. This is different
from an <a href=#/list>ordinary list</a> in several respects.

<ul>
<li>"Keys" can be numbers. This means list items can't be accessed by a numerical index.</li>
<li>Keys can't be repeated in the list, and always have an associated value (even if it's just null).</li>
<li>The order of keys in the list is not under user control.</li>
</ul>

<p>The point of using this type over a regular list is to eke out performance
gains in tight code. Operators such as <tt>+</tt> and <tt>-</tt> have improved
performance because of the rules above.

<p>In this proc the index values should be constants, and that usually means text
constants.  When these index values happen to be text strings that satisfy all
the requirements for variable names, this may also be written in a convenient
short-hand without the double quotes:

<xmp>
var/alist/lst = alist(player = "James Byond", score = 2000)
</xmp>

<p>In other words, this is exactly the same syntax as for
<a href=#/proc/arguments/named>named arguments</a>.

<hr>

<a name=/proc/animate>
<h2 byondver=500>animate proc</h2>

<div class=sidebar>
<h3>Useful terms in this article:</h3>

<p><b>Step:</b> A piece of an animation that transitions from the old
appearance to a new appearance, in a given time.

<p><b>Sequence:</b> One or more steps in an animation. A sequence may loop
a certain number of times, but requires more than one step for the loop to
be meaningful.

<p><b>Parallel:</b> Multiple sequences can run concurrently if they are
flagged as parallel. A parallel animation animates only the relative changes
from the appearance that started the sequence.

<p><b>Supersede:</b> If a new animation sequence is not flagged as parallel,
it will freeze the previous animation at its current point and animate any
changes from there. The previous sequences are superseded, and will eventually
be discarded.
</div>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var>vars (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>animate(Object, var1=new_value1, var2=new_value2, ..., time, loop, easing, flags, delay, tag, command)
<dd>animate(Object, appearance=new_appearance, time, loop, easing, flags, delay, tag, command)
<dd>animate(Object)
</dl>

<dl><dt><b>Args:</b>
<dd>Object: The atom, image, or client to animate; omit to add another step to the same sequence as the last <tt>animate()</tt> call
<dd>var1=new_value1, var2=new_value2, ...: Vars to change in the animation step
<dd byondver=513>var_list: An associative list of vars to change
<dd byondver=513>appearance: New appearance to use instead of multiple var changes (must be a <a href=#/proc/arguments/named>named argument</a>)
<dd>time: Time of this step, in 1/10s (may be a <a href=#/proc/arguments/named>named argument</a>)
<dd>loop: Number of times to run this sequence, or -1 to loop forever (may be a named argument)
<dd>easing: The "curve" followed by this animation step (may be a <a href=#/proc/arguments/named>named argument</a>)
<dd byondver=509>flags: Flags that impact how the animation acts (may be a <a href=#/proc/arguments/named>named argument</a>)
<dd byondver=515>delay: Delay time for starting the first step in a sequence (may be negative; may be a <a href=#/proc/arguments/named>named argument</a>)
<dd byondver=516>tag: Optional name for a new animation sequence (must be a <a href=#/proc/arguments/named>named argument</a>)
<dd byondver=516>command: Optional <a href=#/{skin}/commands>client command</a> to run at the end of this step
</dl>

<p>This proc creates an <b>animation step</b>, which may be the start of a
<b>sequence</b> of multiple steps, that will be displayed to players. Starting
with an atom or image, you can change one or more vars that affect its
apprearance. This change will take place immediately, but will be displayed to
users as a gradual change over a period of time. The actual interpolation
between frames is all done on the client.

<p>If the <tt>Object</tt> argument is left out, a new animation step will be
created for the previously used animation seqeunce. If all other arguments
besides the object are left out, the animation is stopped completely.

<h3>Example:</h3>
<xmp>
mob/proc/GrowAndFade()
    // expand (scale by 2x2) and fade out over 1/2s
    animate(src, transform = matrix()*2, alpha = 0, time = 5)

obj/spell/proc/Spin()
    // cast a spell on a monster: make the icon spin
    // this animation takes 3s total (6 ticks * 5)
    animate(src, transform = turn(matrix(), 120), time = 2, loop = 5)
    animate(transform = turn(matrix(), 240), time = 2)
    animate(transform = null, time = 2)
</xmp>

<p>The following vars will animate smoothly:

<ul>
<li>alpha</li>
<li>color</li>
<li>glide_size</li>
<li>infra_luminosity</li>
<li>layer</li>
<li>maptext_width, maptext_height, maptext_x, maptext_y</li>
<li>luminosity</li>
<li>pixel_x, pixel_y, pixel_w, pixel_z</li>
<li>transform</li>
</ul>

<p>These vars can be changed, but will change immediately on each step rather
than smoothly:

<ul>
<li>dir</li>
<li>icon</li>
<li>icon_state</li>
<li>invisibility</li>
<li>maptext</li>
<li>suffix</li>
</ul>

<p>Other vars may apply:

<ul>
<li byondver=514>space: A named var for the <a href=#/{{appendix}}/color-space>color space</a>, if animating color; only applies to non-matrix color values.</li>
</ul>

<p byondver=513>For convenience, you can use an
<a href=#/list/associations>associative list</a>, appearance, or
<a href=#/mutable_appearance>mutable appearance</a> in place of the appearance
vars. You can use <tt>appearance</tt> itself as a name for this argument, or
leave the argument unnamed.

<h3>Easing</h3>

<p>An animation step doesn't have to be strictly linear. Some changes look
much better if they follow a curve. A cubic curve, for instance, will start
slow, accelerate very quickly in the middle, and slow down again at the end. A
sine curve could be used with a flip transformation to make a coin appear to
spin. A text bubble can jump into place and bounce a little before it settles.
The choice of curve you use is called easing, and you have several good
choices to pick from.

<script>
function easing(t,ease,doubled) {
  var _in=(ease&64), _out=(ease&128), b; ease &= 63;
  t = Math.max(0,Math.min(1,t));  // clamp t
  if(!ease) return t; // linear case, simplest of all
  if(!_in && !_out) { // default case
    switch(ease) {
      case 4: case 5: case 8: _out = true; break; // bounce, elastic, jump
      default: _in = _out = true; break;  // all other cases
    }
  }
  if(_in && _out) {
    if(ease == 8) return t <= 0.5 ? 0 : 1;  // jump is a special case
    return ((t <= 0.5) ? easing(t*2,ease|64,true) : easing(t*2-1,ease|128,true)+1) / 2;
  }
  if(_in) return 1-easing(1-t,ease|128,doubled);
  switch(ease) {  // all out cases
    case 1: // sine
      return Math.sin(t*Math.PI/2);
    case 2: // circular
      t = 1-t; return Math.sqrt(1 - t*t);
    case 3: // cubic
      t = 1-t; return 1 - t*t*t;
    case 4: // bounce
      b = t*2.75;
      if(b<1) return b*b; // 1st arc
      if(b<2) {b-=1.5; return b*b + 0.75;}  // bounce #1
      if(b<2.5) {b-=2.25; return b*b + 0.9375;} // bounce #2
      b-=2.625; return b*b + 0.984375;  // final bounce
    case 5: // elastic
      return 1 - Math.pow(2,-10*t) * Math.cos(t*Math.PI/0.15);
    case 6: // back
      b = doubled ? 2.59491 : 1.70158;
      t = 1-t; return 1 - t*t*((b+1)*t - b);
    case 7: // quad
      t = 1-t; return 1 - t*t;
    case 8: // jump
      return (t<1) ? 0 : 1;
    default: return t;
  }
}
function drawEasing() {
  var canvas = document.querySelector('#easing_canvas');
  var ease = document.querySelector('#easing_type').value;
  if(document.querySelector('#ease_in').checked) ease |= 64;
  if(document.querySelector('#ease_out').checked) ease |= 128;
  var ctx=canvas.getContext("2d"), t, y, w=ctx.canvas.width, h=ctx.canvas.height, margin=5, miny=0, maxy=1, s;
  ctx.fillStyle = 'white';
  ctx.fillRect(0,0,w,h);
  ctx.fillStyle = 'transparent';

  w -= margin*2+1; h -= margin*2+1;
  for(x=0,y=[]; x<=w; ++x) {
    y[x] = easing(x/w,ease);
    if(y[x] < miny) miny = y[x];
    else if(y[x] > maxy) maxy = y[x];
  }
  s = h / (maxy-miny);

  ctx.beginPath();
  ctx.setLineDash([3,3]); ctx.strokeStyle = 'rgba(0,128,0,0.5)'; ctx.strokeWidth = 1;
  ctx.moveTo(margin, margin+h+miny*s); ctx.lineTo(margin+w, margin+h+miny*s);
  ctx.stroke();

  ctx.beginPath();
  ctx.strokeStyle = 'rgba(0,128,255,0.5)';
  ctx.moveTo(margin, margin+(maxy-1)*s); ctx.lineTo(margin+w, margin+(maxy-1)*s);
  ctx.stroke();

  ctx.beginPath();
  ctx.setLineDash([]); ctx.strokeStyle = 'black';
  ctx.moveTo(margin, margin+h+miny*s);
  for(x=1; x<=w; ++x) ctx.lineTo(margin+x, margin+h+(miny-y[x])*s);
  ctx.stroke();
}
</script>

<div class="sidebar play">
<p>In this play area, you can test different easing functions to see how they
work.

<p>The horizontal axis from left to right represents the time of the animation
from beginning to end. The vertical axis, from bottom to top, is how the
animation will be interpolated; the lower green line represents the starting
appearance, and the upper blue line is the ending appearance.

<div style="margin:10px 0; text-align: center;">
  <table class="nopadding has-shadow" style="display:inline-block; margin:0 10px 0 auto; vertical-align:middle; background:white; border-collapse:collapse;">
    <tr>
      <td class=center style="width:1em; height:150px;"><div style="width:1em; height:150px;"><div class=nobr style="color:black; width:150px; height:150px; transform:rotate(270deg);">Progress &#x2192;</div></div></td>
      <td><canvas id="easing_canvas" width=150 height=150 onarticle="drawEasing()"></canvas></td>
    </tr>
    <tr>
      <td></td>
      <td class=center style="color:black; width:150px; height:1em"><div class=nobr>Time &#x2192;</div></td>
    </tr>
  </table>
  <div style="display:inline-block; text-align: left; vertical-align: middle; margin: 0 auto 0 0;">
    <select class=code id="easing_type" onchange="drawEasing()">
      <option value=0>LINEAR_EASING</option>
      <option value=1>SINE_EASING</option>
      <option value=2>CIRCULAR_EASING</option>
      <option value=3>CUBIC_EASING</option>
      <option value=4>BOUNCE_EASING</option>
      <option value=5>ELASTIC_EASING</option>
      <option value=6>BACK_EASING</option>
      <option value=7>QUAD_EASING</option>
      <option value=8>JUMP_EASING</option>
    </select><br/>
    <input class=vcenter id="ease_in" type=checkbox onchange="drawEasing()" /> <label for="ease_in" class="code vcenter">EASE_IN</label><br/>
    <input class=vcenter id="ease_out" type=checkbox onchange="drawEasing()" /> <label for="ease_out" class="code vcenter">EASE_OUT</label>
  </div>
</div>
</div>

<dl class=codedt>
<dt>LINEAR_EASING</dt><dd>Default. Go from one value to another at a constant rate.</dd>
<dt>SINE_EASING</dt><dd>The animation follows a sine curve, so it starts off and finishes slowly, with a quicker transition in the middle.</dd>
<dt>CIRCULAR_EASING</dt><dd>Similar to a sine curve, but each half of the curve is shaped like a quarter circle.</dd>
<dt byondver=510>QUAD_EASING</dt><dd>A quadratic curve, good for gravity effects.</dd>
<dt>CUBIC_EASING</dt><dd>A cubic curve, a little more pronounced than a sine curve.</dd>
<dt>BOUNCE_EASING</dt><dd>This transitions quickly like a falling object, and bounces a few times.<br/>Uses <tt>EASE_OUT</tt> unless otherwise specified.</dd>
<dt>ELASTIC_EASING</dt><dd>This transitions quickly and overshoots, rebounds, and finally settles down.<br/>Uses <tt>EASE_OUT</tt> unless otherwise specified.</dd>
<dt>BACK_EASING</dt><dd>Goes a little bit backward at first, and overshoots a little at the end.</dd>
<dt byondver=513>JUMP_EASING</dt><dd>Jumps suddenly from the beginning state to the end. With the default or <tt>EASE_OUT</tt>, this happens at the end of the time slice. With <tt>EASE_IN</tt>, the jump happens at the beginning. With both flags set, the jump happens at the halfway point.</dd>
</dl>

<p>These can be combined with <tt>EASE_IN</tt> or <tt>EASE_OUT</tt> using the <tt>|</tt> operator, to use just the first or last part of the curve.

<h3>Example:</h3>
<xmp>
obj/coin/proc/Spin()
    var/matrix/M = matrix()
    M.Scale(-1, 1)  // flip horizontally
    animate(src, transform = M, time = 5, loop = 5, easing = SINE_EASING)
    animate(transform = null, time = 5, easing = SINE_EASING)

obj/speech_bubble/New(newloc, msg)
    icon = 'bubble.dmi'

    var/obj/O = new
    O.maptext = msg
    O.maptext_width = width
    O.maptext_height = height
    overlays = O

    // start below final position and jump into place
    pixel_z = -100
    alpha = 0
    animate(src, pixel_z = 0, alpha = 255, time = 10, easing = ELASTIC_EASING)
</xmp>

<p>Some easing functions may overshoot one line or the other, so it's fully
possible to have a <tt>pixel_w</tt> value, for instance, animate from 0 to 100
but actually end up briefly outside of that range during the animation.

<h3 byondver=509>Flags</h3>

<p>Any combination of these flags may be used for animation (use <tt>+</tt> or
<tt>|</tt> to combine them):

<dl>
  <dt><tt>ANIMATION_END_NOW</tt>
  <dd>Normally if you interrupt another animation, it transitions from its
    current state. This flag will start the new animation fresh by bringing
    the old one to its conclusion immediately. It is only meaningful on the
    first step of a new animation. If using the <tt>tag</tt> argument, only
    a previous sequence with the same matching tag is stopped.
  <dt><tt>ANIMATION_LINEAR_TRANSFORM</tt>
  <dd>The transform var is interpolated in a way that preserves size during
    rotation, by pulling the rotation step out.  This flag forces linear
    interpolation, which may be more desirable for things like beam effects,
    mechanical arms, etc.
  <dt byondver=511><tt>ANIMATION_PARALLEL</tt>
  <dd>Start a parallel animation sequence that runs alongside the current
    animation sequence. The difference between where the parallel sequence
    started, and its current appearance, is added to the result of any
    previous animations. For instance, you could use this to animate pixel_y
    separately from pixel_x with different timing and easing. You could also
    use this to apply a rotational transform after a previous animation
    sequence did a translate. (When using this flag, the src var may be
    included, but it is optional.) This flag is implied if using the
    <tt>tag</tt> argument for a named sequence.
  <dt byondver=511><tt>ANIMATION_RELATIVE</tt>
  <dd>The vars specified are relative to the current state. This works for
    maptext_x/y/width/height, pixel_x/y/w/z, luminosity, layer, alpha,
    transform, and color. For transform and color, the current value is
    multiplied by the new one. Vars not in this list are simply changed as
    if this flag is not present. (If you supply an appearance instead of
    individual vars, this flag is meaningless.)
  <dt byondver=515><tt>ANIMATION_CONTINUE</tt>
  <dd>This flag is equivalent to leaving out the <tt>Object</tt> argument.
    It exists to make it easier to define an animation using a
    <a href=#/proc/for>for loop</a>. If <tt>Object</tt> differs from the
    previous sequence, this flag will be ignored and a new sequence will
    start.
  <dt byondver=515><tt>ANIMATION_SLICE</tt>
  <dd>Following a series of <tt>animate()</tt> calls, you can view just a
    portion of the animation by using <tt>animate(object, delay=start,
    time=duration, flags=ANIMATION_SLICE)</tt>. The <tt>loop</tt> parameter
    may optionally be included. The <tt>delay</tt> is the start time of the
    slice, relative to the beginning of all the active animations on the
    object. (That is, earlier animations that have concluded will not be
    included.) You can call the proc again with a different slice if you
    want to see a different portion of the animation. A negative value for
    <tt>time</tt> will remove the slice and finish any existing animations.
  <dt byondver=516><tt>ANIMATION_END_LOOP</tt>
  <dd>Tells previous animation sequences to stop looping and end naturally.
    The delay for starting this new sequence is adjusted based on that. If
    using the <tt>tag</tt> argument, only a previous sequence with the same
    matching tag is told to stop looping.
</dl>

<h3 byondver=512>Filters</h3>

<p><a href=#/{notes}/filters>Filters</a> can be animated too. If you want to
animate a filter, you need to specify the filter to be animated. If the last
call to <tt>animate()</tt> used the same object as this filter, or a different
filter for that object, then this will be treated as a new step in the same
animation sequece. Likewise, if the last <tt>animate()</tt> call was to a
filter, and this call is for the object that filter belonged to, again it will
be treated as a continuation of the sequence.

<h3>Example:</h3>
<xmp>atom/proc/BlurFade()
    filters += filter(type = "blur", size = 0)
    // Animating a filter of src
    animate(filters[filters.len], size = 5, time = 10)
    // Switching back to src to animate the next step
    animate(src, alpha = 0, time = 2.5)
</xmp>

<h3 byondver=516>Named sequences</h3>

<p>The <tt>tag</tt> argument allows you to refer to an animation sequence by
name. This is useful for being able to replace or stop a previous animation
sequence with the same name, but leaving other parallel sequences alone.

<p>The <tt>ANIMATION_PARALLEL</tt> flag is always implied when using a named
sequence. However, a named sequence will always supersede an earlier sequence
with the same name, so you can't have two sequences with the same name running
concurrently.

<p>Stopping a named sequence is as simple as calling
<tt>animate(Object, tag=name)</tt> with no other arguments.

<h3 byondver=516>Client commands</h3>

<p>If the <tt>command</tt> argument is present, a command will run on the
client when this step ends. If this is part of a looping sequence, it will run
each time. (If for any reason an entire loop runs in between client ticks,
those loops will be ignored.)

<p>The purpose of this is to synchronize events on the client, such as the
<a class=code href=#/{skin}/commands/%2esound>.sound</a> command, that otherwise
couldn't be matched to the animation.

<p>Using <tt>[[*]]</tt> in the command will expand it to a reference to the
object being animated. (If this is a filter, it references the object that
owns the filter.) The reference will be in the same format output by
<a class=code href=#/proc/ref>ref()</a>, without quotes.

<h3>Example:</h3>
<xmp>
obj/bouncing_ball/New()
    // this is only here to ensure the sound is included in resources
    var/static/bounce = 'bounce.ogg'
    var/sound_command = @".sound 'bounce.ogg' atom=[[*]] transform=1,0,0,0,0.707,0.707,0,0,0 falloff=10"

    animate(src, pixel_z=16, easing=QUAD_EASING|EASE_OUT, time=5, loop=-1)
    animate(pixel_z=0, command=sound_command, easing=QUAD_EASING|EASE_IN, time=5)
</xmp>

<hr>

<a name=/proc/arccos>
<h2>arccos proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arcsin>arcsin proc</a>
<dd><a href=#/proc/arctan>arctan proc</a>
<dd><a href=#/proc/cos>cos proc</a>
<dd><a href=#/proc/turn>turn proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>arccos(X)
</dl>

<dl><dt><b>Returns:</b>
<dd>The inverse cosine of X in degrees.
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << arccos(0)        // 90
   usr << arccos(0.707107) // 45
   usr << arccos(1)        // 0
</xmp>

<hr>

<a name=/proc/arcsin>
<h2>arcsin proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arccos>arccos proc</a>
<dd><a href=#/proc/arctan>arctan proc</a>
<dd><a href=#/proc/sin>sin proc</a>
<dd><a href=#/proc/turn>turn proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>arcsin(X)
</dl>

<dl><dt><b>Returns:</b>
<dd>The inverse sine of X in degrees.
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << arcsin(0)        // 0
   usr << arcsin(0.707107) // 45
   usr << arcsin(1)        // 90
</xmp>

<hr>

<a name=/proc/arctan>
<h2 byondver=513>arctan proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arcsin>arcsin proc</a>
<dd><a href=#/proc/arccos>arccos proc</a>
<dd><a href=#/proc/tan>tan proc</a>
<dd><a href=#/proc/turn>turn proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>arctan(Num)
<dd>arctan(x, y)
<dd>arctan(Vector)
</dl>

<dl><dt><b>Args:</b>
<dd>Num: A number
<dd>x, y: 2D coordinates
<dd>Vector: A vector (only 2 dimensions are used)
</dl>

<dl><dt><b>Returns:</b>
<dd>The inverse tangent in degrees.
</dl>

<p>When <tt>arctan</tt> is called with just one number argument, the number
is a tangent, and the return value is the angle that produces that tangent.
The resulting angle can range from -90 to 90.

<p>The two-argument form returns a polar angle from -180 to 180. This angle
starts at 0&deg; for due east, and increases counter-clockwise from there.
Therefore 1,0 has an arctangent of 0&deg;, 0,1 is 90&deg;, -1,0 is 180&deg;,
and so on. At point 0,0 the angle is undefined since it could be any angle,
but <tt>arctan</tt> will return 0.

<p>Finally, you can use a vector instead of a number. Only the x and y
components of a vector will be used.

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << arctan(0)        // 0
   usr << arctan(1)        // 45
   usr << arctan(sqrt(3))  // 60

   // polar coordinates
   usr << arctan(3, 4)     // 53.1301
   usr << arctan(-1, 1)    // 135
   usr << arctan(0, -5)    // -90
</xmp>

<p>Here's another example, in which a rotating turret points to a target on
another tile.

<xmp>
mob/turret
   proc/PointAt(atom/target)
      if(!target) return
      var/dx = target.x - x
      var/dy = target.y - y
      // turret's icon normally faces east
      transform = matrix().Turn(-arctan(dx, dy))
</xmp>

<hr>

<a name=/proc/arglist>
<h2>arglist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arguments>arguments (proc)</a>
<dd><a href=#/proc/call>call proc</a>
<dd><a href=#/proc/call_ext>call_ext proc</a>
<dd><a href=#/proc/list>list proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>arglist(List)
</dl>

<dl><dt><b>Args:</b>
<dd>List: a list to be used as the arguments to a procedure
</dl>

<p>Normally, if you were to pass a list directly to a procedure, it would only
come through as a singe argument to that procedure.  In some cases, you might
instead want the items in the list to become the arguments to the procedure.
That is what <code>arglist()</code> achieves.

<p>If the items in the list are associations, these are treated as
<a href=#/proc/arguments/named>named arguments</a>.  Each such list item is
matched against the names of the procedure arguments and its associated value
is assigned to that parameter.

<p>Most built-in DM instructions do not support use of
<code>arglist()</code>, but all user-defined procedures automatically
support it.  The built-in instructions which support named arguments will also
support <code>arglist()</code>.

<p>The following example shows how to use <code>arglist()</code> with both
positional parameters and named arguments.  Both of these examples could be
replaced by a much simpler direct call without need for a list to hold the
arguments; this is just to illustrate the syntax.

<h3>Example:</h3>
<xmp>
proc/MyProc(a,b)
   usr << "MyProc([a],[b])"

mob/verb/test()
   var/lst = list(1,2)
   MyProc(arglist(lst))  //MyProc(1,2)

   lst = list(b=2,a=1)   //just to illustrate that order does not matter
   MyProc(arglist(lst))  //MyProc(b=2,a=1)  -->  MyProc(1,2)
</xmp>

<hr>

<a name=/proc/arguments>
<h2>arguments (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arguments/named>named arguments (proc)</a>
<dd><a href=#/operator/path>path operators</a>
<dd><a href=#/proc/arglist>arglist proc</a>
<dd><a href=#/proc/var/args>args var (proc)</a>
</dl>

<p>The parameters to a proc are referred to as arguments.  To define
argument variables, place them inside the ()'s in the proc definition.  A
default value may be specified.  Otherwise, arguments default to null.

<h3>Example:</h3>
<xmp>
proc/Sum(a,b)
  return a + b
</xmp>

<h3>Example:</h3>
<xmp>
proc/set_mob_desc(mob/M,desc="big and bad")
  M.desc = desc
  world << "The new desc for [M] is [desc]."
</xmp>

<p>Note how the variable type may be specified.  It is just like any other
variable definition, except "<code>var/</code>" is implicit and does not need
to be typed.

<hr>

<a name=/proc/arguments/named>
<h2>named arguments (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/New>New proc (atom)</a>
<dd><a href=#/proc/arglist>arglist proc</a>
<dd><a href=#/proc/arguments>arguments (proc)</a>
</dl>

<p>The parameters passed to a procedure are called arguments.  These may
either be passed in positional order, or they can be passed as <em>named
arguments</em>.  Not all procedures are defined with the intention of
supporting named arguments, so consult the documentation for the procedure in
question first.  (This is mainly an issue of whether the argument names might
change in the future.)

<p>The following example shows several ways of producing the same call to a
procedure.

<h3>Example:</h3>
<xmp>
mob/proc/MyProc(a,b,c)
	src << "MyProc([a],[b],[c])"

mob/verb/test()
	MyProc(1,2,3)       //positional parameters
	MyProc(a=1,b=2,c=3) //named arguments
	MyProc(1,b=2,c=3)   //positional and named arguments
	MyProc(c=3,a=1,b=2) //named arguments can come in any order
</xmp>

<p>To prevent silent errors, named arguments that do not match any of the
arguments of the procedure being called will generate a runtime error.  This
is somewhat different from the behavior of positional arguments in DM where it
is perfectly acceptable to pass more arguments than were explicitly defined in
the procedure.

<p>As always, arguments that are not assigned in the call will simply be given
the value null (or whatever default value is specified in the definition).

<p>When an object procedure is overridden, the variable names in the new
definition are the ones that get matched against named arguments in a call to
that procedure.  A procedure which is intended to support named arguments
should therefore be defined with care so as to conform to the interface
expected by users of the procedure.  That doesn't stop you from changing that
interface when overriding a procedure, but the normal case would be to
preserve the argument names of the base procedure when overriding it.

<p>The following example is not useful, but it illustrates a situation where a
procedure is overridden so as to preserve the same argument names and
positions.  As mentioned above, you are not <em>required</em> to preserve
either the names or positions, but that is usually what you want.

<h3>Example:</h3>
<xmp>
mob
   proc/MyProc(a,b,c)
      usr << "mob.MyProc([a],[b],[c])"

   mob/verb/test()
      MyProc(a=1,b=2,c=3)

   special_mob
      MyProc(a,b,c,d)
         if(d) ..()      //pass in same order
         else ..(c,b,a)  //pass in reverse order

      test()
         MyProc(a=1,b=2,c=3,d=0) //normal order
         MyProc(a=1,b=2,c=3,d=1) //reverse the order

</xmp>

<p>This example merely used positional parameters in the call to
<code>..()</code>, but one can use named arguments there too if it is
desirable.

<p>The best time to use named arguments is when calling a procedure that takes
a lot of optional parameters.  You can just name the ones that you want to
assign and leave the rest unspecified.  Trying to do the same thing with
positional parameters can be much more awkward&ndash;especially when the
arguments you do want to assign are preceded by a number of ones that you
don't care to assign.  It's easy to lose your place in the list or to forget
what it does.

<p>Since named arguments involve a slight amount of extra overhead, one should
avoid them in code that is highly cpu intensive due to being called many many
times.  Otherwise, code clarity may be a bigger priority.

<hr>

<a name=/proc/ascii2text>
<h2>ascii2text proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text/entities>entities (text)</a>
<dd><a href=#/proc/text2ascii>text2ascii proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ascii2text(N)
</dl>

<dl><dt><b>Returns:</b>
<dd>A text string.
</dl>

<dl><dt><b>Args:</b>
<dd>N: A number.
</dl>

<p>ASCII codes are numerical values corresponding to keyboard and special
characters. Among other things, they are used to represent many symbols in
HTML.  This proc converts an ASCII code to its corresponding text
representation.

<h3>Example:</h3>
<xmp>
T = ascii2text(65)  // = "A"
</xmp>

<p>BYOND now supports <a href=#/{notes}/Unicode>Unicode</a> via UTF-8
encoding, so you can use the character code for any valid Unicode
character, not just ASCII.

<hr>

<a name=/proc/astype>
<h2 byondver=516>astype proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/istype>istype proc</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>astype(Val,Type)
<dd>astype(Val)
</dl>

<dl><dt><b>Returns:</b>
<dd>Val if Val is derived from Type; null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Val:  An object instance.
<dd>Type: An object prototype or instance. If no type is specified, it will be implied (see below).
</dl>

<p>Forcibly casts an object to a type, returning null if it isn't valid.

<h3>Example:</h3>
<xmp>
astype(gift, /obj/potion)?.Drink()
</xmp>

<p>Similarly to <tt>istype()</tt>, the type can be implied. The implied type is determined as
follows:

<ol>
<li>If <tt>astype()</tt> is on the right-hand side of an assignment operation, the left-hand side's var type is the implied type, just like with the <tt>new()</tt> operator.</li>
<li>Otherwise, the var type of the first argument is the implied type, just as it is in <tt>istype()</tt>.</li>
</ol>

<h3>Example:</h3>
<xmp>
// if obstacle is of type /obj/box, it will be assigned to B; otherwise B is null
var/obj/box/B = astype(obstacle)
if(B?.closed) B.Open()

// B is assigned no matter what, but astype() will return null if it isn't an /obj/box
B = obstacle
if(astype(B)?.closed) B.Open()
</xmp>

<hr>

<a name=/proc/block>
<h2>block proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
</dl>

<dl><dt><b>Format:</b>
<dd>block(Start,End)
<dd byondver=515>block(StartX,StartY,StartZ, EndX=StartX,EndY=StartY,EndZ=StartZ)
</dl>

<dl><dt><b>Returns:</b>
<dd>The list of turfs in the 3D block defined by Start and End (inclusive).
</dl>

<dl><dt><b>Args:</b>
<dd>Start: A turf to be the lower-left corner of the block.
<dd>End: A turf to be the upper-right corner of the block.
<dd>StartX, StartY, StartZ: XYZ coordinates of the lower-left corner of the block.
<dd>EndX, EndY, EndZ: XYZ coordinates of the upper-right corner of the block.
</dl>

<p>The following example shows how to loop over a block of turfs.

<h3>Example:</h3>
<xmp>
world
   maxx = 20
   maxy = 20

mob/verb/block_test()
   var/turf/T
   for(T in block(locate(1,1,1), locate(10,10,1)))
      T.text = " "
</xmp>

<p>In the version that uses coordinates directly instead of two turfs, you can
leave any of the EndX, EndY, or EndZ values as null, and omit the last
arguments entirely; they will default to using the corresponding StartX,
StartY, or StartZ. Therefore this example is equivalent to the one above:

<h3>Example:</h3>
<xmp>
world
   maxx = 20
   maxy = 20

mob/verb/block_test()
   var/turf/T
   for(T in block(1,1,1, 10,10))
      T.text = " "
</xmp>

<hr>

<a name=/proc/bound_pixloc>
<h2 byondver=516>bound_pixloc proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/atom/var/pixloc>pixloc var (atom)</a>
<dd><a href=#/proc/pixloc>pixloc proc</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>bound_pixloc(Atom, Dir)
</dl>

<dl><dt><b>Returns:</b>
<dd>A <tt>pixloc</tt> object representing a corner, side, or center of atom bounds.
</dl>

<dl><dt><b>Args:</b>
<dd>Atom: An atom.
<dd>Dir: The side or corner to use, or 0 for center.
</dl>

<p>Creates a new <tt>pixloc</tt> object based on an existing object's bounds.
If either <tt>bound_x</tt> or <tt>bound_y</tt> are nonzero, then
<tt>bound_pixloc(atom, SOUTHWEST)</tt> will differ from <tt>atom.pixloc</tt>.

<p>If the atom is not directly on the map, this value is null.

<h3>Example:</h3>
<xmp>
mob/verb/DistanceTo(atom/A)
    var/my_center = bound_pixloc(src, 0)
    var/A_center = bound_pixloc(A, 0)
    var/vector/V = A_center - my_center
    return length(V)
</xmp>

<hr>

<a name=/proc/bounds>
<h2>bounds proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/obounds>obounds proc</a>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
<dd><a href=#/client/var/bounds>bounds var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>bounds(Ref=src, Dist=0)
<dd>bounds(Ref, x_offset, y_offset, extra_width=0, extra_height=0)
<dd>bounds(x, y, width, height, z)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of atoms (except areas) within the given bounding box.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref:    A turf, obj, mob, pixloc, or a pair of pixlocs as two arguments.
<dd>Dist:   A number (distance in pixels).
<dd>x_offset, y_offset: Shifts bounding box position
<dd>extra_width, extra_height: Adjusts bounding box size
<dd>x, y, z: Lower left corner of bounding box in absolute coords; x=1,y=1 is lower left of map
<dd>width, height: Size of bounding box in absolute coords
</dl>

<p>To leave Ref out of the results, use obounds() instead.

<p>Calling bounds() will default to bounds(src,0), if src is a turf, obj, or
mob. This returns all turfs, objs, and mobs (including src) within src's
bounding box. If a single pixloc is used for Ref, it will have no width or
height; you can use a pair of pixlocs instead to get a block between two
pixlocs.

<p>Changing the distance will return all objects within that distance from the
bounding box. E.g., bounds(turf,12) will show you everything within 12 pixels
of that turf.

<p>An object's bounding box can also be offset. bounds(src,-6,0) shows what src
would touching if it moved 6 pixels west. bounds(turf,-12,-12,24,24) is
equivalent to bounds(turf,12).

<p>In the final form, bounds() can use absolute coordinates and does not need
an object to be Ref. Absolute coordinates start at 1,1 at the lower left corner
of the map, by tradition.

<p>Note: A <a href=#/vector>vector</a> may be used in place of any x/y or
width/height pair.

<hr>

<a name=/proc/bounds_dist>
<h2>bounds_dist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/proc/bounds>bounds proc</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Format:</b>
<dd>bounds_dist(Ref, Target)
</dl>

<dl><dt><b>Returns:</b>
<dd>The distance, in pixels, between Ref's and Target's bounding boxes.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref:    A turf, obj, or mob.
<dd>Target: A turf, obj, or mob.
</dl>

<p>The value returned by bounds_dist() is the number of pixels that
the two objects would have to move closer together (if this is even
possible, of course) to be touching but not overlapping.

<p>A return value of 12 for instance means the two objects have a gap
of 12 pixels between them.

<p>A return value of 0 means the two objects are not overlapping, but
their bounding boxes touch.

<p>A return value of -2 means the two objects are overlapping by 2
pixels; they would have to move 2 pixels apart to separate.

<hr>

<a name=/proc/break>
<h2>break statement</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/continue>continue statement</a>
<dd><a href=#/proc/do>do proc</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
<dd><a href=#/proc/while>while proc</a>
<dd><a href=#/proc/switch>switch proc</a>
<dd><a href=#/DM/preprocessor/pragma/syntax>#pragma syntax directive</a>
</dl>

<dl><dt><b>Format:</b>
<dd>break
<dd>break Label
</dl>

<p>Terminate the loop with the given label.  If no label is specified, the
innermost loop containing the <code>break</code> statement is assumed.

<h3>Example:</h3>
<xmp>
obj/zapper
  verb/use()
    var/mob/M

    for(M in view())
      if(!M.key) break

    if(!M) M = usr
    M << "ZAP!"
    del(M)
</xmp>

<p>The zapper object kills the first mob it finds that doesn't belong to a
player.  If none can be found, it kills the user.  Be careful!  Note how
this code takes advantage of the fact that the loop variable <var>M</var>
will be <code>null</code> if the loop terminates normally.

<p>For an example of how to use labeled loops, see the reference section for
the <code>continue</code> statement.

<p>The <tt>break</tt> statement can also be used inside of a
<a href=#/proc/switch><tt>switch()</tt> proc</a> when using
<a href=#/DM/preprocessor/pragma/syntax>C-like syntax</a>, where it
breaks out of a <tt>case</tt> block to the end of the switch. See
<a href=#/proc/switch>switch proc</a> for more details.

<hr>

<a name=/proc/browse>
<h2>browse proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/browse_rsc>browse_rsc proc</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/link>link proc</a>
<dd><a href=#/proc/run>run proc</a>
<dd><a href=#/proc/output>output proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>usr &lt;&lt; browse(Body,Options)
</dl>

<dl><dt><b>Args:</b>
<dd>Body: html text, file, or null to close the browser.
<dd>Options: optional parameters
</dl>

<p>This sends the html text or file to the user and optionally displays it in
the web browser.  The default action is to use the embedded browser panel in the Dream
Seeker window; specifying an alternate window name (see below) causes it to appear in a
popup window.  Passing in 'null' for the html text causes the browser panel or named
window to be closed.

<p>The option parameters should either be omitted or they should be in a text
string of the following format:

<code>
"<var>window</var>=name;<var>file</var>=name;<var>display</var>=1;
<br><var>size</var>=300x300;<var>border</var>=0;<var>can_close</var>=1;
<br><var>can_resize</var>=1;<var>can_minimize</var>=1;<var>titlebar</var>=1"
</code>

<p>You may use commas (,), ampersands (&amp;), or semicolons (;) as the
delimiter.  Any or all of the parameters may be specified and they may be
included in any order.

<h3>General options</h3>
These control how to handle the text or file.
<p>
<dl>
<dt>window
<dd>This is the name used to identify the popup window.  It is not visible to
the user.  Multiple calls to browse() with the same window name overwrite
previous contents of the same popup window.  If window is not specified, the
embedded browser panel will be used.

<dt>file
<dd>When this is unspecified, the client will store the generated html file in the
user's byond "cache" directory with an appropriate name.  If Body is a
text string, the client will generate a unique name.  If it is a file, it will use
the name of the file.  You can override this by setting this parameter.  This is
only useful when you need to reference the file later, typically in tandem with the
display setting below.

<dt>display
<dd>This controls whether the browser actually displays Body in the web browser
or not.  If it is turned off (display=0), the text or file is simply sent
to the user and expected to be referenced later.  This might be useful, for instance, to first send an image to a user and then display a web page that uses that image:
<xmp>
usr << browse('monster.png',"display=0")
usr << browse("<img src=monster.png>A scary monster appears from the mist!")
</xmp>
Note that this performs the same function as the <a href=#/proc/browse_rsc>browse_rsc</a> proc (preserved for legacy reasons).  It is a little more powerful because you can use
it to send html text as well as files.  In that case, you'll have to also supply the file=name argument so that you can reference the html text from within a later browse().
<p>
When display=0, all of the other arguments besides file are ignored.
</dl>

<h3>Popup options</h3>
These control how the popup window initially appears.  Setting these parameters for
an existing popup window or the embedded browser has no effect.
<p>
<dl>
<dt>border

<dd>This is the width of the border between the edges of the dialogue and the window
content.  The default value is 0, meaning that the entire window is filled with
html content.

<dt>size

<dd>This is the size of the popup window in pixels.  The format is
<code>WIDTHxHEIGHT</code>.

<dt>can_close

<dd>This specifies whether the window should be closable.  The default value
is 1, which enables the standard "X" button for closing.

<dt>can_resize

<dd>This controls whether the window is resizable.  The default value is 1,
enabling resizing and maximizing.

<dt>can_minimize

<dd>This controls whether the window is minimizable.  The default value is 1,
enabling the standard minimization button.

<dt>titlebar

<dd>The default titlebar=1 enables the standard bar at the top of the window.
Turning it off disables can_close and can_minimize.

</dl>

<p>Note also that many display options can be controlled through the html
itself.  For instance, to turn off the scrollbars, you can do:
<code>&lt;body scroll=no&gt;</code>; to add a title, you can do:
<code>&lt;head&gt;&lt;title&gt;My Title&lt;/title&gt;&lt;/head&gt;</code>; and so forth.

<p>The following example displays a help page in a popup window.

<h3>Example:</h3>

<xmp>
var/const/help = {"
<html>
<head><title>Help!</title></head>
<body>

You are beyond help!

</body>
</html>
"}
client/verb/help()
   usr << browse(help,"window=help")
</xmp>

You can use commands like <a href=#/proc/output>output()</a> and
<a href=#/proc/winset>winset()</a> to interact with popups. The name of the
window is the same name you gave the popup, and the browser is
"[windowname].browser".

<h3>Example:</h3>

<xmp>
client/verb/more_help()
   usr << output("You are still beyond help!", "help.browser")
</xmp>


<hr>

<a name=/proc/browse_rsc>
<h2>browse_rsc proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/browse>browse proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>usr &lt;&lt; browse_rsc(File,FileName)
</dl>

<dl><dt><b>Args:</b>
<dd>File: a resource file (such as an image)
<dd>FileName: name of file (if different from source file)
</dl>

<p>This sends the specified resource file to usr (or anybody else) and
stores it in their <code>cache</code> directory with the specified name.  In
subsequent <code>browse()</code> output, you can then refer to that file.

<p>If your world is always running on the internet, you can save yourself
the trouble and simply link to the image files through a web server.
However, if it may be played offline, you can compile in the resource files
and manually send them to players with <code>browse_rsc()</code>.

<p>Note that no data is transmitted if it already exists in the user's
cache, so there is little overhead in calling this every time you are about
to use <code>browse()</code>.

<h3>Example:</h3>
<xmp>
area
   var
      room_graphic = 'cozy_room.jpg'
   Enter(O)
      . = ..() //do default checks
      if(.)    //if we got clearance to enter
         O << browse_rsc(room_graphic,"room.jpg")
         O << browse("<p><img src=room.jpg></p>[desc]")
</xmp>

<hr>

<a name=/proc/call>
<h2>call proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arglist>arglist proc</a>
<dd><a href=#/proc/call_ext>call_ext proc</a>
<dd><a href=#/proc/hascall>hascall proc</a>
<dd><a href=#/operator/path>path operators</a>
</dl>

<dl><dt><b>Format:</b>
<dd>call(ProcRef)(Arguments)
<dd>call(Object,ProcName)(Arguments)
<dd deprecated>call(LibName,FuncName)(Arguments) (use <tt>call_ext()</tt> instead)
</dl>

<dl><dt><b>Args:</b>
<dd>ProcRef: path of proc (/proc/MyProc)
<dd>Object: source of proc or verb
<dd>ProcName: name of proc or verb ("MyProc")
<dd deprecated>LibName: name of external library ("test.DLL")
<dd deprecated>FuncName: name of function in external library ("func")
</dl>

<dl><dt><b>Returns:</b>
<dd>The return value of the proc being called.
</dl>

<p>This instruction exists in order to call procs dynamically, since the proc
reference or name may be an expression rather than a hard-coded value.  This
may serve the same purpose as a "function pointer" in C programs.

<p>The following examples do not demonstrate why you would want to do this,
but the syntax is illustrated.  The first one calls a specific procedure by
using a path reference to that procedure.

<h3>Example:</h3>
<xmp>
/proc/MyProc(Arg)
   usr << "MyProc([Arg])"
mob
   var
      MyProc = /proc/MyProc
   verb
      call_myproc()
         call(MyProc)("Hello, world!")
</xmp>

<p>The next example calls an object procedure (or verb) by name, rather than
by path.

<h3>Example:</h3>
<xmp>
mob
   proc
      Proc1(Arg)
         usr << "Proc1([Arg])"
      Proc2(Arg)
         usr << "Proc2([Arg])"
   verb
      call_proc(Proc in list("Proc1","Proc2"))
         call(src,Proc)("Hello, world!")
</xmp>

<p>Note: In prior versions, <tt>call()</tt> was also used to access third-party
libraries (.DLL files on Windows, .SO files on Unix), but this has been moved
to <a class=code href=#/proc/call_ext>call_ext()</a> for clarity.

<hr>

<a name=/proc/call_ext>
<h2 byondver=515>call_ext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/load_ext>load_ext proc</a>
<dd><a href=#/proc/arglist>arglist proc</a>
<dd><a href=#/proc/call>call proc</a>
<dd><a href=#/operator/path>path operators</a>
<dd><a href=#/{{appendix}}/Byondapi>Byondapi</a>
</dl>

<dl><dt><b>Format:</b>
<dd>call_ext(LibName,FuncName)(Arguments)
<dd>call_ext(LoadedFunc)(Arguments)
</dl>

<dl><dt><b>Args:</b>
<dd>LibName: name of external library ("test.DLL") (note: the .dll or .so suffix is not required)
<dd>FuncName: name of function in external library ("func"), which may have prefixes to describe the type of function
<dd>LoadedFunc: reference to a function that was loaded via <tt>load_ext()</tt>
</dl>

<dl><dt><b>Returns:</b>
<dd>The return value of the external library function.
</dl>

<p>This instruction exists in order to access third-party libraries (.DLL
files on Windows, .SO files on Unix), as long as the one or more of the
following conditions is met:
<ul>
<li>The library is located in the BYOND user <tt>bin/</tt> folder
(<tt>~/.byond/bin</tt> on Unix, typically
<tt>%APPDATA%/Documents/BYOND/bin/</tt> on Windows).  This is intended to
allow the user to install permanently "trusted" libraries. <b><i>OR</i></b></li>
<li>The server is run in <tt>-trusted</tt> mode. <b><i>OR</i></b></li>
<li>The server grants permission to access the library at runtime, through a
prompt query.</li>
</ul> 

<p>If the library access or lookup fails for any reason, a runtime error will
be thrown.

<p>Normally you use LibName and FuncName, and <tt>call_ext()</tt> will look up
the function for you. However you can save a little time by using
<tt>load_ext()</tt>, which will do the lookup once and let you reuse the
reference to that function as often as you need to, which should be helpful for
performance-hungry code.

<h3>String version</h3>

<p>The standard way of making external calls (and until version 515, the only
way) uses strings for everything. Any arguments that are not strings are
passed as empty strings instead. The call is prototyped in the DLL this way:

<pre class=cpp>
extern "C" char *func(unsigned int argc, char *argv[]);
</pre>

<p>The <tt>argc</tt> argument is a number of arguments, and <tt>argv</tt> is
an array of the arguments themselves. The integer must be 32-bit.

<p>As the library prototype is <tt>char**</tt>, the <tt>call_ext()</tt>
arguments must be strings. Other types (like numbers) will be passed as the
empty string (<tt>""</tt>) into the library function.

<h3 class=cpp>Example:</h3>
<pre class=cpp>
// test.dll, a win32 C++ library compiled in VC++:
#include &lt;string.h&gt;
// This is an example of an exported function.
// Windows requires __declspec(dllexport) to be used to declare public symbols
// The name of the function from within the dll may be compiler-dependent
// (in this case it will usually be "merge" or "_merge").
// Google "name decoration" for more information on this exciting topic.
extern "C" __declspec(dllexport) char *merge(int n, char *v[]) 
{
    static char buf[500]; 
    *buf=0;
    for(int i=0; i&lt;n; i++) {
        strcat(buf,v[i]); // we should bounds-check but it's a stupid example!
    }
    return buf;
}
</pre>

<xmp>
// DM code to use test.dll
mob/verb/test()
    usr << call_ext("test.dll","merge")("fee","fi","fo") // returns "feefifo"

// As with the other call() versions, arglist() may be used to do runtime arguments:
mob/verb/argtest()
    var/L = list("fee","fi","fo")
    usr << call_ext("test.dll","func")(arglist(L)) // returns "feefifo"
</xmp>

<p>The <tt>char *</tt> pointer returned by the library is expected to be
cleaned up by the library when it's unloaded, or it can be cleaned up on a
subsequent function call. BYOND makes a copy of the string when the function
returns and does not need it after that.

<h3 byondver=515>Byondapi version</h3>

<p>A newer and more flexible way of calling external libraries is now
available, and it allows you to pass strings, numbers, and references, and
also get other types of valus in return. This uses
<a href=#/{{appendix}}/Byondapi>Byondapi</a> and requires your external
library to be compiled with the <tt>byondapi.h</tt> header file (if using C
or C++). Byondapi also includes helpful C++ wrapper classes in separate files.

<p>With Byondapi calls, the function name you use in <tt>call_ext()</tt>
should be prefixed by <tt>byond:</tt> so that the engine knows what type of
function it is. In your library, the call is prototyped like so:

<pre class=cpp>
extern "C" CByondValue func(u4c argc, CByondValue argv[]);
</pre>

<p>The <tt>u4c</tt> type is an unsigned 32-bit integer, defined in
<tt>byondapi.h</tt>. <tt>CByondValue</tt> is also defined there. Interacting
with a CByondValue structure requires the functions exported as part of
Byondapi.

<h3 class=cpp>Example:</h3>
<pre class=cpp>
// test_byondapi.dll, a win32 C++ library compiled in VC++:
#include &lt;byondapi.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;

// a different take on the merge example above
extern "C" BYOND_EXPORT CByondValue merge(int n, CByondValue v[])
{
    CByondValue result;
    u4c buflen = 1024;  // initial size of buffer
    u4c totallen = 0;   // length of total string so far (not including trailing null)
    char *buf = (char*)malloc(buflen);

    if(!buf) {  // we couldn't allocate memory
        ByondValue_Clear(&result);
        return result;
    }

    for(int i=0; i&lt;n; i++) {
        u4c len = buflen - totallen;    // # of bytes left in buffer
        bool success = Byond_ToString(v[i], buf+totallen, &len);
        // on success, len is filled with # of bytes written (including trailing null)
        if(success) {
            totallen += (len-1);
        }
        // if we failed but len > 0, it's the new size of the buffer we need
        else if(len) {
            len = (len + 1023) & ~1023; // round up to 1K increments
            char *newbuf = (char *)mallloc(len);
            if(!newbuf) {   // out of memory; stop here
                ByondValue_Clear(&result);
                return result;
            }
            memcpy(newbuf, buf, totallen+1);    // include trailing null in copy
            free(buf);
            buf = newbuf; buflen = len;
            --i;  // retry Byond_ToString() for this argument
        }
        // if we failed but len == 0, there was an error
        else {
            free(buf);
            ByondValue_Clear(&result);
            return result;
        }
    }
    ByondValue_SetStr(&result, buf);    // create a new internal string
    free(buf);  // free the buffer
    return result;
}

extern "C" BYOND_EXPORT CByondValue average(int n, CByondValue v[])
{
    CByondValue result;
    float total = 0.0f;
    int count = 0;
    for(int i=0; i&lt;n; i++) {
        if(!ByondValue_IsNum(v[i])) continue;
        total += ByondValue_GetNum(v[i]);
        ++count;
    }
    if(count) ByondValue_SetNum(&result, total / count);
    else ByondValue_Clear(&result); // return null on failure
    return result;
}
</pre>

<xmp>
// DM code to use test_byondapi.dll
mob/verb/test()
    usr << call_ext("test_byondapi","byond:merge")("fee","fi","fo") // returns "feefifo"

mob/verb/average()
    usr << call_ext("test_byondapi","byond:average")(1,6,8)  // returns 5
</xmp>

<p>You are of course allowed to mix different argument types, so they don't
all have to be numbers or all strings. Your library code can use the Byondapi
functions to interact with these values.

<h3>Other prefixes</h3>

<p>For advanced users: on Windows, <tt>call_ext()</tt> uses the <tt>__cdecl</tt>
convention by default. If you are designing or linking to a DLL that uses the
<tt>__stdcall</tt> convention instead, you can inform <tt>call_ext()</tt> by
prefacing the function name with the <tt>"@"</tt> symbol. E.g.,
<tt>call_ext("test.dll","@merge")</tt> would call a version of <tt>merge</tt>
declared with the <tt>__stdcall</tt> convention. Likewise if you use the
Byondapi version, you can use <tt>call_ext("test.dll","@byond:merge")</tt> or
<tt>call_ext("test.dll","byond:@merge")</tt> (it doesn't matter which order the
prefixes go in).

<hr>

<a name=/proc/ceil>
<h2 byondver=515>ceil proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/floor>floor proc</a>
<dd><a href=#/proc/round>round proc</a>
<dd><a href=#/proc/trunc>trunc proc</a>
<dd><a href=#/proc/fract>fract proc</a>
<dd><a href=#/proc/sign>sign proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ceil(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>the ceiling of A
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number, pixloc, or vector.
</dl>

<p>Returns the ceiling of A (the largest integer greater than or equal to A).

<h3>Example:</h3>
<xmp>
usr << ceil(1.45) // outputs 2

usr << ceil(-1.45) // outputs -1
</xmp>

<hr>

<a name=/proc/ckey>
<h2>ckey proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ckeyEx>ckeyEx proc</a>
<dd><a href=#/mob/var/ckey>ckey var (mob)</a>
<dd><a href=#/savefile>savefile</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ckey(Key)
</dl>

<dl><dt><b>Args:</b>
<dd>Key: The player key to convert to canonical form.
</dl>

<dl><dt><b>Returns:</b>
<dd>The key in canonical form.  To do this, it strips all punctuation and
    space from the key and converts to lowercase.  The result is still
    unique for each different key.
</dl>

<p>The result could be used as a unique directory name in a server-side save
file.  Each player could be stored in a separate directory.  By converting
to canonical form, possible problems resulting from punctuation (like the
path delimiter '/') in the key would be avoided.  If players are saved in
stand-alone files, it could be equally useful for generating a unique file
name.

<p>Note that this may be used on any text string.  It is not just limited to
keys.

<h3>Example:</h3>
<xmp>
var/savefile/SaveFile = new("world.sav")
proc/SavePlayer(mob/M)
  var/keydir = ckey(M.key)
  SaveFile.cd = "/players"
  SaveFile.cd = keydir
  M.Write(SaveFile)

proc/LoadPlayer(mob/M)
  var/keydir = ckey(M.key)
  SaveFile.cd = "/players"
  if(!SaveFile.Find(keydir)) return 0
  SaveFile.cd = keydir
  M.Read(SaveFile)
  return 1
</xmp>

<p>This example defines two procs for saving and loading players to a
server-side file.  These could be called in mob.Login() and mob.Logout().
Notice that instead of calling SaveFile.Write(M), this example instead calls
M.Write(SaveFile) directly.  The difference is that in this example we did
not want a new mob to be created when loading the player but instead wanted
to load information into an existing mob.

<p>In this example, the ckey() proc was used, but it would be more efficient
to use mob.ckey, which is the same value precomputed.

<hr>

<a name=/proc/ckeyEx>
<h2>ckeyEx proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ckey>ckey proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ckeyEx(Text)
</dl>

<dl><dt><b>Args:</b>
<dd>Text: The text string to convert to case-sensitive canonical key form.
</dl>

<dl><dt><b>Returns:</b>
<dd>The same text stripped of all punctuation and space.  Unlike, ckey(),
    case is preserved as are the '-' and '_' characters.
</dl>

<p>The true canonical form of a key is in all lowercase, but occasionally,
it is nice to preserve case when stripping a key (or other text) of any
special characters.

<p class=compatibility>Note: This proc used to be named <tt>cKey</tt>, like
<tt>ckey</tt> but with a capital k. To avoid confusion it has been renamed,
but old code will still compile with a warning.

<hr>

<a name=/proc/clamp>
<h2 byondver=513>clamp proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/min>min proc</a>
<dd><a href=#/proc/max>max proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>clamp(Value, Low, High)
<dd>clamp(List, Low, High)
</dl>

<dl><dt><b>Args:</b>
<dd>Value: A number, text, pixloc, or vector (or null, treated as 0).
<dd>List: A list of values.
<dd>Low: The lowest value that can be returned.
<dd>High: The highest value that can be returned.
</dl>

<dl><dt><b>Returns:</b>
<dd>A copy of the original Value, constrained between Low and High.
<dd>The original List, whose contents have all been clamped.
</dl>

<p>"Clamps" a value, usually a number, to a given allowable range from
<tt>Low</tt> to <tt>High</tt>. If the value is already in that range, it is
unchanged. Otherwise, the closer of <tt>Low</tt> or <tt>High</tt> is returned.

<p>If the <tt>Low</tt> and <tt>High</tt> values are out of order, it doesn't
matter.

<p>This is effectively equivalent to <tt>min(max(Value, min(Low,High)),
max(Low,High))</tt>, but slightly faster.

<h3>Example:</h3>
<xmp>
usr << clamp(5, 0, 10)  // 5; it falls between 0 and 10
usr << clamp(-1, 0, 10) // 0; it is less than 0
usr << clamp(20, 0, 10) // 10; it is more than 10
</xmp>

<p>If the compared items are objects such as pixlocs or vectors, the result of
clamping them is a new object, not one of the objects that was compared.

<p>The list format will accept a list in place of a value as the first
argument, and it behaves as if you looped through the entire list and ran
<tt>clamp()</tt> on each value. Please note the original list will be
modified. If you want to leave the original list alone, use the
<a href=#/list/proc/Copy><tt>Copy()</tt> proc</a> to pass a copy to
<tt>clamp()</tt> instead.

<hr>

<a name=/proc/cmptext>
<h2>cmptext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/cmptextEx>cmptextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>cmptext(T1,T2,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all arguments are equal; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of text strings to compare.
</dl>

<p>This instruction is NOT sensitive to case.  It also ignores the
<code>\proper</code> and <code>\improper</code> text macros.  The
case-sensitive version is cmptextEx().

<h3>Example:</h3>
<xmp>
if(cmptext("Hi","HI"))
   world << "Equal!"
else
  world << "Not equal!"
</xmp>

<p>This outputs "Equal!" since "Hi" and "HI" are the same, ignoring case.

<hr>

<a name=/proc/cmptextEx>
<h2>cmptextEx proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/cmptext>cmptext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>cmptextEx(T1,T2,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all arguments are equal; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of text strings to compare.
</dl>

<p>This instruction is sensitive to case.  The case-insensitive version is
cmptext().

<p>Because identical text is internally combined to conserve memory,
cmptextEx(T1,T2) is equivalent to (T1 == T2).

<h3>Example:</h3>
<xmp>
if(cmptextEx("Hi","HI"))
   world << "Equal!"
else
  world << "Not equal!"
</xmp>

<p>This outputs "Not equal!" since "Hi" and "HI" are different when taking
case into account.

<p class=compatibility>Note: This proc used to be named cmpText, like cmptext
but with a capital T. To avoid confusion it has been renamed, but old code
will still compile.

<hr>

<a name=/proc/continue>
<h2>continue statement</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/break>break statement</a>
<dd><a href=#/proc/do>do proc</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
<dd><a href=#/proc/while>while proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>continue
<dd>continue Label
</dl>

<p>Begins the next iteration of the loop with the given label.  If no label
is specified, the innermost loop containing the continue statement is
assumed.

<p>In a <tt>for(Init,Test,Inc)</tt> loop, the <tt>continue</tt> statement will
jump to the <tt>Inc</tt> portion (if any) and move on to the conditional
<tt>Test</tt>. In a <tt>for(item in list)</tt> loop, it will skip to the
next item in the list. In a <tt>while</tt> or <tt>do-while</tt> loop,
<tt>continue</tt> jumps to the condition in the <tt>while</tt> statement.

<h3>Example:</h3>
<xmp>
client/verb/who()
  var/mob/M
  usr << "Players:"
  for(M in world)
    if(M == usr) continue
    if(M.key) usr << M.key
</xmp>

<p>This displays a list of players who have a mob in the world.  The
<code>continue</code> statement is used here to avoid including the user in
the list.  The same thing could have been achieved by using only the
<code>if</code> statement.  In more complicated situations, however, very
long conditional expressions and deeply nested <code>if</code> statements
can be avoided by using <code>continue</code> and its companion
<code>break</code>.

<p>Here is an example using a label to continue an outer loop from inside an
inner one:  <xmp> client/verb/loners()
  var/mob/M
  var/mob/G

  usr << "Loners:"
  finding_loners:
    for(M in world)
      for(G in world)
        if(M in G.group) continue finding_loners

      //found a loner
      usr << M.name
</xmp>

<p>This displays a list of mobs who do not belong in anyone else's group.
Notice the syntax for labeling a list.  The name of the block is simply
placed in the code followed by a colon and its contents are indented inside
it.

<hr>

<a name=/proc/copytext>
<h2>copytext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/splicetext>splicetext proc</a>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/splittext>splittext proc</a>
<dd><a href=#/proc/trimtext>trimtext proc</a>
<dd><a href=#/list/proc/Copy>Copy proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>copytext(T,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A text string.
</dl>

<dl><dt><b>Args:</b>
<dd>T:     A text string.
<dd>Start: The text byte position in which to begin the copy.
<dd>End: The text byte position immediately following the last character to be copied.
</dl>

<p>Copy characters in T between Start and End. The default end position of 0
stands for <tt>length(T)+1</tt>, so by default the entire text string is copied.

<h3>Example:</h3>
<xmp>
pre = copytext("Hi there",1,3))// = "Hi"
post = copytext("Hi there",4)) // = "there"
</xmp>

<p>If the start or end position is negative, it counts backwards from the end
of the string.

<h3>Example:</h3>
<xmp>
post = copytext("Hi there",-5)) // = "there"
</xmp>

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>copytext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/cos>
<h2>cos proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arccos>arccos proc</a>
<dd><a href=#/proc/sin>sin proc</a>
<dd><a href=#/proc/tan>tan proc</a>
<dd><a href=#/proc/turn>turn proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>cos(X)
</dl>

<dl><dt><b>Returns:</b>
<dd>The cosine of X, where X is in degrees.
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << cos(0)  // 1
   usr << cos(45) // 0.707...
   usr << cos(90) // 0
</xmp>

<hr>

<a name=/proc/del>
<h2>del proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/proc/Del>Del proc (datum)</a>
<dd><a href=#/DM/garbage>garbage collection</a>
<dd><a href=#/proc/refcount>refcount proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>del Object
</dl>

<dl><dt><b>Args:</b>
<dd>Object: Any data object (datum, savefile, world, you name it)
</dl>

<p>Destroy an object and null out all references to it.  Procs that are
executing with <code>src</code> equal to that object are silently killed,
causing execution to return to the caller.  If that is not what you want, you
should detach the proc from the source object by setting <code>src</code> to
<code>null</code>.

<p>When an object is deleted, its Del() procedure is called.  Currently, if
the Del() procedure does not execute the default action (by calling ..()),
then the deletion of the object is aborted.  You should not depend on this, as
it may change.  In other words, be sure to always call the default handler
after doing your own stuff.

<h3>Example:</h3>
<xmp>
mob/Del()
   src << "Aaaaaaaah!"
   ..()
mob/verb/self_destruct()
   del usr
</xmp>

<p>While manual object deletion is useful in many cases, the search for live
references to an object does take some time.  The more active objects in the
world, and the more variables in those objects, the longer the search will
take.  For larger projects, this search time can become significant.  In these
cases, as a best practice, manual deletion should be avoided by ensuring that
all references to an object are taken care of when the need for object
destruction arises.  Objects that have no references are deleted automatically
without the need for a search.  See <a href=#/DM/garbage>garbage collection</a>
for more details.

<hr>

<a name=/proc/do>
<h2>do proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/break>break statement</a>
<dd><a href=#/proc/continue>continue statement</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
<dd><a href=#/proc/while>while proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>do Statement while( E )
</dl>

<p>Execute Statement.  If E is true (non-zero) do it over again.  Continue
until E is false (zero).

<p>Statement may be a block of code or a single statement.

<h3>Example:</h3>
<xmp>
var/i = 3
do
  world << i--
while(i)
</xmp>

<p>This outputs:

<xmp>
3
2
1
</xmp>

<hr>

<a name=/proc/EXCEPTION>
<h2>EXCEPTION proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/try>try and catch statements</a>
<dd><a href=#/proc/throw>throw statement</a>
<dd><a href=#/exception>exception</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<dl><dt><b>Format:</b>
<dd>EXCEPTION(value)
</dl>

<dl><dt><b>Args:</b>
<dd>value: A text string (such as an error message) or other value
identifying the exception.
</dl>

<p>This is used to create an /exception datum, and is shorthand for calling
new/exception(value, __FILE__, __LINE__). The value you provide will be in
exception.name.

<hr>

<a name=/proc/fcopy>
<h2>fcopy proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/fcopy_rsc>fcopy_rsc proc</a>
<dd><a href=#/proc/shell>shell proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>fcopy(Src,Dst)
</dl>

<dl><dt><b>Args:</b>
<dd>Src: file to copy
<dd>Dst: new copy to make
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<p>Src may be either a cache file, a savefile, or the name of an external
file.  Cache files are specified in single quotes and external files are in
double quotes.  If the path to the destination file does not already exist,
it will be created.

<p>If the source and target are paths ending in "/", the contents of the
source directory (including sub-directories) will be copied to the target
path.

<p>This instruction could be useful when players upload files (like code)
that you might want to dump to an external file.

<h3>Example:</h3>
<xmp>
mob/verb/change_world(F as file)
  fcopy(F,"world.dm")
  shell("DreamMaker world")
  world.Reboot()
</xmp>

<p>This (somewhat dangerous) example allows players to upload code, recompile,
and reboot the world.  It assumes that DreamMaker is in the path where the
shell looks for executable files and also that the name of the running world
is world.dmb.

<hr>

<a name=/proc/fcopy_rsc>
<h2>fcopy_rsc proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/cache>cache</a>
<dd><a href=#/proc/fcopy>fcopy proc</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/load_resource>load_resource proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>fcopy_rsc(File)
</dl>

<dl><dt><b>Args:</b>
<dd>File: file to copy into the resource cache
</dl>

<dl><dt><b>Returns:</b>
<dd>reference to the file as a cache entry
</dl>

<p>The file to copy may either be a file name (text string) or the return
value of file() operating on the same.  If a cache entry is passed as the
argument, it will simply be returned with no action necessary.

<p>Once a file has been copied into the resource cache (i.e. the world's .rsc
file), it may be used as an icon or a sound or whatever is appropriate.  Most
internal operations involving resource files automatically perform this
operation when you try to use an external file in place of a cache entry.  For
example, when assigning a file() object to atom.icon, fcopy_rsc() is
implicitly invoked.

<p>The main reason you would ever want to call this explicitly is if you are
storing references to resource files in your own data structures and you want
to ensure that all values are converted to cache entries so they may be
directly compared to one another.

<hr>

<a name=/proc/fdel>
<h2>fdel proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/shell>shell proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>fdel(File)
</dl>

<dl><dt><b>Args:</b>
<dd>File: name of file to delete
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<p>If the specified file ends in '<code>/</code>', it is treated as a
directory.  Any contents (including sub-directories) are deleted as well.

<p>Be careful!

<hr>

<a name=/proc/fexists>
<h2>fexists proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/flist>flist proc</a>
<dd><a href=#/proc/ftime>ftime proc</a>
<dd><a href=#/proc/length>length proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>fexists(File)
</dl>

<dl><dt><b>Args:</b>
<dd>File: name of file to test
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if file exists; 0 otherwise.
</dl>

<hr>

<a name=/proc/file>
<h2>file proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/fcopy_rsc>fcopy_rsc proc</a>
<dd><a href=#/proc/ftp>ftp proc</a>
<dd><a href=#/proc/isfile>isfile proc</a>
<dd><a href=#/proc/link>link proc</a>
<dd><a href=#/proc/run>run proc</a>
<dd><a href=#/savefile>savefile</a>
<dd><a href=#/proc/sound>sound proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>file(Path)
</dl>

<p>Returns a file object corresponding to the named file.  This file object
can then be used in a variety of ways.  One would be to send it to a player to
view using the browse() instruction.  Output may also be appended to the file
using the << operator.

<p>Note that the file exists in the external filesystem (ie the hard disk)
and not the cache.  That means the path is specified in double quotes and
will be evaluated at run-time rather than compile-time.  The file need not
exist at compile time and may even be modified at a later date.  This is the
principle reason for using a file in the filesystem rather than a cached
resource file (specified in single quotes).

<h3>Example:</h3>
<xmp>
mob/verb/help()
  usr << browse(file("help.html"))
</xmp>

<p>Many DM instructions that deal with files treat file("name") and "name" the
same.  There are cases such as browse() where a simple text string is not
interpreted as a filename; it is in those situations where file() is really
necessary.

<hr>

<a name=/proc/file2text>
<h2>file2text proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/shell>shell proc</a>
<dd><a href=#/proc/text2file>text2file proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>file2text(File)
</dl>

<dl><dt><b>Args:</b>
<dd>File: file to read
</dl>

<dl><dt><b>Returns:</b>
<dd>the contents of the file.
</dl>

<p>This can be useful when interacting with external applications that
generate output in a text file.  For example, you might have an external
program that mimics conversation:

<h3>Example:</h3>
<xmp>
mob/oracle/verb/tell(T as text)
  text2file(T,"talk.in")
  shell("talk < talk.in > talk.out")
  usr << file2text("talk.out")
</xmp>

<hr>

<a name=/proc/filter>
<h2 byondver=512>filter proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/filters>filters var (atom)</a>
<dd><a href=#/{notes}/filters>Filter effects</a>
</dl>

<dl><dt><b>Format:</b>
<dd>filter(type = Type, parameter = Value, ...)
</dl>

<p>Creates a graphical filter that can be assigned or added to a list of
filters on an atom or image.

<p>This proc uses named arguments, and the "type" value must always be
included. To see which types of filters are available and what parameters
they accept, see <a href=#/{notes}/filters>Filter effects</a>.

<h3>Example:</h3>
<xmp>
atom/proc/Highlight(apply)
    if(apply)
        filters = filter(type="outline", size=1, color=rgb(255,0,0))
    else
        filters = null
</xmp>

<p>A filter created with this proc is an <i>abstract</i> filter; it is not
associated with any atom. When you add it to atom's filters, the atom gets a
copy of this filter, so changing the abstract filter's values afterward will
not change the atom's filters. For the same reason, an abstract filter can't
be animated.

<p>A filter that is part of an atom's filters list, like obj.filters[1], is an
<i>attached</i> filter. Changing the values for an attached filter will change
how that atom is displayed, and attached filters can be animated.

<h3 byondver=516>Named Filters</h3>

<p>Filters can also be given a <tt>name</tt> argument, and can be referred
to in an atom's <tt>filters</tt> list via that name (e.g. as
<tt>filters["shadow"]</tt>) instead of a numeric index.

<hr>

<a name=/proc/findlasttext>
<h2 byondver=510>findlasttext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/findtextEx>findtextEx proc</a>
<dd><a href=#/proc/findlasttextEx>findlasttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>findlasttext(Haystack,Needle,Start=0,End=1)
</dl>

<dl><dt><b>Returns:</b>
<dd>The last position of Needle in Haystack; 0 if not found.
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needle: The sub-text to search for.
<dd>Start: The text byte  position in Haystack in which to begin the search.
    Because this searches backwards, the default is the end of the string (0).
<dd>End: The earliest position in Haystack that can be matched as a result.
</dl>

<p>This instruction is NOT sensitive to the case of Haystack or Needle.  The
case-sensitive version is findlasttextEx().

<p>If the start or end position is negative, the position is counted backwards
from the end of the string. E.g., findlasttext("Banana", "na", -3) starts three
characters from the end and will skip over the last "na".

<p>Note: Unlike findtext(), a regular expression may NOT be used as the
Needle. Searching backwards is simply too complex for the regular expression
engine.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>findlasttext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/findlasttextEx>
<h2 byondver=510>findlasttextEx proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/findtextEx>findtextEx proc</a>
<dd><a href=#/proc/findlasttext>findlasttext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>findlasttextEx(Haystack,Needle,Start=0,End=1)
</dl>

<dl><dt><b>Returns:</b>
<dd>The last position of Needle in Haystack; 0 if not found.
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needle: The sub-text to search for.
<dd>Start: The text byte position in Haystack in which to begin the search.
    Because this searches backwards, the default is the end of the string (0).
<dd>End: The earliest position in Haystack that can be matched as a result.
</dl>

<p>This instruction is sensitive to the case of Haystack and Needle.  The
case-insensitive version is findlasttext().

<p>If the start or end position is negative, the position is counted backwards
from the end of the string.

<p>Note: Unlike findtextEx(), a regular expression may NOT be used as the
Needle. Searching backwards is simply too complex for the regular expression
engine.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>findlasttextEx_char()</tt>
to work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/findtext>
<h2>findtext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findlasttext>findlasttext proc</a>
<dd><a href=#/proc/findtextEx>findtextEx proc</a>
<dd><a href=#/proc/replacetext>replacetext proc</a>
<dd><a href=#/{notes}/regex>Regular expressions</a>
</dl>

<dl><dt><b>Format:</b>
<dd>findtext(Haystack,Needle,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The first position of Needle in Haystack; 0 if not found.
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needle: The sub-text to search for. May be a regular expression (regex).
<dd>Start: The text byte position in Haystack in which to begin the search.
<dd>End: The text byte position in Haystack immediately following the last
     character to search.
</dl>

<p>When Needle is text, this instruction is NOT sensitive to the case of
Haystack or Needle.  The case-sensitive version is findtextEx().

<h3>Example:</h3>
<xmp>
if(findtext("Hi There","there")==0)
  world << "Not found!"
else
  world << "Found!"
</xmp>

<p>This outputs "Found!", since "there" is a part of the string "Hi There",
ignoring case.

<p>If the start or end position is negative, the position is counted backwards
from the end of the string. E.g., findtext("Banana", "na", -3) starts three
characters from the end and only searches the final "ana".

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>findtext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/findtextEx>
<h2>findtextEx proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/replacetextEx>replacetextEx proc</a>
<dd><a href=#/{notes}/regex>Regular expressions</a>
</dl>

<dl><dt><b>Format:</b>
<dd>findtextEx(Haystack,Needle,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The position of Needle in Haystack; 0 if not found.
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needle: The sub-text to search for. May be a regular expression (regex).
<dd>Start: The text byte position in Haystack in which to begin the search.
<dd>End: The text byte position in Haystack immediately following the last
     character to search.
</dl>

<p>When Needle is text, this instruction is sensitive to the case of Haystack
and Needle.  The case-insensitive version is findtext().

<h3>Example:</h3>
<xmp>
if(findtextEx("Hi There","there")==0)
  world << "Not found!"
else
  world << "Found!"
</xmp>

<p>This outputs "Not found!", since "there" is not a part of the string "Hi
There", taking into account case.

<p>If the start or end position is negative, the position is counted backwards
from the end of the string. E.g., findtextEx("Banana", "na", -3) starts three
characters from the end and only searches the final "ana".

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>findtextEx_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<p class=compatibility>Note: This proc used to be named <tt>findText</tt>,
like <tt>findtext</tt> but with a capital T. To avoid confusion it has been
renamed, but old code will still compile.

<hr>

<a name=/proc/flick>
<h2>flick proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon_state>icon_state var (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>flick(Icon,Object)
</dl>

<dl><dt><b>Args:</b>
<dd>Icon:  An icon file or state name.
<dd>Object:   The target object.
</dl>

<p>Cause the icon attached to Object to be temporarily replaced with the
specified icon or icon state for the duration of the animation.  This is a
purely visual effect and does not effect the actual value of the object's
icon variable.

<h3>Example:</h3>
<xmp>
flick('blink.dmi',usr) //show another icon
flick("fight",usr)     //show usr's fight state
</xmp>

<p>The target object may be any atom or image.

<hr>

<a name=/proc/flist>
<h2>flist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/fexists>fexists proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>flist(Path)
</dl>

<dl><dt><b>Args:</b>
<dd>Path: The path in the filesystem to get a listing of.
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of files contained in the specified directory and whose names
     begin with the specified text.  The names of sub-directories are listed
     too, and are marked by a trailing "/".
</dl>

<p>The path is of the form "dir1/dir2/.../file".  Only files beginning with
the "file" part are listed, so be sure to end a directory name with "/" if
you wish to see its contents.  Otherwise you will just get that directory
name back with a "/" appended.

<p>Only files and sub-directories directly contained in the specified path
are listed (ie not the contents of the sub-directories too).  The file names
in the list do not include the path information but just the bare file name.

<hr>

<a name=/proc/floor>
<h2 byondver=515>floor proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ceil>ceil proc</a>
<dd><a href=#/proc/round>round proc</a>
<dd><a href=#/proc/trunc>trunc proc</a>
<dd><a href=#/proc/fract>fract proc</a>
<dd><a href=#/proc/sign>sign proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>floor(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>the floor of A
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number, pixloc, or vector.
</dl>

<p>Returns the floor of A (the largest integer less than or equal to A).

<h3>Example:</h3>
<xmp>
usr << floor(1.45) // outputs 1

usr << floor(-1.45) // outputs -2
</xmp>

<hr>

<a name=/proc/for>
<h2>for proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/for/list>for list proc</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
</dl>

<p>The for proc can be used to iterate values over a fixed range or list.
Consult the appropriate entry for more information.

<hr>

<a name=/proc/for/list>
<h2>for list proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/for/loop>for loop proc</a>
<dd><a href=#/list>list</a>
<dd><a href=#/list/assoc>list associations</a>
<dd><a href=#/proc/istype>istype</a>
</dl>

<dl><dt><b>Format:</b>
<dd>for (Var [as Type] [in List]) Statement
<dd>for (Var in Start to End [step Step]) Statement
<dd byondver=516>for (Key [as Type], Value in List) Statement
</dl>

<dl><dt><b>Args:</b>
<dd>Var:  A variable to sequentially contain each member of the list.
<dd>List: The list to loop through.  This defaults to the whole world.
<dd>Type: One or more of area, turf, mob, or obj, ORed together.  If no
     type is specified, the declared type of Var will be used to skip over
     inappropriate elements in the list.
<dd>Start: A starting numeric value.
<dd>End: An ending numeric value (inclusive).
<dd>Step: An increment for the numeric value; default is 1.
<dd>Key: A variable to sequentially contain each "key" in a key,value pair from an <a href=/list/assoc>associative list</a>
<dd>Value: A variable to sequentially contain each associated value in a key,value pair list
</dl>

<h3>Example:</h3>
<xmp>
usr << "Mobs:"
var/mob/M
for(M in view())
   usr << M.name
</xmp>

<p>This loops M through the mobs in view(), outputting the name at each
iteration.

<p>When you loop through a list, with the exception of looping through
world, you're actually looping through a copy of that list. If the list
changes, those changes won't have any bearing on this loop. If you want to
be able to handle a list that might change, you'll need to use the
<a href=#/proc/for/loop>for loop proc</a> instead.

<p>You can declare the variable right inside the for statement.  Its scope
is entirely contained within the for statement, so it will not conflict with
a similar variable declared elsewhere in the same procedure.

<h3>Example:</h3>
<xmp>
client/verb/who()
   for(var/client/Player)
      usr << Player
</xmp>

<p>If the loop var has a type, a hidden <tt>istype()</tt> call is included in
the code. Only items of that type, or its descendants, are handled within the
loop. That means null values and objects of unrelated types will be skipped.

<h3>Numeric loop</h3>

<p>The numeric loop form is a quick internal version of the
<a href=#/proc/for/loop>for loop proc</a>. It's equivalent to
<tt>for(Var = Start, Var &lt;= End, Var += Step)</tt> unless Step is
negative, in which case a &gt;= comparison is used instead. The main
difference is that unlike in a for loop proc, the values of Step and
End are calculated at the beginning and never change after that, so an
expression like <tt>list.len</tt> that might be subject to change will not be
read again&mdash;in much the same way that looping through a list only loops
through a copy of that list.

<h3>Example:</h3>
<xmp>
for(var/count in 1 to 100)
   src << count
</xmp>

<p>Note: Although you can use fractional values for <tt>step</tt> in this
numeric format, there may be accuracy considerations to keep in mind. See
<a href=#/{notes}/numbers>Numbers</a> for more information.

<h3 byondver=516>Key,value pair loop</h3>

<p>The key,value pair loop is meant for quickly traversing the items in an
<a href=/list/assoc>associative list</a>, without having to do an additional
lookup of <tt>List[Key]</tt> in the list. Additionally this also copies the
associated values when the list is copied, so the loop won't react to changes
in the original list.

<h3>Example:</h3>
<xmp>
var/alist/prices = alist(/obj/item/weapon/sword = 100, /obj/item/armor/helmet = 50)
player << "<b>Welcome to my shop!</b>"
for(var/item,price in prices)
    player << "[item::name] - $[price]"
</xmp>

<p>If the key var has a type, a hidden <tt>istype()</tt> call is included in
the loop, just like in a regular <tt>for(Var in List)</tt> loop. You can also
use the <tt>as</tt> clause to specify basic types like <tt>obj</tt>,
<tt>num</tt>, <tt>text</tt>, etc.

<p>If this format is used with non-associative lists, then the associated
value will always be assigned null.

<hr>

<a name=/proc/for/loop>
<h2>for loop proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/break>break statement</a>
<dd><a href=#/proc/continue>continue statement</a>
<dd><a href=#/proc/do>do proc</a>
<dd><a href=#/proc/for/list>for list proc</a>
<dd><a href=#/proc/while>while proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>for(Init, Test, Inc) Statement
</dl>

<p>First execute Init.  Then if Test is true (non-zero), execute Statement.
After this execute Inc.  Continue checking Test, doing Statement, and
performing Inc until Test turns out to be false (zero).

<p>Statement may be a code block or a single statement.  Semicolons may be
substituted for commas inside the parentheses as a convenience to C/C++
programmers.

<p>Init and Inc may be omitted.  If Test is omitted, the loop will continue
forever (unless a break, goto, or return instruction is used to get out of
the loop).

<h3>Example:</h3>
<xmp>
var/i
for(i=0, i<3, i++)
    world << i
</xmp>

<p>This outputs:

<xmp>
0
1
2
</xmp>

<p>Note: An Inc statement like <tt>i += 0.1</tt> is perfectly valid, but
you should keep in mind that numerical accuracy is not exact. See
<a href=#/{notes}/numbers>Numbers</a> for more information.

<h3>C-like syntax</h3>

<p>Using the <a href=#/DM/preprocessor/pragma/syntax><tt>#pragma syntax</tt>
directive</a> you can change <tt>for()</tt> to be more like other languages
such as C. This uses a semicolon <tt>;</tt> in place of commas to separate
Init, Test, and Inc. Instead the comma is treated as a way of stringing
multiple statements together.

<h3>Example:</h3>
<xmp>
// make this syntax change temporary
#pragma push
#pragma syntax C for

var/i,j
for(i=j=0; i<=10; ++i,j+=i)
    world << "A triangle [i] block\s high has [j] block\s total."

#pragma pop
</xmp>

<hr>

<a name=/proc/fract>
<h2 byondver=515>fract proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/trunc>trunc proc</a>
<dd><a href=#/proc/floor>floor proc</a>
<dd><a href=#/proc/ceil>ceil proc</a>
<dd><a href=#/proc/round>round proc</a>
<dd><a href=#/proc/sign>sign proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>fract(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>fractional part of A
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number, pixloc, or vector.
</dl>

<p>Returns the fractional part of the number A, with the same sign. This is
everything after the decimal point.

<h3>Example:</h3>
<xmp>
usr << fract(1.45) // outputs 0.45

usr << fract(-1.45) // outputs -0.45
</xmp>

<p>If A is a pixloc, it will be treated as a vector with just its x and y
parts, and the result will be a vector.

<hr>

<a name=/proc/ftime>
<h2>ftime proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/time2text>time2text proc</a>
<dd><a href=#/proc/flist>flist proc</a>
<dd><a href=#/proc/fexists>fexists proc</a>
<dd><a href=#/proc/length>length proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ftime(File, IsCreationTime)
</dl>

<dl><dt><b>Args:</b>
<dd>File: name of file to test
<dd>IsCreationTime (optional): true to return file creation time, false (default) to return last-modified time
</dl>

<dl><dt><b>Returns:</b>
<dd>A time value that can be sent to time2text().
</dl>

<hr>

<a name=/proc/ftp>
<h2>ftp proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/browse>browse proc</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/link>link proc</a>
<dd><a href=#/proc/run>run proc</a>
<dd><a href=#/proc/sound>sound proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>target &lt;&lt; ftp(File, Name)
</dl>

<p>Sends a file to the target with the (optional) suggested name for saving to
disk.  The file may be a cache file (loaded at compile time) or an external
file (accessed at run-time).  Cache files are specified in single quotes, and
external files are in double quotes.

<p>This function could be used to distribute source code, supplementary
documentation, or anything.

<h3>Example:</h3>
<xmp>
mob/verb/geticon(O in view())
  usr << ftp(O:icon)
</xmp>

<p>This example allows the user to download the icons from other objects in
the game.

<hr>

<a name=/proc/generator>
<h2 byondver=514>generator proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/generators>Generators</a>
<dd><a href=#/{notes}/particles>Particle effects</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/{notes}/color-matrix>Color matrix</a>
<dd><a href=#/vector>vector</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<dl><dt><b>Format:</b>
<dd>generator(type, A, B, rand)
</dl>

<dl><dt><b>Args:</b>
<dd>type: The type of generator object, which determines what kind of results it produces
<dd>A: One extreme of the generator results
<dd>B: The other extreme
<dd>rand: Type of random distribution used
</dl>

<p>Creates a generator that can be used to produce a random value. This generator can be used in client-side particle effects, or it can be used in proc code. The types of values it can produce are numbers, 2D or 3D vectors, or colors (a text string like "#rrggbb" or a color matrix).

<table class=codefirst>
<tr><th>Generator type</th><th>Result type</th><th>Description</th></tr>
<tr><td>num</td><td>num</td><td>A random number between A and B.</td></tr>
<tr><td>vector</td><td>vector</td><td>A random vector on a line between A and B.</td></tr>
<tr><td>box</td><td>vector</td><td>A random vector within a box whose corners are at A and B.</td></tr>
<tr><td>color</td><td>color (string) or color matrix</td><td>Result type depends on whether A or B are matrices or not. The result is interpolated between A and B; components are not randomized separately.</td></tr>
<tr><td>circle</td><td>vector</td><td>A random XY-only vector in a ring between radius A and B, centered at 0,0.</td></tr>
<tr><td>sphere</td><td>vector</td><td>A random vector in a spherical shell between radius A and B, centered at 0,0,0.</td></tr>
<tr><td>square</td><td>vector</td><td>A random XY-only vector between squares of sizes A and B. (The length of the square is between A*2 and B*2, centered at 0,0.)</td></tr>
<tr><td>cube</td><td>vector</td><td>A random vector between cubes of sizes A and B. (The length of the cube is between A*2 and B*2, centered at 0,0,0.)</td></tr>
</table>

<p>The optional <tt>rand</tt> argument determines the type of random distribution.

<table class=codefirst>
<tr><td>UNIFORM_RAND</td><td>Default. Random values are uniformly likely to be chosen.</td></tr>
<tr><td>NORMAL_RAND</td><td>Approximates a Gaussian normal distribution, but on a finite interval. Values closest to the mean are more likely to be chosen, while the extremes are much less likely.</td></tr>
<tr><td>LINEAR_RAND</td><td>The probability of choosing a number is proportional to its absolute value.</td></tr>
<tr><td>SQUARE_RAND</td><td>The probability of choosing a number is proportional to its square.</td></tr>
</table>

<p>The result of calling <tt>generator()</tt> is a datum of type <tt>/generator</tt> and you can get a random value from it by calling its <tt>Rand()</tt> proc.

<h3>Example:</h3>
<xmp>
var/generator/G = generator("num", -1, 1)    // generates a random number between -1 and 1
world << G.Rand()   // generate a number and output it to world
</xmp>

<p class=compatibility>Note: Worlds compiled in older BYOND versions before <a href=#/vector>vector</a> will return lists from vector generators.

<hr>

<a name=/proc/get_dir>
<h2>get_dir proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/dir>dir var (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_dir(Loc1, Loc2)
</dl>

<dl><dt><b>Returns:</b>
<dd>The direction from Loc1 to Loc2.  Possible results are <tt>NORTH</tt>,
    <tt>SOUTH</tt>, <tt>EAST</tt>, <tt>WEST</tt>, <tt>NORTHEAST</tt>,
    <tt>NORTHWEST</tt>, <tt>SOUTHEAST</tt>, and <tt>SOUTHWEST</tt>.
</dl>

<dl><dt><b>Args:</b>
<dd>Loc1: An object on the map.
<dd>Loc2: An object on the map.
</dl>

<p>If the direction is not directly lying along one of the four primary
cardinal directions, the result will become the nearest diagonal direction
(eg. if <tt>Loc2</tt> is mostly north but a little to the east of
<tt>Loc1</tt>, the direction returned will be <tt>NORTHEAST</tt>).

<hr>

<a name=/proc/get_dist>
<h2>get_dist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/bounds_dist>bounds_dist proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_dist(Loc1, Loc2)
</dl>

<dl><dt><b>Returns:</b>
<dd>The distance between <tt>Loc1</tt> and <tt>Loc2</tt>, in tiles.  This is
the number of full-tile movements (disregarding any obstacles and allowing
diagonal moves <i>including across Z levels</i>) required to go from one to
the other.  You can think of it as the max of their x, y, and z distances.
</dl>

<dl><dt><b>Args:</b>
<dd>Loc1: An object on the map.
<dd>Loc2: An object on the map.
</dl>

<p>For a distance in pixels, use <tt>bounds_dist()</tt>.

<p><tt>get_dist()</tt> will return -1 when <tt>Loc1</tt> and <tt>Loc2</tt> are
the same object. If one or both of them is not on the map, an infinite value
is returned.

<p>Note: Prior to BYOND 515, <tt>get_dist()</tt> never returned a value
greater than 127, which it counted as "infinite".

<hr>

<a name=/proc/get_step>
<h2>get_step proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/step>step proc</a>
<dd><a href=#/proc/walk>walk proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_step(Ref, Dir)
</dl>

<dl><dt><b>Returns:</b>
<dd>The location of the new position.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: Starting point or object.
<dd>Dir: One of <tt>NORTH</tt>, <tt>SOUTH</tt>, <tt>EAST</tt>, <tt>WEST</tt>,
     <tt>NORTHEAST</tt>, <tt>NORTHWEST</tt>, <tt>SOUTHEAST</tt>,
     <tt>SOUTHWEST</tt>.
</dl>

<p>Calculate the position of a step from <tt>Ref</tt> in the direction
<tt>Dir</tt>.

<hr>

<a name=/proc/get_step_away>
<h2>get_step_away proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/step_away>step_away proc</a>
<dd><a href=#/proc/walk_away>walk_away proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_step_away(Ref, Trg, Max=5)
</dl>

<dl><dt><b>Returns:</b>
<dd>The location of the new position, or 0 if no change.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: Starting point or object.
<dd>Trg: An object on the map.
<dd>Max: The maximum distance between Ref and Targ before movement halts.
</dl>

<p>Calculate position of a step from <tt>Ref</tt> on a path away from
<tt>Trg</tt>, taking obstacles into account.  If <tt>Ref</tt> is farther than
<tt>Max</tt> steps from <tt>Trg</tt>, 0 will be returned.

<hr>

<a name=/proc/get_step_rand>
<h2>get_step_rand proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/step_rand>step_rand proc</a>
<dd><a href=#/proc/walk_rand>walk_rand proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_step_rand(Ref)
</dl>

<dl><dt><b>Returns:</b>
<dd>The location of the new position, or 0 if no change.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: Starting point or object.
</dl>

<p>Calculate position of a step from <tt>Ref</tt> in random motion.

<hr>

<a name=/proc/get_step_to>
<h2>get_step_to proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/step_to>step_to proc</a>
<dd><a href=#/proc/walk_to>walk_to proc</a>
<dd><a href=#/proc/get_steps_to>get_steps_to proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_step_to(Ref, Trg, Min=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The location of the new position, or 0 if no change.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: Starting point or object.
<dd>Trg: An object on the map.
<dd>Min: The minimum distance between Ref and Trg before movement halts.
</dl>

<p>Calculate the position of a step from <tt>Ref</tt> on a path to
<tt>Trg</tt>, taking obstacles into account.

<p>If <tt>Ref</tt> is within <tt>Min</tt> steps of <tt>Trg</tt>, no step is
computed. This is also true if the target is too far away (more than twice
<tt>world.view</tt> steps).  In either case, null is returned.

<hr>

<a name=/proc/get_step_towards>
<h2>get_step_towards proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/step_towards>step_towards proc</a>
<dd><a href=#/proc/walk_towards>walk_towards proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_step_towards(Ref, Trg)
</dl>

<dl><dt><b>Returns:</b>
<dd>The location of the new position.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: Starting point or object.
<dd>Trg: An object on the map.
</dl>

<p>Calculate the position of a step from <tt>Ref</tt> in the direction of
<tt>Trg</tt>.

<hr>

<a name=/proc/get_steps_to>
<h2 byondver=515>get_steps_to proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/step>step proc</a>
<dd><a href=#/proc/step_to>step_to proc</a>
<dd><a href=#/proc/walk_to>walk_to proc</a>
<dd><a href=#/proc/get_step_to>get_step_to proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>get_steps_to(Ref, Trg, Min=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of directions to step.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: Starting point or object.
<dd>Trg: An object on the map.
<dd>Min: The minimum distance between Ref and Trg before movement halts.
</dl>

<p>Calculate a set of steps from <tt>Ref</tt> on a path to
<tt>Trg</tt>, taking obstacles into account. The result of the proc is a list
of directions that can be used with <tt>step()</tt>, or null if a path could
not be found.

<p>If <tt>Ref</tt> is within <tt>Min</tt> steps of <tt>Trg</tt>, no steps are
computed. This is also true if the target is too far away (more than twice
<tt>world.view</tt> steps).  In either case, null is returned.

<hr>

<a name=/proc/goto>
<h2>goto proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/break>break statement</a>
<dd><a href=#/proc/continue>continue statement</a>
<dd><a href=#/proc/do>do proc</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
<dd><a href=#/proc/for/list>for list proc</a>
<dd><a href=#/proc/while>while proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>goto node
</dl>

<p>Jump to the specified node in the current proc.

<h3>Example:</h3>
<xmp>
goto End
world << "ERR"
End
world << "The end"
</xmp>

<p>This displays "The end".

<p>Note: <tt>goto</tt> should be used judiciously. It's easy to fall into the
trap of "spaghetti logic" where <tt>goto</tt> is relied on so much that it
becomes too difficult to follow how the flow of code execution will proceed.
Normally, you'll want to use a construct like <tt>while()</tt> or
<tt>for()</tt> loops, and <tt>break</tt> and <tt>continue</tt> statements.
<tt>goto</tt> is for more complex situations that aren't readily handled by
any of these.

<hr>

<a name=/proc/gradient>
<h2>gradient proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/color-gradient>Color gradient</a>
<dd><a href=#/proc/rgb>rgb proc</a>
<dd><a href=#/proc/rgb2num>rgb2num proc</a>
<dd><a href=#/{{appendix}}/color-space>Color space</a>
</dl>

<dl><dt><b>Format:</b>
<dd>gradient(Item1, Item2, ..., index)
<dd>gradient(Gradient, index)
</dl>

<dl><dt><b>Args:</b>
<dd>Gradient: A <a href=#/{notes}/color-gradient>color gradient</a> list
<dd>Item1, Item2...: Elements of a <a href=#/{notes}/color-gradient>color gradient</a> list
<dd>index: The index along the gradient where the interpolation is done.
</dl>

<dl><dt><b>Returns:</b>
<dd>A color, represented by a text string in #RRGGBB or #RRGGBBAA format
</dl>

<p>Interpolates between two or more colors along a <a href=#/{notes}/color-gradient>color
gradient</a>. By default, gradients extend from an index of 0 to 1, but they
are allowed to go beyond that if you choose.

<p>The simplest way to use this proc is to interpolate between two colors:

<h3>Example:</h3>
<xmp>
// 20% of the way from red to black
// prints #cc0000 which is rgb(204,0,0)
src << gradient("red", "black", 0.2)
</xmp>

<p>Anything that applies to color gradients can be used in this proc, so you
can have a looping gradient, or a gradient that uses a color space other than
RGB.

<p>In the first format where you specify all the items separately, you can use
<a href=#/proc/arguments/named>named arguments</a> for <tt>index</tt> and
<tt>space</tt> (the gradient's color space). If you don't specify an argument called
"index", the last argument is assumed to be the index.

<h3>Example:</h3>
<xmp>
// This gradient loops through all the hues and goes from 0 to 6.
// Because this is a looping gradient, index=10 becomes index=4.
// In HSL, this will give you blue (#0000ff).
src << gradient(0, "#f00", 3, "#0ff", 6, "#f00", "loop", space=COLORSPACE_HSL, index=10)
</xmp>

<p>The <tt>gradient(Gradient, index)</tt> format is used for cases where you
want to pass an existing gradient to the proc.

<h3>Example:</h3>
<xmp>
var/candy_cane_gradient = list(0.5,"red",0.5,"white","loop")

// the color output alternates between red and white depending on the current time
src << gradient(candy_cane_gradient, world.time/100)
</xmp>

<hr>

<a name=/proc/hascall>
<h2>hascall proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/call>call proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>hascall(Object,ProcName)
</dl>

<dl><dt><b>Args:</b>
<dd>Object: source of proc or verb
<dd>ProcName: name of proc or verb ("MyProc")
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if object has such a proc or verb; 0 otherwise
</dl>

<hr>

<a name=/proc/hearers>
<h2>hearers</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ohearers>ohearers</a>
<dd><a href=#/proc/view>view proc</a>
<dd><a href=#/proc/viewers>viewers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>hearers(Depth=world.view,Center=usr)
</dl>

<p>This is just like <code>viewers()</code>, but it is a list of mobs that can
hear the center object.  Currently, this is computed on the assumption that
opaque objects block sound, just like they block light.

<hr>

<a name=/proc/html_decode>
<h2>html_decode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/html_encode>html_encode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>html_decode(HtmlText)
</dl>

<dl><dt><b>Args:</b>
<dd>HtmlText: text to be "unescaped"
</dl>

<dl><dt><b>Returns:</b>
<dd>unescaped text
</dl>

<p>Special characters such as &lt; and &gt; are not displayed literally in
html and may produce garbled output.  To display these characters literally,
they must be "escaped".  For example, &lt; is produced by the code
<code>&amp;lt;</code> and &gt; is produced by the code <code>&amp;gt;</code>.

<p>The <code>html_decode()</code> instruction takes a text string containing
such escaped symbols and turns them into their literal counterparts.  The
more useful function is <code>html_encode()</code> which does the reverse.

<hr>

<a name=/proc/html_encode>
<h2>html_encode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/html_decode>html_decode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>html_encode(PlainText)
</dl>

<dl><dt><b>Args:</b>
<dd>PlainText: text to be html "escaped"
</dl>

<dl><dt><b>Returns:</b>
<dd>escaped text
</dl>

<p>Special characters such as &lt; and &gt; are not displayed literally in
html and may produce garbled output.  If you want to ensure that an entire
text string is displayed literally, you can "escape" those characters.  For
example, &lt; is produced by the code <code>&amp;lt;</code> and &gt; is
produced by the code <code>&amp;gt;</code>.

<p>The <code>html_encode()</code> instruction does this for you
automatically.  If you wanted to disallow html input from players, you
could use this to force their text to be displayed literally:

<h3>Example:</h3>
<xmp>
mob/verb/say(T as text)
   view() << "[usr] says, '[html_encode(T)]'"
</xmp>

<p>If a URL is included in the text, special characters like &amp; that are
part of the URL will be skipped. This keeps automatically created links in
the output from being broken.

<p>Note for BYOND oldies: the old-style formatting codes such as "\red" which
are still parsed but not encouraged are completely stripped out by
html_encode().

<hr>

<a name=/proc/icon>
<h2>icon proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/icon_states>icon_states proc</a>
<dd><a href=#/DM/icon>icons</a>
</dl>

<dl><dt><b>Format:</b>
<dd>icon(icon,state,dir,frame,moving)
<dd><small>(supports <a href=#/proc/arguments/named>named arguments</a>)</small>
</dl>

<dl><dt><b>Args:</b>
<dd>icon: an icon file or /icon object
<dd>icon_state: an optional text string, specifying a single icon state to load
<dd>dir: an optional direction to extract
<dd>frame: an optional animation frame to extract
<dd>moving: Non-zero to extract only movement states, 0 for non-movement states,
  or null (default) for both
</dl>

<p>This is equivalent to new/icon().  It creates an /icon object, which is
initialized to contain the same graphical data as the given file.  If an icon
state or direction are specified, only those parts of the original icon will
be included in the new icon object.

<hr>

<a name=/proc/icon_states>
<h2>icon_states proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/icon>icons</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>
</dl>

<dl><dt><b>Format:</b>
<dd>icon_states(Icon, mode=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of text strings.
</dl>

<dl><dt><b>Args:</b>
<dd>Icon: the icon being accessed
<dd>mode: applies to icons larger than one tile when using map_format=TILED_ICON_MAP; see below
</dl>

<p>Icons may have one or more internal states, which are identified by name.
The state "" is the default.

<p>If you are not using the TILED_ICON_MAP value for world.map_format, you
can ignore the mode argument.

<p>When graphics bigger than world.icon_size are used as an icon, and the
map_format in use is TILED_ICON_MAP, they are internally broken up into
tiles, one per icon state. The <tt>mode</tt> argument was added for big
icons that get split into several smaller tiles. Those icons have several
smaller states per true icon_state. For example if your 64&times;64 icon
has a state named "open", it will contain states "open", "open 0,0",
"open 1,0", "open 0,1", and "open 1,1" which are all used internally.
(If the state name is blank, the sub-states are just "0,0", etc.) When using
the TILED_ICON_MAP format, you need these for displaying the icon over
several different atoms.

<p>mode=0 will only show the sub-states ("open 0,0" and so on), all of which
can be safely extracted in a single-tile icon via the <tt>icon()</tt> proc.
mode=1 will show the main state names ("open"); any time you work with that
state name you're working with the full-size icon. mode=2 will show all of
the states.

<hr>

<a name=/proc/if>
<h2>if proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/goto>goto proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>if( E ) Statement1
<dd>else if( E2 ) Statement2
<dd>else Statement3
</dl>

<p>If the expression E is true (non-zero) then execute Statement1.
Otherwise, test E2, etc.  Finally, if none of the expressions are true,
execute Statement3.  The else nodes are all optional.

<p>Statement1, Statement2, and Statement3 may be a single statement or a
code block with optional braces: {}.

<h3>Example:</h3>
<xmp>
if(T==1) world << "TRUE"
else world << "FALSE"
</xmp>

<p>This will display "TRUE" if T has value 1, and "FALSE" otherwise.

<hr>

<a name=/proc/image>
<h2>image proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c>&lt;&lt; operator</a>
<dd><a href=#/proc/del>del proc</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/image>image objects</a>
<dd><a href=#/client/var/images>images var (client)</a>
<dd><a href=#/atom/var/overlays>overlays var (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>image(icon,loc,icon_state,layer,dir)
<dd><small>(supports <a href=#/proc/arguments/named>named arguments</a>)</small>
</dl>

<dl><dt><b>Returns:</b>
<dd>An image reference on success; 0 on failure.
</dl>

<dl><dt><b>Args:</b>
<dd>icon: An icon, icon_state, object prototype, object instance, or other image.
<dd>loc:  The location at which to display the image.
<dd>icon_state: The icon state to use.
<dd>layer: The drawing layer to use.
<dd>dir: The direction to orient the image.
</dl>

<p>Images are "virtual" objects, which have a purely visual effect.  Once
created, they can be made to appear to selected players.  The image()
instruction is simply a short-hand for new/image().

<p>The image remains attached to the location specified by <var>loc</var>.
For example, if <var>loc</var> is a mob, the image will appear above the mob
until it is destroyed.

<p>The <tt>icon</tt> argument can be anything that can be interpreted as an
appearance, i.e. anything you might add to an overlays list. If this argument
is interpreted as an appearance, it will be used <i>instead of</i> the
appearance of the image type. A null value will use the image type's own
default appearance. An icon value will use the default appearance but change
the icon. A text string will be interpreted as the <tt>icon_state</tt>
argument if one is not present, but otherwise will be interpreted as an
appearance.

<p>The arguments <var>icon_state</var>, <var>layer</var>, and <var>dir</var>
may be used to override the settings associated with the icon or object used
to create the image.  For example, the default drawing layer for an plain icon
is FLY_LAYER (above all other objects), but you could change this to OBJ_LAYER
to make it appear under mobs on the map.

<h3>Example:</h3>
<xmp>
var/Box
Box = image ('highlight.dmi', usr)
usr << Box
...
del(Box)  //when done, remove image
</xmp>

<p>Another common use of images is in making an overlay:

<xmp>
overlays += image('pants.dmi',icon_state = "red")
</xmp>

<p>Since the <code>loc</code> argument could never be a text string, the above
statement can be further shortened:

<xmp>
overlays += image('pants.dmi',"red")
</xmp>

<p>This is much preferable to achieving the same effect with
<code>icon('pants.dmi',"red")</code>, since that involves the
overhead of creating a new icon file, which should only be done when it is
really necessary.

<p>Note: The fact that <tt>image</tt> is essentially a wrapper for
<tt>new/image()</tt> means that the arguments in
<a class=code href=#/datum/proc/New>image/New()</a> are always treated the
same way as defined in this article. This applies even to subtypes, like
<tt>/image/thing</tt>. 


If you create a user-defined subtype like <tt>new/image/thing()</tt>
it will still use the arguments the same way as in <tt>image()</tt>. You can't
meaningfully customize the arguments in <tt>New()</tt> for images.

<hr>

<a name=/proc/initial>
<h2>initial proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/::>:: operator</a>
<dd><a href=#/proc/issaved>issaved proc</a>
<dd><a href=#/datum/var/vars>vars list var (datum)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>initial(Var)
</dl>

<dl><dt><b>Args:</b>
<dd>Var: A variable to find the initial value of.
</dl>

<p>This returns the original compile-time value of a variable.  It could
be used to reset a variable to its default value or to check if a variable
has changed.

<h3>Example:</h3>
<xmp>
obj/verb/set_icon(I as null|icon)
   if(!I) I = initial(icon)
   icon = I
</xmp>

This example allows an object's icon to be modified.  If the user does not
specify a new icon, it will be reset to the original one.

<hr>

<a name=/proc/input>
<h2>input proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/alert>alert proc</a>
<dd><a href=#/verb/arguments>arguments (verb)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>input(Recipient=usr,Message,Title,Default) as Type in List
</dl>

<dl><dt><b>Returns:</b>
<dd>User's response.
</dl>

<dl><dt><b>Args:</b>
<dd>Recipient: The user who will see this input prompt.
<dd>Message: A message in the prompt, to tell the user what it's asking for.
<dd>Title: The title of the prompt window.
<dd>Default: Default value if the user cancels the input.
<dd>Type: A verb input type, such as <tt>text</tt>, <tt>message</tt>, <tt>num</tt>, <tt>anything</tt>. If you omit "as Type", the type defaults to <tt>text</tt>.
<dd>List: An optional list of items to choose from.
</dl>

<p>Creates a prompt dialog that asks the user for a response. The current proc
sleeps until they respond.

<p>The only required argument is the message.  The type may be any combination of
input types allowed for verb arguments, which can be combined with the <tt>|</tt>
operator. The <tt>null</tt> type will allow the user to cancel, e.g.
<tt>as null | anything in contents</tt>.

<h3>Example:</h3>
<xmp>
mob/verb/create_character()
   usr.name = input("Choose a name for your character.",
                    "Your Name",
                    usr.name)

   usr.gender = input("Select a gender for your character.",
                      "Your Gender",
                      usr.gender) in list("male","female","neuter")
</xmp>

<p>If the target of the input prompt is not a player, the result will be the
default value.  If no default value is specified and null is allowed by the
input type, null will be returned.  Otherwise, an error will result, crashing
the proc that called <tt>input()</tt>.

<p>A more common use for <tt>input()</tt> is to give a player a list of
things to choose from. For example, this is a simple shopkeeper NPC, where
the shopkeeper's inventory is its contents.

<h3>Example:</h3>
<xmp>
mob/shopkeeper/verb/Buy()
   var/list/options = list()
   var/obj/item
   for(item in src)
      // show a pretty list of options with prices included
      options["[item]: $[item.price]"] = item
   var/choice = input("Buy something!", "Shop") as null|anything in options
   item = options[choice]
   if(!item) return     // user canceled
   if(item.price > usr.gold)
      usr << "You can't afford that."
   else
      // give the buyer a copy of the item
      var/t = item.type
      new t(usr)
      usr.gold -= item.price
      usr << "You bought \a [item] for $[item.price]."
</xmp>

<p>Using <tt>as num</tt> is another popular input choice, which you might use
for haggling, deciding how many of an item to pick up or drop, etc.

<p class="note security">This next part is important! Always validate input from a
user to make sure it's correct.

<p>You should be sure to sanitize any user input to make sure the value is
valid. For instance, if you have a verb that gives gold to another player, you
should check that the amount isn't negative and doesn't contain any fractions,
and isn't more than they have.

<h3>Example:</h3>
<xmp>
mob/player/verb/Give_Gold()
   set src in oview(1)
   var/amount = input("How much?", "Give gold") as null|num
   if(isnull(amount)) return
   amount = floor(amount)   // round down to a whole number
   amount = min(amount, usr.gold)   // don't give more than you have
   if(amount <= 0) return   // ignore negatives and 0
   gold += amount
   usr.gold -= amount
   usr << "You gave [src] $[amount]."
   src << "[src] gave you $[amount]."
</xmp>

<p>Likewise if you're allowing a user to input text, it too should be
sanitized. If they shouldn't enter multi-line text, you should strip out
<tt>"\n"</tt> characters. If they're putting in something like a character
name, strip out any HTML via <tt>html_encode()</tt>, or you can simply
reject anything that contains invalid characters and make them do it again.

<hr>

<a name=/proc/isarea>
<h2>isarea proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isloc>isloc proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isarea(Loc1, Loc2 ...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of locations to test.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all args are valid areas; 0 otherwise
</dl>

<hr>

<a name=/proc/isfile>
<h2>isfile proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/cache>cache</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/isicon>isicon proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isfile(File)
</dl>

<dl><dt><b>Args:</b>
<dd>File: the value to test
</dl>

<p>This returns a true value when given a file.  Both objects returned by
file() and files stored in the resource cache qualify.

<hr>

<a name=/proc/isicon>
<h2>isicon proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/cache>cache</a>
<dd><a href=#/icon>icon</a>
<dd><a href=#/proc/isfile>isfile proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isicon(Icon)
</dl>

<dl><dt><b>Args:</b>
<dd>Icon: the value to test
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the value is a valid icon; 0 otherwise.
</dl>

<p>This returns a true value when given an icon.  Both <tt>/icon</tt> memory
objects and icon files stored in the resource cache qualify.

<hr>

<a name=/proc/isinf>
<h2 byondver=515>isinf proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isnum>isnum proc</a>
<dd><a href=#/proc/isnan>isnan proc</a>
<dd><a href="/{notes}/numbers">Numbers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isinf(n)
</dl>

<dl><dt><b>Args:</b>
<dd>n: A number
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if this is an infinite numeric value, either positive or negative; 0 otherwise
</dl>

<hr>

<a name=/proc/islist>
<h2 byondver=513>islist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/proc/list>list proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>islist(Object)
</dl>

<dl><dt><b>Args:</b>
<dd>Object: The value to test
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the object is a valid list; 0 otherwise.
</dl>

<p>Tests whether an object is a list. This includes user-defined lists,
special lists like <tt>contents</tt> and <tt>overlays</tt>, and more.

<hr>

<a name=/proc/isloc>
<h2>isloc proc</h2>

<dl><dt><b>Format:</b>
<dd>isloc(Loc1, Loc2 ...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of locations to test.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all args are valid locs; 0 otherwise.
</dl>

<p>Tests validity of a location.  If all arguments are mobs, objs, turfs, or
areas, this returns 1.

<p>For a single argument this is equivalent to: <tt>(ismob(Loc) ||
isobj(Loc) || isturf(Loc) || isarea(Loc))</tt>.

<hr>

<a name=/proc/ismob>
<h2>ismob proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isloc>isloc proc</a>
<dd><a href=#/proc/ismovable>ismovable proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ismob(Loc1, Loc2 ...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of locations to test.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all args are valid mobs; 0 otherwise
</dl>

<hr>

<a name=/proc/ismovable>
<h2 byondver=513>ismovable proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isloc>isloc proc</a>
<dd><a href=#/proc/isobj>isobj proc</a>
<dd><a href=#/proc/ismob>ismob proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ismovable(Loc1, Loc2 ...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of locations to test.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all args are valid objs or mobs; 0 otherwise
</dl>

<p>Movable atoms are either objs or mobs, so this combines the <tt>isobj</tt>
and <tt>ismob</tt> tests into a single proc.

<hr>

<a name=/proc/isnan>
<h2 byondver=515>isnan proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isnum>isnum proc</a>
<dd><a href=#/proc/isinf>isinf proc</a>
<dd><a href="/{notes}/numbers">Numbers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isnan(n)
</dl>

<dl><dt><b>Args:</b>
<dd>n: A number
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if this is a numeric value but is an invalid "not a number" (NaN); 0 otherwise
</dl>

<p>Some math operations return the special number <tt>NaN</tt> if they're
undefined, such as dividing 0 by 0. This tells you if a number is that type.

<p>NaN is never greater than, less than, or equal to another number, even
itself.

<hr>

<a name=/proc/isnull>
<h2>isnull proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/null>null</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isnull(Val)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if Val is null; 0 otherwise
</dl>

<hr>

<a name=/proc/isnum>
<h2>isnum proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isinf>isinf proc</a>
<dd><a href=#/proc/isnan>isnan proc</a>
<dd><a href="/{notes}/numbers">Numbers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isnum(Val)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if Val is a number; 0 otherwise
</dl>

<hr>

<a name=/proc/isobj>
<h2>isobj proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isloc>isloc proc</a>
<dd><a href=#/proc/ismovable>ismovable proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isobj(Loc1, Loc2 ...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of locations to test.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all args are valid objs; 0 otherwise
</dl>

<hr>

<a name=/proc/ispath>
<h2>ispath proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/typesof>typesof proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ispath(Val)
<dd>ispath(Val,Type)
</dl>

<dl><dt><b>Returns:</b>
<dd>single-argument: 1 if Val is a type path
<dd>double-argument: 1 if Val is a type path derived from Type; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Val:  A type path.
<dd>Type: A type path or instance.
</dl>

<h3>Example:</h3>

<xmp>
var/M
M = /mob/ugly/duckling
if(ispath(M,/mob/ugly))  //true
if(ispath(M))            //true
if(ispath(new/mob))      //false
</xmp>

<hr>

<a name=/proc/ispointer>
<h2 byondver=515>ispointer proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/*>* operator (pointers)</a>
<dd><a href=#/operator/&>&amp; operator (pointers)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ispointer(Value)
</dl>

<dl><dt><b>Args:</b>
<dd>Value: The value to test
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the value is a pointer; 0 otherwise.
</dl>

<p>Tests whether an value is a pointer.

<p>Note: This does not check if the pointer is still valid, like for instance
if the object it belongs to has been deleted, or if it points to a list index
that is now out of bounds.

<hr>

<a name=/proc/issaved>
<h2>issaved proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/initial>initial proc</a>
<dd><a href=#/savefile>savefile</a>
<dd><a href=#/var/tmp>tmp vars</a>
<dd><a href=#/datum/var/vars>vars list var (datum)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>issaved(Var)
</dl>

<dl><dt><b>Args:</b>
<dd>Var: The variable to test.
</dl>

<p>This returns 1 if the given variable should be automatically saved when
writing an object to a savefile and 0 otherwise.  Variables which are not
global, const, or tmp will return 1.

<hr>

<a name=/proc/istext>
<h2>istext proc</h2>

<dl><dt><b>Format:</b>
<dd>istext(Val)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if Val is text; 0 otherwise
</dl>

<hr>

<a name=/proc/isturf>
<h2>isturf proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isloc>isloc proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>isturf(Loc1, Loc2 ...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of locations to test.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if all args are valid turfs; 0 otherwise
</dl>

<hr>

<a name=/proc/istype>
<h2>istype proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ispath>ispath proc</a>
<dd><a href=#/proc/locate>locate proc</a>
<dd><a href=#/proc/typesof>typesof proc</a>
<dd><a href=#/proc/astype>astype proc</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>istype(Val,Type)
<dd>istype(Val)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if Val is derived from Type; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Val:  An object instance.
<dd>Type: An object prototype or instance.  If no type is specified and a
     variable was passed in as the first argument, it will default to the
     declared type of the variable.
</dl>

<p>If you don't have an object instance to test, but just want to see if one
prototype derives from another one, use <a href=#/proc/ispath>ispath()</a>
instead.

<h3>Example:</h3>

<xmp>
var/M
M = new/mob/ugly/duckling()
if(istype(M,/mob/ugly))  //this will be true
  usr << "[M] is ugly!"
</xmp>

<p>Using implicit types, that same example can be rewritten as follows:

<xmp>
var/mob/ugly/M
M = new/mob/ugly/duckling()
if(istype(M))  //this will be true
  usr << "[M] is ugly!"
</xmp>

<hr>

<a name=/proc/jointext>
<h2 byondver=510>jointext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/splittext>splittext proc</a>
<dd><a href=#/list/proc/Join>Join proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>jointext(List,Glue,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A text string made up of the items in List, joined together by Glue.
</dl>

<dl><dt><b>Args:</b>
<dd>List: The list to be joined.
<dd>Glue: The text that will go between each item.
<dd>Start: The list item on which to begin.
<dd>End: The list item immediately following the last item to be joined.
<dd>include_delimiters: True if any delimiters found should be included in
     the result.
</dl>

<p>Any items in List that are not already text will be converted to text.
The Glue string only goes between two items, so a single-item list is the
same as converting that one item to text, and an empty list becomes an empty
string.

<h3>Example:</h3>
<xmp>
var/list/items = list("apples", "oranges", "bananas")
usr << jointext(items, ", ")
</xmp>

<p>If the start or end position is negative, the position is counted backwards
from the end of the list.

<p>Calling List.Join(Glue,Start,End) is the same thing, as long as List is a
valid list.

<hr>

<a name=/proc/json_decode>
<h2 byondver=510>json_decode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/json_encode>json_encode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>json_decode(JSON)
<dd byondver=515>json_decode(JSON, flags)
</dl>

<dl><dt><b>Returns:</b>
<dd>A value interpreted from a JSON-formatted text string.
</dl>

<dl><dt><b>Args:</b>
<dd>JSON: The JSON-formatted text to decode.
<dd>flags: A set of flags that tell the decoder how to act.
</dl>

<p>Arrays like <tt>[1,2,3]</tt> will be converted to regular lists like
<tt>list(1,2,3)</tt>.

<p>Object literals like <tt>{"a":1}</tt> will be converted to associative
lists such as <tt>list("a"=1)</tt>. Each item in the list is also decoded.
Except in strict mode, non-string values are allowed as the "keys" in an
associaitve list, even though that's not valid JSON, and strings used as keys
can be left unquoted. BYOND doesn't care, as long as it can understand the
formatted text it's given. The only exception is that a number isn't allowed
to be an associative list key, and will be converted to a string instead, so
<tt>{1:2}</tt> becomes <tt>list("1"=2)</tt>.

<p>Special numbers <tt>NaN</tt> and <tt>Infinity</tt> are recognized correctly
(these are case-sensitive). All other numbers are parsed and stored in the
regular BYOND format (32-bit floating point).

<p>Since BYOND doesn't have dedicated boolean values, <tt>true</tt> and
<tt>false</tt> are interpreted as 1 and 0, respectively.

<p>The <tt>JSON_STRICT</tt> flag uses stricter JSON parsing rules and will
not allow some things. In strict mode: 
<ul>
<li>All strings must be double-quoted.</li>
<li>Special numbers <tt>NaN</tt> and <tt>Infinity</tt> are not allowed, but
  the <tt>{__number__:"NaN"}</tt> format used by <tt>json_encode()</tt> is
  recognized as a number.</li>
<li>Keys in an associative list must always be strings, and must be
  double-quoted.</li>
</ul>

<p>The <tt>JSON_ALLOW_COMMENTS</tt> flag allows you to include <tt>//</tt>
single-line comments and <tt>/* ... */</tt> long-form comments in the text to
be decoded. This can be mixed with the strict flag. This flag is now used by
default.

<hr>

<a name=/proc/json_encode>
<h2 byondver=510>json_encode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/json_decode>json_decode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>json_encode(Value)
<dd byondver=515>json_encode(Value, flags)
</dl>

<dl><dt><b>Returns:</b>
<dd>A JSON-formatted text string representing Value.
</dl>

<dl><dt><b>Args:</b>
<dd>Value: The value to encode.
<dd>flags: A set of flags that tell the encoder how to act.
</dl>

<p>If Value is a simple list or a matrix, the result will be formatted as a
JSON array, and each item in the list is encoded.

<p>If Value is an associative list, the result will be formatted as a JSON
object literal, and each item and associated value is encoded. (The keys in
the object literal don't have to be strings. Even though that isn't valid
JSON, BYOND doesn't care. Be aware however that strict JSON parsers
<i>will</i> care.)

<p>Datums are <i>not</i> serialized, but are converted to the equivalent of
<tt>"[Value]"</tt> instead.

<p>The special numbers NaN and infinity will be encoded as object literals
in a form like <tt>{"__number__":"NaN"}</tt>.

<h3>Example:</h3>
<xmp>
var/list/info = list("name"="fridge", "power"=12)
// send {"name":"fridge","power":12} to a JavaScript function
usr << output(url_encode(json_encode(info)), "mybrowser:myJSfunction")
</xmp>

<p>BYOND formatting such as \red is removed from encoded strings.

<p>Situations where a list has a reference to itself will cause the nested
version to print a null value instead.

<p>The <tt>JSON_PRETTY_PRINT</tt> flag introduces spacing into the output for
improved readibility. Spaces will be added after colons and commas. Non-empty
arrays and object literals will have a line break and tabs before each item,
and a line break with one fewer tab before the closing bracket or brace. (The
special formatting for numbers like Infinity, or the list form for matrices,
will not be given tabs and line breaks.)

<hr>

<a name=/proc/length>
<h2>length proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
</dl>

<dl><dt><b>Format:</b>
<dd>length(E)
</dl>

<dl><dt><b>Returns:</b>
<dd>The length of the data associated with E.
</dl>

<dl><dt><b>Args:</b>
<dd>E: text, list, file, or vector
</dl>

<h3>Example:</h3>
<xmp>
world << length("Hi")
</xmp>

<p>This outputs, "2", the length of the string "Hi".

<h3>Example:</h3>
<xmp>
world << length(list(1,2,3))
</xmp>

<p>This outputs, "3", the length of the list.

<h3>Example:</h3>
<xmp>
world << length(file("test.txt"))
</xmp>

<p>This outputs the length of the file.

<p>Note: In strings containing non-ASCII characters, this is the length in
bytes, not characters; a character may span multiple bytes. Use
<tt>length_char()</tt> to work with character counts instead of bytes. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<p>For vectors, the length is the order of the vector, as in 2 for a 2D vector
or 3 for a 3D vector. See <a class=code href=#/vector/var/len>vector.len</a>.

<hr>

<a name=/proc/lentext>
<h2 deprecated=1>lentext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/length>length proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>lentext(T)
</dl>

<dl><dt><b>Returns:</b>
<dd>The length of text T.
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
</dl>

<p class="note deprecated">Use <a class=code href=#/proc/length>length()</a> instead.

<hr>

<a name=/proc/lerp>
<h2 byondver=516>lerp proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/matrix/proc/Interpolate>Interpolate proc (matrix)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>lerp(A, B, factor)
</dl>

<dl><dt><b>Returns:</b>
<dd>An interpolated value between A and B
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number, matrix, vector, or turf/pixloc.
<dd>B: Another number, matrix, vector, or turf/pixloc.
<dd>factor: Interpolation factor, usually 0 to 1
</dl>

<p>Returns an interpolation or extrapolation from A to B. If factor is 0, A
is returned; if factor is 1, B is returned. Otherwise an interpolated value
between A and B is returned, based on the value of factor. The types of A and
B must match, with few exceptions.

<p>This is basically equivalent to returning <tt>A + (B-A) * factor</tt> for
most things. When interpolating objects such as vectors, the returned value
is always a new value, never a direct copy of A or B.

<h3>Example:</h3>
<xmp>
usr << lerp(1, 5, 0.25)   // outputs 2
</xmp>

<p>Turfs can be treated like pixlocs in <tt>lerp()</tt>, so you can
interpolate between turfs. Note that they must have the same Z coordinate.

<p>Matrix interpolation behaves according to the rules in the matrix
<a class=code href=#/matrix/proc/Interpolate>Interpolate()</a> proc. For
linear interpolation you need to use <tt>A + (B-A) * factor</tt> instead.

<hr>

<a name=/proc/link>
<h2>link proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/run>run proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>O &lt;&lt; link(url)
</dl>

<p>This causes the recipient (O) to view the specified url.  The url could
be a web or BYOND address.  In the latter case, the player will disconnect
from the current world and connect to the specified one.

<p>The format of a BYOND url is as follows:

<xmp>
byond://address:port?TopicData
</xmp>

<p>To access a registered world, address:port may be replaced by the
registered name in the hub.  The optional topic data is processed by the
world once the player has connected.  If only a topic is specified, the
current world processes it.

<h3>Example:</h3>
<xmp>
usr << link("byond://byond.com:6000") //BYOND address
usr << link("http://www.byond.com")   //web address
usr << link("?myTopic")                //topic
</xmp>

<hr>

<a name=/proc/list>
<h2>list proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arglist>arglist proc</a>
<dd><a href=#/list>list</a>
<dd><a href=#/list/associations>list associations</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list(A,B,C,...)
<dd>or
<dd>list(A=a,B=b,C=c,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new list with contents A, B, C, and (optional) associated values a, b, c.
</dl>

<dl><dt><b>Args:</b>
<dd>Arbitrary number of elements to be inserted into the list.
</dl>

<p>Assign elements to a list.

<h3>Example:</h3>
<xmp>
var/L[]
L = list(1,2,3)
</xmp>

<p>This creates a new list 'L' that initially contains elements 1, 2, and
3.  The length of L is 3.

<p>The <code>list()</code> instruction may also be used to create associative
lists.

<h3>Example:</h3>
<xmp>
var/list/lst = list("player" = "James Byond", "score" = 2000)
</xmp>

<p>That creates a list with contents ("player, "score") and associated values
("James Byond", 2000) respectively.

<p>The index values should be constants, and that usually means text
constants.  When these index values happen to be text strings that satisfy all
the requirements for variable names, this may also be written in a convenient
short-hand without the double quotes:

<xmp>
var/list/lst = list(player = "James Byond", score = 2000)
</xmp>

<p>In other words, this is exactly the same syntax as for
<a href=#/proc/arguments/named>named arguments</a>.

<hr>

<a name=/proc/list2params>
<h2>list2params proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/world/var/params>params var (world)</a>
<dd><a href=#/proc/params2list>params2list proc</a>
<dd><a href=#/proc/text2num>text2num proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>list2params(List)
</dl>

<dl><dt><b>Args:</b>
<dd>List: List to encode as a text string.
</dl>

<p>This instruction converts a list of parameter names and associated values
into a single text string suitable for use in a URL or similar situation.
The format of the resulting text string is:

<xmp>
"name1=value1&name2=value2&..."
</xmp>

<p>Special characters such as '=' and '&amp;' inside the parameter names or
values are written in the form: <code>%xx</code> where <code>xx</code> are
two hexadecimal digits representing the ASCII value of the character. For
<a href=#/{notes}/Unicode>Unicode</a> characters, their UTF-8 encoding will
be processed this way, which may make up multiple <code>%xx</code> sequences.
In addition, spaces are converted to <tt>+</tt>.

<p>This parameter format is the same one used by most HTML forms and is
known by the MIME type <tt>application/x-www-form-urlencoded</tt>.  It is
often used in DM to pack information into topic links.

<p>The original list has items <tt>"name1"</tt>, <tt>"name2"</tt>, and so on.
These in turn are associated with the corresponding values <tt>"value1"</tt>,
<tt>"value2"</tt>, and so on.

<h3>Example:</h3>
<xmp>
var/plist[0]

plist["offense"] = "jwalk"
plist["time"] = "10:00"

usr << list2params(plist)
</xmp>

<p>The above example creates a simple parameter list which associates the
item "offense" with the value "jwalk" and the item "time" with the value
"10:00".  This will produce the text string "offense=jwalk&time=10:00".

<p>Object values in the list (like say a mob) get turned into references in
the parameter text, just as though you had embedded them with "\ref[Object]".
When read back in with params2list(), you could convert these values back into
real references by using locate().

<hr>

<a name=/proc/load_ext>
<h2 byondver=516>load_ext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/call_ext>call_ext proc</a>
<dd><a href=#/{{appendix}}/Byondapi>Byondapi</a>
</dl>

<dl><dt><b>Format:</b>
<dd>load_ext(LibName,FuncName)
</dl>

<dl><dt><b>Args:</b>
<dd>LibName: name of external library ("test.DLL") (note: the .dll or .so suffix is not required)
<dd>FuncName: name of function in external library ("func"), which may have prefixes to describe the type of function
</dl>

<dl><dt><b>Returns:</b>
<dd>A reference to a function in an external library, for use with <tt>call_ext()</tt>.
</dl>

<p>Use <tt>load_ext()</tt> to pre-load external library functions you intend
to use often, when maximum performance is required. (See
<a class=code href=#/proc/call_ext>call_ext()</a> for the rules for loading
libraries.)

<p>The result of this proc can be passed to <tt>call_ext()</tt> as a single
argument in lieu of the normal LibName and FuncName.

<p>If the lookup fails for any reason, a runtime error will be thrown.

<h3>Example:</h3>
<xmp>
var/logfunc

proc/LogLine(msg)
    logfunc ||= load_ext("my_lib", "byond:OutputToLog")
    call_ext(logfunc)(msg)
</xmp>

<hr>

<a name=/proc/load_resource>
<h2>load_resource proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Player &lt;&lt; load_resource(File)
<dd>Player &lt;&lt; load_resource(File, KeepTime)
<dd>Player &lt;&lt; load_resource(File1, File2..., KeepTime1, File3, File4..., KeepTime2...)
</dl>

<dl><dt><b>Args:</b>
<dd>Player: A mob or client, a list of them, or world
<dd>File: A resource file (image or sound)
<dd>KeepTime: Minimum time (in seconds) to keep the file loaded; 0=default, -1=forever
</dl>

<p>Tells the player's client (or multiple players) to load the specified
resources now, and how long to keep them. If you do not specify a keep time, 0
is used which will use the default time.

<p>This may be useful for loading sounds into memory before they play, or to
load an icon as soon as possible even if it hasn't been displayed yet. This
can avoid delays later on when the resources are needed.

<p>Dream Seeker keeps most assets loaded for at least 5 minutes (300 seconds)
after their  last use. However if you think a more appropriate time is closer
to half an hour, you can set a keep time of 1800 seconds. Or if you want them
to stay loaded indefinitely, set a keep time of -1.

<h3>Example:</h3>
<xmp>
mob/Login()
    ..()
    // load up these songs now and keep them loaded indefinitely
    src << load_resource('music1.ogg', 'music2.ogg', 'music3.ogg', -1)
</xmp>

<p>In cases of extreme memory duress, Dream Seeker's garbage collector will
get more aggressive and can still override your choices if need be.

<hr>

<a name=/proc/locate>
<h2>locate proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/istype>istype proc</a>
<dd><a href=#/datum/var/tag>tag var (datum)</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>locate(Type) in Container
<dd>locate(X,Y,Z)
<dd>locate(Tag)
<dd>locate(TextRef)
</dl>

<dl><dt><b>Returns:</b>
<dd>An object of the specified type or the turf at the given coordinates.
     If a text string is given in place of an object type, the object with
     the same tag is found.  If a container is given, only objects
     directly within that object are searched.
</dl>

<dl><dt><b>Args:</b>
<dd>Type:  An object prototype or tag.  If locate() is being used in an assignment to a variable with a declared type, this argument is optional and will default to the type of the variable being assigned.
<dd>Container: An optional container object.  (The default is <code>world</code>.)
<dd>X,Y,Z: A set of numerical coordinates.
<dd>Tag: The value of an object's tag variable (must be unique).
<dd>TextRef: An embedded object reference created by the \ref text macro.
</dl>

<p>Types are matched in the same manner as istype().  In other words,
locate(/obj) could return an instance of something derived from /obj, such as
/obj/armor.

<p>If there is more than one instance of the specified type, the first one
found will be chosen.

<h3>Example:</h3>
<xmp>
var/mob/shopkeeper/M = locate()
if(M)
  usr << "Found the shopkeeper."
else
  usr << "Could not find the shopkeeper."
</xmp>

<p>This looks for a mob of a type /mob/shopkeeper in the world
(world.contents).

<h3>Example:</h3>
<xmp>
usr.Move(locate(/turf/Home))
</xmp>

<p>This "teleports" the usr to a turf of the type /turf/Home.

<h3>Example:</h3>
<xmp>
usr.Move(locate(1,2,3))
</xmp>

<p>This moves the usr to the turf at coordinates (x,y,z) = (1,2,3).

<hr>

<a name=/proc/log>
<h2>log proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/**>** operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>log(X,Y)
<dd>log(Y)
</dl>

<dl><dt><b>Returns:</b>
<dd>The logarithm (base X) of Y.  If X is not specified, a natural logarithm
is computed (base 2.718...).
</dl>

<p>The logarithm is the power to which you have to raise X in order to get
Y.  In other words, the following is true (ignoring round-off error):

<xmp>
X ** log(X,Y) == Y
</xmp>

<p>One nice property of this function is that it gradually increases, with a
slope that continuously tapers off.  In other words, it can be useful to
represent diminishing returns from some input, such as money, experience
points, and so forth.

<hr>

<a name=/proc/lowertext>
<h2>lowertext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/uppertext>uppertext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>lowertext(T)
</dl>

<dl><dt><b>Returns:</b>
<dd>A lowercase text string.
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
</dl>

<p>Make all of the characters of T lowercase.

<h3>Example:</h3>
<xmp>
L = lowertext("HI THERE") // = "hi there"
</xmp>

<hr>

<a name=/proc/matrix>
<h2 byondver=500>matrix proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/atom/var/transform>transform var (atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>matrix()
<dd>matrix(Matrix)
<dd>matrix(a, b, c, d, e, f)
<dd>matrix(x, y, MATRIX_SCALE)
<dd>matrix(n, MATRIX_SCALE)
<dd>matrix(angle, MATRIX_ROTATE)
<dd>matrix(x, y, MATRIX_TRANSLATE)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new matrix.
</dl>

<dl><dt><b>Args:</b>
<dd>Matrix: a matrix to copy
<dd>a - f: The individual matrix components (in column-major order)
<dd>x, y: Arguments affecting how the shortcut matrix format affects x and y
<dd>n: The same value used for x and y together
<dd>angle: Rotation angle in degrees, clockwise
</dl>

<p>If no arguments are provided, a new default (identity) matrix is created.

<p>There are also several "shortcut" matrix calls that can be made:

<dl class=codedt>
<dt>matrix(x, y, MATRIX_SCALE)</dt>
<dt>matrix(n, MATRIX_SCALE)</dt>
<dd>A scaling matrix, scaling either x and y independently or both together</dd>
<dt>matrix(angle, MATRIX_ROTATE)</dt>
<dd>A matrix that rotates by the angle in degrees, clockwise</dd>
<dt>matrix(x, y, MATRIX_TRANSLATE)</dt>
<dd>A matrix that translates by x and y</dd>
</dl>

<hr>

<a name=/proc/max>
<h2>max proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/min>min proc</a>
<dd><a href=#/proc/clamp>clamp proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>max(A,B,C,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>the maximum of the arguments.
</dl>

<h3>Example:</h3>
<xmp>
usr << max(1,2,3)
</xmp>

<p>This example displays 3.

<p>If a single argument is specified, this is expected to be a list and the
maximum item from the list is returned.

<p>Items to be compared may be numbers, text strings, pixlocs, or vectors, or
null, but different types may not be mixed. (Null values can be mixed with
nums or text, but that's the only exception.)

<p>If the compared items are objects such as pixlocs or vectors, the result is
a new object, not one of the objects that was compared.

<hr>

<a name=/proc/md5>
<h2>md5 proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sha1>sha1 proc</a>
<dd><a href=#/proc/file>file proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>md5(T)
<dd>md5(F)
</dl>

<dl><dt><b>Returns:</b>
<dd>text or null.
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
<dd>F: A file.
</dl>

<p>This proc implements MD5 hashing.  A hash function is a one-way process
that compacts information to a short value: a hash.  The same value will
always have the same hash.  Among other uses, most computers use hashing
to store passwords.  By storing just the hash, the password file contains
very little sensitive information, but the password can still be verified
by confirming that <code>md5(password)==hash</code>.  MD5 is a widely-used
hash function.

<h3>Example:</h3>
<xmp>
mob/var/hash

mob/Read(savefile/S)
  ..()
  // hash was saved in the file along with other values
  if(md5("[level]/[exp]/[exp_needed]") != hash)
    src << "Cheater!"
    del(src)
</xmp>

<p>In the example, a few vars belonging to a mob were saved along with a hash
of those values.  When the mob is loaded again, the game compares the hash
to the values to make sure it's still accurate.  If the values or hash had
been changed by a sneaky player, they wouldn't match.  (But a sneaky player
could still calculate <code>hash</code> themselves if they knew the exact
text used to make it, so this should be kept secret.)

<p>If the argument is a file, <tt>md5()</tt> will read the file and return the
MD5 hash of the file's entire contents.  If the file doesn't exist, it returns
null.  The file may be a cache file or an external file.

<h3>Examples:</h3>
<xmp>
var/hash = "(insert hash value here)"	// Compute this ahead of time

// Check that the cached default icon is still the same
if (md5('default.dmi') != hash)
  world << "The default icon has been modified!"

// Or check that the entire game resource file is pristine
if (md5(file("mygame.rsc")) != hash)
  world << "The game resources have been modified!"
</xmp>

<p>Note that you must pass the result of <a class=code href=#/proc/file>file()</a>
in order to compute the hash of an external file's contents at runtime.
Otherwise <tt>md5()</tt> will treat the filename as text and return the hash
of the name only.

<p>If <tt>T</tt> is anything but a text string or file, the proc returns null.

<hr>

<a name=/proc/min>
<h2>min proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/max>max proc</a>
<dd><a href=#/proc/clamp>clamp proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>min(A,B,C,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>the minimum of the arguments.
</dl>

<h3>Example:</h3>
<xmp>
usr << min(1,2,3)
</xmp>

<p>This example displays 1.

<p>If a single argument is specified, this is expected to be a list and the
minimum item from the list is returned.

<p>Items to be compared may be numbers, text strings, pixlocs, or vectors, or
null, but different types may not be mixed. (Null values can be mixed with
nums or text, but that's the only exception.)

<p>If the compared items are objects such as pixlocs or vectors, the result is
a new object, not one of the objects that was compared.

<hr>

<a name=/proc/missile>
<h2>missile proc</h2>

<dl><dt><b>Format:</b>
<dd>missile(Type, Start, End)
</dl>

<dl><dt><b>Args:</b>
<dd>Type:  An object prototype or icon file.
<dd>Start: The starting location.
<dd>End:   The ending location.
</dl>

<p>Send a missile of the given Type between two locations.  The effect is
purely visual.  When Type is an object, its icon is used for the missile.

<h3>Example:</h3>
<xmp>
missile(/obj/fireball, usr, loc)
</xmp>

<hr>

<a name=/proc/nameof>
<h2 byondver=515>nameof proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/::>:: operator</a>
</dl>

<dl><dt><b>Format:</b>
<dd>nameof(Var)
<dd>nameof(ProcRef)
<dd>nameof(Path)
</dl>

<dl><dt><b>Args:</b>
<dd>Var: A variable, e.g. src.density or foo::bar.
<dd>ProcRef: A proc reference, e.g. /mob::Enter().
<dd>Path: A type path, e.g. /obj/item/barrel.
</dl>

<p>This returns the name of a var or proc, or the last part of a type path.
This proc only exists at compile-time.

<p>The main purpose of this proc is to turn a proc reference into a name,
which is useful in some esoteric situations.

<h3>Example:</h3>
<xmp>
var/list/event_queue

proc/CallLater(object, procref, a, b, c)
    var/list/forlater = list(object, nameof(procref), a, b, c)
    event_queue ||= list()
    event_queue[++event_queue.len] = forlater

world/Tick()
    while(length(event_queue))
        var/list/forlater = event_queue[1]
        event_queue.Cut(1,2)
        var/object = forlater[1]
        var/procname = forlater[2]
        var/a = forlater[3]
        var/b = forlater[4]
        var/c = forlater[5]
        call(object, procname)(a, b, c)
</xmp>

<hr>

<a name=/proc/new>
<h2>new proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/New>New proc (atom)</a>
<dd><a href=#/datum/proc/New>New proc (datum)</a>
<dd><a href=#/icon/proc/New>New proc (icon)</a>
<dd><a href=#/proc/newlist>newlist proc</a>
<dd><a href=#/operator/path>path operators</a>
<dd><a href=#/DM/preprocessor/__IMPLIED_TYPE__>__IMPLIED_TYPE__ macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>new Type(Args)
</dl>

<dl><dt><b>Returns:</b>
<dd>A reference to a new instance of Type.
</dl>

<dl><dt><b>Args:</b>
<dd>Type: The type of object to create.
<dd>Args: Arguments for the Type.New() proc.
</dl>

<p>A new instance of Type is created.  The arguments (Args) are passed to its
New() proc.  A handy short-cut: if Type is not specified and new() is being
used in an assignment, the variable type of the left-hand-side will be used as
the default type.

<p>The atom types /area, /turf, /obj, and /mob all take a location argument
specifying the initial position.  If not specified, it defaults to null.

<p>Newly created areas or turfs replace any existing area or turf at the
specified location.

<h3>Example:</h3>
<xmp>
obj/stick
mob/verb/magic_stick()
   var/obj/stick/S = new(src)  //create a stick in my inventory
   S.desc = "This is no ordinary stick!"
   view() << "[src] creates \an [S] from thin air!"
</xmp>

<hr>

<a name=/proc/newlist>
<h2>newlist proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/list>list proc</a>
<dd><a href=#/proc/new>new proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>newlist(A,B,C,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of new objects, just as though you had done <code>list(new
A,new B,new C,...)</code>.
</dl>

<dl><dt><b>Args:</b>
<dd>Arbitrary number of types to be created in the list.
</dl>

<h3>Example:</h3>
<xmp>
mob/contents = newlist(/obj/scroll/readme)
</xmp>

<p>This causes new mobs to be created with a readme scroll in their
inventory.

<p>It is possible to make simple initializations when you want variables to
have values other than the default for the particular type you are creating.

<h3>Example:</h3>
<xmp>
mob/contents = newlist(
   /obj/scroll/readme {
      name = "Introduction"
      desc = "The fate of Bracolia depends on you ..."
   }
)
</xmp>

<p>This is the most common use of "modified types", but it is not specific to
the newlist instruction.  Anywhere a type value may be used in DM, it may be
followed by a list of initializations.  The general syntax for a modified
types is:

<p><em>path</em> {<em>var1</em> = <em>val1</em>; <em>var2</em> = <em>val2</em>}

<p>The semicolon is necessary if you put several variable assignments on the
same line.  The braces are necessary, even though they are generally optional
in DM (since the compiler looks at your indentation).  The reason is that the
path + initializations must be parsed as a single expression, which is a
different context from the usual use of braces in DM when you are defining a
true type.  Also, indentation inside of an argument list is always ignored
anyway.

<hr>

<a name=/proc/noise_hash>
<h2 byondver=515>noise_hash proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/rand>rand proc</a>
<dd><a href=#/proc/rand_seed>rand_seed proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>noise_hash(num1, num2, num3...)
<dd>noise_hash(list_of_nums)
<dd>noise_hash(hash_name, num1, num2, num3...)
<dd>noise_hash(hash_name, list_of_nums)
</dl>

<dl><dt><b>Returns:</b>
<dd>A number between 0 and 1 (excluding 1 itself)
</dl>

<dl><dt><b>Args:</b>
<dd>num1, num2, num3...: Numbers to be hashed (at least one)
<dd>list_of_nums: A list containing the numbers to hash
<dd>hash_name: A text string indicating the hash type (reserved for future use)
</dl>

<p>For some games using concepts of procedural generation, it's nice to be
able to reliably create pseudo-random numbers in a repeatable, reliable way.
This proc takes all the numbers put into it and hashes them together to get
a value from 0 to 1. That output value will be the same for any given set of
input numbers. This can be used on its own or as part of a more in-depth
noise algorithm.

<p>If the first argument is a string, that may be used in future versions to
specify the type of hash to use. For now it is not used.

<p>Non-numbers provided to the proc will be interpreted arbitrarily. Don't do
that.

<hr>

<a name=/proc/nonspantext>
<h2 byondver=510>nonspantext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/spantext>spantext proc</a>
<dd><a href=#/proc/splittext>splittext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>nonspantext(Haystack,Needles,Start=1)
</dl>

<dl><dt><b>Returns:</b>
<dd>The number of consecutive characters, from the start position, that do NOT match the characters in Needles.
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needles: A text string with all the characters that should not match.
<dd>Start: The text byte  position in Haystack in which to begin the search.
</dl>

<p>This proc is case-sensitive.  A common use for this proc is in parsing.
For instance nonspantext("apples, oranges",", ") will return 6, because the
first 6 characters don't match a comma or a space.

<p>If the start position is negative, the position is counted backwards from
the end of the string.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>nonspantext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/num2text>
<h2>num2text proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/isnum>isnum proc</a>
<dd><a href=#/proc/text2num>text2num proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>num2text(N, SigFig=6)
<dd byondver=513>num2text(N, Digits, Radix)
</dl>

<dl><dt><b>Returns:</b>
<dd>A text string.
</dl>

<dl><dt><b>Args:</b>
<dd>N: A number.
<dd>SigFig: Number of significant digits.
<dd>Digits: Minimum number of digits
<dd>Radix: The base of the number, e.g. 16 is hexadecimal.
</dl>

<p>Get the text string for a number.  The number of significant digits
determines when scientific notation is used.  The default is 6, so
scientific notation will only be used when there are more than 6 digits.

<h3>Example:</h3>
<xmp>
T = num2text(12)  // = "12"
T = num2text(12,1)  // = "1.2e1"
</xmp>

<p>The Radix format is intended for converting numbers to bases other than
10, although you can still use 10. In this format, Digits represents the
minimum number of digits to use, and the result will be left-padded with
zeroes if necessary. Also, in this form only the integer part of the number
is used, and it can't be any larger than what a 32-bit integer could store
(about 4 billion). These limitations may be lessened or removed in the future,
but this format was mainly intended for simple conversions.

<h3>Example:</h3>
<xmp>
world << num2text(11, 2, 16)  // "0b"
world << num2text(343, 0, 7)  // "1000"
</xmp>

<hr>

<a name=/proc/obounds>
<h2>obounds proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/bounds>bounds proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>obounds(Ref, Dist=0)
<dd>obounds(Ref, x_offset, y_offset, extra_width=0, extra_height=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of atoms (except areas) within Ref's bounding box, excluding Ref.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref:    A turf, obj, or mob.
<dd>Dist:   A number (distance in pixels).
<dd>x_offset, y_offset: Shifts bounding box position
<dd>extra_width, extra_height: Adjusts bounding box size
</dl>

<p>The results from obounds() are identical to bounds(), but obounds() leaves
Ref out of the results.

<hr>

<a name=/proc/ohearers>
<h2>ohearers</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/hearers>hearers</a>
<dd><a href=#/proc/oview>oview proc</a>
<dd><a href=#/proc/oviewers>oviewers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ohearers(Depth=world.view,Center=usr)
</dl>

<p>This is just like <code>hearers()</code>, but it excludes the center object
and its contents from the list.  It is a list of all other mobs that can hear
the center object.

<hr>

<a name=/proc/orange>
<h2>orange proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/block>block</a>
<dd><a href=#/proc/oview>oview proc</a>
<dd><a href=#/proc/range>range proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>orange(Dist,Center=usr)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of objects within Dist tiles of Center, excluding Center.
</dl>

<dl><dt><b>Args:</b>
<dd>Dist:   A number.
<dd>Center: An object on the map.
</dl>

<p>This instruction is identical to oview() except visibility is ignored.
All objects are included in the list whether they are visible or not.  The
center object and its contents are excluded.

<hr>

<a name=/proc/output>
<h2>output proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/winclone>winclone proc</a>
<dd><a href=#/proc/winset>winset proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>output(msg, control)
</dl>

<dl><dt><b>Args:</b>
<dd>msg: Text, an atom, a file, or null
<dd>control: The ID of a control in the player's skin, or null for the default
</dl>

<p>This is used in conjunction with the &lt;&lt; output operator to send
output to a particular control in the player's skin. If null is sent, the
control will be cleared.

<h3>Example:</h3>
<xmp>
usr << output("Your score is [score].", "scorepane.output")
</xmp>

<p>As with <tt>winset()</tt>, the control name may be in the form
<tt>":[type]"</tt> which sends to the default control of that type, e.g.
<tt>":output"</tt>.

<p>The control ID can be followed by a colon and extra info such as a name
or a grid cell, which can send the output to the control in a different way.
In a grid, this can output directly to a specific grid cell, like so:

<h3>Example:</h3>
<xmp>
usr << output("Column 3, Row 2", "examplegrid:3,2")
</xmp>

<p>For a browser control, the extra info is a JavaScript function. The format
for sending a script to the browser control is
<tt>output("[params]","[control]:[scriptname]")</tt> where "[params]" is a
URL-encoded list of string arguments to the javascript function, as formatted
by <a class=code href=#/proc/list2params>list2params()</a>.

<h3>Example:</h3>
<xmp>
mob/Login()
    . = ..()
    usr << output(\
{"
<script type="text/javascript">
function replace(v) {
  document.getElementById('foo').innerHTML =
    v.replace(/&/g, '&amp;').replace(/</g, '&lt;');
}
</script>
<div id="foo">This text can change.</div>
<p>And this can't.</p>
"},
    ":browser");

#define LP(str) list2params(list(str))
mob/verb/newtext(T as text)
    usr << output(LP(T), ":browser:replace")
</xmp>

<p>This allows for the creation of more dynamic interfaces, since javascript
provides access to many client-side operations and flicker-free updates.

<hr>

<a name=/proc/oview>
<h2>oview proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/orange>orange proc</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>oview(Dist,Center=usr)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of visible objects within Dist tiles of Center, excluding Center.
</dl>

<dl><dt><b>Args:</b>
<dd>Dist:   A number.
<dd>Center: An object on the map.
</dl>

<p>This instruction is just like view() except it doesn't include Center or
its contents in the list.

<h3>Example:</h3>
<xmp>
oview() << "to others in sight of [usr]"
</xmp>

<hr>

<a name=/proc/oviewers>
<h2>oviewers</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/hearers>hearers</a>
<dd><a href=#/proc/oview>oview proc</a>
<dd><a href=#/proc/oviewers>oviewers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>oviewers(Depth=world.view,Center=usr)
</dl>

<p>This is just like <code>viewers()</code>, but it excludes the center object
and its contents from the list.  It is a list of all other mobs that can see
the center object.

<hr>

<a name=/proc/params2list>
<h2>params2list proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/list2params>list2params proc</a>
<dd><a href=#/world/var/params>params var (world)</a>
<dd><a href=#/proc/text2num>text2num proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>params2list(Params)
</dl>

<dl><dt><b>Args:</b>
<dd>Params: Text string of parameter values.
</dl>

<dl><dt><b>Returns:</b>
<dd>An associative list of parameter names and values.
</dl>

<p>This instruction converts a parameter text string to a list of individual
parameters and associated values.  The format of the parameter text is:

<xmp>
"name1=value1&name2=value2&..."
</xmp>

<p>The field separator <tt>;</tt> may be used in place of <tt>&amp;</tt>.

<p>Special characters such as <tt>=</tt>, <tt>;</tt>, and <tt>&amp;</tt>
inside the parameter names or values should be written in the form
<code>%xx</code>, where <code>xx</code> are two hexadecimal digits
representing the ASCII value of the character. (For
<a href=#/{notes}/Unicode>Unicode</a> characters, this may be several
<code>%xx</code> sequences using UTF-8 encoding.)  For example,
<tt>=</tt> would be written <code>%3d</code>, <tt>;</tt> would be
<code>%3b</code>, <tt>&amp;</tt> would be <code>%26</code>, and <tt>%</tt>
would be <code>%25</code>.  These "escaped" codes are automatically translated
into the corresponding character when read by <tt>params2list()</tt>.

<p>This parameter format is the same one used by most HTML forms and is
known by the MIME type <tt>application/x-www-form-urlencoded</tt>.  It is
often used in DM to pack information into topic links.  Though DM does not
require it, the standard format is for newlines to be written as CR LF pairs
(<code>%0d%0a</code>) and spaces to be written as <tt>+</tt> characters.  That
means if you want to write a <tt>+</tt> symbol, you will have to use
<code>%2b</code>.

<p>The list produced from the parameter text has items <tt>"name1"</tt>,
<tt>"name2"</tt>, and so on.  To access the values associated with these, you
use the parameter name as the list index.

<h3>Example:</h3>
<xmp>
var/ptext = "offense=jwalk&time=10:00"
var/plist[] = params2list(ptext)

var/p
for(p in plist)
   usr << "[p] = [plist[p]]"
</xmp>

<p>The above example defines a simple parameter text string containing two
parameters: <tt>"offense"</tt> and <tt>"time"</tt>.  These are associated with
the values <tt>"jwalk"</tt> and <tt>"10:00"</tt>.  The <code>for</code> loop
illustrates how one might loop through the list and print out each setting.

<p>Note that all values are stored as text strings in the list.  If you wish
to perform a numerical operation (such as addition), you should convert the
value to a number first using <tt>text2num()</tt>.  If the value is an object
text reference, you can convert that into the object itself by using
<tt>locate()</tt>.

<p>If you have multiple items with the same name, they will be combined into
a list of text strings. For example, <tt>"key=value1;key=value2"</tt> would
set <tt>list["key"]</tt> to a list containing <tt>"value1"</tt> and
<tt>"value2"</tt>, not necessarily in that order.

<hr>

<a name=/proc/pick>
<h2>pick proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/prob>prob proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>pick(Val1,Val2,...)
<dd>pick(List)
</dl>

<dl><dt><b>Returns:</b>
<dd>One of the given values randomly chosen.
</dl>

<p>Randomly chooses an item from a list or from the arguments provided. If
only one argument is included and it is a list, then the item is chosen from
that list.

<p>When not using the list form, you can make a particular value more or less
likely to be chosen by providing a relative probability like this:

<xmp>
prob(P); Val
  Or
P; Val
</xmp>

<p>A value for P of 200 makes it twice as likely as the norm, 50 half as
likely, and so on.

<h3>Example:</h3>
<xmp>
obj/food
  verb/eat()
    usr << pick (
        "[usr] eats \a [src].",
      prob(50)
        "[usr] devours \a [src].",
      prob(25)
       "[usr] wolfs down \a [src]."
    )
    del(src)
</xmp>

<p>There is no analogous weighted format for the list version of this proc.

<hr>

<a name=/proc/pixloc>
<h2 byondver=516>pixloc proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/atom/var/pixloc>pixloc var (atom)</a>
<dd><a href=#/proc/bound_pixloc>bound_pixloc proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>pixloc(x, y, z)
<dd>pixloc(Atom)
<dd>pixloc(Atom, x, y)
<dd>pixloc(Atom, Vector)
<dd>pixloc(Pixloc)
<dd>pixloc(Pixloc, x, y)
<dd>pixloc(Pixloc, Vector)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new <tt>pixloc</tt> object or null.
</dl>

<dl><dt><b>Args:</b>
<dd>x, y, z: Pixel coordinates in world space (starting at 1,1,1). When the first argument is an atom or pixloc, x and y are offsets.
<dd>Atom: An atom whose pixloc will be copied.
<dd>Pixloc: An existing pixloc to copy.
<dd>Vector: A 2D vector to offset the new pixloc by.
</dl>

<p>Creates a new <tt>pixloc</tt> object based on an existing object's
location or using raw world coordinates. If the pixloc can't be created, for
instance if the Atom argument is not directly on the map, the result is null.

<h3>Example:</h3>
<xmp>
mob/proc/GoToStrangeForest()
    // in a world with 32x32 icon size, this is x=18, y=29, step_x=5, step_y=11
    mob.pixloc = pixloc(550, 907, 1)
</xmp>

<p>When the pixloc is created with world coordinates, x and y are a
combination of tile x and step_x, and tile y and step_y, starting at a value
of 1. The world x and y for any tile and step combo can be calculated like so
(if for any reason you needed to):

<xmp>
world_x = (tile_x - 1) * pixels_per_x_tile  + step_x + 1
world_y = (tile_y - 1) * pixels_per_y_tile + step_y + 1
</xmp>

<hr>

<a name=/proc/prob>
<h2>prob proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/pick>pick proc</a>
<dd><a href=#/proc/rand>rand proc</a>
<dd><a href=#/proc/rand_seed>rand_seed proc</a>
<dd><a href=#/proc/roll>roll proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>prob(P)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 with probability P percent; otherwise 0
</dl>

<dl><dt><b>Args:</b>
<dd>P: A number.
</dl>

<hr>

<a name=/proc/rand>
<h2>rand proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/pick>pick proc</a>
<dd><a href=#/proc/prob>prob proc</a>
<dd><a href=#/proc/rand_seed>rand_seed proc</a>
<dd><a href=#/proc/roll>roll proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>rand(L=0,H) or rand()
</dl>

<dl><dt><b>Returns:</b>
<dd>A random integer between L and H inclusive; or a random number from 0 up
to 1 if L and H are omitted.
</dl>

<dl><dt><b>Args:</b>
<dd>L: A number for the lower-bound.
<dd>H: A number for the upper-bound.
</dl>

<hr>

<a name=/proc/rand_seed>
<h2>rand_seed proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/pick>pick proc</a>
<dd><a href=#/proc/prob>prob proc</a>
<dd><a href=#/proc/rand>rand proc</a>
<dd><a href=#/proc/roll>roll proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>rand_seed(Seed)
</dl>

<dl><dt><b>Args:</b>
<dd>Seed: An integer used to initialize the random number generator.
</dl>

<p>Many DM procedures make use of a pseudo-random number generator.  You can
use rand_seed() to initialize the generator.  The sequence returned by the
generator is identical each time it is initialized with the same seed, so you
could use this to reproduce the same output from an algorithm that uses the
random number generator.  If you never call rand_seed(), the generator is
initialized with a seed from the system clock, so it is effectively random.

<p>Note that with multiple realtime algorithms making calls to the generator
at unpredictable times, you are likely not to get the same result even when
using the same seed.  The overall sequence will be the same, but individual
sub-components of your world might call it in a different order.

<p>The pseudo-random number generator is system dependent, so do not expect
the sequence generated from a particular seed to be identical on two different
machines or operating systems.

<hr>

<a name=/proc/range>
<h2>range proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/block>block</a>
<dd><a href=#/proc/view>view proc</a>
<dd><a href=#/proc/orange>orange proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>range(Dist,Center=usr)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of objects within Dist tiles of Center.
</dl>

<dl><dt><b>Args:</b>
<dd>Dist:   A number.
<dd>Center: An object on the map.
</dl>

<p>This instruction is identical to view() except visibility is ignored.
All objects are included in the list whether they are visible or not.

<p>A Dist of 0 includes Center, the contents of Center (normally
usr.contents), its location (normally the turf a mob is standing on), and any
other contents of that location.  A value of 1 extends the region to the
neighboring squares on the map and so on.  You can also use a rectangular box
size using a text string such as "13x11".  Both arguments are optional and may
be passed in any order.

<hr>

<a name=/proc/ref>
<h2>ref proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text/macros/ref>\ref text macro</a>
<dd><a href=#/proc/locate>locate proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ref(Object)
</dl>

<dl><dt><b>Args:</b>
<dd>Object: The object to get a reference for
</dl>

<dl><dt><b>Returns:</b>
<dd>A string containing a reference ID.
</dl>

<p>This is a shortcut for <tt>"\ref[Object]"</tt>.

<hr>

<a name=/proc/refcount>
<h2 byondver=515>refcount proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/garbage>garbage collection</a>
</dl>

<dl><dt><b>Format:</b>
<dd>refcount(Object)
</dl>

<dl><dt><b>Args:</b>
<dd>Object: The object to get a reference count for
</dl>

<dl><dt><b>Returns:</b>
<dd>A count of references for the object.
</dl>

<p>This gets a reference count for a value, not including the reference that
was placed on the stack while evaluating this proc. 

<p>A return value of 0 can mean one of several things: Either this was the last
reference and the object was subsequently deleted after refcount(), or the
value doesn't support reference counting.

<p>Note: A nonzero return value does not necessarily mean the object will be
deleted when its count reaches zero; mobs for instance will not be
soft-deleted by the garbage collector if their <tt>key</tt> var is set, and
some objects like clients and areas never soft-delete. A zero value also does
not necessarily mean the object is immortal; it may be transient, like the
<tt>args</tt> list in a proc that only lives as long as that copy of the proc
lives.

<hr>

<a name=/proc/regex>
<h2 byondver=510>regex proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc>regex procs</a>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/replacetext>replacetext proc</a>
<dd><a href=#/proc/splittext>splittext proc</a>
<dd><a href=#/proc/REGEX_QUOTE>REGEX_QUOTE proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>regex(pattern, flags)
<dd>regex(Regex)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new /regex datum.
</dl>

<dl><dt><b>Args:</b>
<dd>pattern: The pattern string to search for
<dd>flags: (optional) A text string containing any combination of modifier flags
<dd>Regex: an existing /regex datum to copy
</dl>

<p>Creates a <a href=#/{notes}/regex>regular expression</a>, stored in a /regex
datum, that can be used for searching and/or replacing text.

<hr>

<a name=/proc/REGEX_QUOTE>
<h2 byondver=510>REGEX_QUOTE proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/regex>regex proc</a>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<dl><dt><b>Format:</b>
<dd>REGEX_QUOTE(text)
<dd>REGEX_QUOTE_REPLACEMENT(text)
</dl>

<dl><dt><b>Returns:</b>
<dd>REGEX_QUOTE: A version of the text with any special regular expression characters escaped by backslashes.
<dd>REGEX_QUOTE_REPLACEMENT: A version of the text with $ characters escaped by a second $.
</dl>

<dl><dt><b>Args:</b>
<dd>text: The text to escape
</dl>

<p>Quotes a piece of text so that it can be used inside a regular expression
without fear of being treated as pattern instructions.

<h3>Example:</h3>
<xmp>
proc/FindWord(text, word)
    // The \b pattern is a word break, to search for the word
    // on its own instead of as part of another word.
    var/regex/R = regex("\\b[REGEX_QUOTE(word)]\b", "i")
    // find the pattern in the text
    return R.Find(text)
</xmp>

<hr>

<a name=/proc/replacetext>
<h2 byondver=510>replacetext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/replacetextEx>replacetextEx proc</a>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex/proc/Replace>Replace proc (regex)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>replacetext(Haystack,Needle,Replacement,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The Haystack text with all cases of Needle replaced by Replacement
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needle: The sub-text to search for. May be a regular expression (regex).
<dd>Replacement: The replacement text, or a proc.
<dd>Start: The text byte position in Haystack in which to begin the search.
<dd>End: The text byte position in Haystack immediately following the last
     character to search.
</dl>

<p>When Needle is text, this instruction is NOT sensitive to the case of
Haystack or Needle.  The case-sensitive version is replacetextEx().  If the
Needle is a lowercase word, the replacement will be changed to uppercase or
all caps if the found text is uppercase or all caps.

<h3>Example:</h3>
<xmp>
world << replacetext("One on one", "one", "two")
</xmp>

<p>This outputs "Two on two", where the first case's "One" is identified as
uppercase.

<p>You may use a proc as the Replacement value.  In that case, the proc will
be called with the found text as an argument, and its return value will be the
replacement.  There will be no automatic correction to uppercase or all caps
in this case.

<p>When the Needle value is a regular expression, this proc behaves identically
to the <a href=#/regex/proc/Replace>regex Replace()</a> proc.  Case-sensitivity,
and whether one match or all are replaced, depend on the regular expression.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>replacetext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/replacetextEx>
<h2 byondver=510>replacetextEx proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtextEx>findtextEx proc</a>
<dd><a href=#/proc/replacetext>replacetext proc</a>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex/proc/Replace>Replace proc (regex)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>replacetextEx(Haystack,Needle,Replacement,Start=1,End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The Haystack text with all cases of Needle replaced by Replacement
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needle: The sub-text to search for. May be a regular expression (regex).
<dd>Replacement: The replacement text, or a proc.
<dd>Start: The text byte position in Haystack in which to begin the search.
<dd>End: The text byte position in Haystack immediately following the last
     character to search.
</dl>

<p>When Needle is text, this instruction is sensitive to the case of Haystack
and Needle.  The case-insensitive version is replacetext().

<h3>Example:</h3>
<xmp>
world << replacetext("One on one", "one", "two")
</xmp>

<p>This outputs "Two on two", where the first case's "One" is identified as
uppercase.

<p>You may use a proc as the Replacement value.  In that case, the proc will
be called with the found text as an argument, and its return value will be the
replacement.  There will be no automatic correction to uppercase or all caps
in this case.

<p>When the Needle value is a regular expression, this proc behaves identically
to the <a href=#/regex/proc/Replace>regex Replace()</a> proc.  Case-sensitivity,
and whether one match or all are replaced, depend on the regular expression.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>replacetextEx_char()</tt>
to work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/return>
<h2>return statement</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var/%2e>. var (proc)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>return E
</dl>

<p>Stop execution of the current proc and return the value of E to the
caller.  If no value is specified, the value of <tt>.</tt> will be returned,
which defaults to null.

<hr>

<a name=/proc/rgb>
<h2>rgb proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/rgb2num>rgb2num proc</a>
<dd><a href=#/proc/gradient>gradient proc</a>
<dd><a href=#/{{appendix}}/color-space>Color space</a>
<dd><a href=#/{{appendix}}/html-colors>HTML colors</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/icon/proc/Blend>Blend proc (icon)</a>
<dd><a href=#/{notes}/color-matrix>Color matrix</a>
<dd><a href=#/{notes}/filters/color>Color matrix filter</a>
<dd><a href=#/{notes}/particles>Particle effects</a>
</dl>

<dl><dt><b>Format:</b>
<dd>rgb(R,G,B)
<dd>rgb(R,G,B,A)
<dd>rgb(x,y,z,space=<i>color space</i>)
<dd>rgb(x,y,z,a,space)
</dl>

<dl><dt><b>Args:</b>
<dd>R,G,B: Numbers from 0-255 corresponding to the red, green, and blue
components of a color.
<dd>A: Optional alpha component; 0 is transparent, 255 is opaque.
<dd>x,y,z: Color components for a different color space
<dd>space: <a href=#/{{appendix}}/color-space>Color space</a>; defaults to <tt>COLORSPACE_RGB</tt>
</dl>

<dl><dt><b>Returns:</b>
<dd>A color, represented by a text string in #RRGGBB or #RRGGBBAA format
</dl>

<p>A way of representing a color to be used in conjunction with icon
arithmetic, atom.color, or other effects.  The colors <tt>rgb(0,0,0)</tt>
and <tt>rgb(255,255,255)</tt> represent black and white, two corners of the
"color cube".

<h3>Example:</h3>
<xmp>
mob/proc/hurtme() // make a mob look damaged by adding red to its icon
  src.icon += rgb(20,0,0)
</xmp>

<p>This proc returns a text string in the form used by HTML (#RRGGBB).
rgb(255,0,128) for example becomes "#ff0080". If you use an alpha component,
the format is #RRGGBBAA. You can use strings like this in most procs that use
colors such as icon blending operations, and you can also use the short form
#RGB or #RGBA. So if you know in advance that you want to use the color
white, you can simply use"#fff" instead of rgb(255,255,255).

<p>You can create colors other ways by specifying a different
<a href=#/{{appendix}}/color-space>color space</a>. A color space can be
specified by using a <a href=#/proc/arguments/named>named</a> "space" argument,
or by using a 5-argument format (you can leave the alpha value blank or null to
skip it), or by using named arguments for the other components.

<h3>Example:</h3>
<xmp>
// All of these lines are equivalent.
// They create (0,100,50) in HSL which is red (#ff0000).
src << rgb(0, 100, 50, space=COLORSPACE_HSL)
src << rgb(0, 100, 50, , COLORSPACE_HSL)
src << rgb(h=0, s=100, l=50)
</xmp>

<p>Named arguments that are valid in <tt>rgb()</tt> are:

<ul>
<li><tt>space</tt></li>
<li><tt>red</tt></li>
<li><tt>green</tt></li>
<li><tt>blue</tt></li>
<li><tt>alpha</tt></li>
<li><tt>hue</tt></li>
<li><tt>saturation</tt></li>
<li><tt>chroma</tt></li>
<li><tt>value</tt></li>
<li><tt>luminance</tt></li>
<li><tt>y</tt> (HCY luminance)</li>
</ul>

<p>With the exception of <tt>space</tt>, only the first letter of the argument
name matters, so <tt>r</tt> and <tt>red</tt> are the same thing.

<hr>

<a name=/proc/rgb2num>
<h2>rgb2num proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/rgb>rgb proc</a>
<dd><a href=#/proc/gradient>gradient proc</a>
<dd><a href=#/{{appendix}}/color-space>Color space</a>
<dd><a href=#/{{appendix}}/html-colors>HTML colors</a>
</dl>

<dl><dt><b>Format:</b>
<dd>rgb2num(color)
<dd>rgb2num(color, space)
</dl>

<dl><dt><b>Args:</b>
<dd>color: A color value (see <a href=#/{{appendix}}/html-colors>HTML colors</a>)
<dd>space: <a href=#/{{appendix}}/color-space>Color space</a>; default is <tt>COLORSPACE_RGB</tt>
</dl>

<dl><dt><b>Returns:</b>
<dd>A list with the components of this color
</dl>

<p>Parses a color into a list with 3 or 4 component values; the 4th value is
alpha, if it's part of the color provided.

<h3>Example:</h3>
<xmp>
var/list/RGB = rgb2num("#ff8000")
src << RGB[1]     // red (255)
src << RGB[2]     // green (128)
src << RGB[3]     // blue (0)
</xmp>

<p>By specifying a different color space, you can convert a color into a
different format.

<h3>Example:</h3>
<xmp>
var/list/HSL = rgb2num("#5af", COLORSPACE_HSL)
src << HSL[1]     // hue (210)
src << HSL[2]     // saturation (100)
src << HSL[3]     // luminance (66.6667)
</xmp>

<hr>

<a name=/proc/roll>
<h2>roll proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/rand>rand proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>roll(ndice=1,sides)
<dd>roll(dice)
</dl>

<dl><dt><b>Returns:</b>
<dd>The sum of the rolled dice.
</dl>

<dl><dt><b>Args:</b>
<dd>ndice: number of dice to role.
<dd>sides: number of sides to the dice.
<dd>dice: a text string encoding both ndice and sides (see below).
</dl>

<p>The sides of the dice are numbered 1 through the total number of sides
and each is equally likely.

<p>An alternate form takes the dice parameters in a single text value such
as "3d4".  This may be useful when you want to store the dice information in
a single variable.  You can even specify an offset, such as "3d4+5".  That
adds 5 to the sum of 3 dice having 4 sides each.

<h3>Example:</h3>
<xmp>
obj/potion/healing
  var/dice = "3d6"
  verb/drink()
    var/h = roll(dice)
    if(h>15) usr << "Very refreshing!"
    else usr << "You feel better."
</xmp>

<hr>

<a name=/proc/round>
<h2>round proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/floor>floor proc</a>
<dd><a href=#/proc/ceil>ceil proc</a>
<dd><a href=#/proc/trunc>trunc proc</a>
<dd><a href=#/proc/fract>fract proc</a>
<dd><a href=#/proc/sign>sign proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd deprecated=1>round(A)
<dd>round(A,B)
</dl>

<dl><dt><b>Returns:</b>
<dd>rounded A
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number, pixloc, or vector.
<dd>B: The nearest multiple to round A.
</dl>

<p>The first format returns the floor of A (the largest integer less than or
equal to A), and has been deprecated in favor of <tt>floor(A)</tt>. The second
format rounds A to the nearest multiple of B.

<h3>Example:</h3>
<xmp>
usr << round(1.45) // outputs 1

usr << round(-1.45) // outputs -2

usr << round(1.45,1.5) // outputs 1.5
</xmp>

<p>If A is a vector, B can also be a vector to round each component
separately.

<p>If A is a pixloc, only the x and y portions will be considered. B may be a
vector.

<hr>

<a name=/proc/run>
<h2>run proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/link>link proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>O &lt;&lt; run(File)
</dl>

<p>This is similar to link() but instead of a URL, you can pass a file to be
viewed directly.  The file may be a cache file or an external file.

<h3>Example:</h3>
<xmp>
mob/var/picture = 'mob.jpg'
mob/verb/view_pic(mob/M as mob in view())
  usr << run(M.picture)

mob/verb/set_pic(F as file)
  usr.picture = F
</xmp>

<p>This example defines a picture to be associated with each mob and a verb
for viewing another mob's picture.  Players can also configure their own
pictures.

<hr>

<a name=/proc/set>
<h2>settings (proc)</h2>

<p>proc settings:

<code><pre>
verb/set
  <a href=#/verb/set/name>name</a>
  <a href=#/verb/set/desc>desc</a>
  <a href=#/verb/set/category>category</a>
  <a href=#/verb/set/hidden>hidden</a>
  <a href=#/verb/set/popup_menu>popup_menu</a>
  <a href=#/verb/set/instant>instant</a>
  <a href=#/verb/set/invisibility>invisibility</a>
  <a href=#/verb/set/src>src</a>
  <a href=#/proc/set/background>background</a>
  <a href=#/proc/set/waitfor>waitfor</a>
</pre></code>

<p>Procs and verbs are the same "type" so these attributes may be set for both
procs and verbs; most of them only apply to verbs, so they only take effect if
the proc is invoked as a verb (by adding it to a verb list).

<hr>

<a name=/proc/set/background>
<h2>background setting (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sleep>sleep proc</a>
<dd><a href=#/proc/spawn>spawn proc</a>
</dl>

<p>To avoid lag from procedures that hog the CPU for too long, you can turn on
background processing.  This will cause it to periodically sleep for long
enough to allow other events to be processed.

<p>The following example is a typical "ticker" procedure.  It spawns off an
infinite loop which does some work and then sleeps before iterating again.  By
running this in the background, you ensure that the work being done does not
create large delays.  You could achieve a similar thing by sprinkling calls to
sleep(0) or sleep(-1) in the "working" part of the loop.

<h3>Example</h3>
<xmp>
proc/Ticker()
   set background = 1
   spawn while(1)
      for(var/mob/M in world)
         M.Tick()
      sleep(10)
</xmp>

<p>Since the background procedure sleeps at unpredictable times, you must be
aware that race conditions are possible if the background procedure interacts
with variables modified by other procedures.  It's still much safer than
multi-threaded programs because the background procedure never interrupts
other code; but other code may interrupt the background procedure.

<p>Note that procedures that are called by the background procedure do not
automatically run in the background unless they too have the background
setting turned on.  For instance, the code in the above example does not imply
that the mob Tick() procs would run in the background.  This is convenient,
because you should only ever apply background processing to code after
checking that there are no potential race conditions involved.

<p>If you have an eye for race conditions, you might think that the above code
has one in which a mob gets deleted after it is assigned to M but before the
call to M.Tick() is executed.  However, <em>background processing is only
interrupted at loop points in the code</em>, so the above code is safe.  It
would only ever be interrupted at the end of the <code>for</code> or
<code>while</code> loops.

<hr>

<a name=/proc/set/waitfor>
<h2>waitfor setting (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sleep>sleep proc</a>
<dd><a href=#/proc/spawn>spawn proc</a>
<dd><a href=#/proc/var/%2e>. var (proc)</a>
</dl>

<p>By default, procs that sleep usually expect their callers to wait for them
to finish, so the callers must sleep as well. Using <tt>set waitfor=0</tt>
will disable that behavior, causing any sleep to return control to the caller
immediately.

<h3>Example</h3>
<xmp>
mob/proc/LongLoop()
   set waitfor = 0
   while(1)
      UpdateAI()
      // proc will return to caller here
      sleep(1)
</xmp>

<p>This setting will also dictate what happens if a callee sleeps. Consider an
example where proc A calls proc B which calls proc C, and proc B has
<tt>waitfor</tt> set to 0. When proc C sleeps, proc B will also sleep, but
proc A will continue running as if proc B returned early. The <tt>.</tt> var
currently in proc B will be used as its return value to A. When proc C wakes
up and finishes, it will wake up proc B, but now B's return value will be
ignored since A is no longer waiting for it.

<p>In older versions, the <a href=#/datum/proc/New><tt>New</tt> proc</a>
always had <tt>waitfor</tt> set to 0 by default, but this was later changed.
Now 1 is always the default, so setting <tt>waitfor</tt> to 1 will result in a
warning that it is no longer necessary.

<hr>

<a name=/proc/sha1>
<h2 byondver=513>sha1 proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/md5>md5 proc</a>
<dd><a href=#/proc/file>file proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sha1(T)
<dd>sha1(F)
</dl>

<dl><dt><b>Returns:</b>
<dd>text or null.
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
<dd>F: A file.
</dl>

<p>This proc implements SHA1 hashing.  A hash function is a one-way process
that compacts information to a short value: a hash.  The same value will
always have the same hash.  Among other uses, most computers use hashing
to store passwords.  By storing just the hash, the password file contains
very little sensitive information, but the password can still be verified
by confirming that <code>sha1(password)==hash</code>.  SHA1 is a widely-used
hash function.

<h3>Example:</h3>
<xmp>
mob/var/hash

mob/Read(savefile/S)
  ..()
  // hash was saved in the file along with other values
  if(sha1("[level]/[exp]/[exp_needed]") != hash)
    src << "Cheater!"
    del(src)
</xmp>

<p>In the example, a few vars belonging to a mob were saved along with a hash
of those values.  When the mob is loaded again, the game compares the hash
to the values to make sure it's still accurate.  If the values or hash had
been changed by a sneaky player, they wouldn't match.  (But a sneaky player
could still calculate <code>hash</code> themselves if they knew the exact
text used to make it, so this should be kept secret.)

<p>If the argument is a file, <tt>sha1()</tt> will read the file and return
the SHA1 hash of the file's entire contents.  If the file doesn't exist, it
returns null.  The file may be a cache file or an external file.

<h3>Examples:</h3>
<xmp>
var/hash = "(insert hash value here)" // Compute this ahead of time

// Check that the cached default icon is still the same
if (sha1('default.dmi') != hash)
  world << "The default icon has been modified!"

// Or check that the entire game resource file is pristine
if (sha1(file("mygame.rsc")) != hash)
  world << "The game resources have been modified!"
</xmp>

<p>Note that you must pass the result of <a class=code href=#/proc/file>file()</a>
in order to compute the hash of an external file's contents at runtime. Otherwise
<tt>sha1()</tt> will treat the filename as text and return the hash of the
name only.

<p>If <tt>T</tt> is anything but a text string or file, the proc returns null.

<hr>

<a name=/proc/shell>
<h2>shell proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/fcopy>fcopy proc</a>
<dd><a href=#/proc/fdel>fdel proc</a>
<dd><a href=#/proc/file2text>file2text proc</a>
<dd><a href=#/world/var/process>process var (world)</a>
<dd><a href=#/world/var/system_type>system_type var (world)</a>
<dd><a href=#/proc/text2file>text2file proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>shell(Command)
</dl>

<dl><dt><b>Args:</b>
<dd>Command: system command to run
</dl>

<dl><dt><b>Returns:</b>
<dd>null on failure to execute command
<dd>exit code of command otherwise
</dl>

<p>This function is used to run an external program.  The syntax of Command
depends on the server machine's operating system.  Be sure to redirect input
and output to files if there is any.  Also realize that the command will
fail if the program you try to run is not in the path where the shell
expects to find executable files (unless you specify a full path).

<p>Since shell() allows arbitrary access to the system, each call requires
authorization from the person hosting the world, unless running in trusted
mode.  Authorization is only sought when running in Dream Seeker, since Dream
Daemon is intended to be non-interactive.  Calling shell() with no arguments
is a way of checking if it is allowed by the current safety settings.  It will
return true if running in Dream Seeker (regardless of safety mode) or if
running in Dream Daemon in trusted mode.

<p>The calling proc will sleep until the command is finished executing.

<h3>Example:</h3>
<xmp>
mob/verb/dir(Path as text)
  shell("dir [Path] > dir.out")
  usr << file2text("dir.out")
</xmp>

<p>This example displays the output of the "dir" command to the user.

<hr>

<a name=/proc/shutdown>
<h2>shutdown proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/Export>Export proc (world)</a>
<dd><a href=#/proc/startup>startup proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>shutdown(Addr,Natural=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Addr: This is the address of the child world returned by startup().
<dd>Natural: Specifies whether to wait for the child world to die
     naturally, or whether it should be killed with the "Del" world topic.
     The default value of 0 kills the child, and a value of 1 waits for the
     child to exit of its own accord.
</dl>

<p>If no address is specified, the current world is shut down.

<hr>

<a name=/proc/sign>
<h2 byondver=516>sign proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/floor>floor proc</a>
<dd><a href=#/proc/ceil>ceil proc</a>
<dd><a href=#/proc/round>round proc</a>
<dd><a href=#/proc/trunc>trunc proc</a>
<dd><a href=#/proc/fract>fract proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sign(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if A &gt; 0, -1 if A &lt; 0, 0 if A == 0
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number.
</dl>

<p>Returns the sign of A.

<h3>Example:</h3>
<xmp>
usr << sign(20) // outputs 1
usr << sign(0)  // outputs 0
usr << sign(-3) // outputs -1
</xmp>

<hr>

<a name=/proc/sin>
<h2>sin proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arcsin>arcsin proc</a>
<dd><a href=#/proc/cos>cos proc</a>
<dd><a href=#/proc/tan>tan proc</a>
<dd><a href=#/proc/turn>turn proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sin(X)
</dl>

<dl><dt><b>Returns:</b>
<dd>The sine of X, where X is in degrees.
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << sin(0)  // 0
   usr << sin(45) // 0.707...
   usr << sin(90) // 1
</xmp>

<hr>

<a name=/proc/sleep>
<h2>sleep proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/set/background>background setting (proc)</a>
<dd><a href=#/proc/set/waitfor>waitfor setting (proc)</a>
<dd><a href=#/proc/spawn>spawn proc</a>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sleep(Delay)
</dl>
<dl><dt><b>Args:</b>
<dd>Delay: The amount of time to sleep, in 1/10 seconds.
</dl>

<div class="sidebar underhood">
<p>When a proc sleeps, it actually makes a copy of itself. The copy is what
will wake up later, and the current proc simply ends. The same thing happens
to its callers.
</div>

<p>Pause the current proc (and its callers) for a specified amount of time.
If no delay is specified, it will be scheduled to resume as soon as other
immediately pending events are processed.

<p>Note that sleeping in some procedures results in the return value being
lost.  For example, if you sleep inside <code>Entered()</code> or
<code>Exited()</code>, it will be as if you returned immediately where you
started sleeping. This is because <tt>Move()</tt> calls them in away that says
the return value should be ignored. Also if a proc has its
<a class=code href=#/proc/set/waitfor>waitfor</a> setting changed to 0, it
will return the value of the <tt>.</tt> var to its caller immediately if it or
one of its callees sleeps.

<p>Also be aware that a sleeping procedure whose <var>src</var> object gets
deleted will automatically terminate when execution returns to it.  This is
to protect you against trying to access properties or procedures of a
deleted (and therefore <code>null</code>) object.  If you do not want the
procedure to be terminated, you should set <var>src</var> to
<code>null</code>.

<p>One common use of <code>sleep</code> is to create what is known as a
<i>ticker</i>.  That is an infinite loop that performs some periodic
operation.

<h3>Example:</h3>
<xmp>
proc/Weather()
   spawn while(1) //infinite ticker loop
      world << "The sun rises in the east."
      sleep(500)
      world << "The noon day sun rises high in the sky."
      sleep(500)
      world << "The sun sinks low in the west."
      sleep(1000)
</xmp>

<p>Notice how such infinite loops are usually created using
<code>spawn</code> to prevent the caller from getting locked up.  You could
call this procedure from <code>world.New()</code> to start it rolling.

<p>Note: sleep time is in 1/10s units, not server ticks.  If your
<code>world.tick_lag</code> or <code>world.fps</code> value is different from
the default, <tt>sleep(1)</tt> still means "sleep for 1/10s".  To sleep for
exactly <tt>N</tt> ticks, call <code>sleep(N * world.tick_lag)</code>.

<p>If the ticker does intensive processing during each iteration, you probably
want to run it in the background like this:

<xmp>
proc/Ticker()
   set background = 1
</xmp>

<p>Calling sleep() with a negative argument (such as sleep(-1)) causes it to
do a backlog check.  Only if other pending events have become backlogged will
it sleep.  This is similar to running in the background, but you manually
control where the backlog checks are made.  The difference between this and
sleep(0) is that sleep(0) <i>always</i> sleeps the current procedure for as
short a time as possible, whereas sleep(-1) only sleeps the current procedure
if other scheduled events have become backlogged.  Therefore, sleep(-1) will
tend to run the current procedure at a higher priority with fewer
interruptions.  It is appropriate when there is a single task that needs to be
done before anything else can happen, and you just want to make sure that
network and user I/O are not terribly lagged in the process.

<hr>

<a name=/proc/sorttext>
<h2>sorttext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/proc/sorttextEx>sorttextEx proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sorttext(T1,T2,...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of text strings to sort.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if text is ascending
<dd>-1 if text is descending
<dd>0 otherwise
</dl>

<p>This instruction is NOT sensitive to case.  The case sensitive version is
sorttextEx().

<h3>Example:</h3>
<xmp>
switch(sorttext("A","B"))
  if(1) world << "ascending"
  if(-1)world << "descending"
  if(0) world << "neither"
</xmp>

<p>This outputs "ascending", since "A" comes before "B" in the alphabet.

<hr>

<a name=/proc/sorttextEx>
<h2>sorttextEx proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e>&gt; operator</a>
<dd><a href=#/operator/%3c>&lt; operator</a>
<dd><a href=#/proc/sorttext>sorttext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sorttextEx(T1,T2,...)
</dl>

<dl><dt><b>Args:</b>
<dd>Any number of text strings to sort.
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if text is ascending
<dd>-1 if text is descending
<dd>0 otherwise.
</dl>

<p>This instruction is sensitive to case.  The case-insensitive version is
sorttext().

<p>Note: Uppercase letters are lower in the alphabetical order than
lowercase letters.

<h3>Example:</h3>
<xmp>
switch(sorttextEx("a","B"))
  if(1) world << "ascending"
  if(-1)world << "descending"
  if(0) world << "neither"
</xmp>

<p>This outputs, "descending", since "B" comes before "a" in the alphabet.

<p class=compatibility>Note: This proc used to be named <tt>sortText</tt>,
like <tt>sorttext</tt> but with a capital T. To avoid confusion it has been
renamed, but old code will still compile.

<hr>

<a name=/proc/sound>
<h2>sound proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound>sound datum</a>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/load_resource>load_resource proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>sound(file,repeat=0,wait,channel,volume)
<dd><small>(supports named arguments)</small>
</dl>

<dl><dt><b>Args:</b>
<dd>file: A sound file to play
<dd>repeat: 1 to play sound repeatedly
<dd>wait: 0 to interrupt current sound on channel; 1 to wait in queue
<dd>channel: 0 for any available channel, 1-1024 for specific channel (non-MIDI only)
<dd>volume: 100 for full volume (default), 0 for none, or any value in between
</dl>

<p>This is used to play a sound file.

<p>The sound file must be a music or sample file. Music files include MIDI
(.mid or .midi), and module formats .mod, .it, .s3m, .xm, and .oxm. A sample
file used for sound effects can be .wav, .ogg, .raw, .wma, or .aiff.*

<p>The following example plays some sound files.  Note that
<code>sound()</code> is not even necessary when you don't need to set any
additional parameters.

<h3>Example:</h3>
<xmp>
usr << 'giggle.wav' // play a giggle once
usr << sound('gigue.midi',1) // repeat gigue
usr << sound('boom.wav', volume=50) // play an explosion at half volume
</xmp>

<p><small>*See <b>Notes</b> under <a href=#/DM/sound>sound support</a> for
more information.</small>

<hr>

<a name=/proc/spantext>
<h2 byondver=510>spantext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/nonspantext>nonspantext proc</a>
<dd><a href=#/proc/splittext>splittext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>spantext(Haystack,Needles,Start=1)
</dl>

<dl><dt><b>Returns:</b>
<dd>The number of consecutive characters, from the start position, that match the characters in Needles.
</dl>

<dl><dt><b>Args:</b>
<dd>Haystack: The text string to search.
<dd>Needles: A text string with all the characters that match.
<dd>Start: The text byte position in Haystack in which to begin the search.
</dl>

<p>This proc is case-sensitive.  A common use for this proc is in parsing.
spantext("apples, oranges",", ",7) will tell you that, starting at position 7,
you need to skip 2 characters to get past any commas or spaces.

<p>If the start position is negative, the position is counted backwards from
the end of the string.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>spantext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/spawn>
<h2>spawn proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/set/background>background setting (proc)</a>
<dd><a href=#/proc/sleep>sleep proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>spawn(Delay=0) Statement
<dd>spawn(Delay=0)<br/>Statement
</dl>

<dl><dt><b>Args:</b>
<dd>Delay: The amount of time (in 1/10 seconds) before Statement is executed.
</dl>

<p>Run Statement after a delay.  Statement may be a single statement or a code
block enclosed in (optional) braces and indented.  If delay is negative, the
spawned code is executed before continuing in the main code.  If it is zero,
the spawned code is scheduled to happen right after other existing events that
are immediately pending.

<h3>Example:</h3>
<xmp>
spawn(30) storm()
usr << "Storm clouds are brewing!"
</xmp>

<p>This will display <code>"Storm clouds are brewing!"</code> and then call the
storm() proc after 3 seconds.

<div class="sidebar underhood">
<p>A spawned statement or block is a copy of the current proc. The current proc
keeps running and the copy waits its turn. The copy stops at the end of the
statement/block, and its return value is discarded.

<p>In the case of spawn(-1), the original proc keeps running the
statement/block and then stops, while the copy runs everything after that.
</div>

<p>The important feature of spawn() is that the caller does not have to wait
around for the spawned code to finish.

<p>Any vars you have defined in the proc itself, including arguments, will be
copied between the spawned code and the code that runs right away. This means
that if one part modifies one of those vars, the other part will not see that
change. Changes made to objects, lists, datums, etc. however will be visible
to both code blocks.

<p><a href=#/operator/&/pointer>Pointers</a> to any vars that belong to the
proc will stay with the original proc, not the copy.

<hr>

<a name=/proc/splicetext>
<h2 byondver=514>splicetext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/copytext>copytext proc</a>
<dd><a href=#/list/proc/Splice>Splice proc (list)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>splicetext(Text,Start=1,End=0,Insert="")
</dl>

<dl><dt><b>Returns:</b>
<dd>Spliced text
</dl>

<dl><dt><b>Args:</b>
<dd>Text: The text string to splice.
<dd>Start: The text byte position in Text where the splice will begin.
<dd>End: The text byte position in Text immediately following the last
     character to be cut from the splice. 0 is the end of the string.
<dd>Insert: Text to be inserted.
</dl>

<p>Cuts out a section of a text string and inserts a different piece of text
in its place. This is basically equivalent to <tt>copytext(Text,1,Start) +
Insert + copytext(Text,End)</tt>, but faster.

<h3>Example:</h3>
<xmp>
// cuts "nan" from "banana" and replaces it with "laclav"
// prints "balaclava"
usr << splicetext("banana", 3, 6, "laclav")
</xmp>

<p>The <tt>Start</tt> and <tt>End</tt> index values can be negative, which
count backwards from the end of the string. If the index values are out of
range, there will be no error; they will simply be clamped to the beginning
or end of the string. If <tt>End</tt> comes before <tt>Start</tt>, the two
values are swapped.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>splicetext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/splittext>
<h2 byondver=510>splittext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/jointext>jointext proc</a>
<dd><a href=#/proc/nonspantext>nonspantext proc</a>
<dd><a href=#/proc/spantext>spantext proc</a>
<dd><a href=#/{notes}/regex>Regular expressions</a>
</dl>

<dl><dt><b>Format:</b>
<dd>splittext(Text,Delimiter,Start=1,End=0,include_delimiters=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of text strings split by the delimiter given.
</dl>

<dl><dt><b>Args:</b>
<dd>Text: The text string to search.
<dd>Delimiter: A text string that will be used as the separator between items,
     OR a regular expression (regex) used to find splits
<dd>Start: The text byte position in Text in which to begin looking for splits.
<dd>End: The text byte position in Text immediately following the last
     character to look at for splits.
<dd>include_delimiters: True if any delimiters found should be included in
     the result.
</dl>

<p>Splits up a text string and returns a list.  The delimiter is
case-sensitive (unless you use a case-insensitive regular expression), and
can be more than one character long.

<h3>Example:</h3>
<xmp>
var/list/items = splittext("apples,oranges,bananas", ",")
// prints "apples", "oranges", and "bananas" separately
for(var/item in items)
    usr << item
</xmp>

<p>Where multiple delimiters are next to each other, they're considered to be
separating an empty string.  Therefore splittext("a,,b,c", ",") would return a
list with four elements instead of three.  Splitting empty text returns an
empty list.

<p>If a regular expression is used as the delimiter, any capturing groups in
the expression will be included in the list, in order. (The whole match itself
will come first, if include_delimiters is true.) So for instance splitting by
regex(",") will not include the comma, but splitting by regex("(,)") will.
Groups that were not part of the match will be null.

<p>If the start or end position is negative, the position is counted backwards
from the end of the string. Please note that the start and end positions do
NOT trim the string; if you want to split a trimmed string, trim it with
<a class=code href=#/proc/copytext>copytext()</a> and send the result to
<tt>splittext()</tt> instead.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>splittext_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/proc/sqrt>
<h2>sqrt proc</h2>

<dl><dt><b>Format:</b>
<dd>sqrt(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>The square root of A
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number.
</dl>

<h3>Example:</h3>
<xmp>
usr << sqrt(2) // outputs 1.41421
</xmp>

<hr>

<a name=/proc/startup>
<h2>startup proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/params>params var (world)</a>
<dd><a href=#/proc/shutdown>shutdown proc</a>
</dl>


<dl><dt><b>Format:</b>
<dd>startup(File,Port=0,Options,...)
</dl>

<dl><dt><b>Args:</b>
<dd>File: The dmb file to run in a new server or null to load the current world.
<dd>Port: The network port to start the new server on.  A value of 0
          indicates that any available port should be used.
<dd>Options: Any number of the options listed below.  Each option should be
             in an argument by itself.  If the option takes a parameter, this
             can be in the same argument or in the following one.
</dl>

<h3>The valid options are:</h3>
<dl>

<dt>-once
<dd> automatically shuts down the server when all players have logged off.

<dt>-close
<dd>Closes the child copy of DreamDaemon after the world it is running shuts
down.

<dt>-log &lt;logfile&gt;
<dd>sends all server output to the specified file.  The path to the file is
relative to the world directory (the path containing the world
<code>.dmb</code> file).

<dt>-logself
<dd>is identical to "-log [YourWorldFile].log".

<dt>-safe
<dd>runs the server in a special protective mode.  The server may only
access files in the same directory (or below) as the dmb file and access to
the shell() command is disabled.  This is the default mode if no security
setting is specified and the world is run from a directory by the same name
as the dmb file.

<dt>-home &lt;path&gt;
<dd>runs with the specified "safe home" directory.  Normally, in safe mode
the directory containing the world dmb file is the safe home.

<dt>-ultrasafe
<dd>like -safe, this prohibits all file access.  This is the default if no
security mode is specified and the world is not run from a directory with
the same name.

<dt>-trusted
<dd>allows full access to files on the computer and to the shell() command.
Note that this does not bypass the normal security of the operating system.
For example, in the UNIX operating system, all of the usual access
restrictions apply.  This mode merely removes BYOND's built-in safety checks.

<dt>-params &lt;paramtext&gt;
<dd>this is for passing user-defined parameters to the world.  Multiple
parameters may be packed into a single argument or -params may be used
several times.  In either case, the parameters are all loaded into
world.params when the world starts up.  The parameter format is
"name1=value1&name2=value2&...".

<dt>-quiet
<dd>disables the server's normal output indicating the BYOND version number
and network port.

<dt>-nologdates
<dd>disables automatic date/time output in the log.

<dt>-CGI
<dd>runs the world as a CGI program (to be executed by a web server).  A
/client object is automatically created for the user and any output sent to
the associated mob gets returned to the user's web browser.  This option is
normally specified in the compile-time setting:
<a href=#/world/var/executor>world.executor</a>, which is automatically
initialized for you if you include <code>html/CGI.dm</code> from the html
library.

<dt>-suid &lt;path&gt;
<dd>runs the world as the owner of the specified directory or path.  This only
works if DreamDaemon is running as root on operating systems where there even
is such a thing.

<dt>-suidself
<dd>runs the world as the owner of the world dmb file.  This only works if
DreamDaemon is running as root on operating systems where there even is such a
thing.

<dt>-cd &lt;path&gt;
<dd>runs with the specified working directory.  Normally, the directory
containing the world dmb file is used.

<dt>-port P
<dd>sets the network port to P.  The port may also be specified as a
positional argument (following the .dmb name).

<dt>-ports &lt;list&gt;
<dd>restricts the range of ports that DreamDaemon and any child worlds may
use.  The syntax of <i>list</i> is a comma separated list of ports or ranges
of ports.  Example: <code>-ports 1234,1236,1240-1250</code>.

<dt>-ip &lt;address&gt;
<dd>sets the IP address of the server. This will only work for an IP address
the system recognizes as one it can use for hosting. Accepts numerical
addresses only.

<dt>-webclient
<dd>Enables the webclient, overriding default behavior.

<dt>-nowebclient
<dd>Disables the webclient, overriding default behavior.

<dt>-verbose
<dd>Runtime errors will continue outputting details after a certain number of
errors has been reached. Without this option, the number of errors that
provide detailed info (such as call stack) is limited. Use this option with
caution as it could fill up a log file quickly if a problem occurs.

</dl>


<dl><dt><b>Returns:</b>
<dd>The address of the new server in the form ip:port.
</dl>

<hr>

<a name=/proc/stat>
<h2>stat proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Stat>Stat proc (atom)</a>
<dd><a href=#/client/proc/Stat>Stat proc (client)</a>
<dd><a href=#/proc/statpanel>statpanel proc</a>
<dd><a href=#/{skin}/control/info>Info control (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>stat(Name,Value)
</dl>

<dl><dt><b>Args:</b>
<dd>Name: the name of the stat line
<dd>Value: the data to be displayed
</dl>

<p>This is used in a Stat() proc to send a stat line to usr, the person
looking at an object.  A stat line has an optional name part which must be
unique for each stat line (or successive calls will replace previous ones).

<p>The stat line gets appended to the current stat panel.  The current panel
may be changed by using statpanel().

<p>If no name is specified and the value is a list, this is the same as
calling stat on each item in the list.  This can be used (in conjunction
with statpanel) to create an inventory panel or something similar.

<h3>Example:</h3>
<xmp>
mob/Stat()
   stat("description",src.desc)
   if(src == usr) stat(src.contents)
</xmp>

<p>This example displays the mob's description and inventory all in one panel.
The code ensures that only the mob may see his own inventory, but you don't
have to worry about that unless you change client.statobj to something other
than one's own mob.

<hr>

<a name=/proc/statpanel>
<h2>statpanel proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/proc/Stat>Stat proc (atom)</a>
<dd><a href=#/client/proc/Stat>Stat proc (client)</a>
<dd><a href=#/proc/stat>stat proc</a>
<dd><a href=#/{skin}/control/info>Info control (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>statpanel(Panel,Name,Value)
</dl>

<dl><dt><b>Args:</b>
<dd>Panel: the name of the stat panel
<dd>Name: the name of the stat line
<dd>Value: the data to be displayed
</dl>

<dl><dt><b>Returns:</b>
<dd>If called with just a Panel argument, 1 is returned if the player is
    looking at the panel and 0 is returned if not.  This may be useful to
    avoid the needless overhead of generating output to a panel that is not
    visible.
</dl>

<p>This is used in a Stat() proc to change the default panel (for subsequent
stat lines) or to send one line to the specified panel.  Name and Value are
both optional.  If neither is specified, this simply changes the default
panel.  Otherwise, the default panel is unchanged and a stat line is
appended to Panel.

<h3>Example:</h3>
<xmp>
mob/Stat()
   stat("description",src.desc)
   if(src == usr) statpanel("inventory",src.contents)
</xmp>

<p>This example displays the mob's description in one panel and inventory in
another.  Only the mob may see his own inventory, but you don't have to worry
about that unless you change client.statobj to something other than one's own
mob.

<hr>

<a name=/proc/step>
<h2>step proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step>get_step proc</a>
<dd><a href=#/proc/walk>walk proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
<dd><a href=#/vector>vector</a>
</dl>

<dl><dt><b>Format:</b>
<dd>step(Ref,Dir,Speed=0)
<dd>step(Ref,Vector)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Dir: One of NORTH, SOUTH, EAST, WEST, NORTHEAST, NORTHWEST, SOUTHEAST,
     SOUTHWEST.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
<dd byondver=516>Vector: A 2D vector to move by, in pixels.
</dl>

<p>Move Ref in the direction Dir.

<p>The vector version of this proc takes a 2D vector and tries to move by that
amount of pixels.

<hr>

<a name=/proc/step_away>
<h2>step_away proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_away>get_step_away proc</a>
<dd><a href=#/proc/walk_away>walk_away proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>
<dl><dt><b>Format:</b>
<dd>step_away(Ref,Trg,Max=5,Speed=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Trg: An object on the map.
<dd>Max: The maximum distance between Ref and Targ before movement halts.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Move Ref on a path away from location Trg, taking obstacles into
account.  If Ref is farther than Max steps from Trg, no action will be taken.

<hr>

<a name=/proc/step_rand>
<h2>step_rand proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_rand>get_step_rand proc</a>
<dd><a href=#/proc/walk_rand>walk_rand proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>step_rand(Ref,Speed=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Move Ref randomly.

<hr>

<a name=/proc/step_to>
<h2>step_to proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_to>get_step_to proc</a>
<dd><a href=#/proc/get_steps_to>get_steps_to proc</a>
<dd><a href=#/proc/walk_to>walk_to proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>step_to(Ref,Trg,Min=0,Speed=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Trg: An object on the map.
<dd>Min: The minimum distance between Ref and Trg before movement halts.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Move Ref on a path to the location Trg, taking obstacles into account.  If
Ref is within Min steps of Trg, no action will be taken.  This is also the
case if the target is too far away (more than twice world.view steps).

<hr>

<a name=/proc/step_towards>
<h2>step_towards proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_towards>get_step_towards proc</a>
<dd><a href=#/proc/walk_towards>walk_towards proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>step_towards(Ref,Trg,Speed)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Trg: An object on the map.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Move Ref in the direction of the location Trg.

<hr>

<a name=/proc/switch>
<h2>switch proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/if>if proc</a>
<dd><a href=#/DM/preprocessor/pragma/syntax>#pragma syntax directive</a>
</dl>

<dl><dt><b>Format:</b>
  <dl><dt>switch(E)
      <dd>if(A1,A2,...) Statement1
      <dd>if(B1,B2,...) Statement1
      <dd>else Statement3
  </dl>
</dl>

<p>The "switch" instruction is a compact notation for a lengthy "else-if"
chain.  The expression E is compared to the values A1, A2, B1, B2, etc.
When a match is found, the following statement (or code block) is executed.
An optional "else" statement is run if no match is found.  Once a matching
switch condition is found, no further conditions will be tested.

<p>The values A1, A2, etc. must be constants.  As a convenience, a range of
values may be specified in the form: A1 to An.

<p>The switch instruction is MUCH more efficient than a lengthy "else-if"
chain, because the expression E is evaluated only once.  The conditional
values may be any constant expression, such as a number or text string.

<h3>Example:</h3>
<xmp>
switch (2)
  if(1)       world << "ONE"
  if(4)       world << "FOUR"
  if(2,3)     world << "TWO or THREE"
  if(5 to 10) world << "FIVE to TEN"
  else        world << "not ONE to TEN"
</xmp>

<p>This outputs:

<xmp>
TWO or THREE
</xmp>

<p>Note: Currently the compiler does not throw a warning or error if there is
a conflict between two different <tt>if</tt> blocks in a <tt>switch</tt>, e.g.
when you define <tt>if(1 to 10)</tt> and <tt>if(5 to 20)</tt> which overlap
from 5 to 10. If two different blocks could handle a given value, the choice
of which block takes over is not defined.</p>

<h3>C-like syntax</h3>

<p>Using the <a href=#/DM/preprocessor/pragma/syntax><tt>#pragma syntax</tt>
directive</a> you can change <tt>switch()</tt> to be more like other languages
such as C. This replaces the if/else instructions with <tt>case <i>value</i></tt>
and <tt>default</tt> with a trailing colon. If you don't use the
<a href=#/proc/break><tt>break</tt> statement</a> at the end of a block, it will
fall through to the next block.

<h3>Example:</h3>
<xmp>
// make this syntax change temporary
#pragma push
#pragma syntax C switch

mob/proc/Greeting(friend)
    switch(roll(6))
        case 4:
            friend << "I'm [name]. \..."
            // fall through to cases 1 and 2
        case 1,2:
            friend << "Hi!"
            break
        case 3:
            friend << "Hello there!"
        default:
            friend << "Yo."
            break

#pragma pop
</xmp>

<p>Multiple cases can be put together with either commas between the values,
or separate <tt>case</tt> statements. The <tt><i>A</i> to <i>B</i></tt> syntax
is still allowed also.

<hr>

<a name=/proc/tan>
<h2 byondver=513>tan proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/arctan>arctan proc</a>
<dd><a href=#/proc/cos>cos proc</a>
<dd><a href=#/proc/sin>sin proc</a>
<dd><a href=#/proc/turn>turn proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>tan(X)
</dl>

<dl><dt><b>Returns:</b>
<dd>The tangent of X, where X is in degrees.
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/test()
   usr << tan(0)  // 0
   usr << tan(45) // 1
   usr << tan(90) // infinity (or close enough)
</xmp>

<hr>

<a name=/proc/text>
<h2>text proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c>&lt;&lt; operator</a>
<dd><a href=#/DM/text/macros>macros (text)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>text(FormatText,Args)
</dl>

<dl><dt><b>Returns:</b>
<dd>The text with macros arguments substituted.
</dl>

<dl><dt><b>Args:</b>
<dd>FormatText: a text string possibly containing text macros.
<dd>Args: a set of arguments that corresponds to the number of empty
     embedded expressions in FormatText.
</dl>

<p>Complicated or lengthy embedded expressions in a text string can
sometimes make the string difficult to read.  In this case, one can use
trailing arguments.  The position in which the expression should be
substituted should be marked with [] and the expression should then be
passed as an argument after the text string.

<h3>Example:</h3>
<xmp>
usr << text("You are [] leagues from home.",sqrt(usr.x**2 + usr.y**2))
</xmp>

<hr>

<a name=/proc/text2ascii>
<h2>text2ascii proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ascii2text>ascii2text proc</a>
<dd><a href=#/DM/text/entities>entities (text)</a>
<dd><a href=#/{notes}/Unicode>Unicode</a>
</dl>

<dl><dt><b>Format:</b>
<dd>text2ascii(T,pos=1)
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
<dd>pos: The byte position in T to use, starting at 1.
</dl>

<dl><dt><b>Returns:</b>
<dd>A number representing the character's ASCII or Unicode code.
</dl>

<p>ASCII codes are numerical values corresponding to keyboard and special
characters. Among other things, they are used to represent many symbols in
HTML. This proc converts a text string to its corresponding ascii
representation.

<h3>Example:</h3>
<xmp>
world << text2ascii("A")  // = 65
world << text2ascii("HAPPY",2)  // = 65
</xmp>

<p>With <a href=#/{notes}/Unicode>Unicode</a>, things may get more
complicated. DM stores text with UTF-8 encoding, so at this position there
might be several bytes strung together to make a single character. The value
of <tt>pos</tt> is in bytes, not characters. When the return value is 128
(0x80) or higher, multiple bytes are used for the charcter. In that case the
next character position is not <tt>pos + 1</tt> like it is for regular text,
but you can use <tt>pos + length(ascii2text(result))</tt> instead. Or, you
can determine the byte count from this table:

<table class=withborder>
<tr><th>Character code</th><th>Size in bytes</th></tr>
<tr><td>0 - 0x7F</td><td>1</td></tr>
<tr><td>0x80 - 0x7FF</td><td>2</td></tr>
<tr><td>0x800 - 0xFFFF</td><td>3</td></tr>
<tr><td>0x10000 - 0x10FFFF</td><td>4</td></tr>
</table>

<p>Alternatively, you can use <tt>test2ascii_char()</tt> to work with
character positions instead of bytes, at a performance cost.

<hr>

<a name=/proc/text2file>
<h2>text2file proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/file2text>file2text proc</a>
<dd><a href=#/proc/shell>shell proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>text2file(Text,File)
</dl>

<dl><dt><b>Args:</b>
<dd>Text: text to be added to file
<dd>File: file to be appended to
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 otherwise.
</dl>

<p>Appends text to a file.  If the file does not exist, one will be created.

<p>This can be useful when interacting with external applications that read
output from a text file.  For example, you might have an external program
that mimics conversation:

<h3>Example:</h3>
<xmp>
mob/oracle/verb/tell(T as text)
  text2file(T,"oracle.in")
  shell("oracle < oracle.in > oracle.out")
  usr << file2text("oracle.out")
</xmp>

<hr>

<a name=/proc/text2num>
<h2>text2num proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/istext>istext proc</a>
<dd><a href=#/proc/num2text>num2text proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>text2num(T)
<dd byondver=513>text2num(T, radix)
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
<dd>radix: The radix/base of the number, e.g. 16 for hexadecimal
</dl>

<dl><dt><b>Returns:</b>
<dd>A number.
</dl>

<p>If T is a text string for a number, return the number.  Any non-numeric
text following the initial portion will be ignored.  If there is no initial
numeric portion, the result is null.

<h3>Example:</h3>
<xmp>
var/number = text2num("123")  // = 123
</xmp>

<p>The optional radix, which defaults to 10, can be any integer from 2 to 36.

<hr>

<a name=/proc/text2path>
<h2>text2path proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/ispath>ispath proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>text2path(T)
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
</dl>

<dl><dt><b>Returns:</b>
<dd>a type path or null.
</dl>

<h3>Example:</h3>
<xmp>
var/myturf = text2path("/turf/[src.color]")
if(myturf)
  src.loc = locate(myturf)
</xmp>

<p>T is changed from a text string to the equivalent type path, or null if
  there is no such type.

<hr>

<a name=/proc/throw>
<h2>throw statement</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/try>try statement</a>
<dd><a href=#/world/proc/Error>Error proc (world)</a>
<dd><a href=#/proc/EXCEPTION>EXCEPTION proc</a>
<dd><a href=#/exception>exception</a>
</dl>

<dl><dt><b>Format:</b>
<dd>throw Value
</dl>

<dl><dt><b>Args:</b>
<dd>Value: Any value, which will be sent to catch() if present.
</dl>

<p>This keyword throws an exception, which will stop executing the current
proc and go to the most recent catch block if one is present. The catch block
will receive the thrown value. If there is no try/catch in use, the exception
will be passed to <tt>world.Error()</tt> (if present), then the current proc
will end and control will return to the caller.

<h3>Example:</h3>
<xmp>
try
  if(!src.ready) throw EXCEPTION("Not ready")
  DoSomething()
catch(var/e)
  world.log << "Exception: [e]"
</xmp>

<p>You can use the <tt>EXCEPTION</tt> macro to create a new <tt>/exception</tt>
datum, which contains a value or message as well as the file and line number
where the exception was created. The thrown value does not have to be an
<tt>/exception</tt> datum; you can throw anything, even null.

<hr>

<a name=/proc/time2text>
<h2>time2text proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/realtime>realtime var (world)</a>
<dd><a href=#/world/var/timeofday>timeofday var (world)</a>
<dd><a href=#/world/var/timezone>timezone var (world)</a>
<dd><a href=#/client/var/timezone>timezone var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>time2text(timestamp,format,timezone)
</dl>

<dl><dt><b>Args:</b>
<dd>timestamp: a time value as obtained from world.realtime or world.timeofday
<dd>format: a text string describing the output format.
<dd byondver=514>timezone: optional offset, in hours, from UTC
</dl>

<dl><dt><b>Returns:</b>
<dd>a text string containing the date and time in the specified format.
</dl>

<p>A time value (UTC) is converted to text representing the time. The world's
local time is used, unless you specify a <tt>timezone</tt> argument which will
add an offset to UTC.

<p>The default format is "DDD MMM DD hh:mm:ss YYYY", which produces results
such as "Wed, May 23 15:41:13 2001".  As you can see, the fields in the format
text are replaced by components of the date and time.  The following list
contains all of the recognized fields.  Anything else in the format string is
inserted directly into the output.

<dl compact>
<dt>YYYY <dd>year (2001, 2002, ...)
<dt>YY <dd>year (01, 02, ...)
<dt>Month <dd>January, February, ...
<dt>MMM <dd>Jan, Feb, ...
<dt>MM  <dd>number of the month (01, 02, ...)
<dt>Day <dd>Monday, Tuesday, ...
<dt>DDD <dd>Mon, Tue, ...
<dt>DD  <dd>day of the month
<dt>hh <dd>hour (00, 01, ... 23)
<dt>mm <dd>minute
<dt>ss <dd>second
</dl>

<p>Because world.timeofday is in a range of 0 to 864000, values in this range
are treated as a time for the current date. This way time2text() can return
accurate results for world.timeofday. Any other values are interpreted as
coming from world.realtime and will have the right time and date.

<hr>

<a name=/proc/trimtext>
<h2 byondver=515>trimtext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/copytext>copytext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>trimtext(Text)
</dl>

<dl><dt><b>Returns:</b>
<dd>Text with whitespace trimmed from both ends
</dl>

<dl><dt><b>Args:</b>
<dd>Text: The text string to trim.
</dl>

<p>Trims whitespace from both ends of a text string.

<p>All <a href=#/{notes}/Unicode>Unicode</a> whitespace characters are counted, whether they can cause a break or not.

<hr>

<a name=/proc/trunc>
<h2 byondver=515>trunc proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/fract>fract proc</a>
<dd><a href=#/proc/floor>floor proc</a>
<dd><a href=#/proc/ceil>ceil proc</a>
<dd><a href=#/proc/round>round proc</a>
<dd><a href=#/proc/sign>sign proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>trunc(A)
</dl>

<dl><dt><b>Returns:</b>
<dd>truncated A
</dl>

<dl><dt><b>Args:</b>
<dd>A: A number, pixloc, or vector.
</dl>

<p>Returns the integer part of the number A. That is, this rounds toward 0 to an integer.

<h3>Example:</h3>
<xmp>
usr << trunc(1.45) // outputs 1

usr << trunc(-1.45) // outputs -1
</xmp>

<hr>

<a name=/proc/try>
<h2 byondver=508>try and catch statements</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/Error>Error proc (world)</a>
<dd><a href=#/proc/throw>throw statement</a>
<dd><a href=#/proc/EXCEPTION>EXCEPTION proc</a>
<dd><a href=#/exception>exception</a>
</dl>

<p>The try and catch keywords are used for error handling. Any code that runs
inside of a try block will, if an error happens or the throw keyword is used,
stop executing and jump to the matching catch block. (This is also true of
indirect proc calls. If you call a proc from inside a try block, any errors
in that proc will be sent to the catch.)

<p>For every try there must be a catch, even if it does nothing. The catch
block takes an optional value that can receive the error.

<h3>Example:</h3>
<xmp>
var/a = 2
try
  a += "Hello"  // will throw a type mismatch error
catch(var/exception/e)
  // file and line info is available if you enable debugging
  world.log << "[e] on [e.file]:[e.line]"
world << "a is [a]"
</xmp>

<p>Because the value in the catch keyword is optional, you can simply use the
catch keyword alone. It is also not necessary to include any code under the
catch keyword, if the error is meant to be ignored. (However, it is not
usually a good idea to ignore errors.)

<p>The throw keyword is used if you want to throw an error deliberately. When
you use throw, the error thrown does not have to be an /exception datum, but
can be anything you like.

<hr>

<a name=/proc/turn>
<h2>turn proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon/proc/Turn>Turn proc (icon)</a>
<dd><a href=#/atom/var/dir>dir var (atom)</a>
<dd><a href=#/vector/proc/Turn>Turn proc (vector)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>turn(Dir, Angle)

</dl>

<dl><dt><b>Args:</b>
<dd>Dir: One of NORTH, SOUTH, EAST, WEST, NORTHEAST, NORTHWEST, SOUTHEAST, SOUTHWEST.
<dd>Angle:  An angle in degrees (counterclockwise rotation).
</dl>

<dl><dt><b>Returns:</b>
<dd>The rotated direction.
</dl>

<p>This proc can also be applied to an <a href=#/proc/turn/icon>icon</a>, a
<a href=#/proc/turn/matrix>matrix</a>, or a
<a href=#/proc/turn/vector>vector</a>.

<h3>Example:</h3>
<xmp>
var/dir
dir = turn(NORTH, 90)  // dir = west
dir = turn(dir, -90)   // dir = north
dir = turn(dir, 45)    // dir = northwest
</xmp>

<p>Only multiples of 45 are allowed for angles. If an invalid angle is used,
it will be treated as the closest multiple of 45 to 0.

<p>If the supplied Dir is invalid, such as 0, or something like UP or DOWN,
the result is a random direction unless the angle is also 0.

<hr>

<a name=/proc/turn/icon>
<h2>turn proc (applied to an icon)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/turn>turn proc</a>
<dd><a href=#/icon>icon</a>
</dl>

<dl><dt><b>Format:</b>
<dd>turn(Icon, Angle)
</dl>

<dl><dt><b>Returns:</b>
<dd>The rotated icon.
</dl>

<dl><dt><b>Args:</b>
<dd>Icon: an icon to rotate
<dd>Angle: An angle in degrees (clockwise rotation).
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/drink()
   //this effect is very confusing!
   usr.icon = turn(usr.icon,90)
   usr << "Woah!  That stuff is powerful!"
   sleep(200)
   usr.icon = turn(usr.icon,-90)
</xmp>

<p>An icon that is not square will not be turned.

<p>If the icon is an /icon datum, a new datum will be created as the result.

<hr>

<a name=/proc/turn/matrix>
<h2>turn proc (applied to a matrix)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/turn>turn proc</a>
<dd><a href=#/matrix>matrix</a>
</dl>

<dl><dt><b>Format:</b>
<dd>turn(Matrix, Angle)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new matrix which has been rotated.
</dl>

<dl><dt><b>Args:</b>
<dd>Matrix: a matrix to rotate
<dd>Angle: An angle in degrees (clockwise rotation).
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/drink()
   //this effect is very confusing!
   usr.transform = turn(usr.transform, 90)
   usr << "Woah!  That stuff is powerful!"
   sleep(200)
   usr.transform = null
</xmp>

<hr>

<a name=/proc/turn/vector>
<h2 byondver=516>turn proc (applied to a vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/proc/Turn>Turn proc (vector)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>turn(vector/A, angle)
<dd>turn(vector/A, vector/B)
</dl>

<dl><dt><b>Returns:</b></dt>
<dd>A new rotated vector.
</dl>

<dl><dt><b>Args:</b>
<dd>A: The vector to rotate.
<dd>angle: An angle to turn a vector counter-clockwise in 2D.
<dd>B: A vector to rotate around (left-hand rule).
</dl>

<p>All angles are in degrees.

<p>When the argument is an angle, the result is a copy of vector A, rotated in
2 dimensions counter-clockwise.

<p>When the argument is a vector, the result is rotated in 3 dimensions around
vector B using the left-hand rule (thumb pointed in the direction of B,
rotation following curled fingers). The angle of rotation is the length of B,
in degrees.

<hr>

<a name=/proc/typesof>
<h2>typesof proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/istype>istype proc</a>
<dd><a href=#/proc/locate>locate proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>typesof(Type1,Type2,...)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of all types that are derived from the specified "base" types,
including the base types themselves.
</dl>

<dl><dt><b>Args:</b>
<dd>The "base" types.
</dl>

<h3>Example:</h3>
<xmp>
obj/fruit
  apple
  peach
  mango
var/list/fruit_types = typesof(/obj/fruit)
</xmp>

<p>In this example, fruit_types is initialized to contain /obj/fruit,
/obj/fruit/apple, /obj/fruit/peach, and /obj/fruit/mango.

<p>This procedure can also be used to list procs and verbs.

<h3>Example:</h3>
<xmp>
mob/admin_commands/verb
   shutdown_world()
      world.Del()
   reboot_world()
      world.Reboot()

//for testing
mob/verb/add_admin()
   verbs += typesof(/mob/admin_commands/verb)
mob/verb/remove_admin()
   verbs -= typesof(/mob/admin_commands/verb)
</xmp>

<hr>

<a name=/proc/uppertext>
<h2>uppertext proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/lowertext>lowertext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>uppertext(T)
</dl>

<dl><dt><b>Returns:</b>
<dd>A capitalized text string.
</dl>

<dl><dt><b>Args:</b>
<dd>T: A text string.
</dl>

<p>Capitalize all of the characters of T.

<h3>Example:</h3>
<xmp>
U = uppertext("hi there") // = "HI THERE"
</xmp>

<hr>

<a name=/proc/url_decode>
<h2>url_decode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/proc/url_encode>url_encode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>url_decode(UrlText)
</dl>

<dl><dt><b>Args:</b>
<dd>UrlText: text to be "unescaped"
</dl>

<dl><dt><b>Returns:</b>
<dd>unescaped text
</dl>

<p>Most non-alphanumeric characters are converted to another format in a URL.
To send these characters literally, they must be "escaped".

<p>The <code>url_decode()</code> instruction takes a text string containing
such escaped symbols and turns them into their literal counterparts.  Usually
this is done for you automatically in <code>Topic()</code>. The more useful
function is <code>url_encode()</code> which does the reverse.

<hr>

<a name=/proc/url_encode>
<h2>url_encode proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/url_decode>url_decode proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>url_encode(PlainText, format=0)
</dl>

<dl><dt><b>Args:</b>
<dd>PlainText: text to be URL "escaped"
<dd>format: 0 to treat PlainText as a query string, 1 to treat it as a full URL
</dl>

<dl><dt><b>Returns:</b>
<dd>escaped text
</dl>

<p>Special characters such as spaces are not used literally in URLs.
If you want to ensure that an entire text string is sent literally, you can
"escape" those characters.  For example, a double quote (ASCII 34) is produced
by the code <code>%22</code>, where 22 is hexadecimal for 34.

<p>The <code>url_encode()</code> instruction does this for you
automatically. Using <code>format=1</code> will treat the URL as already
encoded and only re-encode characters that don't belong in the result.
Otherwise PlainText is treated as part of a query string; in this case spaces
are converted to <code>+</code> instead of <code>%20</code>, and most
characters are escaped.

<h3>Example:</h3>
<xmp>
mob/verb/Private(M as mob in players, T as text)
   if(!client || !M || !M.client || !T) return
   usr << "\[To <a href='?msg=[url_encode(M.key)]'>[M.name]</a>\] [T]"
   M << "\[From <a href='?msg=[url_encode(key)]'>[name]</a>\] [T]"
</xmp>

<hr>

<a name=/proc/values_cut_over>
<h2 byondver=516>values_cut_over proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/values_cut_under>values_cut_under proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>values_cut_over(Alist, Max, inclusive=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>Number of items removed
</dl>

<dl><dt><b>Args:</b>
<dd>Alist: An <a href=#/list/associations>associative list</a> or <a href=#/proc/alist>alist</a>
<dd>Max: The maximum number allowed
<dd>inclusive: Also cut items whose value equals Max
</dl>

<p>Removes all items from the list whose associated values are greater than
Max, not numbers, or <a href=#/proc/isnan>NaN</a>.

<p>If the optional <tt>inclusive</tt> argument is true, items with associated
values equal to Max are removed also.

<h3>Example:</h3>
<xmp>
var/list/stuff = list("a"=1, "b"=2, "c"=-4)
values_cut_over(stuff, 0)
for(var/k,v in stuff)
    usr << "[k] = [v]"
// prints:
// c = -4
</xmp>

<p>This is a convenience proc for games trying to eke out high performance.

<p>If Alist is not an associative list, nothing happens.

<hr>

<a name=/proc/values_cut_under>
<h2 byondver=516>values_cut_under proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/values_cut_over>values_cut_over proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>values_cut_under(Alist, Min, inclusive=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>Number of items removed
</dl>

<dl><dt><b>Args:</b>
<dd>Alist: An <a href=#/list/associations>associative list</a> or <a href=#/proc/alist>alist</a>
<dd>Min: The maximum number allowed
<dd>inclusive: Also cut items whose value equals Min
</dl>

<p>Removes all items from the list whose associated values are less than Min,
not numbers, or <a href=#/proc/isnan>NaN</a>.

<p>If the optional <tt>inclusive</tt> argument is true, items with associated
values equal to Min are removed also.

<h3>Example:</h3>
<xmp>
var/list/stuff = list("a"=1, "b"=2, "c"=-4)
values_cut_under(stuff, 0)
for(var/k,v in stuff)
    usr << "[k] = [v]"
// prints:
// a = 1
// b = 2
</xmp>

<p>This is a convenience proc for games trying to eke out high performance.

<p>If Alist is not an associative list, nothing happens.

<hr>

<a name=/proc/values_dot>
<h2 byondver=516>values_dot proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/values_sum>values_sum proc</a>
<dd><a href=#/proc/values_product>values_product proc</a>
<dd><a href=#/proc/values_cut_over>values_cut_over proc</a>
<dd><a href=#/proc/values_cut_under>values_cut_under proc</a>
<dd><a href=#/proc/alist>alist proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>values_dot(A, B)
</dl>

<dl><dt><b>Returns:</b>
<dd>The dot product of all associated numbers in A and B
</dl>

<dl><dt><b>Args:</b>
<dd>A, B: An <a href=#/list/associations>associative list</a> or <a href=#/proc/alist>alist</a>
</dl>

<p>Returns the dot product of two associative lists. If the same item exists
in both lists, the associated values are multiplied together as numbers. All
of those multiplications are added together to form the dot product. This is
similar to <a href=#/vector/proc/Dot>vector dot products</a>.

<h3>Example:</h3>
<xmp>
var/list/first = list("a"=1, "b"=2, "c"=3)
var/list/second = list("b"=4, "c"=5, "d"=6)
// first["a"] * second["a"] = 1 * 0 = 0
// first["b"] * second["b"] = 2 * 4 = 8
// first["c"] * second["c"] = 3 * 5 = 15
// first["d"] * second["d"] = 0 * 6 = 0
// total is 23
usr << values_dot(first, second)  // outputs 23
</xmp>

<p>This is a convenience proc for games trying to eke out high performance.

<hr>

<a name=/proc/values_product>
<h2 byondver=516>values_product proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/values_sum>values_sum proc</a>
<dd><a href=#/proc/values_dot>values_dot proc</a>
<dd><a href=#/proc/values_cut_over>values_cut_over proc</a>
<dd><a href=#/proc/values_cut_under>values_cut_under proc</a>
<dd><a href=#/proc/alist>alist proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>values_product(Alist)
</dl>

<dl><dt><b>Returns:</b>
<dd>The product of all associated numbers in Alist, or 1 if no numbers were found
</dl>

<dl><dt><b>Args:</b>
<dd>Alist: An <a href=#/list/associations>associative list</a> or <a href=#/proc/alist>alist</a>
</dl>

<p>Returns the product of all associated values in this list that are numbers.
Other values, including <a href=#/vector>vectors</a>, are not multiplied.

<h3>Example:</h3>
<xmp>
var/list/stuff = list("foo" = 3, "bar" = -4, "banana" = 5)
usr << values_product(stuff)  // outputs -60
</xmp>

<p>This is a convenience proc for games trying to eke out high performance.

<p>If Alist is not an associative list or no numbers were found among the
associated values, the result is 1.

<hr>

<a name=/proc/values_sum>
<h2 byondver=516>values_sum proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/values_product>values_product proc</a>
<dd><a href=#/proc/values_dot>values_dot proc</a>
<dd><a href=#/proc/values_cut_over>values_cut_over proc</a>
<dd><a href=#/proc/values_cut_under>values_cut_under proc</a>
<dd><a href=#/proc/alist>alist proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>values_sum(Alist)
</dl>

<dl><dt><b>Returns:</b>
<dd>The sum of all associated numbers in Alist
</dl>

<dl><dt><b>Args:</b>
<dd>Alist: An <a href=#/list/associations>associative list</a> or <a href=#/proc/alist>alist</a>
</dl>

<p>Returns the sum of all associated values in this list that are numbers.
Other values, including <a href=#/vector>vectors</a>, are not summed.

<h3>Example:</h3>
<xmp>
var/list/weights = list(/obj/crate = 12, /obj/vase = 1)
usr << values_sum(weights)  // outputs 13
</xmp>

<p>This is a convenience proc for games trying to eke out high performance.

<p>If Alist is not an associative list, the result is 0.

<hr>

<a name=/proc/var>
<h2>vars (procs)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc>procs</a>
</dl>

<p>Built-in proc vars:

<dl><dt>proc/var
<dd><a href=#/proc/var/%2e>.</a>
<dd><a href=#/proc/var/args>args</a>
<dd><a href=#/proc/var/callee>callee</a>
<dd><a href=#/proc/var/caller>caller</a>
<dd><a href=#/proc/var/src>src</a>
<dd><a href=#/proc/var/usr>usr</a>
</dl>

<hr>

<a name=/proc/var/%2e toc=".">
<h2>. var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/return>return statement</a>
<dd><a href=#/proc/var>vars (procs)</a>
</dl>

<p>This is the default return value.  If a proc exits without calling return
or if no arguments are specified the value of <tt>.</tt> will be returned.
The default value of <tt>.</tt> is null.

<h3>Example:</h3>
<xmp>
mob/Login()
  . = ..()
  view() << "[src] logs in."
</xmp>

<hr>

<a name=/proc/var/args>
<h2>args list var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
</dl>

<p>This is a list of the arguments passed to the proc or verb.

<h3>Example:</h3>
<xmp>
proc/add()
  var {cur; tot}
  for(cur in args)
    tot += cur
  return tot
</xmp>

<p>Here, <tt>add()</tt> may be called with any number of arguments, each
accessed through the <tt>args</tt> list.

<hr>

<a name=/proc/var/callee>
<h2 byondver=516>callee var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/callee>callee</a>
<dd><a href=#/proc/var/caller>caller var (proc)</a>
</dl>

<p>Returns a <a href=#/callee>callee object</a> representing the current
running proc. This is seldom as useful as the <tt>caller</tt> var, but is
available if it's needed.

<hr>

<a name=/proc/var/caller>
<h2 byondver=516>caller var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/callee>callee</a>
<dd><a href=#/proc/var/callee>callee var (proc)</a>
</dl>

<p>Returns a <a href=#/callee>callee object</a> representing the current
proc's caller, which can be used to access information like the proc name,
line number (if compiled with debug information), arguments, and more.

<p>The main purpose of this is to make it possible to trace the call stack
when handling errors.

<h3>Example:</h3>
<xmp>
world/Error(err)
    world.log << "Error [err]:"
    for(var/callee/p = caller, p, p = p.caller)
        world.log << "  [p.type] (src=[p.src], usr=[p.usr])"
        if(p.file) world.log << "    at [p.file]:[p.line]"
</xmp>

<hr>

<a name=/proc/var/global>
<h2>global var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var/src>src var (proc)</a>
</dl>

<p>This is not really a variable but is used to force treatment of the
following variable or proc as global.  This may be necessary if a local or
src-level variable has the same name.

<h3>Example:</h3>
<xmp>
var/myvar = "global"
mob
  verb/test()
    var/myvar = "local"
    usr << myvar
    usr << global.myvar
</xmp>

<p>This example outputs "local" and then "global".

<hr>

<a name=/proc/var/src>
<h2>src var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var/src>usr var (proc)</a>
<dd><a href=#/proc>procs</a>
<dd><a href=#/verb>verbs</a>
</dl>

<p>This is a variable equal to the object containing the proc or verb.  It
is defined to have the same type as that object.

<h3>Example:</h3>
<xmp>
obj/bread
  verb/eat()
    world << "[usr] eats [src]"
</xmp>

<p>If a player named "Bob" calls "eat bread", the output will be "Bob eats
the bread."

<p>Note that <tt>src</tt> has no meaning for global procs, derived from
<tt>/proc</tt>, unless they are invoked as verbs (by being attached to a
<a href=#/atom/var/verbs>verb list</a>).

<hr>

<a name=/proc/var/usr>
<h2>usr var (proc)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/var/src>src var (proc)</a>
<dd><a href=#/verb>verbs</a>
<dd><a href=#/client/proc/Topic>Topic proc (client)</a>
<dd><a href=#/proc/range>range proc</a>
<dd><a href=#/proc/view>view proc</a>
<dd><a href=#/proc/alert>alert proc</a>
<dd><a href=#/proc/input>input proc</a>
</dl>

<p>This is a mob variable (var/mob/usr) containing the mob of the player who
executed the current verb, or whose action ultimately called the current
proc.

<h3>Example:</h3>
<xmp>
obj/bread
  verb/eat()
    world << "[usr] eats [src]"
</xmp>

<p>If a player named "Bob" calls "eat bread", the output will be "Bob eats
the bread."

<p>Essentially, <tt>usr</tt> is an implicit parameter that is passed to every
proc or verb.  Each procedure inherits the value from its caller.  While it
can simplify your code in some situations, it can also lead to subtle problems
if you are assuming that <tt>usr</tt> is automatically assigned the value of
<tt>src</tt> when you call a verb programmatically.  It is not.

<p>The only time <tt>usr</tt> is assigned for you is when a player executes a
verb, clicks something with the mouse, clicks a link (see
<a class=code href=#/client/proc/Topic>Topic</a>), or any other such action.

<p class=tip>Note: <b>A good rule of thumb is to never put usr in a proc, only
verbs.</b> Typically <tt>usr</tt> in a proc is an unsafe programming practice.
If <tt>src</tt> would not be the correct choice, it is better to send another
argument to your proc with the information it needs.

<p>Certain built-in procs such as
<a class=code href=#/atom/proc/Click>atom/Click()</a> are called automatically
by a client counterpart like
<a class=code href=#/client/proc/Click>client/Click()</a>; usually
<a class=code href=#/atom/proc/Click>atom/Stat()</a> is called by
<a class=code href=#/client/proc/Click>client/Stat()</a>; and so on. It is
mostly safe to apply <tt>usr</tt> as directed in those situations, because
these procs are pseudo-verbs. It is mostly <em>not</em> safe to apply
<tt>usr</tt> in a movement proc such as
<a class=code href=#/atom/movable/proc/Move>Move()</a> or
<a class=code href=#/atom/proc/Enter>Enter()</a>, because objs and non-player
mobs may move autonomously without setting <tt>usr</tt>.

<p>Although <tt>usr</tt> is often set in <a href=#/mob/proc/Login>mob/Login()</a>
when a client first connects, you should not assume it is valid if
<tt>Login()</tt> is called any other way. Common cases occur when creating a
new character, loading a player's mob from a savefile; or explicitly when
setting a mob's key or changing the value of
<a class=code href=#/client/var/mob>client.mob</a>. It is safest to use
<tt>src</tt> in <tt>mob/Login()</tt>, which is always correct, rather than
<tt>usr</tt>.

<p><tt>usr</tt> is the default point of reference for several procs like
<a class=code href=#/proc/view>view()</a> and
<a class=code href=#/proc/range>range()</a>, because of their common use in
verbs. It is also the default recipient for
<a class=code href=#/proc/input>input()</a> and
<a class=code href=#/proc/alert>alert()</a> messages. When using these in
procs, be aware of that so you can change the default reference value to
something more appropriate.

<hr>

<a name=/proc/vector>
<h2 byondver=516>vector proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/pixloc>pixloc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>vector(x,y)
<dd>vector(x,y,z)
<dd>vector(String)
<dd>vector(List)
<dd>vector(Vector)
<dd>vector(Pixloc)
</dl>

<dl><dt><b>Returns:</b>
<dd>A new vector.
</dl>

<dl><dt><b>Args:</b>
<dd>x,y,z: Components of the new vector.
<dd>String: A text string to parse as a vector, where the delimiter between numbers can be a comma or x.
<dd>List: A numeric list to copy as a vector.
<dd>Vector: A vector to copy.
<dd>Vector: A pixloc to copy as a vector.
</dl>

<p>Creates a vector.

<hr>

<a name=/proc/view>
<h2>view proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/proc/hearers>hearers</a>
<dd><a href=#/proc/oview>oview proc</a>
<dd><a href=#/proc/range>range proc</a>
<dd><a href=#/mob/var/see_in_dark>see_in_dark var (mob)</a>
<dd><a href=#/mob/var/see_infrared>see_infrared var (mob)</a>
<dd><a href=#/mob/var/see_invisible>see_invisible var (mob)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/world/var/view>view var (world)</a>
<dd><a href=#/proc/viewers>viewers</a>
</dl>

<dl><dt><b>Format:</b>
<dd>view(Dist=5,Center=usr)
</dl>

<dl><dt><b>Returns:</b>
<dd>A list of visible objects within Dist tiles of Center.
</dl>

<dl><dt><b>Args:</b>
<dd>Dist:   A number.
<dd>Center: An object on the map.
</dl>

<p>A Dist of 0 includes Center, the contents of Center (normally
usr.contents), its location (normally the turf a mob is standing on), and
any other contents of that location.  A value of 1 extends the region to the
neighboring squares on the map and so on.  Both arguments are optional and
may be passed in any order.

<p>The default range is actually controlled by the size of the map viewport
size, which is configured with <code>world.view</code>.  Since the default
value of that variable is 5, the default range is also 5.  You may use any
valid view size, so an explicit view size such as "11x17" is also valid.

<h3>Example:</h3>
<xmp>
view() << "to all in sight of [usr]"
view(src) << "to all in sight of [src]"
view(1,src.loc) << "to all within reach of [src]"
</xmp>

<p>Be aware of the following distinctions:

<xmp>
view(usr)         //objects that usr can see
view(usr.loc)     //objects visible from usr's position
view(usr.client)  //objects visible to player
</xmp>

<p>In many cases, the three different statements could produce the same
result, but they are not identical in general.  For example, the first
statement takes into account the visual capabilities of usr, which might
include such things as the ability to see in the dark or to see invisible
objects.

<p>The second statement, since it is from a non-mob would just do a plain
visibility calculation with no special visual capabilities.  In many cases,
you would want to use viewers() or hearers() instead.

<p>The third statement produces a list of visible objects as the player sees
things, which might be different than how the mob sees things if
<code>client.eye</code> and <code>client.mob</code> are different.

<hr>

<a name=/proc/viewers>
<h2>viewers</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/hearers>hearers</a>
<dd><a href=#/proc/oviewers>oviewers</a>
<dd><a href=#/proc/view>view proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>viewers(Depth=world.view,Center=usr)
</dl>

<p>This is just like <code>view()</code>, but it is a list of mobs that can
see the center object, rather than a list of objects visible to the center
object.

<hr>

<a name=/proc/walk>
<h2>walk proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step>get_step proc</a>
<dd><a href=#/proc/step>step proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>walk(Ref,Dir,Lag=0,Speed=0)
<dd>walk(Ref,Vector,Lag=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Dir: One of NORTH, SOUTH, EAST, WEST, NORTHEAST, NORTHWEST, SOUTHEAST,
     SOUTHWEST, or 0 to halt.
<dd>Lag: Delay in world ticks between movement.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
<dd byondver=516>Vector: 2D vector to move by, in pixels.
</dl>

<p>Move Ref in the direction Dir continuously.  Each step will be preceded
by Lag time of inactivity.

<p>A call to a walking function aborts any previous walking function called
on Ref.  To halt walking, call walk(Ref,0).

<p>This function returns immediately, but continues to process in the
background.

<p>The vector version of this proc will make a copy of the vector, so changing
the vector afterward won't have an effect on existing walking.

<hr>

<a name=/proc/walk_away>
<h2>walk_away proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_away>get_step_away proc</a>
<dd><a href=#/proc/step_away>step_away proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>walk_away(Ref,Trg,Max=5,Lag=0,Speed=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Trg: An object on the map.
<dd>Max: The maximum distance between Ref and Targ before movement halts.
<dd>Lag: Delay in world ticks between movement.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Moves Ref on a path away from Trg continuously, taking obstacles into
account.  Each step will be preceded by Lag time of inactivity.  If Ref is
farther than Max steps from Trg, no action will be taken.

<p>A call to a walking function aborts any previous walking function called
on Ref.  To halt walking, call walk(Ref,0).

<p>This function returns immediately, but continues to process in the
background.

<hr>

<a name=/proc/walk_rand>
<h2>walk_rand proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_rand>get_step_rand proc</a>
<dd><a href=#/proc/step_rand>step_rand proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>walk_rand(Ref,Lag=0,Speed=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Lag: Delay in world ticks between movement.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Moves Ref randomly.  Each step will be preceded by Lag time of inactivity.

<p>A call to a walking function aborts any previous walking function called
on Ref.  To halt walking, call walk(Ref,0).

<p>This function returns immediately, but continues to process in the
background.

<hr>

<a name=/proc/walk_to>
<h2>walk_to proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_to>get_step_to proc</a>
<dd><a href=#/proc/step_to>step_to proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>walk_to(Ref,Trg,Min=0,Lag=0,Speed=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Trg: An object on the map.
<dd>Min: The minimum distance between Ref and Trg before movement halts.
<dd>Lag: Delay in world ticks between movement.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Move Ref on a path to Trg continuously, taking obstacles into account.
Each step will be preceded by Lag time of inactivity.  If Ref is within Min
steps of Trg, no action will be taken.  This is also true if the target is
too far away (more than twice world.view steps).

<p>A call to a walking function aborts any previous walking function called
on Ref.  To halt walking, call walk(Ref,0).

<p>This function returns immediately, but continues to process in the
background.

<hr>

<a name=/proc/walk_towards>
<h2>walk_towards proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/get_step_towards>get_step_towards proc</a>
<dd><a href=#/proc/step_towards>step_towards proc</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>walk_towards(Ref,Trg,Lag=0,Speed=0)
</dl>

<dl><dt><b>Args:</b>
<dd>Ref: A mob or obj.
<dd>Trg: An object on the map.
<dd>Lag: Delay in world ticks between movement.
<dd>Speed: Speed to move, in pixels. 0 uses Ref.step_size.
</dl>

<p>Move Ref in the direction of Trg continuously.  Each step will be preceded
by Lag time of inactivity.

<p>A call to a walking function aborts any previous walking function called
on Ref.  To halt walking, call walk(Ref,0).

<p>This function returns immediately, but continues to process in the
background.

<hr>

<a name=/proc/while>
<h2>while proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/break>break statement</a>
<dd><a href=#/proc/continue>continue statement</a>
<dd><a href=#/proc/do>do proc</a>
<dd><a href=#/proc/for/loop>for loop proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>while(E) Statement
</dl>

<p>If E is true (non-zero) execute Statement.  Continue testing E and doing
the while block until E becomes false (zero).

<p>Statement may be a block of code or a single statement.

<h3>Example:</h3>
<xmp>
var/i = 3
while(i)
  world << i--
</xmp>

<p>This outputs:

<xmp>
3
2
1
</xmp>

<hr>

<a name=/proc/winclone>
<h2>winclone proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winexists>winexists proc</a>
<dd><a href=#/proc/winget>winget proc</a>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/proc/winshow>winshow proc</a>
<dd><a href=#/{skin}>User interface skins</a>
</dl>

<dl><dt><b>Format:</b>
<dd>winclone(player, window_name, clone_name)
</dl>

<dl><dt><b>Args:</b>
<dd>player: A mob or client.
<dd>window_name: The name of a window, pane, menu, or macro set in the world's skin file.
<dd>clone_name: The name of the new window, pane, menu, or macro set to create.
</dl>

<p>Creates a clone of a window, pane, menu, or macro set that exists in the
world's skin file. The original object as it exists in the skin file (not its
current state) is used as a template to build the clone. The clone will exist
only for the player you choose.

<h3>Example:</h3>
<xmp>
winset(usr, "templatewindow", "clonedwindow")
</xmp>

<p>If a window is not visible by default, it will have to be shown with
<tt>winset()</tt> or <tt>winshow()</tt>. A pane may be shown by using it in a
Child or Tab control. Menus or macros must be assigned to a window with
<tt>winset()</tt> before they will work.

<p>If window_name is "window", "pane", "menu", or "macro", and the skin file
does not have a control of that name already, the proc will create a new
control of that type from scratch.

<h3>Example:</h3>
<xmp>
winclone(usr, "menu", "newmenu")
winset(usr, "newmenu_file", "parent=newmenu;name=File")
winset(usr, "newmenu_quit", "parent=newmenu_file;name=Quit;command=.quit")
</xmp>

<p>A new window is invisible by default. For windows and panes, you should
give them a size with <tt>winset()</tt> before adding any controls so you can
set their anchors properly.

<h3>Example:</h3>
<xmp>
// Create the pane
winclone(usr, "pane", "newpane")
// Give it a size so we can figure out where to put controls
winset(usr, "newpane", "size=100x100")
// Add controls
winset(usr, "newpane_label", \
       "parent=newpane;pos=0,0;size=100x100;anchor1=0,0;anchor2=100,100")
// Put the pane in a child control where it can be seen
winset(usr, "a_child", "left=newpane")
usr << output("New label", "newpane_label")
</xmp>

<p>Once a clone is created, it can be deleted via a <tt>winset()</tt>
call:</p>

<h3>Example:</h3>
<xmp>
winset(usr, "clonedwindow", "parent=none")
</xmp>

<hr>

<a name=/proc/winexists>
<h2>winexists proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winclone>winclone proc</a>
<dd><a href=#/proc/winget>winget proc</a>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/proc/winshow>winshow proc</a>
<dd><a href=#/{skin}>User interface skins</a>
<dd><a href=#/{skin}/param/type>type parameter (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>winexists(player, control_id)
</dl>

<dl><dt><b>Args:</b>
<dd>player: A mob or client.
<dd>control_id: The unique ID of a control in the player's skin.
</dl>

<p>Tells if a control exists and if so, what type it is. The return value is
an empty string if the control does not exist, but otherwise it is the type
of control.

<p>This proc will not tell you if a control has been defined in the skin file
but is not in use yet.

<p>Because the client must be contacted to get this information, winexists()
will sleep the current proc.

<hr>

<a name=/proc/winget>
<h2>winget proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winexists>winexists proc</a>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/{skin}>User interface skins</a>
<dd><a href=#/{skin}/param>parameters (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>winget(player, control_id, params)
</dl>

<dl><dt><b>Args:</b>
<dd>player: A mob or client.
<dd>control_id: The unique ID of a control in the player's skin.
<dd>params: The name of a parameter to read, or a semicolon-separated list of parameters
</dl>

<p>Retrieves info from a player about the current state of their skin. If
<tt>control_id</tt> and <tt>params</tt> are each just a single value, then the
return value will be a simple string with the value of that parameter. If
<tt>control_id</tt> or <tt>params</tt> is a semicolon-separated list like the
kind used in <tt>list2params()</tt>, then the result will be in a similar
format, and can be converted to a list form using <tt>params2list()</tt>.

<p>The <tt>control_id</tt> can be a window name, or in a
<tt>"[window].[control]"</tt> format, or just the control's ID itself as long
as it is unique.  Another valid form is <tt>":[type]"</tt> which selects the
default control of that type, e.g. <tt>":map"</tt> for the main map. As
mentioned above, you can retrieve info on more than one control at once by
separating them with semicolons, like <tt>"button1;button2"</tt>.

<h3>Example:</h3>
<xmp>
usr << "mainwindow.is-visible = [winget(usr, "mainwindow", "is-visible")]"
usr << "\nOther params:"
usr << winget(usr, "mainwindow", "pos;is-maximized")
usr << "\nButtons:"
usr << winget(usr, "button1;button2", "is-checked")
</xmp>

<p>This outputs:

<xmp>
mainwindow.is-visible = true

Other params:
pos=0x0;is-maximized=true

Buttons:
button1.is-checked=true;button2.is-checked=false
</xmp>

<p>If the returned result is actual text for any parameters, the single quote
or double quote characters may be escaped with a backslash. An actual backslash
will also be escaped with a backslash.

<p>You can also use a special wildcard format to retrieve info about all the
controls in a window, menu, or macro set. If control_id is <tt>"mainwindow.*"</tt>
for instance, then any control that is part of <tt>mainwindow</tt>&mdash;and
<tt>mainwindow</tt> itself&mdash;is included in the result if it has the
parameter(s) you're looking for. Use <tt>params2list()</tt> to interpret the
result.

<p class=performance>Note: Because the client must be contacted to get this
information, <tt>winget()</tt> will sleep the current proc.

<h3>Special wingets</h3>

<p>Calling <tt>winget()</tt> with a blank or null <tt>control_id</tt> can
return some values that belong to the client as a whole, not to specific
controls. They can also be used for <a href=#/{skin}/commands>embedded
wingets</a>.

<dl class=codedt>
<dt>focus</dt><dd>The full ID of the control, if any, that currently has keyboard focus.</dd>
<dt>windows</dt><dd>The IDs of all windows, separated by semicolons.</dd>
<dt byondver=496>panes</dt><dd>The IDs of all panes, separated by semicolons.</dd>
<dt>menus</dt><dd>The IDs of all menus, separated by semicolons.</dd>
<dt>macros</dt><dd>The IDs of all macro sets, separated by semicolons.</dd>
<dt>sound</dt><dd>True if sounds are enabled.</dd>
<dt>hwmode</dt><dd>True if the map displays in hardware rendering mode.</dd>
<dt>url</dt><dd>The URL the client is connected to in <tt>IP:port</tt> form. The port is 0 if connected to a local .dmb file, and either an empty string or null is returned if Dream Seeker is not connected at all.</dd>
<dt byondver=515>num-lock</dt><dd>True if Num Lock is on.</dd>
<dt byondver=515>caps-lock</dt><dd>True if Caps Lock is on.</dd>
<dt byondver=515>scroll-lock</dt><dd>True if Scroll Lock is on.</dd>
</dl>

<hr>

<a name=/proc/winset>
<h2>winset proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winclone>winclone proc</a>
<dd><a href=#/proc/winexists>winexists proc</a>
<dd><a href=#/proc/winget>winget proc</a>
<dd><a href=#/proc/winshow>winshow proc</a>
<dd><a href=#/{skin}>User interface skins</a>
<dd><a href=#/{skin}/param>parameters (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>winset(player, control_id, params)
</dl>

<dl><dt><b>Args:</b>
<dd>player: A mob or client.
<dd>control_id: The unique ID of a control in the player's skin.
<dd>params: A text string with parameters to set, in the format returned by
  <tt>list2params()</tt>; <i>OR</i> an associative list.
</dl>

<p>Sets parameters for a player's skin. The parameter list can be created by
making a list and using <tt>list2params()</tt>, or it can be done manually by
just using a string like <tt>"is-visible=true;text-color=#f00"</tt>. You can
also just use a list directly, which will be passed to <tt>list2params()</tt>
internally.

<p>The <tt>control_id</tt> can be a window name, or in a
<tt>"[window].[control]"</tt> format, or just the control ID as long as it is
unique. In some special cases it can also be null. Another valid form is
<tt>":[type]"</tt> which selects the default control of that type, e.g.
<tt>":map"</tt> for the main map.

<p>If you want to use a text string that may include spaces, surround the
string with double quotes and escape them using a backslash, e.g.
<tt>"text=\"This is some text.\""</tt>. Backslashes can also be used by
preceding them with another backslash. For filenames, use single quotes around
the file. Sometimes escapement may need to go several levels deep; for example
to set up an input control with a default say command, you will need to escape
it twice:

<blockquote>
Desired command: <tt>say "</tt><br>   
Escaped form with quotes: <tt>"<b>say \"</b>"</tt><br>   
Final form: <tt>\"say \\\"\"</tt>

<p><tt>winset(usr, "mainwindow.input", "command=<b>\"say \\\"\"</b>")</tt>   
</blockquote>

<p>You can set more than one control's parameters at once by leaving the
<tt>control_id</tt> argument null, and including the control as part of the
parameter list:

<xmp>winset(usr, null,\
  "mainwindow.output.background-color=#ffffff;mainwindow.input.background-color=#ffffff")</xmp>

<h3>Special winsets</h3>

<p>Some "global" winset options will let you change things that affect the
client as a whole, not just specific controls.

<h4 byondver=496>reset</h4>

<p>You can reset the skin to its beginning state, removing all
runtime-created controls and windows, by calling
<tt>winset(player, null, "reset=true")</tt>.

<h4>command</h4>

<p>Another use for <tt>winset()</tt> is to send commands to the client that
normally can only run from there, like <tt>.profile</tt> or <tt>.quit</tt>. To
do this, leave the <tt>control_id</tt> argument null, and just use a parameter
called "command":

<xmp>obj/quitbutton
    name = "Quit"
    icon = 'buttons.dmi'
    icon_state = "quit"

    Click()
        winset(usr, null, list("command"=".quit"))</xmp>

<p>Because many characters need to be specially encoded for winsets, it's
best to either use the list format of <tt>winset()</tt> which handles that
encoding for you. If you want to use the string form, like <tt>winset(usr,
null, "command=XYZ")</tt>, then you should use
<a class=code href=#/proc/url_encode>url_encode()</a> to encode your command.

<h4 byondver=516>browser-options</h4>

<p>The "browser-options" global parameter lets you enable or disable certain
browser functionality. This can be a comma-separated list, or you can precede
an option with <tt>+</tt> or <tt>-</tt> to enable or disable it specifically.

<table class=codefirst>
<tr><th>Option</th><th>Default</th><th>Description</th></tr>
<tr><td>find</td><td>&#x274c;</td><td>Ctrl+F can open the built-in Find dialog.</td>
<tr><td>devtools</td><td>&#x274c;</td><td>F12 can open a devtools window, which is useful for debugging scripts.</td>
<tr><td>refresh</td><td>&#x274c;</td><td>Ctrl+R or F5 can refresh the page.</td>
<tr><td>zoom</td><td>&#x274c;</td><td>Ctrl with the + or - keys can zoom the browser, and Ctrl+0 can reset it.</td>
<tr><td>byondstorage</td><td>&#x274c;</td><td>Enables <a class=code href=#/{skin}/control/browser/byondStorage>byondStorage</a> access.</td>
</table>

<h3>Example:</h3>
<xmp>mob/Login()
    ..()
    winset(usr, null, "browser-options=devtools,find")</xmp>

<p>If you plan to use the <tt>+</tt> or <tt>-</tt> modifiers, you should
either use the list format of <tt>winset()</tt> or use
<a class=code href=#/proc/url_encode>url_encode()</a> to encode the list of
options.

<p>Browser options are shared across all browser controls.

<hr>

<a name=/proc/winshow>
<h2>winshow proc</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winclone>winclone proc</a>
<dd><a href=#/proc/winget>winget proc</a>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/{skin}>User interface skins</a>
<dd><a href=#/{skin}/param/is-visible>is-visible parameter (skin)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>winshow(player, window, show=1)
</dl>

<dl><dt><b>Args:</b>
<dd>player: A mob or client.
<dd>window: The name of a window in the player's skin.
<dd>show: Use a nonzero value to show the window, zero to hide it.
</dl>

<p>Shows or hides a window in the player's skin. This is a shortcut,
equivalent to setting <tt>is-visible</tt> via <tt>winset()</tt>.

<hr>

<a name=/regex>
<h2 byondver=510>regex datum</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex/proc>regex procs</a>
<dd><a href=#/regex/var>regex vars</a>
<dd><a href=#/proc/regex>regex proc</a>
<dd><a href=#/proc/REGEX_QUOTE>REGEX_QUOTE proc</a>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/splittext>splittext proc</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>The /regex datum holds a regular expression that can be used for
searching and/or replacing text. Rather than searching for a specific piece
of text, a regular expression is a <i>pattern</i> to search for. This can
include things like wildcards. See <a href=#/{notes}/regex>Regular expressions</a>
for more information.

<p>A new regular expression can be created with regex() or new/regex().

<hr>

<a name=/regex/proc>
<h2 byondver=510>regex procs</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/var>regex vars</a>
<dd><a href=#/proc/regex>regex proc</a>
</dl>

<dl><dt>regex/proc
<dd><a href=#/proc/regex>New</a>
<dd><a href=#/regex/proc/Find>Find</a>
<dd><a href=#/regex/proc/Replace>Replace</a>
</dl>

<hr>

<a name=/regex/proc/Find>
<h2 byondver=510>Find proc (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Replace>Replace proc (regex)</a>
<dd><a href=#/regex/var>regex vars</a>
<dd><a href=#/proc/regex>regex proc</a>
<dd><a href=#/proc/findtext>findtext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Find(haystack, Start=1, End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The position of the matched text, or 0 if no match was found.
</dl>

<dl><dt><b>Args:</b>
<dd>haystack: The text to be searched
<dd>Start: The start position (in bytes) to search; defaults to 1, or to src.next if this is a global pattern
<dd>End: The position of the byte after the end of the search; 0 is the end. The actual match is allowed to extend past End.
</dl>

<p>Finds the regular expression pattern within the "haystack" text.  The
following vars are set by the match:

<ul>
<li>text: The text that was searched.</li>
<li>index: The index where the match was found (same as the return value)</li>
<li>match: The actual matched text</li>
<li>group: If the expression contains capturing groups with the ( ) parentheses operator, this is a list that holds the text found in those groups. group[1] is the first group, and so on.</li>
<li>next: If the "g" flag was used to create thie expression, this is the next index to begin searching.
</ul>

<p>In a global expression (using the "g" flag), Find() can be called
repeatedly on the same piece of text and the Start position will be advanced
automatically unless you specify it.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>Find_char()</tt> to
work with character counts instead of bytes, at a performance cost. See the
<a href=@/{notes}/Unicode>Unicode</a> section for more information.

<hr>

<a name=/regex/proc/New>
<h2 byondver=510>New proc (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/proc/regex>regex proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>regex(pattern, flags)
<dd>regex(Regex)
</dl>

<dl><dt><b>Args:</b>
<dd>pattern: The pattern string to search for
<dd>flags: (optional) A text string containing any combination of modifier flags
<dd>Regex: an existing /regex datum to copy
</dl>

<p>Calling new/regex() is the same as calling regex().  It will create a new
/regex datum.

<hr>

<a name=/regex/proc/Replace>
<h2 byondver=510>Replace proc (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Find>Find proc (regex)</a>
<dd><a href=#/regex/var>regex vars</a>
<dd><a href=#/proc/regex>regex proc</a>
<dd><a href=#/proc/replacetext>replacetext proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Replace(haystack, replacement, Start=1, End=0)
</dl>

<dl><dt><b>Returns:</b>
<dd>The original haystack string with the first match replaced.  If using the "g" flag, all matches are replaced.
</dl>

<dl><dt><b>Args:</b>
<dd>haystack: The text to be searched
<dd>replacement: A piece of text, OR a proc, that will be used to replace the match
<dd>Start: The start position (in bytes) to search; defaults to 1, or to src.next if this is a global pattern
<dd>End: The position of the byte after the end of the search; 0 is the end. The actual match is allowed to extend past End.
</dl>

<p>Finds the regular expression pattern within the "haystack" text, and
replaces the match with the given replacement value.

<p>In a non-global expression (not using the "g" flag), the values of
src.index and src.next are set as they would be in a global Find(). See the
Find() proc for more info.

<p>Note: In strings containing non-ASCII characters, byte position and
character position are not the same thing. Use <tt>Replace_char()</tt> to
work with character counts instead of bytes. See the
<a href=#/{notes}/Unicode>Unicode</a> section for more information.

<h3>Replacing with text</h3>

<p>If the replacement value is text, the $ character is treated as special.
If you want to use the actual dollar sign, it must be escaped with a second
dollar sign. Otherwise, the $ character is one of these special values:

<table class="regex">
<tr><th>Replacement</th><th>Value</th></tr>
<tr><td>$1 <i>through</i> $9</td><td><tt>$1</tt>tt> is whatever was in the first parentheses group, <tt>$2</tt> is the second, and so on.</td></tr>
<tr><td>$`</td><td>The text that came before the match</td></tr>
<tr><td>$'</td><td>The text that came after the match</td></tr>
<tr><td>$0 <i>or</i> $&</td><td>The whole match itself</td></tr>
</table>

<h3>Replacing with a proc</h3>

<p>If replacing matches with a proc, then the proc will be called with the
match as its first argument, and any capturing groups as the following
arguments. Whatever the proc returns will be used as the replacement text in
place of the match.

<h3>Example</h3>
<xmp>
var/regex/vowels = new("[aeiou]", "i")
// match any word of 2 letters or more
var/regex/piglatin = new("\\b(\\l)(\\l+)\\b", "ig")

// group1 is the first letter, and group2 is everything else
proc/word2piglatin(match, group1, group2)
	// If the word starts with a vowel, just add "ay"
    if(vowels.Find(group1)) return "[match]ay"
    // If the word was capitalized, capitalize the replacement    
    if(group1 == uppertext(group1))
        group1 = lowertext(group1)
        group2 = uppertext(copytext(group2,1,2)) + lowertext(copytext(group2,2))
    return "[group2][group1]ay"

mob/verb/PigSay(msg as text)
    msg = html_encode(msg)
    world << piglatin.Replace(msg, /proc/word2piglatin)
</xmp>

<hr>

<a name=/regex/var>
<h2 byondver=510>regex vars</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc>regex procs</a>
<dd><a href=#/proc/regex>regex proc</a>
</dl>

<dl><dt>regex/var
<dd><a href=#/regex/var/flags>flags</a>
<dd><a href=#/regex/var/group>group</a>
<dd><a href=#/regex/var/index>index</a>
<dd><a href=#/regex/var/match>match</a>
<dd><a href=#/regex/var/name>name</a>
<dd><a href=#/regex/var/next>next</a>
<dd><a href=#/regex/var/text>text</a>
</dl>

<hr>

<a name=/regex/var/flags>
<h2 byondver=510>flags var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/var/name>name var (regex)</a>
</dl>

<p>The flags that were used to create this regular expression.  Changing this
value after the datum is created will not change how the expression behaves.

<hr>

<a name=/regex/var/group>
<h2 byondver=510>group var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Find>Find proc (regex)</a>
<dd><a href=#/regex/var/index>index var (regex)</a>
<dd><a href=#/regex/var/match>match var (regex)</a>
</dl>

<p>After a call to Find(), if this regular expression had any parentheses
groups, whatever text was matched in those groups is stored here in a list.

<h3>Example</h3>
<xmp>
var/regex/R = new("B(.)(.)(.)D")
R.Find("BYOND")     // find this pattern in "BYOND"
</xmp>

The result of the example is that R.group is list("Y","O","N").

<hr>

<a name=/regex/var/index>
<h2 byondver=510>index var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Find>Find proc (regex)</a>
<dd><a href=#/regex/proc/Replace>Replace proc (regex)</a>
<dd><a href=#/regex/var/match>match var (regex)</a>
<dd><a href=#/regex/var/next>next var (regex)</a>
</dl>

<p>After a call to Find(), this var contains the index where the match was
found.

<p>Replace() on a non-global pattern will also store the index of the match
here.

<hr>

<a name=/regex/var/match>
<h2 byondver=510>match var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Find>Find proc (regex)</a>
<dd><a href=#/regex/var/group>group var (regex)</a>
<dd><a href=#/regex/var/index>index var (regex)</a>
</dl>

<p>After a call to Find(), this var contains the text that was matched.

<hr>

<a name=/regex/var/name>
<h2 byondver=510>name var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/var/flags>flags var (regex)</a>
</dl>

<p>The pattern that was used to create this regular expression.  Changing this
value after the datum is created will not change how the expression behaves.

<hr>

<a name=/regex/var/next>
<h2 byondver=510>next var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Find>Find proc (regex)</a>
<dd><a href=#/regex/proc/Replace>Replace proc (regex)</a>
<dd><a href=#/regex/var/index>index var (regex)</a>
<dd><a href=#/regex/var/match>match var (regex)</a>
</dl>

<p>If this is a global pattern (using the "g" flag), then after a call to
Find() this var contains the index where next Find() should begin.

<p>Replace() on a non-global pattern will also store the index of the next
place to begin a search here.  The position to search will be based on the
replaced text, which is stored in the text var.

<hr>

<a name=/regex/var/text>
<h2 byondver=510>text var (regex)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/regex/proc/Find>Find proc (regex)</a>
<dd><a href=#/regex/var/index>index var (regex)</a>
<dd><a href=#/regex/var/match>match var (regex)</a>
<dd><a href=#/regex/var/next>next var (regex)</a>
</dl>

<p>If this is a global pattern (using the "g" flag), then after a call to
Find() this var contains the text that was searched.  If that same text is
searched again, the next var is the default starting position.

<p>Replace() on a non-global pattern will store the text <i>after</i>
replacement here.

<hr>

<a name=/savefile>
<h2>savefile</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3e%3e>&gt;&gt; operator (savefile)</a>
<dd><a href=#/savefile/operator/%3c%3c>&lt;&lt; operator (savefile)</a>
<dd><a href=#/client/proc/Export>Export proc (client)</a>
<dd><a href=#/client/proc/New>New proc (client)</a>
<dd><a href=#/savefile/proc>procs (savefile)</a>
<dd><a href=#/savefile/var>vars (savefile)</a>
<dd><a href=#/var/tmp>tmp vars</a>
<dd><a href=#/proc/issaved>issaved proc</a>
<dd><a href=#/datum/proc/Read>Read proc (datum)</a>
<dd><a href=#/datum/proc/Write>Write proc (datum)</a>
</dl>

<div class="sidebar note">
<p>Savefiles are easy to use, but you should always plan what you're going to
save and what you don't want to save. Use <tt>/tmp</tt> to avoid saving
anything you don't need, and you can avoid a lot of trouble.

<p>In particular you should be careful that if you're saving a player's mob,
you don't accidentally save any other mobs. If you save a turf, you should
avoid saving its contents unless you know there are no mobs standing on it
(but usually it's better to save x,y,z coordinates than the turf itself).
This is explained further in the <a href=#/var/tmp>tmp vars</a> entry.

<p>Currently, overlays and underlays also save by combining each list into a
single icon that saves its full icon data in the file. This may not be
desired, so you can remove that data. Usually you'll want to rebuild any
overlay/underlay lists during <a class=code href=#/datum/proc/Read>Read()</a>.
</div>

<p>A database file in DM is called a "savefile".  All of the contents of a
savefile reside in a single file.  The contents of the file are stored in
database directories.  These should not be confused with real directories in
the external file system.  The database directories are all contained inside
the one file.

<p>Each database directory contains a list of sub-directories and a buffer in
which data may be written.  The absolute path to a directory has the following
format:  "/Dir1/Dir2/...".  The current directory may be set by assigning its
absolute path name to <code>savefile.cd</code>.  A relative path (one that
doesn't begin with "/") may also be used, in which case the new path starts at
the current directory.  The path "."  stands for the current directory, ".."
for its parent, "../.." for its parent's parent, etc.

<p>A savefile may be created with <code>new/savefile(name)</code>.  The
optional name argument may be an external file name (existing or to be
created) in double quotes or a file from the resource cache in single quotes.
Of course, a variable containing either of these types of values may also be
used.  If no name is specified, a temporary file will be created, which will
be destroyed when the savefile is no longer in use.  If a resource cache is
specified, a temporary file will be created and the contents of the cached
file will be copied into it.  Changes will therefore only be temporary.

<hr>

<a name=/savefile/operator>
<h2>operators (savefile)</h2>

<p>Built-in savefile operators:

<dl><dt>savefile/operator
<dd><a href=#/savefile/operator/%3c%3c>&lt;&lt</a>
<dd><a href=#/savefile/operator/%3e%3e>&gt;&gt</a>
</dl>

<hr>

<a name=/savefile/operator/%3e%3e>
<h2>&gt;&gt; operator (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/%3e%3e/input>&gt;&gt; input operator</a>
<dd><a href=#/savefile/operator/%3c%3c>&lt;&lt; operator (savefile)</a>
<dd><a href=#/datum/proc/Read>Read proc (datum)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>F &gt;&gt; Var
<dd>F["Path"] &gt;&gt; Var
</dl>

<p>Reads a value from a buffer into a variable.  If Path is not specified, the
current buffer will be used.  Otherwise, the buffer at the specified path will
be accessed.  Whenever the current directory is set, reading starts at the
beginning of that buffer (replacing any previous contents).  For this reason,
when the Path parameter is given, the first value in the specified buffer is
always read.  If there is no data in the buffer or the end of the buffer has
been reached, null is returned.

<p>If the value read is a previously written object, its own directory will be
opened and the object's Read proc will be called to load any data that was
written in the object's Write proc.

<p>If the value read is a savefile (ie a savefile inside of a savefile), it is
treated a little differently.  Instead of returning a savefile object, it
returns data cached in the world's rsc file.  This is to give you control over
what file this data is copied into before it is opened as a savefile.  If you
want to just open it up in a temporary file, do something like this:

<xmp>
obj
   var
      savefile/myfile
   Read()
      . = ..()   //do the normal stuff
      if(myfile) //load data into a temporary file and create savefile object
         myfile = new/savefile(myfile)
</xmp>

<hr>

<a name=/savefile/operator/%3c%3c>
<h2>&lt;&lt; operator (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/operator/%3e%3e>&gt;&gt; operator (savefile)</a>
<dd><a href=#/operator/%3c%3c/output>&lt;&lt; output operator</a>
<dd><a href=#/datum/proc/Write>Write proc (datum)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>F &lt;&lt; Val
<dd>F["Path"] &lt;&lt; Val
</dl>

<p>Writes Val to a buffer.  If Path is not specified, the current buffer
will be used.  Otherwise, the buffer at the specified path will be written
to.  Whenever the current directory is set, writing starts at the beginning
of that buffer (replacing any previous contents).  For this reason, when the
Path parameter is given, the specified buffer is always overwritten.

<p>If Val is an object, a separate directory will be created for the object
and the object's Write proc will be called.  In addition to data that may be
written by the Write() proc, the type of the object is stored in a buffer
called "type".  In the case of turfs, the location of the turf is also
recorded so that it can be recreated at the same position.  All other objects
must be repositioned after the object is recreated (like in the object's
Read() proc).

<p>Single operations that write multiple values (such as saving an object) are
handled somewhat specially to avoid two references to the same object creating
duplicate entries in the savefile.  After the object being referenced is
written once, successive references to the same object will be saved simply as
references rather than as full objects.  If this was not done, two references
to the same object would be read back in as two separate objects.  This also
avoids infinite loops that would result when objects contain references back
to themselves.

<hr>

<a name=/savefile/proc>
<h2>procs (savefile)</h2>

<dl><dt>savefile/proc
<dd><a href=#/savefile/proc/ExportText>ExportText</a>
<dd><a href=#/savefile/proc/Flush>Flush</a>
<dd><a href=#/savefile/proc/ImportText>ImportText</a>
<dd><a href=#/savefile/proc/Lock>Lock</a>
<dd><a href=#/savefile/proc/Unlock>Unlock</a>
<dd><a href=#/savefile/proc/New>New</a>
</dl>

<hr>

<a name=/savefile/proc/ExportText>
<h2>ExportText proc (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/proc/ImportText>ImportText proc (savefile)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>savefile.ExportText(path=cd,file)
</dl>

<dl><dt><b>Args:</b>
<dd>path: the path to export
<dd>file: optional file to write to
</dl>

<p>Converts all or part of a savefile to a human readable text format, similar
in syntax to DM.  If no file is specified, the savefile text is returned as a
text string instead of being written to a file.

<p>The following example shows how to export and later import a savefile.  The
user's mob is written into a directory with the same name as their
<a href=#/mob/var/ckey>ckey</a> and the result is written to a text file.

<h3>Example:</h3>
<xmp>
mob/verb/write()
   var/savefile/F = new()
   var/txtfile = file("players/[ckey].txt")

   F[ckey] << usr

   fdel(txtfile)
   F.ExportText("/",txtfile)

   usr << "Your savefile looks like this:"
   usr << "<pre>[html_encode(file2text(txtfile))]</pre>"

mob/verb/read()
   var/savefile/F = new()
   var/txtfile = file("players/[ckey].txt")

   F.ImportText("/",txtfile)
   F[ckey] >> usr
</xmp>

<hr>

<a name=/savefile/proc/Flush>
<h2 byondver=510>Flush proc (savefile)</h2>

<dl><dt><b>Format:</b>
<dd>savefile.Flush()
</dl>

<p>Flushes any pending write operations for this savefile.</p>

<hr>

<a name=/savefile/proc/ImportText>
<h2>ImportText proc (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/proc/ExportText>ExportText proc (savefile)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>savefile.ImportText(path=cd,source)
</dl>

<dl><dt><b>Args:</b>
<dd>path: the path at which to write the imported data
<dd>source: a file or text string to import
</dl>

<p>Reads a text file or string and writes it into a savefile.  See
<a href=#/savefile/proc/ExportText>ExportText</a> for an example.

<p>If <tt>source</tt> is an ordinary string, it will be treated as savefile
contents to be parsed. If it's a <tt>file()</tt> reference, it will be
treated as a filename and the file's contents will be loaded.

<hr>

<a name=/savefile/proc/Lock>
<h2>Lock proc (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/proc/New>New proc (savefile)</a>
<dd><a href=#/savefile/proc/Unlock>Unlock proc (savefile)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Lock(timeout)
</dl>

<dl><dt><b>Args:</b>
<dd>timeout: seconds to wait; -1 for no timeout
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure
</dl>

<p>In order to modify a savefile, exclusive access to the file must be
guaranteed, so that other processes reading or writing to the file do not
experience data corruption.  This is known as "locking" the file.  While the
file is locked, only the world that obtained the lock may access it.

<p>Normally, you do not need to worry about this, because a lock is
automatically obtained upon the first attempt to write to the file.  In a CGI
application, where many instances of the program might be running
simultaneously, the normal locking, which just tries once and crashes the proc
on failure, would not be ideal.

<p>Explicitly calling Lock() allows you to specify a timeout and it also
allows you to handle the case in which no lock could be obtained.  If you want
it to wait indefinitely, use -1.  Just be careful if there are several files
read by multiple processes that it is not possible for deadlock to occur.

<p>Obtaining a lock will fail if the file is locked by another world or if
it is even open by any other world.

<p>If you are using Lock(), then you probably also want to specify a timeout
when you open the savefile, since that too can fail due to the file being
locked by another process.

<hr>

<a name=/savefile/proc/New>
<h2>New proc (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/proc/Lock>Lock proc (savefile)</a>
<dd><a href=#/savefile/proc/Unlock>Unlock proc (savefile)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>New(filename,timeout)
</dl>

<dl><dt><b>Args:</b>
<dd>filename: name of file or empty for temporary file
<dd>timeout: seconds to wait; -1 for no timeout
</dl>

<p>You call this via new/savefile(filename,timeout).  The timeout is used to
determine how long to wait if the file is locked.  Normally (timeout=0), if
the file is locked, the proc crashes with a runtime error.  If you specify a
timeout, then it will keep trying to open the file and if this fails, it will
simply return with savefile.name being empty (ie a false value).

<p>If the first argument is an entry in the world's rsc cache, the data will
be copied into a temporary file and accessed from there.  Changes to this, and
any other temporary file, are not saved.  When you close the file, it simply
gets deleted.

<hr>

<a name=/savefile/proc/Unlock>
<h2>Unlock proc (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile/proc/Lock>Lock proc (savefile)</a>
<dd><a href=#/savefile/proc/New>New proc (savefile)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Unlock()
</dl>

<p>Exclusive locks are automatically released when the savefile is closed, but
if you want to keep reading the file and allow other processes to do the same,
then you can explicitly unlock it.

<p>Note that this does not allow other processes to lock the file.  It only
allows them to read from it.  As long as the file is open by more than one
process, no lock may be obtained.

<hr>

<a name=/savefile/var>
<h2>vars (savefile)</h2>

<p>savefile vars:

<dl><dt>savefile/var
<dd><a href=#/savefile/var/byond_build>byond_build</a>
<dd><a href=#/savefile/var/byond_version>byond_version</a>
<dd><a href=#/savefile/var/cd>cd</a>
<dd><a href=#/savefile/var/dir>dir</a>
<dd><a href=#/savefile/var/eof>eof</a>
<dd><a href=#/savefile/var/name>name</a>
</dl>

<hr>

<a name=/savefile/var/byond_build>
<h2 byondver=515>byond_build var (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile>savefile</a>
<dd><a href=#/savefile/var/byond_version>byond_version var (savefile)</a>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/world/var/byond_build>byond_build var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Sometimes when transitioning between BYOND versions you'll want to keep a
savefile in a condition where it can be read by older versions. The
<tt>byond_version</tt> var tells it to avoid using newer savefile features
(unless forced to) above a certain build number. (The build number changes
more often than the BYOND version number.) A value of 0 means not to
worry about it.

<p>This can be changed on a per-savefile basis so that you can use newer
features in some files and avoid changing others. For instance, character
saves might want to go on using older features for a while, but for saving
parts of the map you might prefer to allow newer features to be used.

<p>The default savefile compatibility version can be set at compile-time:

<h3>Example:</h3>
<xmp>
savefile/byond_build = 1600  // do not use savefile features from BYOND build 1601 onward
</xmp>

<hr>

<a name=/savefile/var/byond_version>
<h2 byondver=515>byond_version var (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile>savefile</a>
<dd><a href=#/savefile/var/byond_build>byond_build var (savefile)</a>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/world/var/byond_build>byond_build var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Sometimes when transitioning between BYOND versions you'll want to keep a
savefile in a condition where it can be read by older versions. The
<tt>byond_version</tt> var tells it to avoid using newer savefile features
(unless forced to) above a certain version number. A value of 0 means not to
worry about it.

<p>This can be changed on a per-savefile basis so that you can use newer
features in some files and avoid changing others. For instance, character
saves might want to go on using older features for a while, but for saving
parts of the map you might prefer to allow newer features to be used.

<p>The default savefile compatibility version can be set at compile-time:

<h3>Example:</h3>
<xmp>
savefile/byond_version = 514  // do not use savefile features from BYOND 515 onward
</xmp>

<p>Note: By default, worlds compiled before BYOND 515 will set this value to
514.

<hr>

<a name=/savefile/var/cd>
<h2>cd var (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile>savefile</a>
</dl>

<p>This is the path name of the current directory.  Setting it causes the
current directory to change.  (We are talking about the current
<em>database</em> directory inside the savefile.  It is not a
real directory on the filesystem.)  It is perfectly legal to change to a
non-existent directory.  This new directory will not be saved to disk unless
its buffer (or one of its children) is modified, however.

<h3>Example:</h3>
<xmp>
var/savefile/F = new()  // temporary file

F.cd = "/MyDir/Icon"
F.cd = ".."    // change to /MyDir
F.cd = "Icon"  // change to /MyDir/Icon
</xmp>

<hr>

<a name=/savefile/var/dir>
<h2>dir list var (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
<dd><a href=#/savefile>savefile</a>
</dl>

<p>The name of each child directory of the current data directory is stored
in the list savefile.dir.  New directories may be created with
savefile.dir.Add() and removed with savefile.dir.Remove().  To test for the
existence of a directory, use savefile.dir.Find().  (Note that these are
<em>database</em> directories inside the savefile&mdash;not real directories
on the filesystem.)

<p>The order of directories is not necessarily preserved, so do not assume,
for example, that newer directories will be at the end of the list.

<hr>

<a name=/savefile/var/eof>
<h2>eof var (savefile)</h2>

<p>If there is more data to read in the current buffer, eof is 0; otherwise
it is 1.  Setting eof to 1 moves to the end of the buffer and 0 moves to the
beginning.  Setting it to -1 deletes the current buffer.

<hr>

<a name=/savefile/var/name>
<h2>name var (savefile)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile>savefile</a>
</dl>

<p>The external "real" filename is stored in file.name.  It is initialized
when creating a new file.  If none is specified, a temporary file with a
random name will be created.

<h3>Example:</h3>
<xmp>
var/savefile/F1
var/savefile/F2

F1 = new()         // create a temp file
F2 = new("myfile") // open "myfile"

world << "F1.name = [F1]"
world << "F2.name = [F2]"
</xmp>

<hr>

<a name=/sound>
<h2>sound datum</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
<dd><a href=#/proc/load_resource>load_resource proc</a>
</dl>

<p>A <tt>/sound</tt> datum is created by the <tt>sound()</tt> proc or by
<tt>new/sound()</tt>. It can be used to change the way a sound file will
play. When you're ready to play the sound, just send it to a player like
so:

<xmp>
var/sound/S = sound('bubbles.wav')
usr << S
</xmp>

<p>The sound file can be supplied as a list of choices, in which case the
client will play the first compatible sound in the list.

<hr>

<a name=/sound/var>
<h2>vars (sound)</h2>

<p>Built-in sound vars:

<dl><dt>sound/var
<dd><a href=#/sound/var/file>file</a>
<dd><a href=#/sound/var/repeat>repeat</a>
<dd><a href=#/sound/var/wait>wait</a>
<dd><a href=#/sound/var/channel>channel</a>
<dd><a href=#/sound/var/volume>volume</a>
<dd><a href=#/sound/var/frequency>frequency</a>
<dd><a href=#/sound/var/len>len</a>
<dd><a href=#/sound/var/offset>offset</a>
<dd><a href=#/sound/var/pan>pan</a>
<dd><a href=#/sound/var/params>params</a>
<dd><a href=#/sound/var/pitch>pitch</a>
<dd><a href=#/sound/var/priority>priority</a>
<dd><a href=#/sound/var/status>status</a>
<dd><a href=#/sound/var/xyz>x, y, z</a>
<dd><a href=#/sound/var/falloff>falloff</a>
<dd><a href=#/sound/var/environment>environment</a>
<dd><a href=#/sound/var/echo>echo</a>
<dd><a href=#/sound/var/atom>atom</a>
<dd><a href=#/sound/var/transform>transform</a>
</dl>

<hr>

<a name=/sound/var/file>
<h2>file var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<p>This is the file that will be played when the sound is sent to a player.

<p>If this value is a list of files rather than a single file, the client
will play the first compatible sound in the list.  This can be useful for
developing webclient games, where .ogg is preferred by most browsers for
audio, but .mp3 is needed for others.

<p>This var may be filled in by the <tt>SoundQuery</tt> proc.

<hr>

<a name=/sound/var/repeat>
<h2>repeat var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (do not repeat)
</dl>

<p>Set to 1 to repeat the sound indefinitely once it begins playing, 2 to
repeat it forwards and backwards.

<p>This var may be filled in by the <tt>SoundQuery</tt> proc.

<hr>

<a name=/sound/var/wait>
<h2>wait var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (do not wait)
</dl>

<p>Set to 1 to wait for other sounds in this channel to finish before playing
this one.

<p>The <tt>SoundQuery</tt> proc fills in this value with the total duration of
sounds that are queued to be played on this channel.

<hr>

<a name=/sound/var/channel>
<h2>channel var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound/var/status>status var (sound)</a>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0 (any channel)
</dl>

<p>For sound effects, set to 1 through 1024 to choose a specific sound channel.
For values of 0 or less, any available channel will be chosen. If you play a
null sound (no file) on channel 0, the settings for the datum will affect all
channels.

<p>If you want to make any changes to your sound later on via the
<tt>SOUND_UPDATE</tt> status flag, you <i>must</i> specify a channel for it.

<p>This var may be filled in by the <tt>SoundQuery</tt> proc, but only for
sounds that had a specified channel to begin with.

<p class=didyouknow>Note: If you don't specify a channel to play a sound, the
client will choose a channel automatically but it will <i>not</i> conflict
with any specific channels you choose for other sounds later. This means if
you play some sounds with channel 0 but then later want to play something on
channel 1, you don't have to worry about channel 1 being taken.

<hr>

<a name=/sound/var/volume>
<h2>volume var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound/var>vars (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>100 (full volume)
</dl>

<p>Set to a percentage from 0 to 100 of the sound's full volume. It will play
at that volume when it is sent to a player.

<hr>

<a name=/sound/var/frequency>
<h2>frequency var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/pitch>pitch var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Any value from -100 to 100 will play this sound at a multiple of its normal
frequency. Set to 2 to play at double speed, for example, or -1 to play
backwards. A value of 0 or 1 will play the sound at its normal frequency.

<p>Set to a specific frequency (in Hz) outside of the -100 to 100 range to change
the playback rate of the sound. A negative value is also allowed. The value 0
means that the sound should be played as-is. This value will take effect when the
sound is sent to a player.

<p>CD-quality sound is sampled at 44.1 KHz, which is a value of 44100. Other
common sample rates for .wav files are 8000, 11025, and 22050. (11025 is
usually a good quality for most sound effects without making file size too
large.) If you know the file's sample rate, doubling the value will play it at
a higher pitch and twice as fast; halving it will play it at a lower pitch and
twice as slow.

<p byondver=515>To make a sound play at a different speed but keep its pitch
intact, set <tt>frequency</tt> to the speed multiple you want (e.g., 1.2 for 20%
faster) and set <tt>pitch</tt> to the inverse (e.g., 1/1.2).

<hr>

<a name=/sound/var/offset>
<h2 byondver=513>offset var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/status>status var (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<p byondver=515>Can be used to set a starting time, in seconds, for a sound.
It can also alter the current time index when using the <tt>SOUND_UPDATE</tt>
flag.

<p>This value is also set by the <tt>SoundQuery</tt> proc and represents the
current time index of a sound playing on the client.

<hr>

<a name=/sound/var/len>
<h2 byondver=513>len var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<p>This value is set by the <tt>SoundQuery</tt> proc and represents the
length, in seconds, of a sound playing on the client. Frequency is taken into
into consideration, so a higher frequency means the sound takes a shorter time
to play and therefore has a shorter length.

<p>Other uses for this var may be considered in the future.

<hr>

<a name=/sound/var/pan>
<h2>pan var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Alter the panning of a sound. -100 is full left, 100 is full right, and 0 is
at the center. This value will take effect when the sound is sent to a player.

<p>For music, <tt>pan</tt> can range from -100 (no pan separation) to 0 (full
separation).

<hr>

<a name=/sound/var/params>
<h2 byondver=515>params var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>Used to set client skin information related to this sound. This can be set
to an <a href=#/list/associations>associative list</a> or a parameter string
such as you would get from <a class=code href=#/proc/list2params>list2params()</a>.

<p>These are the parameters currently defined:

<dl class=codedt>
<dt>on-end</dt><dd>Plays when the sound ends or is stopped.</dd>
<dt>on-preempt</dt><dd>Plays when the sound is preempted by another sound. If this isn't present, <tt>on-end</tt> still applies if the sound is preempted.</dd>
</dl>

<h3>Example:</h3>
<xmp>
mob/proc/PlayIntro()
    var/sound/S = sound('intro.ogg')
    S.params = list("on-end" = ".intro-ended")
    src << S

mob/verb/_Intro_Ended()
    set name = ".intro-ended"
    src << "The intro has concluded."
</xmp>

<hr>

<a name=/sound/var/pitch>
<h2 byondver=515>pitch var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/frequency>frequency var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Can be used to shift the pitch of a sound up or down. This works similarly
to frequency except that it doesn't impact playback speed.

<p>The value of this var should be a multiple relative to 1, so for instance
to go up a full octave, the value would be 2; to go down an octave, use 0.5.

<p>Note: The filter that handles pitch shifting only goes from 0.5 to 2. The
player will stack up to three filters if it has to, so the range is really
from 0.125 to 8. You will however hear much poorer quality at more extreme
values.

<p>To make a sound play at a different speed but keep its pitch intact, set
<tt>frequency</tt> to the speed multiple you want (e.g., 1.2 for 20% faster)
and set <tt>pitch</tt> to the inverse (e.g., 1/1.2).

<h3>Example:</h3>
<xmp>
client
    var/sound/music // music currently playing

    proc/PlayMusic(music)
        music = new(music)
        music.channel = 100
        src << music

    proc/UpTempo(amount = 0.1)  // 10% faster
        if(!music) return
        music.frequency = (music.frequency || 1) + amount
        music.pitch = 1 / music.frequency
        music.status |= SOUND_UPDATE
        src << music
</xmp>

<hr>

<a name=/sound/var/priority>
<h2>priority var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Sounds with higher priority may steal channels from sounds of lower
priority. The maximum value is 255. 0 is the lowest.

<hr>

<a name=/sound/var/status>
<h2>status var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/client/proc/SoundQuery>SoundQuery proc (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Alter the way the sound is heard by affecting several different on/off
values which combine as bit flags.

<xmp>
SOUND_MUTE      // do not play the sound
SOUND_PAUSED    // pause sound
SOUND_STREAM    // create as a stream
SOUND_UPDATE    // update a playing sound
</xmp>

<p>Use the <tt>|</tt> operator to combine these values. The setting you choose
will take effect when the sound is sent to a player.

<p><tt>SOUND_MUTE | SOUND_UPDATE</tt> will mute a sound, but it will continue
to play. It can be unmuted while still playing by resending it with
<tt>status=SOUND_UPDATE</tt>.

<p><tt>SOUND_PAUSED | SOUND_UPDATE</tt> will pause a sound. It can be
restarted from its current position by resending it with
<tt>status=SOUND_UPDATE</tt>.

<p><tt>SOUND_STREAM</tt> will create this sound as a stream. Streams take less
memory, but can not play multiple times at once, nor can they play in reverse.
This flag is only valid the first time that a sound is played in a particular
mode (normal vs. 3D). Changing the flag later will not change the stream
status of the sound in that mode.

<p><tt>SOUND_UPDATE</tt> updates the settings for the sound currently playing
on the specified channel. If this flag is not set or no channel is specified,
the sound will start again from the beginning.

<p>Some of the flags for this value may be filled in by the
<tt>SoundQuery</tt> proc.

<hr>

<a name=/sound/var/xyz>
<h2>x, y, and z vars (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/atom>atom var (sound)</a>
<dd><a href=#/sound/var/transform>transform var (sound)</a>
<dd><a href=#/sound/var/falloff>falloff var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>all 0
</dl>

<p>Set to different values to give your sound a 3D effect which will be applied
when it is played. Positive values for <tt>x</tt> will sound as if they come
from the right, positive <tt>y</tt> sounds like it is above the player's head,
and positive <tt>z</tt> sounds like it is directly ahead. The effect of 3D sound
depends on the player's computer's sound card, and is greatly enhanced when
wearing headphones.

<p>Depending on the value of <tt>falloff</tt>, the settings for the location of
the sound can also affect its volume. Once the distance passes the value of
<tt>falloff</tt>, the volume will diminish.

<p>If these values are all set to 0, you should set <tt>environment</tt> if you
want to treat it as a 3D sound. Otherwise BYOND will assume this is meant to be
a non-3D sound such as music or the interface.

<p>If the <a class=code href=#/sound/var/atom>atom</a> var is set to an atom
that's visible on the map (that is, if it's close enough to the center of view
to be sent by the server), its relative x and y coordinates are fed through the
<a class=code href=#/sound/var/transform>transform</a> matrix, if present, and
added to the x,y,z coordinates. This way, a sound's 3D position can change in
real time. A sound is considered 3D if the <tt>atom</tt> var is set, even if
the base x,y,z coordinates are all 0.

<hr>

<a name=/sound/var/falloff>
<h2>falloff var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/xyz>x, y, z vars (sound)</a>
<dd><a href=#/sound/var/atom>atom var (sound)</a>
<dd><a href=#/sound/var/transform>transform var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<p>Within the falloff distance a 3D sound stays at the constant loudest
volume possible. Outside of this distance it attenuates at a rate
determined by the falloff.

<p>Higher values will make sounds fade out more slowly as they get farther away.
The distance of a sound is set by <tt>x</tt>, <tt>y</tt>, and <tt>z</tt>.

<hr>

<a name=/sound/var/environment>
<h2>environment var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/xyz>x, y, z vars (sound)</a>
<dd><a href=#/sound/var/atom>atom var (sound)</a>
<dd><a href=#/sound/var/echo>echo var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>-1
</dl>

<p>Changes the environmental reverb for all 3D sounds until another environment is specified. Only 3D sounds react to the environment. Please see the EAX2 documentation at http://developer.creative.com/ for detailed information about these settings.
<p>This value may be a number which selects a preset, or a list to choose settings manually. The default value (-1) specifies no change in environment. A numeric value from 0 to 25 specifies a set of reverb presets for the environment. The environment presets are:

<ol type=1 start=0>
<li>generic</li>
<li>padded cell</li>
<li>room</li>
<li>bathroom</li>
<li>livingroom</li>
<li>stoneroom</li>
<li>auditorium</li>
<li>concert hall</li>
<li>cave</li>

<li>arena</li>
<li>hangar</li>
<li>carpeted hallway</li>
<li>hallway</li>
<li>stone corridor</li>
<li>alley</li>
<li>forest</li>
<li>city</li>
<li>mountains</li>

<li>quarry</li>
<li>plain</li>
<li>parking lot</li>
<li>sewer pipe</li>
<li>underwater</li>
<li>drugged</li>
<li>dizzy</li>
<li>psychotic</li>
</ol>

<p>As of BYOND 515, setting environment to a negative number below -1 will
turn the environment off. The generic environment is not the same as off.

<p>A 23-element list represents a custom environment with the following
reverbration settings. A null or non-numeric value for any setting will
select its default.
<dl>
	<dt>1 EnvSize (1.0 to 100.0) default = 7.5</dt>
	<dd>environment size in meters</dd>
	<dt>2 EnvDiffusion (0.0 to 1.0) default = 1.0</dt>
	<dd>environment diffusion</dd>
	<dt>3 Room (-10000 to 0) default = -1000</dt>

	<dd>room effect level (at mid frequencies)</dd>
	<dt>4 RoomHF (-10000 to 0) default = -100</dt>
	<dd>relative room effect level at high frequencies</dd>
	<dt>5 RoomLF (-10000 to 0) default = 0</dt>
	<dd>relative room effect level at low frequencies</dd>
	<dt>6 DecayTime (0.1 to 20.0) default = 1.49</dt>

	<dd>reverberation decay time at mid frequencies</dd>
	<dt>7 DecayHFRatio (0.1 to 2.0) default = 0.83</dt>
	<dd>high-frequency to mid-frequency decay time ratio</dd>
	<dt>8 DecayLFRatio (0.1 to 2.0) default = 1.0</dt>
	<dd>low-frequency to mid-frequency decay time ratio</dd>
	<dt>9 Reflections (-10000 to 1000) default = -2602</dt>

	<dd>early reflections level relative to room effect</dd>
	<dt>10 ReflectionsDelay (0.0 to 0.3) default = 0.007</dt>
	<dd>initial reflection delay time</dd>
	<dt>11 Reverb (-10000 to 2000) default = 200</dt>
	<dd>late reverberation level relative to room effect</dd>
	<dt>12 ReverbDelay (0.0 to 0.1) default = 0.011</dt>

	<dd>late reverberation delay time relative to initial reflection</dd>
	<dt>13 EchoTime (0.075 to 0.250) default = 0.25</dt>
	<dd>echo time</dd>
	<dt>14 EchoDepth (0.0 to 1.0) default = 0.0</dt>
	<dd>echo depth</dd>
	<dt>15 ModulationTime (0.04 to 4.0) default = 0.25</dt>

	<dd>modulation time</dd>
	<dt>16 ModulationDepth (0.0 to 1.0) default = 0.0</dt>
	<dd>modulation depth</dd>
	<dt>17 AirAbsorptionHF (-100 to 0.0) default = -5.0</dt>
	<dd>change in level per meter at high frequencies</dd>
	<dt>18 HFReference (1000.0 to 20000) default = 5000.0</dt>

	<dd>reference high frequency (hz)</dd>
	<dt>19 LFReference (20.0 to 1000.0) default = 250.0</dt>
	<dd>reference low frequency (hz)</dd>
	<dt>20 RoomRolloffFactor (0.0 to 10.0) default = 0.0</dt>
	<dd>like rolloffscale in System::set3DSettings but for reverb room size effect</dd>
	<dt>21 Diffusion (0.0 to 100.0) default = 100.0</dt>

	<dd>Value that controls the echo density in the late reverberation decay.</dd>
	<dt>22 Density (0.0 to 100.0) default = 100.0</dt>
	<dd>Value that controls the modal density in the late reverberation decay</dd>
	<dt>23 Flags default = 63</dt>
	<dd>Bit flags that modify the behavior of above properties<ul>
		<li>1 - 'EnvSize' affects reverberation decay time</li>

		<li>2 - 'EnvSize' affects reflection level</li>
		<li>4 - 'EnvSize' affects initial reflection delay time</li>
		<li>8 - 'EnvSize' affects reflections level</li>
		<li>16 - 'EnvSize' affects late reverberation delay time</li>
		<li>32 - AirAbsorptionHF affects DecayHFRatio</li>
		<li>64 - 'EnvSize' affects echo time</li>

		<li>128 - 'EnvSize' affects modulation time</li>
	</ul></dd>
</dl>

<hr>

<a name=/sound/var/echo>
<h2>echo var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/xyz>x, y, z vars (sound)</a>
<dd><a href=#/sound/var/atom>atom var (sound)</a>
<dd><a href=#/sound/var/environment>environment var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>If set to an 18-element list, this value customizes reverbration settings
for this sound only. A null or non-numeric value for any setting will select
its default. Please see the EAX2 documentation at http://developer.creative.com/
for indepth information about these settings.

<p>Here's a rundown of some of the terms: <b>Direct</b> refers to the amount
of effect when the sound is on a direct path to the listener.
<b>Obstruction</b> is when an object is blocking the direct path but there
are other ways for the sound to reach the listener. <b>Occlusion</b> means
the sound is on the other side of a wall, and mostly blocked.
<b>Exclusion</b> means the sound is on the other side of a wall, but a
doorway or window is allowing it to pass through to the listener. You can use
a little of each of these effects to increase realism.

<dl>
	<dt>1 Direct  (-10,000 to 1,000) default = 0</dt>
	<dd>direct path level (at low and mid frequencies)</dd>
	<dt>2 DirectHF  (-10,000 to 0) default = 0</dt>

	<dd>relative direct path level at high frequencies </dd>
	<dt>3 Room  (-10,000 to 1,000) default = 0</dt>
	<dd>room effect level (at low and mid frequencies)</dd>
	<dt>4 Room HF  (-10,000 to 0) default = 0</dt>
	<dd>relative room effect level at high frequencies</dd>
	<dt>5 Obstruction  (-10,000 to 0) default = 0</dt>

	<dd>main obstruction control (attenuation at high frequencies)</dd>
	<dt>6 ObstructionLFRatio (0.0 to 1.0) default = 0.0</dt>
	<dd>obstruction low-frequency level re. main control</dd>
	<dt>7 Occlusion  (-10,000 to 0) default = 0</dt>
	<dd>main occlusion control (attenuation at high frequencies)</dd>
	<dt>8 OcclusionLFRatio  (0.0 to 1.0) default = 0.25</dt>

	<dd>occlusion low-frequency level re. main control</dd>
	<dt>9 OcclusionRoomRatio  (0.0 to 10.0) default = 1.5</dt>
	<dd>relative occlusion control for room effect</dd>
	<dt>10 OcclusionDirectRatio  (0.0 to 10.0) default = 1.0</dt>
	<dd>relative occlusion control for direct path</dd>
	<dt>11 Exclusion  (-10,000 to 0) default = 0</dt>

	<dd>main exlusion control (attenuation at high frequencies)</dd>
	<dt>12 ExclusionLFRatio  (0.0 to 1.0) default = 1.0</dt>
	<dd>exclusion low-frequency level re. main control</dd>
	<dt>13 OutsideVolumeHF  (-10,000 to 0) default = 0</dt>
	<dd>outside sound cone level at high frequencies</dd>
	<dt>14 DopplerFactor  (0.0 to 10.0) default = 0.0</dt>

	<dd>like DS3D flDopplerFactor but per source</dd>
	<dt>15 RolloffFactor  (0.0 to 10.0) default = 0.0</dt>
	<dd>like DS3D flRolloffFactor but per source</dd>
	<dt>16 RoomRolloffFactor  (0.0 to 10.0) default = 0.0</dt>
	<dd>like DS3D flRolloffFactor but for room effect</dd>
	<dt>17 AirAbsorptionFactor  (0.0 to 10.0) default = 1.0</dt>

	<dd>multiplies AirAbsorptionHF member of environment reverb properties.</dd>
	<dt>18 Flags default = 7</dt>
	<dd>Bit flags that modify the behavior of properties<ul>
		<li>1 - Automatic setting of 'Direct' due to distance from listener</li>
		<li>2 - Automatic setting of 'Room' due to distance from listener</li>
		<li>4 - Automatic setting of 'RoomHF' due to distance from listener</li>
	</ul></dd>
</dl>

<hr>

<a name=/sound/var/atom>
<h2 byondver=516>atom var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/xyz>x, y, and z vars (sound)</a>
<dd><a href=#/sound/var/transform>transform var (sound)</a>
<dd><a href=#/sound/var/falloff>falloff var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>Links this sound to an atom, whose position relative to the
<a href=#/client/var/virtual_eye>vitual eye</a> (center of view), in tiles, is
transformed and added to the 3D x,y,z coordinates. As you move relative to the
atom, the sound's apparent position in 3D space will change without the server
needing to update this sound manually.

<p>This is usually used in conjunction with the
<a class=code href=#/sound/var/transform>transform</a> var, which converts the
2D x,y offset into 3D coordinates. This can scale or rotate the 2D coordinates
however you need.

<p>Note: The atom must remain "in range", meaning the server has to think it's
close enough within visual range to send updates to the client, for the sound
to be heard.

<hr>

<a name=/sound/var/transform>
<h2 byondver=516>transform var (sound)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/sound/var>vars (sound)</a>
<dd><a href=#/sound/var/atom>atom var (sound)</a>
<dd><a href=#/sound/var/xyz>x, y, and z vars (sound)</a>
<dd><a href=#/sound/var/falloff>falloff var (sound)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null (same as <tt>list(1,0,0, 0,1,0, 0,0,0)</tt>)
</dl>

<p>A 3x3 matrix for converting the 2D position of an atom, relative to the
center of view, into 3D sound coordinates. (This value is meaningless if you
don't link the sound to an atom via the <a href=#/sound/var/atom>atom</a>
var.) The transformed vector is added to the sound's x,y,z values to get a
3D position.

<p>The value of <tt>transform</tt> should be a list with 9 elements, in
row-major order. The default list is <tt>list(1,0,0, 0,1,0, 0,0,0)</tt>. If
you use a list shorter than 9 elements, the defaults will be filled in for
you.

<pre>
list(xx,xy,xz, yx,yy,yz, cx,cy,cz)

          |xx xy xz|
[x y 1] x |yx yy yz| = [x' y' z']
          |cx cy cz|
</pre>

<p>In easier-to-understand terms, this is how the result is calculated:

<xmp>
new_x = x * xx + y * yx + cx
new_y = x * xy + y * yy + cy
new_z = x * xz + y * yz + cz
</xmp>

<p>It is helpful to think of each row in the matrix as what each component of
the original vector will become. The first row of the matrix is the output
x,y,z you'll get for an input x of 1.

<h3>Example:</h3>
<xmp>
obj/fire
    proc/HearMe(mob/player)
        var/sound/S = new('fire.ogg', channel=10, repeat=1)
        S.atom = src
        S.transform = list(1,0,0, 0,sqrt(0.5),sqrt(0.5), 0,0,0)
        player << S
</xmp>

<p>The transform in this example rotates the fire's position by 45&deg;
forward, so positive y values get split between y and z. This gives the player
the impression that an object higher up on their screen is both forward of and
above them, as if they're looking down at the map from a 45&deg; angle.

<hr>

<a name=/turf>
<h2>turf</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom>atom</a>
<dd><a href=#/turf/proc>procs (turf)</a>
<dd><a href=#/turf/var>vars (turf)</a>
<dd><a href=#/map>Map</a>
</dl>

<p>Turfs cover the surface of the map.  They are derived from <tt>/turf</tt>
which derives from <tt>/atom</tt>.

<p>This example defines the turf prototype <tt>/turf/floor</tt> and
<tt>/turf/wall</tt>.

<h3>Example:</h3>
<xmp>
turf
  floor
    desc = "A wood plank floor."
  wall
    desc = "A stone wall."
    density = 1
</xmp>

<p>Turfs cannot be moved. They can only be created or destroyed by changing
<tt>world.maxx</tt>, <tt>world.maxy</tt>, or <tt>world.maxz</tt>. When you
create a new turf with <tt>new()</tt>, it always replaces the old one.

<h3>Example:</h3>
<xmp>
// replace old_turf with a wall
var/turf/wall/T = new(old_turf)
</xmp>

<hr>

<a name=/turf/proc>
<h2>procs (turf)</h2>

<p>Built-in turf procs:

<dl><dt>turf/proc
<dd><a href=#/atom/proc/Click>Click</a>
<dd><a href=#/atom/proc/Cross>Cross proc</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc</a>
<dd><a href=#/atom/proc/DblClick>DblClick</a>
<dd><a href=#/datum/proc/Del>Del</a>
<dd><a href=#/atom/proc/Enter>Enter</a>
<dd><a href=#/atom/proc/Entered>Entered</a>
<dd><a href=#/atom/proc/Exit>Exit</a>
<dd><a href=#/atom/proc/Exited>Exited</a>
<dd><a href=#/atom/proc/MouseDown>MouseDown</a>
<dd><a href=#/atom/proc/MouseDrag>MouseDrag</a>
<dd><a href=#/atom/proc/MouseDrop>MouseDrop</a>
<dd><a href=#/atom/proc/MouseEntered>MouseEntered</a>
<dd><a href=#/atom/proc/MouseExited>MouseExited</a>
<dd><a href=#/atom/proc/MouseMove>MouseMove</a>
<dd><a href=#/atom/proc/MouseUp>MouseUp</a>
<dd><a href=#/atom/proc/MouseWheel>MouseWheel</a>
<dd><a href=#/atom/proc/New>New</a>
<dd><a href=#/datum/proc/Read>Read</a>
<dd><a href=#/atom/proc/Stat>Stat</a>
<dd><a href=#/datum/proc/Topic>Topic</a>
<dd><a href=#/datum/proc/Write>Write</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc</a>
</dl>

<hr>

<a name=/turf/var>
<h2>vars (turf)</h2>

<p>Built-in turf vars:

<dl><dt>turf/var
<dd><a href=#/atom/var/alpha>alpha</a>
<dd><a href=#/atom/var/appearance>appearance</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags</a>
<dd><a href=#/atom/var/blend_mode>blend_mode</a>
<dd><a href=#/atom/var/color>color</a>
<dd><a href=#/atom/var/contents>contents</a>
<dd><a href=#/atom/var/density>density</a>
<dd><a href=#/atom/var/desc>desc</a>
<dd><a href=#/atom/var/dir>dir</a>
<dd><a href=#/atom/var/filters>filters</a>
<dd><a href=#/atom/var/gender>gender</a>
<dd><a href=#/atom/var/icon>icon</a>
<dd><a href=#/atom/var/icon_state>icon_state</a>
<dd><a href=#/atom/var/icon_w>icon_w</a>
<dd><a href=#/atom/var/icon_z>icon_z</a>
<dd><a href=#/atom/var/invisibility>invisibility</a>
<dd><a href=#/atom/var/underlays>underlays</a>
<dd><a href=#/atom/var/overlays>overlays</a>
<dd><a href=#/atom/var/loc>loc</a>
<dd><a href=#/atom/var/layer>layer</a>
<dd><a href=#/atom/var/luminosity>luminosity</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
<dd><a href=#/atom/var/mouse_drop_zone>mouse_drop_zone var</a>
<dd><a href=#/atom/var/mouse_opacity>mouse_opacity var</a>
<dd><a href=#/atom/var/name>name</a>
<dd><a href=#/atom/var/opacity>opacity</a>
<dd><a href=#/turf/var/parent_type>parent_type</a>
<dd><a href=#/atom/var/pixel_x>pixel_x</a>
<dd><a href=#/atom/var/pixel_y>pixel_y</a>
<dd><a href=#/atom/var/pixel_w>pixel_w</a>
<dd><a href=#/atom/var/pixel_z>pixel_z</a>
<dd><a href=#/atom/var/plane>plane</a>
<dd><a href=#/atom/var/render_source>render_source</a>
<dd><a href=#/atom/var/render_target>render_target</a>
<dd><a href=#/atom/var/suffix>suffix</a>
<dd><a href=#/datum/var/tag>tag</a>
<dd><a href=#/atom/var/text>text</a>
<dd><a href=#/atom/var/transform>transform</a>
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/atom/var/verbs>verbs</a>
<dd><a href=#/atom/var/vis_contents>vis_contents</a>
<dd><a href=#/atom/var/vis_flags>vis_flags</a>
<dd><a href=#/atom/var/vis_locs>vis_locs</a>
<dd><a href=#/atom/var/x>x</a>
<dd><a href=#/atom/var/y>y</a>
<dd><a href=#/atom/var/z>z</a>
</dl>

<hr>

<a name=/turf/var/parent_type>
<h2>parent_type var (turf)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/var/parent_type>parent_type var</a>
</dl>

<p>The default parent_type of <a href=#/turf>/turf</a> is <a href=#/atom>/atom</a>.

<hr>

<a name=/var>
<h2>vars</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/operator/path>path operators</a>
<dd><a href=#/atom/var>vars (atom)</a>
<dd><a href=#/client/var>vars (client)</a>
<dd><a href=#/datum/var>vars (datum)</a>
<dd><a href=#/mob/var>vars (mob)</a>
</dl>

<p>Variables are derived from var.

<dl><dt><b>Variable Declaration Format:</b>
<dd>var/Type/Name = Value
<dd>var Type/Name = Value
</dl>

<p>Value defaults to null.

<dl><dt>The hard-coded types are:
<dd><a href=#/datum>datum</a> (ancestor of all objects)
<dd><a href=#/atom>atom</a>   (all mappable objects)
<dd><a href=#/atom/movable>atom/movable</a> (objs and mobs)
<dd><a href=#/obj>obj</a>
<dd><a href=#/mob>mob</a>
<dd><a href=#/turf>turf</a>
<dd><a href=#/area>area</a>
<dd><a href=#/savefile>savefile</a>
<dd><a href=#/client>client</a>
<dd><a href=#/list>list</a>
<dd><a href=#/world>world</a>
</dl>

<dl><dt>Type modifiers:
<dd><a href=#/var/global>global</a>
<dd><a href=#/var/const>const</a>
<dd><a href=#/var/tmp>tmp</a>
<dd><a href=#/var/final>final</a>
</dl>

<p>User types may be derived from anything except for <tt>/world</tt>,
<tt>/list</tt>, <tt>/client</tt>, and <tt>/savefile</tt>.

<hr>

<a name=/var/const>
<h2>const vars</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/var>vars</a>
</dl>

<p>The const type modifier defines a constant value.  This may be useful for
centralizing the location of a value that is used repeatedly so that it can be
easily configured.  It has the advantage over #define macros of obeying the
normal scope rules for variables.  This means, for example, that a const
variable declared inside a proc will not conflict with other variables
declared elsewhere.

<h3>Example:</h3>
<xmp>
mob
    var/const/max_items = 100

    Enter(O)
        if(src.contents.len >= src.max_items)
            return 0
        return ..()
</xmp>

<p>This example defines an upper limit on the number of items a mob may
carry.

<hr>

<a name=/var/final>
<h2 byondver=515>final vars</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/var>vars</a>
<dd><a href=#/var/const>const vars</a>
<dd><a href=#/var/global>global vars</a>
<dd><a href=#/var/tmp>tmp vars</a>
</dl>

<p>The final type modifier indicates that a variable should not be
overridden by a subtype or another compile-time assignment statement.

<p>This modifier also applies to procs. A final proc may not be
overridden.

<hr>

<a name=/var/global>
<h2>global vars</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/var>vars</a>
</dl>

<p>The global type modifier makes a var permanent and shared.  This means
only one copy of the var is maintained.  Otherwise, separate copies of the
var are maintained for each instance containing the var (be it a proc, mob,
obj, etc.)

<h3>Example:</h3>
<xmp>
mob/proc/Counter()
  var/global/count
  src << "Count = [++count]"
</xmp>

<p>This example increases the count each time the proc is called.  If count
were not declared global, the displayed count would be 1 every time.

<hr>

<a name=/var/tmp>
<h2>tmp vars</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/savefile>savefile</a>
<dd><a href=#/var>vars</a>
</dl>

<p>The tmp type modifier indicates that an object variable should not be
automatically written to the save file.  This could mean that the variable
is transient&mdash;that is, it is calculated at run-time and need not be
saved. It could also indicated that the designer will handle saving of that
variable specially and wishes to bypass the automated routine.

<p>It is especially important to use tmp when you have references to
external objects that should not be saved along with the object.  For
example, suppose players have a <var>leader</var> variable which indicates
who or what they are following.  You would not necessarily want the leader
to be saved in the player's savefile.  Therefore, you would need to use
<code>tmp</code> when defining the variable.

<h3>Example:</h3>
<xmp>
mob
   var/tmp
      leader
   verb
      follow(mob/M)
         leader = M
</xmp>

<div class="sidebar note">
<p>Accidentally saving another mob in your savefile can be disastrous. This
can happen if you save a turf that the mob is standing on, or if you save an
obj with a non-tmp var that points to that mob, and many other ways.

<p>The reason this is a problem is that another player's mob will have the
<tt>key</tt> var set already. When that mob is loaded, if they are already
logged into the game they will be immediately reassigned to that just-loaded,
older mob with a <tt>Login()</tt> call, while the mob they're supposed to
be using will have <tt>Logout()</tt> called. Thus they'll appear to
"rollback" to an earlier state.

<p>If your game accidentally falls into this trap, don't panic! You can
look at your savefiles via <a class=code href=#/savefile/ImportText>ImportText()</a>
or in an editor to see which var is the problem. Once you change that var to
<tt>/tmp</tt>, you can override <a class=code href=#/datum/proc/Read>Read()</a>
so if that var is present, you can remove it before calling <tt>..()</tt> to
finish loading.
</div>

<dl><dt>The following built-in variables are defined as tmp vars:
<dd><a href=#/datum/var/type>type</a>
<dd><a href=#/datum/var/parent_type>parent_type</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/atom/var/verbs>verbs</a>
<dd><a href=#/mob/var/group>group</a>
<dd><a href=#/atom/var/loc>loc</a>
<dd><a href=#/atom/var/locs>locs</a>
<dd><a href=#/atom/var/vis_locs>vis_locs</a>
<dd><a href=#/atom/var/x>x</a>
<dd><a href=#/atom/var/y>y</a>
<dd><a href=#/atom/var/z>z</a>
<dd><a href=#/mob/var/ckey>ckey</a>
<dd><a href=#/atom/var/visibility>visibility</a>
<dd><a href=#/atom/movable/var/bound_x>bound_x</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height</a>
<dd><a href=#/atom/var/mouse_over_pointer>mouse_over_pointer</a>
<dd><a href=#/atom/var/mouse_drag_pointer>mouse_drag_pointer</a>
<dd><a href=#/atom/var/mouse_drop_pointer>mouse_drop_pointer</a>
</dl>

<hr>

<a name=/vector>
<h2 byondver=516>vector</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/proc>procs (vector)</a>
<dd><a href=#/vector/var>vars (vector)</a>
<dd><a href=#/pixloc>pixloc</a>
<dd><a href=#/operator>operators</a>
<dd><a href=#/matrix>matrix</a>
</dl>

<p>A primitive value representing a numeric vector in 2 or 3 dimensions. That
is, a 2D vector has x and y components, and a 3D vector has x, y, and z
components.

<p>Vectors are primarily useful for physics and distance calculations.

<p>Vectors can be treated as a list for purposes of using the indexing
<tt>[]</tt> operator, or a for loop. The <tt>len</tt> var is the number of
components in the list, just like a regular list.

<p>Vectors support most math operations. Multiplication and division can be
done with either a single number or a vector; the latter will act piecewise
on each component, just like addition and subtraction do.

<p>When doing math on two vectors of different dimensions, the result will
use the highest dimensionality. E.g., adding a 2D and 3D vector produces a 3D
vector.

<p>Other supported procs for vectors include:

<dl>
  <dt><a class=code href=#/proc/min>min()</a>
  <dt><a class=code href=#/proc/max>max()</a>
  <dt><a class=code href=#/proc/clamp>clamp()</a>
  <dt><a class=code href=#/proc/round>round()</a>
  <dt><a class=code href=#/proc/floor>floor()</a>
  <dt><a class=code href=#/proc/ceil>ceil()</a>
  <dt><a class=code href=#/proc/trunc>trunc()</a>
  <dt><a class=code href=#/proc/fract>fract()</a>
</dl>

<hr>

<a name=/vector/proc>
<h2 byondver=516>procs (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<p>Built-in vector procs:

<dl><dt>vector/proc
<dd><a href=#/vector/proc/Cross>Cross</a>
<dd><a href=#/vector/proc/Dot>Dot</a>
<dd><a href=#/vector/proc/Interpolate>Interpolate</a>
<dd><a href=#/vector/proc/Normalize>Normalize</a>
<dd><a href=#/vector/proc/Turn>Turn</a>
</dl>

<hr>

<a name=/vector/proc/Cross>
<h2 byondver=516>Cross proc (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A.Cross(vector/B)
</dl>

<dl><dt><b>Returns:</b>
<dd>The cross product of the two vectors, which is another vector.
</dl>

<p>This proc treats both vectors as 3D.

<p>The cross product of two 3D vectors is a third vector that is orthogonal
to them both. The length is the product of the length of both vectors and the
sine of the angle between them.

<p>The cross product depends on the order of the two vectors. If you switch
their order, you get the negative result.

<hr>

<a name=/vector/proc/Dot>
<h2 byondver=516>Dot proc (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A.Dot(B)
</dl>

<dl><dt><b>Args:</b>
<dd>B: The other vector.
</dl>

<dl><dt><b>Returns:</b>
<dd>The dot product of the two vectors.
</dl>

<p>The dot product of two vectors is determined by multiplying each component
in the first vector by its matching component in the second, and adding those
multiples together. For instance in a 2D vector, the dot product of A and B
is:

<xmp>dot = A.x * B.x + A.y * B.y</xmp>

<p>The dot product is equal to the product of the magnitude of the two vectors
and the cosine of the angle between them.

<xmp>dot = A.size * B.size * cos(angle)</xmp>

<hr>

<a name=/vector/proc/Interpolate>
<h2 byondver=516>Interpolate proc (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A.Interpolate(B, t)
</dl>

<dl><dt><b>Args:</b>
<dd>B: The other vector to interpolate with.
<dd>t: The interpolation factor: from 0 (A) to 1 (B). Usually this is a value between 0 and 1.
</dl>

<dl><dt><b>Returns:</b>
<dd>A new vector interpolated between A and B.
</dl>

<p>Returns the equivalent of <tt>A + (B-A) * t</tt>.

<p>There is special handling for a case of <tt>t=1</tt> to avoid rounding
errors.

<hr>

<a name=/vector/proc/Normalize>
<h2 byondver=516>Normalize proc (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/var/size>size var (vector)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>V.Normalize()
</dl>

<dl><dt><b>Returns:</b>
<dd>The same vector, after normalizing it to a unit vector.
</dl>

<p>Modifies the vector to make it a unit vector. This is the same as setting
its <tt>size</tt> var to 1.

<p>A degenerate vector such as 0,0,0 cannot be normalized; it will be
unchanged by this call.

<hr>

<a name=/vector/proc/Turn>
<h2 byondver=516>Turn proc (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/turn/vector>turn proc (applied to a vector)</a>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>A.Turn(angle)
<dd>A.Turn(B)
</dl>

<dl><dt><b>Args:</b>
<dd>angle: An angle to turn a vector clockwise in 2D.
<dd>B: A vector to rotate around (right-hand rule).
</dl>

<dl><dt><b>Returns:</b>
<dd>The vector A, after rotating it.
</dl>

<p>This proc modifies the source vector. For legacy reasons, it rotates
in the opposite direction of the built-in <tt>turn()</tt> proc.

<p>All angles are in degrees.

<p>When the argument is an angle, the source vector A is rotated in 2
dimensions clockwise.

<p>When the argument is a vector, the source vector A is rotated in 3
dimensions around vector B using the right-hand rule (thumb pointed in the
direction of B, rotation following curled fingers). The angle of rotation is
the length of B, in degrees.

<hr>

<a name=/vector/var>
<h2 byondver=516>vars (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/proc/vector>vector proc</a>
<dd><a href=#/vector/proc>procs (vector)</a>
</dl>

<p>Built-in vector vars:

<dl><dt>vector/var
<dd><a href=#/vector/var/len>len</a>
<dd><a href=#/vector/var/size>size</a>
<dd><a href=#/vector/var/x>x</a>
<dd><a href=#/vector/var/y>y</a>
<dd><a href=#/vector/var/z>z</a>
</dl>

<hr>

<a name=/vector/var/len>
<h2 byondver=516>len var (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/length>length proc</a>
<dd><a href=#/vector>vector</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<p>The dimensionality (number of components) of this vector. Can be 2 or 3.
This value can be changed.

<p>Most math operations on a vector will expand the result to the same
dimension as the largest operand.

<hr>

<a name=/vector/var/size>
<h2 byondver=516>size var (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<p>The magnitude of this vector. Magnitude is the square root of
the summed-up squares of all its components. For instance in 3D:

<p>size = x*x + y*y + z*z

<p><tt>V.size</tt> is the same as <tt>sqrt(V.Dot(V))</tt>.

<p>This value can be set at runtime, so setting <tt>size = 1</tt> will
normalize the vector.

<p>If the size is already 0, as in the case of a degenerate vector like 0,0,
then changing this value will have no effect.

<hr>

<a name=/vector/var/x>
<h2 byondver=516>x var (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<p>The x component of this vector.

<hr>

<a name=/vector/var/y>
<h2 byondver=516>y var (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<p>The y component of this vector.

<hr>

<a name=/vector/var/z>
<h2 byondver=516>z var (vector)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/vector>vector</a>
<dd><a href=#/vector/var>vars (vector)</a>
</dl>

<p>The z component of this vector.

<hr>

<a name=/verb>
<h2>verbs</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/arguments>arguments (verb)</a>
<dd><a href=#/verb/set>settings (verb)</a>
<dd><a href=#/verb/var>vars (verbs)</a>
<dd><a href=#/proc/var/src>src var (proc)</a>
<dd><a href=#/proc/var/usr>usr var (proc)</a>
</dl>

<p>Verbs may be attached to mobs, objs, turfs, and areas.  Players can then
use them as commands if they have access to the source.

<p>Verbs are fundamentally the same "type" as procs, so their vars are the
same.

<h3>Example:</h3>
<xmp>
mob/verb/poof()
  world << "POOF!"
</xmp>

<p>Whenever a player in the world types the command "poof", this verb will
be invoked.

<p>In addition to the normal access control (see the verb src setting) verbs
can be dynamically added and removed from objects.  One way to do this is to
use new() with the following syntax:

<xmp>
new verb_path(Destination,Name,Desc)
</xmp>

<p>The Destination specifies the object to receive the verb.  Name and Desc
optionally specify a new name and description for the verb.

<h3>Example:</h3>
<xmp>
mob/DM/verb/kill(mob/M)
  del(M)

mob/DM/verb/give_kill_verb(mob/M)
  new/mob/DM/verb/kill(M)
</xmp>

<p>This example defines two verbs (accessible to mobs of type /mob/DM).  One
verb kills other mobs.  The other adds the kill verb to another mob (giving
the second mob the ability to kill).

<p>In some situations, the ability to dynamically change an object's verb
list is quite useful, but most of the time it is far more convenient to do
the same thing by manipulating objects rather than verbs directly.  For
example, the previous example can be handled by having an object with the
kill verb attached it it.  Then players have greater versatility in
manipulating the verb by simply moving the object around.

<h3>Example:</h3>
<xmp>
obj/scroll/kill/verb/kill(mob/M)
  set src = usr.contents //implicit src
  del(M)
</xmp>

<p>The use of an implicit verb source in this example gives the user access
to the kill verb without having to specify the source scroll as long as the
scroll exists in the user's inventory.  In other words, the player types
"kill rat" rather than "kill kill rat".

<hr>

<a name=/verb/arguments>
<h2>arguments (verb)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/arguments/expanding>argument expanding</a>
<dd><a href=#/client/var/command_text>command_text (client)</a>
<dd><a href=#/proc/arglist>arglist proc</a>
<dd><a href=#/verb/var/args>args var (verb)</a>
</dl>

<p>The parameters to a verb are referred to as arguments.  For verbs, the
input type and possible value list may also be specified.

<p>The possible input types are:

<pre>
text          // a quoted text string
password      // un-echoed text (for use with input() only)
message       // multi-line text
command_text  // raw command text from the rest of the input line
num           // a number
icon          // an icon file from the user's computer
sound         // a sound file from the user's computer
file          // any type of file from the user's computer
key           // a key from the user's BYOND key file
color         // a color (see <a href=#/proc/rgb>rgb proc</a>)
null          // indicates that the argument is optional

mob
obj
turf
area
anything
</pre>

<p>These can be combined with the '|' operator.  The first group are called
<EM>constant</EM> input types because they turn on various types of literal
values that the user can type in (like a number or a text string).  The
second group work in conjunction with a list of objects or values.  They are
called input type <EM>filters</EM> because they may be used to filter out
certain types of values from the list.  For example a mob or an obj within
sight would be specified as follows:

<xmp>
myverb(M as mob|obj in view()) {...}
</xmp>

<p>A default value may be specified which takes effect in the case of null
arguments.  For example:

<xmp>
myverb(M=usr as null|mob|obj in view()) {...}
</xmp>

<p>In this example, the input type <code>null</code> did not have to be used
explicitly, because assigning a default value (in this case
<code>usr</code>) turns it on by default.

<p>The <code>anything</code> input type can be used to combine values in a
list with other constant input types.  Here, this is done with the
<code>null</code> input type:

<xmp>
set_aggression(a="on" as null|anything in list("on","off"))
</xmp>

<p>For input types containing mob, obj, turf, or area, the possible value
list defaults to view().

<p>If no input type is specified, the variable type will be used to
determine whether it is a mob, obj, turf, or area.

<h3>Example:</h3>
<xmp>
mob/verb/tell(mob/M,msg as text)
  M << "[usr] tells you, /"[msg]/""
</xmp>

<p>This example defines a verb with two arguments: a target mob, and some
text.

<hr>

<a name=/verb/arguments/expanding>
<h2>argument expanding</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/arguments>arguments (verb)</a>
</dl>

<p>The expression used to to provide a list of possible values for a verb
argument may reference the value of arguments prior to the one being
expanded.  It may even reference the value of the argument being expanded,
but this will always be a text string equal to what the user has typed so
far.

<p>In addition, there is a special variable called "expanding" which is only
accessible in this context.  It is 1 if the user's input is being expanded
and 0 if the user's final input is being validated.  In certain rare cases,
you may wish to tell the difference between these two cases.  For example,
you could use this to have possible values which do not show up in the
expansion lists, but which are accepted when typed in full.

<h3>Example:</h3>

<xmp>
mob/verb/test(A in MyProc(A,expanding))
   usr << "You typed: [A]"

proc/MyProc(A,expanding)
   var/values[] = list("one","two","three")
   if(!expanding) values += "secret"
   return values
</xmp>

<hr>

<a name=/verb/set>
<h2>settings (verb)</h2>

<p>verb settings:

<code><pre>
verb/set
  <a href=#/verb/set/name>name</a>
  <a href=#/verb/set/desc>desc</a>
  <a href=#/verb/set/category>category</a>
  <a href=#/verb/set/hidden>hidden</a>
  <a href=#/verb/set/popup_menu>popup_menu</a>
  <a href=#/verb/set/instant>instant</a>
  <a href=#/verb/set/invisibility>invisibility</a>
  <a href=#/verb/set/src>src</a>
  <a href=#/proc/set/background>background</a>
</pre></code>

<p>Procs and verbs are the same "type" so these attributes may be set for
procs as well; most of them do not have any meaning, however, unless the proc
is invoked as a verb (by adding it to a verb list).

<hr>

<a name=/verb/set/category>
<h2>category setting (verb)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/default_verb_category>default_verb_category var (client)</a>
<dd><a href=#/client/var/show_verb_panel>show_verb_panel var (client)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>set category = "Category"
</dl>

<dl><dt><b>Args:</b>
<dd>Category: A text string for the category.
</dl>

<p>Verbs in the same category are visually grouped together in the verb
panels.  The default is "", which is displayed in the default panel titled
"Commands".  You can change that default by setting
<code>client/default_verb_category</code>.

<p>To hide a verb from all panels, set the category to null.  The verb may
still show up in right-click popup menus, so you may want to use the
<a href=#/verb/set/hidden>hidden</a> or <a href=#/verb/set/popup_menu>popup_menu</a>
verb properties instead.

<hr>

<a name=/verb/set/desc>
<h2>desc setting (verb)</h2>

<dl><dt><b>Format:</b>
<dd>set desc = "Description"
</dl>

<dl><dt><b>Args:</b>
<dd>Description: A text string containing the help text.
</dl>

<p>The desc attribute sets the descriptive help string for the verb.  The
player may access this by hitting the 'F1' key after entering the command.
This will normally produce a list of each argument by type followed by the
desc text.  If you wish to override the syntax description, put your
modified version inside parentheses at the beginning of the desc text.

<h3>Example:</h3>
<xmp>
mob/verb/tell(mob/M,T as text)
   set desc = "(target,message) Talk privately to someone."
   M << "[usr] tells you, '[T]"
</xmp>

<p>This will produce the help text:

<xmp>
usage: tell target message (Talk privately to someone.)
</xmp>

<p>If the syntax description had not been supplied, it would have produced:

<xmp>
usage: tell mob "text" (Talk privately to someone.)
</xmp>

<hr>

<a name=/verb/set/hidden>
<h2>hidden setting (verb)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/category>category setting (verb)</a>
<dd><a href=#/verb/set/invisibility>invisibility setting (verb)</a>
<dd><a href=#/verb/set/name>name setting (verb)</a>
<dd><a href=#/verb/set/popup_menu>popup_menu setting (verb)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>set hidden = Setting
</dl>

<dl><dt><b>Args:</b>
<dd>Setting: 1 for hidden verbs; 0 otherwise.
</dl>

<p>A hidden verb is not visible to players (in menus or in expansion lists)
but if typed in full can still be accessed.

<p>An alternate way to hide a verb from the command-line and verb panels is to
make "." the first character in the name.  The verb will not show up in
command-expansion (ie when hitting spacebar) until the "." has been typed.
This could be useful for hiding verbs that would otherwise clutter up the verb
list, while still making them relatively easy to use.  If you think this is a
random quirky feature, you are right.  To put "." in front of the name, use the
<a href=#/verb/set/name>name setting</a>.

<hr>

<a name=/verb/set/instant>
<h2>instant setting (verb)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set>settings (verb)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>set instant = Setting
</dl>

<dl><dt><b>Args:</b>
<dd>Setting: 1 for "instant" verbs; 0 otherwise.
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Normally a player can only call one verb per tick, but they can call any
number of "instant" verbs in the same tick. This setting is useful for commands
called by the game's interface, or for more responsive controls like for
instance the use of "combos" in fighting games.

<p>Verbs with the instant setting can be used on the same tick as a regular
verb, but only one regular verb can be used each tick. Instant commands will
jump ahead of non-instant commands in the queue.

<p>Any verbs that are already built-in, such as movement commands, cannot be
modified to use this setting. (Some, such as mouse commands, already use it.)
You can, however, create replacement verbs of your own for most of them.

<h3>Example:</h3>
<xmp>
mob/verb/FastNorth()
  set instant = 1
  usr.Move(get_step(usr,NORTH), NORTH)
</xmp>

<hr>

<a name=/verb/set/invisibility>
<h2>invisibility setting (verb)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/hidden>hidden setting (verb)</a>
<dd><a href=#/atom/var/invisibility>invisibility var (atom)</a>
<dd><a href=#/mob/var/sight>sight var (mob)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>set invisibility = Setting
</dl>

<dl><dt><b>Args:</b>
<dd>Setting: 0 to 100
</dl>

<dl><dt><b>Default value:</b>
<dd>same as invisibility of the source object.
</dl>

<p>An invisible verb is only accessible to players who can see invisible
objects.  This is different from a hidden verb which does not clutter up the
verb list but which is still accessible when typed in full.

<hr>

<a name=/verb/set/name>
<h2>name setting (verb)</h2>

<dl><dt><b>Format:</b>
<dd>set name = "Name"
</dl>

<dl><dt><b>Args:</b>
<dd>Name: A text string for the name.
</dl>

<p>The name attribute of a verb defaults to the node name.  Setting the name
attribute explicitly may be necessary if the name includes characters not
allowed in node names.

<hr>

<a name=/verb/set/popup_menu>
<h2>popup_menu setting (verb)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/verb/set/category>category setting (verb)</a>
<dd><a href=#/verb/set/hidden>hidden setting (verb)</a>
<dd><a href=#/verb/set/invisibility>invisibility setting (verb)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>set popup_menu = Setting
</dl>

<dl><dt><b>Args:</b>
<dd>Setting: 1 (default) for showing this verb in the popup menus; 0 otherwise.
</dl>

<p>Use this to prevent a verb from showing up in the popup "context" menu when
users right-click on objects.

<hr>

<a name=/verb/set/src>
<h2>src setting (verb)</h2>

<dl><dt><b>Format:</b>
<dd>set src in List
<dd>set src = List
</dl>

<dl><dt><b>Args:</b>
<dd>List: One of view(), oview(), world, world.contents, usr, usr.contents,
     usr.loc, or usr.group
</dl>

<p>With the first format, if src is in List for a particular player, then
that player will have access to the proc.  The player must explicitly
specify the name of the source on the command line.

<p>The second format behaves the same, except the source is not read from
the command line.  If more than one possible source exists, one will be
chosen at random.

<p>When usr or world is specified for the first format, it will be expanded
to usr.contents and world.contents respectively.

<p>The default setting depends on the type of src:

<xmp>
mob: src = usr
obj: src in usr // short for usr.contents
turf: src = view(0)
area: src = view(0)
</xmp>

<h3>Example:</h3>
<xmp>
obj/verb/examine()
  set src in view()
  usr << "You examine [src]."
</xmp>

<h3>Example:</h3>
<xmp>
obj/MagicCloak/verb/disappear()
  set src = usr.contents

  usr.invisibility = 1
  view() << "[usr] disappears!"
</xmp>

<hr>

<a name=/verb/set/visibility>
<h2>visibility setting (verb)</h2>

<dl><dt><b>See:</b>
<dd><a href=#/verb/set/invisibility>invisibility setting (verb)</a>
</dl>

<p>The function of this variable has been replaced by
<code>invisibility</code>, which provides a full range of settings.

<hr>

<a name=/verb/var>
<h2>vars (verbs)</h2>
<dl><dt><b>See:</b>
<dd><a href=#/proc/var>vars (procs)</a>
</dl>

<hr>

<a name=/verb/var/%2e toc=".">
<h2>. var (verb)</h2>

<dl><dt><b>See:</b>
<dd><a href=#/proc/var/%2e>. var (proc)</a>
</dl>

<hr>

<a name=/verb/var/args>
<h2>args list var (verb)</h2>
<dl><dt><b>See:</b>
<dd><a href=#/proc/var/args>args list var (proc)</a>
</dl>

<hr>

<a name=/verb/var/src>
<h2>src var (verb)</h2>
<dl><dt><b>See:</b>
<dd><a href=#/proc/var/src>src var (proc)</a>
</dl>

<hr>

<a name=/verb/var/usr>
<h2>usr var (verb)</h2>
<dl><dt><b>See:</b>
<dd><a href=#/proc/var/usr>usr var (proc)</a>
</dl>

<hr>

<a name=/world>
<h2>world</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc>procs (world)</a>
<dd><a href=#/world/var>vars (world)</a>
</dl>

<p>The world node is used to define some global properties for the world.
Like the other types, the world has overridable vars and procs.  New vars
and procs cannot be defined under world though; to make global vars and
procs, use /var and /proc instead.

<hr>

<a name=/world/proc>
<h2>procs (world)</h2>

<p>Built-in world procs:

<dl><dt>world/proc
<dd><a href=#/world/proc/AddCredits>AddCredits</a>
<dd><a href=#/world/proc/ClearMedal>ClearMedal</a>
<dd><a href=#/world/proc/Del>Del</a>
<dd><a href=#/world/proc/Export>Export</a>
<dd><a href=#/world/proc/GetConfig>GetConfig</a>
<dd><a href=#/world/proc/GetCredits>GetCredits</a>
<dd><a href=#/world/proc/GetMedal>GetMedal</a>
<dd><a href=#/world/proc/GetScores>GetScores</a>
<dd><a href=#/world/proc/Import>Import</a>
<dd><a href=#/world/proc/IsBanned>IsBanned</a>
<dd><a href=#/world/proc/IsSubscribed>IsSubscribed</a>
<dd><a href=#/world/proc/New>New</a>
<dd><a href=#/world/proc/OpenPort>OpenPort</a>
<dd><a href=#/world/proc/PayCredits>PayCredits</a>
<dd><a href=#/world/proc/Profile>Profile</a>
<dd><a href=#/world/proc/Reboot>Reboot</a>
<dd><a href=#/world/proc/Repop>Repop</a>
<dd><a href=#/world/proc/SetConfig>SetConfig</a>
<dd><a href=#/world/proc/SetMedal>SetMedal</a>
<dd><a href=#/world/proc/SetScores>SetScores</a>
<dd><a href=#/world/proc/Tick>Tick</a>
<dd><a href=#/world/proc/Topic>Topic</a>
</dl>

<hr>

<a name=/world/proc/AddCredits>
<h2 byondver=503>AddCredits proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/GetCredits>GetCredits proc (world)</a>
<dd><a href=#/world/proc/PayCredits>PayCredits proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>AddCredits(player, credits, note)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the credits were added successfully, 0 or null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>player: a mob, client, key, or ckey
<dd>credits: A number of credits to add to the player's account
<dd>note: An optional note (for author purposes) for the credit change
</dl>

<p>Adds credits to a player's account. The proc will return 1 if it is
successful, or 0 if the attempt failed and should not be tried again. This
feature is intended for games that make use of the credit system, and for
security all such games must use a hub password.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is a good idea to use spawn() to avoid holding up the rest of
the game.

<h3>Example:</h3>
<xmp>
mob/proc/QuestCompleted(name, credits)
    src << "Congratulations! You completed the [name] quest and earned [credits] credit\s!"
    world.AddCredits(name, credits, "Quest: [name]")
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/ClearMedal>
<h2>ClearMedal proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/GetMedal>GetMedal proc (world)</a>
<dd><a href=#/world/proc/SetMedal>SetMedal proc (world)</a>
<dd><a href=#/world/proc/GetScores>GetScores proc (world)</a>
<dd><a href=#/world/proc/SetScores>SetScores proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>ClearMedal(medal, player)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the medal was rescinded successfully, 0 or null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>medal: name of the medal being rescinded
<dd>player: a mob, client, key, or ckey
</dl>

<p>Removes a medal from a player. The proc will return 1 if it is successful, or
0 if the medal was not already awarded. If the world already knows this medal was
not earned, the hub will not be contacted.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is a good idea to use spawn() to avoid holding up the rest of
the game.

<h3>Example:</h3>
<xmp>
mob/NPC
   Die(mob/killer)  // assume Die() is a proc all mobs have
      spawn()
         if(ismob(killer) && killer.key)
            world.ClearMedal("Pacifist", killer)
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/Del>
<h2>Del proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/datum/proc/Del>Del proc (datum)</a>
<dd><a href=#/proc/shutdown>shutdown proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Del()
</dl>

<dl><dt><b>When:</b>
<dd>Called when the world is shutdown.
</dl>

<dl><dt><b>Default action:</b>
<dd>Shutdown the world.
</dl>

<p>When the world is destroyed, only the Del() proc of the <code>world</code>
object is called automatically.  If you want to delete any other objects, you
must do so from within <code>world/Del()</code>.  Once this procedure returns,
any other procedures which may still be executing are immediately aborted and
all objects are silently destroyed.

<p>To prevent accidental hangs during <code>world/Del()</code> from preventing
shutdown, a timeout is applied to any sleeping operations such as
<code>sleep</code>, <code>world.Export()</code>, and so on.  If the total time
slept exceeds the timeout, <code>world/Del()</code> is aborted.  Currently,
this timeout is set at 30 seconds.

<hr>

<a name=/world/proc/Error>
<h2 byondver=508>Error proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/try>try and catch statements</a>
<dd><a href=#/proc/throw>throw statement</a>
<dd><a href=#/exception>exception</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Error(exception)
</dl>

<dl><dt><b>Args:</b>
<dd>exception: The error that was thrown. If this was a runtime error, the value will be an /exception datum.
</dl>

<p>Called when a runtime error happens, or the throw keyword is used, without
a try/catch to handle it. The return value is ignored.

<hr>

<a name=/world/proc/Export>
<h2>Export proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/Export>Export proc (client)</a>
<dd><a href=#/world/proc/Import>Import proc (world)</a>
<dd><a href=#/world/proc/Topic>Topic proc (world)</a>
<dd><a href=#/proc/link>link proc</a>
<dd><a href=#/proc/shutdown>shutdown proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Export(Addr,File,Persist,Clients)
</dl>

<dl><dt><b>When:</b>
<dd>Call this to send a message to another server.  The message may be
     composed of an optional topic text string (in the address) and an
     optional file.  This will call world.Topic() on the remote server,
     which may in turn call world.Import() to access the file.
</dl>

<dl><dt><b>Args:</b>
<dd>Addr: The address of the recipient server.  It should be in the form
     byond://server?topic.  The topic portion is optional.
<dd>File: The (optional) file to send.  This could be a cache file (in
     single quotes) an external file (in double quotes) or a savefile.
<dd>Persist: Set to 1 to indicate that the server should keep this connection
open, to expedite subsequent calls to the same address.  An open connection can
be closed at a later time by passing 0 in the Persist field.
<dd>Clients: An optional client, or list of clients, to tell the receiver
about.
</dl>

<dl><dt><b>Default action:</b>
<dd>Send the topic text string and file to the remote server and return the
     result of calling world.Topic() there.  Note that this will cause the
     caller to sleep while waiting for the necessary data to be transfered.
</dl>

<h3>Example:</h3>
<xmp>
mob/verb/shout(Msg as text)
  world << Msg
  world.Export("[ShadowWorld]?shout:[Msg]")
</xmp>

<p>This example defines a verb that will broadcast a message to everyone in
this world as well as sending it in the form of topic text to another world
whose address is stored in the variable ShadowWorld.  This address could be
manually set or could be the result of calling startup().

<p>It is also possible to access an HTTP server via world.Export().  Simply
use an http address such as: <tt>http://www.byond.com</tt>.  This returns a
list of HTTP header parameters as well as the extra values "STATUS" and
"CONTENT". The value associated with the "STATUS" entry is the HTTP status
code returned by the web server (as text). The value associated with the
"CONTENT" entry is the requested resource.

<h3>Example:</h3>
<xmp>
mob/verb/test()
  var/http[] = world.Export("http://www.byond.com")

  if(!http)
    usr << "Failed to connect."
    return

  usr << "HTTP Header:"
  for(var/V in http)
    usr << "[V] = [http[V]]"

  usr << "\n"

  var/F = http["CONTENT"]
  if(F)
    usr << html_encode(file2text(F))
</xmp>

<p>Note that the HTTP request is submitted using the GET method as opposed to
the POST method.  Support for POST may be added in the future.

<p>If the Clients argument is used, it accepts a client that is currently
loggedin, a mob belonging to such a client, or a list of any of these. The
remote server will receive a list of their keys in world.Topic().

<hr>

<a name=/world/proc/GetConfig>
<h2>GetConfig proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/IsBanned>IsBanned proc (world)</a>
<dd><a href=#/world/proc/SetConfig>SetConfig proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetConfig(config_set,param)
</dl>

<dl><dt><b>Returns:</b>
<dd>Value of requested parameter.
</dl>

<dl><dt><b>Args:</b>
<dd>config_set: name of the configuration set (see below)
<dd>param: name of the configuration parameter
</dl>

<p>This command is for retrieving configuration information that is shared
by applications installed on the same system.  The configuration data is
accessed by specifying the configuration "set" and the parameter within that
set.  The "sets" defined so far are:

<xmp>
env       system environment variables (changes are not persistent)
admin     list of site administrators
ban       list of banned users or IP addresses
keyban    list of banned users (deprecated)
ipban     list of banned addresses (deprecated)
</xmp>

<p>If no parameter is specified, a list of the names of all available
parameters is returned.

<p>The format of the configuration data itself is currently being defined.
It will generally be a sequence of parameters (such as produced by
list2params()).  For example, each ban entry would have the user's ckey or
ckeyEx as the parameter, and might have data such as
"reason=jerkish;message=You+jerk!".

<h3>Example:</h3>

<xmp>
mob/verb
   ban(key as text)
      world.SetConfig("ban",ckey(key),"reason=fiendish;admin=[ckey]")
   lookban(key as null|text)
      if(key)
         usr << "[key]: [world.GetConfig("ban",key)]"
      else
         var/lst[] = world.GetConfig("ban")
         for(key in lst)
            usr << "[key]: [world.GetConfig("ban",key)]"
</xmp>

<p>Ban files store information on a game-specific basis. You will only be
able to read and write values that are set for the game you are running 
(defined by the value of world.hub).  It is possible for a host to specify
universal bans as well, but these will not be accessible via GetConfig or
SetConfig.  If you are using "ban" as the config_set, IP addresses are
recognized automatically.  (See the ban format info below.)

<p>It is possible, but rarely useful, to specify a configuration "space" of
SYSTEM, USER, HOME, or APP.  Settings made in the SYSTEM space are shared by
all BYOND software on the computer.  The USER space is shared by all software
owned by the same user.  The HOME space is shared by all worlds running with
the same safe home directory.  The APP space is shared by all software running
from the same filesystem directory.  By default, the USER space is used, and
if that cannot be modified (in safe mode), then HOME is used instead.  These
distinctions are sometimes important on a UNIX machine, where there are many
BYOND sites belonging to different users, but even then, the default behavior
is almost always what you want.

<p>The configuration space is specified inside the configuration set
parameter like this:

<xmp>
world.SetConfig("APP/keyban",...)
</xmp>

<p>When reading configuration settings, the spaces are always lumped
together.  In cases of settings with the same name but different values, APP
overrides HOME, which overrides USER, which overrides SYSTEM.

<h3>Ban Format</h3>

<p>If you want to create or read bans at runtime by using the "ban" config
set, these are the main parameters currently used:

<dl>
<dt>type</dt>
<dd>The ban's type, if any. It can be "sticky", "session", or "time", or a
combination separated by commas.  Session bans expire when the current
session is over (world.Reboot() does not affect this).

<dt>reason</dt>
<dd>The reason the ban was implemented; this is for the host's or admin's
purposes only and is not displayed to the user.

<dt>message</dt>
<dd>A message to display to the user.

<dt>keys</dt>
<dd>Other keys caught in a sticky ban.

<dt>IP</dt>
<dd>Other IP addresses caught in a sticky ban.

<dt>computer_id</dt>
<dd>Other computer_id values caught in a sticky ban.

<dt>time</dt>
<dd>The number of seconds remaining in the ban. The type parameter must include
"time" for this to mean anything. If this parameter is not present when a timed
ban is read, it means the ban has expired.
</dl>

<p>The old "keyban" and "ipban" config files are now just aliases for "ban".

<hr>

<a name=/world/proc/GetCredits>
<h2 byondver=503>GetCredits proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/AddCredits>AddCredits proc (world)</a>
<dd><a href=#/world/proc/PayCredits>PayCredits proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetCredits(player)
</dl>

<dl><dt><b>Returns:</b>
<dd>Number of credits if hub contact was successful, null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>player: a mob, client, key, or ckey
</dl>

<p>Retrieves the number of available credits in a player's account. This
feature is intended for games that make use of the credit system, and for
security all such games must use a hub password.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is a good idea to use spawn() to avoid holding up the rest of
the game.

<p>The best time to call this proc is before a player does something that
would allow them to spend credits, and/or just afterward, so they can see
what is left in their account.

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/GetMedal>
<h2>GetMedal proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/SetMedal>SetMedal proc (world)</a>
<dd><a href=#/world/proc/ClearMedal>ClearMedal proc (world)</a>
<dd><a href=#/world/proc/GetScores>GetScores proc (world)</a>
<dd><a href=#/world/proc/SetScores>SetScores proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>GetMedal(medal, player)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the medal has been earned by the player
<dd>0 if the medal has not been earned
<dd>A list of medals in list2params() format if checking all medals
<dd>null if the hub cannot be contacted
</dl>

<dl><dt><b>Args:</b>
<dd>medal: name of the medal being checked
<dd>player: a mob, client, key, or ckey
</dl>

<p>Checks to see if a medal has been awarded to the player in question. If
the medal has been awarded, the return value is 1. If not, 0.

<p>You can also use GetMedal() to read a list of all medals a player has
earned for the hub entry, by leaving the medal argument blank. If you also
leave the player argument blank, you will get a list of all medals available
to the hub entry. In both cases the result can be parsed with params2list().

<p>This proc will return null if there was no way to reach the hub or
otherwise verify the medal's status. Use isnull() to check for a null value.

<p>Whenever possible, GetMedal() will avoid contacting the hub by using the
information it was given when the user logged in. If contacting the hub is
required, the proc may take a few moments to return a result. It is a good
idea to use spawn() to avoid holding up the rest of the game.

<h3>Example:</h3>
<xmp>
turf/medal_door
  density = 1
  icon_state = "closed"
  var/medal = "Dragon slayer"

  verb/Knock()
    usr << "<b>Guard:</b> Just checking your credentials...."
    var/hasmedal = world.GetMedal(medal, usr)
    if(hasmedal)
      usr << "<b>Guard:</b> Go right in."
      icon_state = "open"
      density = 0
    else if(!isnull(hasmedal))
      usr << "<b>Guard:</b> Sorry, no admittance without a <b>[medal]</b> badge."
    else
      usr << "<b>Guard:</b> Sorry, I lost the paperwork. Try again later."
</xmp>

<p>You can add an optional hub path argument if you want to look at a medal
for a different hub entry.

<hr>

<a name=/world/proc/GetScores>
<h2>GetScores proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/SetScores>SetScores proc (world)</a>
<dd><a href=#/world/proc/GetMedal>GetMedal proc (world)</a>
<dd><a href=#/world/proc/SetMedal>SetMedal proc (world)</a>
<dd><a href=#/world/proc/ClearMedal>ClearMedal proc (world)</a>
</dl>

<dl><dt><b>Formats:</b>
<dd>GetScores(key, fields)
<dd>GetScores(count, field)
<dd>GetScores(count, skip, field)
</dl>

<dl><dt><b>Returns:</b>
<dd>A parameter list of scores for a given entry. Use params2list() to
interpret the results.
</dl>

<dl><dt><b>Args:</b>
<dd>key: the name of the player, character, etc. for which scores have been set
<dd>fields: The data fields to retrieve
<dd>count: The number of top score records to look at
<dd>skip: The number of top score records to skip over
</dl>

<p>Retrieves information about scores that is kept on the BYOND hub.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is a good idea to use spawn() to avoid holding up the rest of
the game.

<h3>GetScores(key, fields)</h3>

<p>In this form, you can get information about individual scores. This is
the most common way to use GetScores().

<p>The key is an arbitrary text value. Usually a player's key is a good
choice, but you can also use the name of their character, or anything else
you like, as long as it is unique. The key is case-insensitive.

<p>Scores and stats use data fields, which might be things like "Score",
"Level", "Class", etc. To retrieve all the fields associated with a key,
leave the fields argument blank. To retrieve only certain fields, you can
send a separated list like "Score;Level" which is in the same format returned
by list2params().

<p>If you leave the key argument blank, you will get a complete list of keys
that have scores and stats associated with them.

<h3>Example 1:</h3>
<xmp>
mob/var/scores_found
mob/var/score = 0

mob/Login()
  ..()
  spawn()
    var/scores = world.GetScores(key)
    scores_found = !isnull(scores)
    if(scores)
      var/list/params = params2list(scores)
      if(params["Score"])
        score = text2num(params["Score"])
        src << "You have [score] point\s!"
</xmp>

<h3>GetScores(count, field)<br/>
<i>and</i> GetScores(count, skip, field)</h3>

<p>In this form, the proc gets a list of the top scores for a certain field,
and gives you the keys and scores in order. To get the top 10 players by
level, for instance, you would use GetScores(10,"level"). This returns a
parameter list with the top keys and scores, so it might be in a form like
"Bob=100;Anita=80;David=20;Charlie=5".

<p>The count and skip arguments are always numbers, not text. The count is
the number of scores to retrieve, and skip is the number to skip over to get
to them. So count=10 and skip=0 is the top 10, while count=10 and skip=5 is
#6 through #15. If you leave out skip, it's a 0.

<p>The way you set up your hub entry is how the top scores are determined.
If you told the hub that the "score" field is always sorted from highest
number to lowest, then that's what you'll get. If "birthplace" is set up to
use an alphabetical order, that's the order that GetScores() will use. If a
field cannot be sorted, this form of GetScores() will return an empty text
string.

<p>If you don't specify a field, your hub entry may have a default field to
use. For instance if your hub page displays "Score", then "Level", then the
"Score" field is the default.

<h3>Example 2:</h3>
<xmp>
mob/var/scores_found

mob/Login()
  ..()
  spawn()
    var/top_scores = world.GetScores(10, "Booty")
    scores_found = !isnull(scores)
    if(scores)
      var/list/params = params2list(scores)
      src << "<b>Top Buccaneers:</b>"
      for(var/i=1, i<params.len, ++i)
        var/player = params[i]
        var/loot = params[player]
        src << "[i]\th place: [player] with [loot] doubloon\s"
      if(params.len && params[1] == key)
        src << "Ye be master of the seas! Take thy well-earned hat."
        icon_state = "Commodore"
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/Import>
<h2>Import proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/Export>Export proc (world)</a>
<dd><a href=#/client/proc/Import>Import proc (client)</a>
<dd><a href=#/world/proc/Topic>Topic proc (world)</a>
<dd><a href=#/proc/fcopy>fcopy proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Import()
</dl>

<dl><dt><b>Returns:</b>
<dd>The file sent by the remote server.  The file will be downloaded to the
     local server's resource cache.  Note that this will cause the caller to
     sleep while waiting for the necessary data to be transfered.
</dl>

<dl><dt><b>When:</b>
<dd>Call this inside world.Topic() if you are expecting a file from the
     remote server.
</dl>

<h3>Example:</h3>
<xmp>
//sending the file
mob/proc/Export(Addr)
  var/savefile/F = new()
  F.Write(src)
  world.Export(Addr,F)

//receiving the file
world/Topic()
  var/savefile/F = new(world.Import())
  F.Read() //read the mob
</xmp>

<p>This example defines a mob proc called Export() which writes the mob to a
savefile and sends it to another server (specified by Addr).  The remote
server opens it as a savefile and creates the mob (if the same mob type is
defined on both servers and mob.Read() is compatible with the sending
server's mob.Write()).

<p>Note that another method of transferring player mobs is to use the key
savefile (accessed by client.Export() and client.Import()).  Direct server
to server communication on the other hand could transfer data (like
non-players) without the need for player involvement at all.

<p>Savefiles are the most common type of file to transfer, but world.Import()
simply returns a reference to an item in the world's .rsc file, which could be
any type of file.  This particular example demonstrates how to open such a
file as a temporary savefile.  (It gets dumped from the cache into a separate
temporary file, which is then opened as a savefile.)  Other types of files
would be handled differently.  For example, you could use fcopy() to dump the
cached item to its own separate file.

<hr>

<a name=/world/proc/IsBanned>
<h2>IsBanned proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/GetConfig>GetConfig proc (world)</a>
<dd><a href=#/proc/params2list>params2list proc</a>
<dd><a href=#/client/var/address>address var (client)</a>
<dd><a href=#/client/var/computer_id>computer_id var (client)</a>
<dd><a href=#/client/var/connection>connection var (client)</a>
<dd><a href=#/world/var/hub>hub var (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>IsBanned(key,address,computer_id,type)
</dl>

<dl><dt><b>Returns:</b>
<dd>True value if user is banned from this world.  This may be a list, in which case special meaning is attributed to certain list elements as described below.
</dl>

<dl><dt><b>Args:</b>
<dd>key: BYOND key of the user.
<dd>address: current IP address of the user.
<dd>computer_id: current computer_id of the user if known.
<dd>type: type of connection if known (see <a href=#/client/var/connection>client.connection</a>)
</dl>

<p>By default, this procedure checks the "ban" configuration file.  If an
entry is found for the current world (based on the value of world.hub), the
parameter text is converted into a list (using params2list()), and the result
is returned.  Otherwise, null is returned.

<p>A ban that applies to all worlds on the host's computer will not call
IsBanned(). The connection will simply be denied.

<p>This procedure is called internally whenever a new user connects (before
client/New() is called).  If the result is true, access is denied.  If you
want to ban a user but still allow them to log in (perhaps with reduced
functionality), you can put "Login=1" in the parameter text.  If you want to
display an explanation to the user about why they are banned, you can also put
"message=X" in the parameter text, where X is the message to display to the user.
A reason for the ban can be added with a "reason=X" field.  Of course, you can
also override IsBanned() and insert these values directly into the list that is
returned.

<h2>Example</h2>
<xmp>
world/IsBanned(key,address)
   . = ..()            //check the ban lists
   if(istype(., /list))
      .["Login"] = 1   //allow banned user to login
</xmp>

<p>When you ban people from paging you, this also causes them to be added to
the keyban list.  Even if they are already connected, IsBanned() will be
re-evaluated and acted upon at that time.  When you remove pager ban, they are
removed from keyban as well.

<p>Additional data elements may be added to the ban list in the future.
The current definition includes just the following items:

<dl>

<dt>Login
<dd>true if banned user should be allowed to log in

<dt>reason
<dd>text string describing the reason or origin of the ban.  For example, when
people are banned from the pager, they are added to the "keyban" list with
reason = "pager ban".  This text is internal information only and is not
displayed to the banned user.

<dt>message
<dd>text string explaining to the user why they were banned and possibly what
they should do to be forgiven.

</dl>

<p>Since the data in the "ban" file is in
<a href=#/proc/list2params>application/x-www-form-urlencoded</a> format, it is
probably not desirable to edit the file by hand.  No built-in facilities for
editing the file have been provided (aside from automatic addition of pager
bans), but an interface could be created, using <a href=#/world/proc/GetConfig>GetConfig</a>
and <a href=#/world/proc/SetConfig>SetConfig</a> to read and write the data.
Extra features could also be added such as automatic inference of key
associations by IP address.

<hr>

<a name=/world/proc/IsSubscribed>
<h2 byondver=503>IsSubscribed proc (world)</h2>

<dl><dt><b>Format:</b>
<dd>IsSubscribed(player)
<dd>IsSubscribed(player, "BYOND") (to check BYOND Membership)
</dl>

<dl><dt><b>Returns:</b>
<dd>Number of days left in subscription, -1 for a lifetime subscriber, <i>or</i> null if hub contact failed
</dl>

<dl><dt><b>Args:</b>
<dd>player: a mob, client, key, or ckey
</dl>

<p>Checks a player for their subscription status to this game. This is a
simpler alternative to <tt>client.CheckPassport()</tt>, which is deprecated,
and also allows you to check even when the player has gone offline.

<p>This proc will return null if contacting the hub was required, but there
was no way to reach the hub. Contacting the hub may take a few moments, so it
is a good idea to use <a class=code href=#/proc/spawn>spawn()</a> to avoid
holding up the rest of the game.

<h3>Example:</h3>
<xmp>
mob/verb/JoinClub()
    if(!world.IsSubscribed(src))
        src << "Sorry, the club is only for subscribers."
    else
        // go to the turf with the tag "clubhouse"
        loc = locate("clubhouse")
        src << "Welcome to the clubhouse!"
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/New>
<h2>New proc (world)</h2>

<dl><dt><b>Format:</b>
<dd>New()
</dl>

<dl><dt><b>When:</b>
<dd>Called after the world is initially loaded.  The only procs preceding
     this one would be in the initialization of global variables and objects
     on the map.
</dl>

<dl><dt><b>Default action:</b>
<dd>None.
</dl>

<hr>

<a name=/world/proc/OpenPort>
<h2>OpenPort proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/port>port var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<dl><dt><b>See also:</b>
<dd>OpenPort(port=0)
</dl>

<dl><dt><b>Args:</b>
<dd>port: the network port to open
</dl>

<dl><dt><b>Returns:</b>
<dd>1 on success; 0 on failure
</dl>

<p>This causes the world to be hosted on the specified network port.  A value
of 0 or "any" requests that any available port be used.  The value "none"
causes the port to be closed so that no new connections are possible.

<p>This proc may be overridden. If it is, calling ..() is necessary to open
the port. If ..() is not called, it will not open.

<h3>Example:</h3>
<xmp>
world/OpenPort(port)
  // only allow subscribers to host
  if(host_is_subscribed)
    return ..()
</xmp>

<p>The "ports" configuration option in cfg/byond.txt can be used to control
what ports worlds may open.  The -ports command-line option may also be used.
See <a href=#/proc/startup>startup</a> for the syntax.

<hr>

<a name=/world/proc/PayCredits>
<h2 byondver=503>PayCredits proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/AddCredits>AddCredits proc (world)</a>
<dd><a href=#/world/proc/GetCredits>GetCredits proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>PayCredits(player, credits, note)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the credits were spent successfully, 0 or null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>player: a mob, client, key, or ckey
<dd>credits: A number of credits to deduct from the player's account
<dd>note: An optional note (for author purposes) for the credit change
</dl>

<p>Removes credits from a player's account, if they have enough. The proc
will return 1 if it is successful, or 0 if the attempt failed (usually
because the player doesn't have enough credits). This feature is intended
for games that make use of the credit system, and for security all such
games must use a hub password.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is often a good idea to use spawn() to avoid holding up the
rest of the game.

<h3>Example:</h3>
<xmp>
mob/proc/ItemShop()
    var/items = list("Get credits!", "Magic sword"=10, "Skeleton key"=50)
    var/choices[0]
    var/item,price
    for(item in items)
        price = items[item]
        choices["[item]: [price] credit\s"] = item

    var/credits = world.GetCredits(key)
    if(isnull(credits))
        src << "Sorry, the item shop isn't available right now."
        return

    var/choice = input(src,\
      "You have [credits] credit\s. What would you like to purchase?",\
      "Item Shop")\
      as null|anything in choices
    if(!choice) return  // cancel

    if(choice == "Get credits")
        src << link("http://www.byond.com/games/Author/MyGame/credits")
        return

    item = choices[choice]
    price = items[item]
    if(!price) return

    src << "Contacting item shop..."
    var/result = world.PayCredits(name, price, "Item shop: [item]")

    if(isnull(result))
        src << "Sorry, the item shop isn't available right now."
    else if(!result)
        src << "You need [price-credits] more credit\s to buy [item]."
    else
        src << "You bought \a [item]!"

        // Now give the user the item and save their character
        // These procs are for you to define
        src.AddEquipment(item)
        src.SaveCharacter()
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/Profile>
<h2 byondver=513>Profile proc (world)</h2>

<dl><dt><b>Format:</b>
<dd>Profile(command, format)
<dd>Profile(command, type, format)
</dl>

<dl><dt><b>Returns:</b>
<dd>Profilng data or null
</dl>

<dl><dt><b>Args:</b>
<dd>command: A numerical value that says whether to start, stop, refresh, etc.
<dd>type: A type of profile to use, other than proc profiling.
<dd>format: Optional format for output data
</dl>

<p>Interacts with the built-in server profiler without requiring the host to do
so via Dream Daemon, or an authorized player via Dream Seeker.

<p>The <tt>command</tt> value is built from bitflags, so it can combine any of
these three values via the <tt>|</tt> operator:

<dl class=codedt>
<dt>PROFILE_STOP</dt><dd>Stop profiling. Not using this flag will start/continue profiling.</dd>
<dt>PROFILE_CLEAR</dt><dd>Clear all profile data. This will also cause the proc to return null.</dd>
<dt>PROFILE_AVERAGE</dt><dd>Any output data should use average times instead of total times.</dd>
</dl>

<p>These additional values are also defined for convenience:

<dl class=codedt>
<dt>PROFILE_START</dt><dd>Start/continue profiling but don't clear any existing data.</dd>
<dt>PROFILE_REFRESH</dt><dd>Currently this is the same as <tt>PROFILE_START</tt>.</dd>
<dt>PROFILE_RESTART</dt><dd>Start profiling and clear existing data.</dd>
</dl>

<h3>Profiling procs</h3>

<p>By default, data will be returned as a list. The first six values are the
column names: <tt>"name"</tt>, <tt>"self"</tt>, <tt>"total"</tt>,
<tt>"real"</tt>, <tt>"over"</tt>, and <tt>"calls"</tt>, corresponding to the
columns in the profiler. These are followed by the profile data for each proc,
with the data being in the same column order. E.g. the next six items
represent the first proc in the profile.

<p>The optional <tt>format</tt> argument however can be used to return the
data in other formats. Currently the only accepted value is <tt>"json"</tt>,
which will output the same data in JSON format.

<h3>SendMaps profile</h3>

<p>Using <tt>"sendmaps"</tt> in the <tt>type</tt> argument will profile the
routines used to send map informaiton to players. Unlike the proc profiling
this only has three data columns: <tt>"name"</tt>, <tt>"value"</tt>, and
<tt>"calls"</tt>. The value column might be a time or number value, depending
on what's being measured. 

<p>The JSON format will include a <tt>unit</tt> property data that is not a
raw number, such as a time value.

<hr>

<a name=/world/proc/Reboot>
<h2>Reboot proc (world)</h2>

<dl><dt><b>Format:</b>
<dd>Reboot(reason)
</dl>

<dl><dt><b>Args:</b>
<dd>reason: the reason <tt>Reboot()</tt> was called:
  <ul>
    <li>0 or null: Called by game code</li>
    <li>1: By host (Ctrl+R in Dream Seeker)</li>
    <li>2: By <a href=#/world/proc/Topic>world.Topic()</a></li>
    <li>3: By SIGUSR1 in UNIX</li>
  </ul>
</dl>

<dl><dt><b>Default action:</b>
<dd></dl>

<p>Reload the world from scratch.  Any connected players will automatically
relogin.  This would be useful if you needed to recompile the world after
changing some code.

<p>In a UNIX environment, you can cause a running server to reboot by
sending it the signal SIGUSR1.

<p>If you override this proc, you must call ..() if you want the reboot to
complete normally.

<p>For reboots initiated by Dream Seeker, usr will be the mob belonging to
the player who sent the command.

<hr>

<a name=/world/proc/Repop>
<h2>Repop proc (world)</h2>

<dl><dt><b>Format:</b>
<dd>Repop()
</dl>

<dl><dt><b>Default action:</b>
<dd>Reload the obj and mob instances defined in the world map.  This
    "repopulates" a world to its initial state.  Only objects that were
    destroyed will be recreated.
</dl>

<hr>

<a name=/world/proc/SetConfig>
<h2>SetConfig proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/GetConfig>GetConfig proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SetConfig(config_set,param,value)
</dl>

<dl><dt><b>Args:</b>
<dd>config_set: name of the configuration set (see below)
<dd>param: name of the configuration parameter
<dd>value: data to store (or null to delete this entry)
</dl>

<p>This command is for storing configuration information that is shared by
applications installed on the same system.  The configuration data is
accessed by specifying the configuration "set" and the parameter within that
set.

<p>For more information, see <a href=#/world/proc/GetConfig>GetConfig</a>.

<hr>

<a name=/world/proc/SetMedal>
<h2>SetMedal proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/GetMedal>GetMedal proc (world)</a>
<dd><a href=#/world/proc/ClearMedal>ClearMedal proc (world)</a>
<dd><a href=#/world/proc/GetScores>GetScores proc (world)</a>
<dd><a href=#/world/proc/SetScores>SetScores proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SetMedal(medal, player)
</dl>

<dl><dt><b>Returns:</b>
<dd>1 if the medal was awarded successfully, 0 or null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>medal: name of the medal being awarded
<dd>player: a mob, client, key, or ckey
</dl>

<p>Awards a medal to a player. The proc will return 1 if it is successful, or
0 if the medal was already awarded. If the world already knows this medal was
earned before, the hub will not be contacted.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is a good idea to use spawn() to avoid holding up the rest of
the game.


<h3>Example:</h3>
<xmp>
mob/monster/dragon
   Die(mob/killer)  // assume Die() is a proc all mobs have
      spawn()
         if(ismob(killer) && killer.key)
            world.SetMedal("Dragon slayer", killer)
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/SetScores>
<h2>SetScores proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/GetScores>GetScores proc (world)</a>
<dd><a href=#/world/proc/GetMedal>GetMedal proc (world)</a>
<dd><a href=#/world/proc/SetMedal>SetMedal proc (world)</a>
<dd><a href=#/world/proc/ClearMedal>ClearMedal proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>SetScores(key, fields)
</dl>

<dl><dt><b>Returns:</b>
<dd>The key, if the scores were successfully updated; null otherwise.
</dl>

<dl><dt><b>Args:</b>
<dd>key: the name of the player, character, etc. for which scores should be set
<dd>fields: The data fields to set
</dl>

<p>Updates scores that are kept on the BYOND hub.

<p>The key is an arbitrary text value. Usually a player's key is a good
choice, but you can also use the name of their character, or anything else
you like, as long as it is unique. The key is case-insensitive.

<p>Scores and stats use data fields, which might be things like "Score",
"Level", "Class", etc. Use list2params() to set the fields that you want to
change. Fields that you do not include in the list will not be changed. A
field with a blank value will be deleted.

<p>Sending an empty text string for the fields will erase the scores for that
key.

<p>This proc will return null if there was no way to reach the hub. Use
isnull() to check for a null value. Contacting the hub may take a few
moments, so it is a good idea to use spawn() to avoid holding up the rest of
the game.

<h3>Example:</h3>
<xmp>
var/params

// Change the Score and Pet fields
params = list("Score"=123, "Pet"="Dog")
world.SetScores("Tom", list2params(params))

// Delete the Pet field
params = list("Pet"="")
world.SetScores("Tom", list2params(params))

// Delete Tom's scores entirely
world.SetScores("Tom", "")
</xmp>

<p class=security>Note: You can specify a different hub path and hub_password
by adding these as extra arguments, but this is not recommended for security
reasons. If you use this feature, it should only be on games that cannot be
downloaded by the public.

<hr>

<a name=/world/proc/Tick>
<h2 byondver=515>Tick proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/cpu>cpu var (world)</a>
<dd><a href=#/world/var/map_cpu>map_cpu var (world)</a>
<dd><a href=#/world/var/tick_usage>tick_usage var (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Tick()
</dl>

<dl><dt><b>When:</b>
<dd>Called during the server tick, after sleeping procs and queued commands,
just before map information is sent to the clients.
</dl>

<dl><dt><b>Default action:</b>
<dd>None.
</dl>

<p>This proc allows you to do any updates just before map info is sent out.
One possible use for this is to run a movement loop, or sync up any user
interface input that might have arrived and deal with it all at once.

<h3>Example:</h3>
<xmp>
world/Tick()
    for(var/client/C)
        if(C.mob?.move_dir)
            try
                step(C.mob, move_dir)
            catch
                // empty catch, just so a failed step won't break the loop
</xmp>

<p>Note: The tick will not wait if this proc sleeps. It effectively has
<a class=code href=#/proc/set/waitfor>set waitfor=0</a> already built in.
It's a good idea not to sleep in this proc or any of its callees at all,
since it will keep getting called every tick.

<hr>

<a name=/world/proc/Topic>
<h2>Topic proc (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/Del>Del proc (world)</a>
<dd><a href=#/world/proc/Export>Export proc (world)</a>
<dd><a href=#/client/proc/Import>Import proc (client)</a>
<dd><a href=#/world/proc/Import>Import proc (world)</a>
<dd><a href=#/world/proc/Reboot>Reboot proc (world)</a>
</dl>

<dl><dt><b>Format:</b>
<dd>Topic(T,Addr,Master,Keys)
</dl>

<dl><dt><b>When:</b>
<dd>Called when a message is received from another server by using
    world.Export().  If a file is expected, world.Import() may be called to
    get it.  The return value of Topic() will be passed back to the remote
    server.
</dl>

<dl><dt><b>Args:</b>
<dd>T: The topic text string specified by the remote server (everything following ? in the URL).
<dd>Addr: The address of the remote server.
<dd>Master: 1 if remote server is the server which started this one.
<dd>Keys: List of keys belonging to users who are logged in on the remote server
</dl>

<dl><dt><b>Default action:</b>
<dd>The topic "ping" returns a true value (number of players plus one),
     which may be useful for telling if a server is alive.  The topics
     "Reboot" and "Del" will call world.Reboot() and world.Del()
     respectively if the message was sent by the master server.
</dl>

<h3>Example:</h3>
<xmp>
world/Topic(T)
  if(findtext(T,"shout:") == 1)
    world << copytext(T,7)
</xmp>

<p>This example allows other servers to send this server topic text of the
form "shout:msg" and will broadcast the message to all the players in this
world.

<p>The Keys argument is either null, or a list of user keys. Any keys in the
list are logged in to the remote server.

<p class="note security">Always validate the input in <tt>Topic()</tt> calls
to make sure it's correct and the query you're recieving is legitimate.

<hr>

<a name=/world/var>
<h2>vars (world)</h2>

<p>Built-in world vars:

<dl><dt>world/var
<dd><a href=#/world/var/address>address</a>
<dd><a href=#/world/var/area>area</a>
<dd><a href=#/world/var/byond_build>byond_build</a>
<dd><a href=#/world/var/byond_version>byond_version</a>
<dd><a href=#/world/var/cache_lifespan>cache_lifespan</a>
<dd><a href=#/world/var/contents>contents</a>
<dd><a href=#/world/var/cpu>cpu</a>
<dd><a href=#/world/var/executor>executor</a>
<dd><a href=#/world/var/fps>fps</a>
<dd><a href=#/world/var/game_state>game_state</a>
<dd><a href=#/world/var/host>host</a>
<dd><a href=#/world/var/hub>hub</a>
<dd><a href=#/world/var/hub_password>hub_password</a>
<dd><a href=#/world/var/icon_size>icon_size</a>
<dd><a href=#/world/var/internet_address>internet_address</a>
<dd><a href=#/world/var/log>log</a>
<dd><a href=#/world/var/loop_checks>loop_checks</a>
<dd><a href=#/world/var/map_format>map_format</a>
<dd><a href=#/world/var/map_cpu>map_cpu</a>
<dd><a href=#/world/var/maxx>maxx</a>
<dd><a href=#/world/var/maxy>maxy</a>
<dd><a href=#/world/var/maxz>maxz</a>
<dd><a href=#/world/var/mob>mob</a>
<dd><a href=#/world/var/movement_mode>movement_mode</a>
<dd><a href=#/world/var/name>name</a>
<dd><a href=#/world/var/params>params</a>
<dd><a href=#/world/var/port>port</a>
<dd><a href=#/world/var/process>process</a>
<dd><a href=#/world/var/realtime>realtime</a>
<dd><a href=#/world/var/reachable>reachable</a>
<dd><a href=#/world/var/sleep_offline>sleep_offline</a>
<dd><a href=#/world/var/status>status</a>
<dd><a href=#/world/var/system_type>system_type</a>
<dd><a href=#/world/var/tick_lag>tick_lag</a>
<dd><a href=#/world/var/tick_usage>tick_usage</a>
<dd><a href=#/world/var/time>time</a>
<dd><a href=#/world/var/timeofday>timeofday</a>
<dd><a href=#/world/var/timezone>timezone</a>
<dd><a href=#/world/var/turf>turf</a>
<dd><a href=#/world/var/url>url</a>
<dd><a href=#/datum/var/vars>vars</a>
<dd><a href=#/world/var/version>version</a>
<dd><a href=#/world/var/view>view</a>
<dd><a href=#/world/var/visibility>visibility</a>
</dl>

<hr>

<a name=/world/var/address>
<h2>address var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/port>port var (world)</a>
<dd><a href=#/world/var/url>url var (world)</a>
<dd><a href=#/world/var/internet_address>internet_address var (world)</a>
</dl>

<p>This is the network address of the machine hosting the world.  If it
cannot be determined, it will be null.

<p>The full network address of the world may be formed by concatenating the
world address and port: "byond://[address]:[port]".

<p>In CGI mode, this is the web address of the world.

<p>This is the local address only. If the world is hosted via a router, the
external IP address may be different. Use <tt>internet_address</tt> to find
the external address, if available.

<hr>

<a name=/world/var/area>
<h2>area var (world)</h2>

<dl><dt><b>Default value:</b>
<dd>/area.
</dl>

<p>This is the default area type to be placed on the map wherever no area is
specified.  A value of 0 turns off the default area.

<hr>

<a name=/world/var/byond_build>
<h2 byondver=512>byond_build var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/DM_VERSION>DM_VERSION macro</a>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/client/var/byond_version>byond_version var (client)</a>
<dd><a href=#/savefile/var/byond_build>byond_build var (savefile)</a>
<dd><a href=#/savefile/var/byond_version>byond_version var (savefile)</a>
</dl>

<p>This is the build number (minor version) of BYOND being run by this server.
Typically this is not useful information, but it can come in handy when
diagnosing issues reported by players when hosting with a beta build.

<hr>

<a name=/world/var/byond_version>
<h2>byond_version var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/preprocessor/DM_VERSION>DM_VERSION macro</a>
<dd><a href=#/world/var/byond_build>byond_build var (world)</a>
<dd><a href=#/world/var/system_type>system_type var (world)</a>
<dd><a href=#/client/var/byond_version>byond_version var (client)</a>
<dd><a href=#/savefile/var/byond_build>byond_build var (savefile)</a>
<dd><a href=#/savefile/var/byond_version>byond_version var (savefile)</a>
</dl>

<p>This is the version of BYOND at run-time.  A game designed to work around
known bugs in older versions could use this to adapt its behavior accordingly.

<hr>

<a name=/world/var/cache_lifespan>
<h2>cache_lifespan var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/cache>cache</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>30 (days)
</dl>

<p>Number of days items that are not in use will be saved in the resource
cache (.rsc file).  Files uploaded by players are stored in the world's .rsc
file for future use.  If the file is not used for the specified amount of
time, it will be removed to save space.

<p>Setting this value to 0 causes items to be saved for the current session
only.  This is used by the CGI library, because web browsers cannot make use
of server-side caches when uploading files anyway.

<p>This value must be a whole number.

<hr>

<a name=/world/var/contents>
<h2>contents list var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list>list</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>List of all areas, turfs, mobs, and objs initially in the world.
</dl>

<p>This is a list of every object in the world.  Objects in this list are in
no particular order.

<h3>Example:</h3>
<xmp>
proc/ListAreas(mob/M)
  var/area/A
  M << "Areas:"
  for (A in world.contents)
    M << A
</xmp>

<p>This example displays a list of every area in existence.  As a convenient
short-hand, one may simply write for(A) or for(A in world) instead of the
full for(A in world.contents).

<hr>

<a name=/world/var/cpu>
<h2>cpu var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/map_cpu>map_cpu var (world)</a>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
<dd><a href=#/world/var/tick_usage>tick_usage var (world)</a>
<dd><a href=#/world/proc/Tick>Tick proc (world)</a>
</dl>

<p>This is the percentage of a server tick that the server spends processing
running procs and the work of sending map information to players.  A value of 0
would indicate very little cpu usage.  A value of 100 would indicate full cpu
usage, which could mean that the server cannot complete all the necessary
computations during a tick to finish in time for the next tick.  In this case,
timed events (such as sleep) may take
longer than requested.

<p>When deciding on a value for tick_lag, one could use this value to
determine if the CPU is fast enough to tick at a higher rate.

<p>The <tt>map_cpu</tt> var is a subset of this, measuring only time used for
sending map information.

<hr>

<a name=/world/var/executor>
<h2>executor var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/startup>startup proc</a>
</dl>

<dl><dt><b>Format:</b>
<dd>executor = "/usr/local/byond/bin/DreamDaemon [params]"
</dl>

<p>This option is for direct execution of <code>.dmb</code> files in UNIX.
The most common use is for writing CGI programs that are executed by the web
server.

<p>The first parameter in the <var>executor</var> text string is the path to
DreamDaemon.  The one listed above is the standard UNIX location.

<p>Optional parameters may follow.  The most common are -CGI and -logself.

<h3>Example:</h3>
<xmp>
world/executor = "/usr/local/byond/bin/DreamDaemon -CGI -logself"
</xmp>

<p>This example creates a CGI program to be executed by a web server.  It
puts its error output in the file <code><var>projname</var>.log</code>.

<p>All of this is configured for you when you include
<code>html/CGI.dm</code> from the html library.

<hr>

<a name=/world/var/fps>
<h2 byondver=490>fps var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
<dd><a href=#/client/var/fps>fps var (client)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>10
</dl>

<p>The value of <tt>world.fps</tt> defines the speed of the world in frames
(server ticks) per second. By default this is 10 fps, which is a good speed if
all objects move in full tiles. Higher values yield smoother results, but at a
cost to performance. Timing of many events may be limited by the system clock,
so <tt>fps</tt> values beyond 40 or 50 may cause unwanted effects like jitter
even for projects that are not very demanding in terms of performance.

<p>For projects making use of pixel movement, higher <tt>fps</tt> is usually
desired. 40 seems to be a good value for general use, but in worlds that have
a large number of players, you may wish to lower the value and give players a
higher <tt>step_size</tt> per tick instead.

<p>This var exists for convenience; it is calculated by <tt>10 /
world.tick_lag</tt>. The value of <tt>world.tick_lag</tt> is actually more
accurate, but it is easier to think of world speed in terms of frames per
second. The actual tick rate has a resolution of 1 ms.

<p>When reading <tt>world.fps</tt>, the result is always given as a whole
number to gloss over rounding error.

<p>If you set <tt>client.tick_lag</tt> or <tt>client.fps</tt> to a value other
than 0, you can make the client tick at a different (usually faster) rate.

<hr>

<a name=/world/var/game_state>
<h2>game_state var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/name>name var (world)</a>
<dd><a href=#/world/var/status>status var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>At runtime, this value may be changed to let the BYOND hub know about
certain changes in the game's status. An example for using this value is if
the number of players in the game gets too high and most new logins are
rejected, you can set game_state to 1 to let the hub know this server is
full.

<p>The following values are accepted:

<dl>
<dt>0</dt><dd>Normal status</dd>
<dt>1</dt><dd>Server is full</dd>
</dl>

<p>Note that this value does not affect how your world actually reacts to new
players logging in. It is only used by the hub and website.

<hr>

<a name=/world/var/host>
<h2>host var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/game_state>game_state var (world)</a>
<dd><a href=#/world/var/name>name var (world)</a>
<dd><a href=#/world/var/status>status var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>If the information is made available by the pager, this will provide the
key of the world's host. If the host is not known, this value will be either
null or an empty string.

<hr>

<a name=/world/var/hub>
<h2>hub var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/hub_password>hub_password var (world)</a>
<dd><a href=#/world/var/name>name var (world)</a>
<dd><a href=#/world/var/status>status var (world)</a>
<dd><a href=#/world/var/game_state>game_state var (world)</a>
<dd><a href=#/world/var/version>version var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is a registered <a href=http://www.byond.com/hub/>BYOND hub</a> path.
The default value of null is for unregistered games.  Registered games (don't
worry, it's free!) have their own hub page showing a brief description of the
game, the author, an optional installation package, and links to online games.
The hub path is a string of the form "YourName.GameName" and can be found in your
<a href="https://secure.byond.com/members/?command=edit_hub">hub console</a>.

<p>Even unregistered games show up in the hub when they are live (that is
online with people connected).  It just doesn't show any of the extra info
like a description, and there is no way for people to find out about it when
nobody is logged in.

<p>If you do not want your game to show up in the hub (like while you are in
the initial stages of development), just compile with
<code>visibility=0</code>.  Either that, or turn off your pager or your BYOND
locator when you are connected to it.

<p>You (or the players) might also wish to turn off the notice of a live
game in the hub when there is no longer any room for new players or if it is
too late in the game for new people to join.  At such times, you can simply
set the visibility to 0.

<h3>Example:</h3>
<xmp>
world
   hub = "Dan.PipeStock"   //registered hub path

mob/verb/start_game()
   world.visibility = 0
   //...
</xmp>

<p>If you configure your hub page to require a hub password, you must also
specify <code>world.hub_password</code>.

<hr>

<a name=/world/var/hub_password>
<h2>hub_password var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/hub>hub var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>If <code>world.hub</code> is set, any live session of the game will be
attached to the specified BYOND Hub page.  Under the default settings,
any game can set <code>world.hub</code> and attach itself to any BYOND
Hub page.</p>

<p>To beef up security, you can set a hub password in your hub's
configuration page via the BYOND website.  This will ensure that
only authorized copies of your game can attach themselves to your
hub page when live.  Then simply copy that password into your code as
<code>world.hub_password</code> so that your game's live broadcast will
be accepted by the hub.</p>

<h3>Example:</h3>
<xmp>
world
   hub = "Dan.PipeStock"   //registered hub path
   hub_password = "UPAggnJaeXmSBoKK"   //password for live game authentication
</xmp>

<p>Note that for security reasons, reading this variable at runtime will
return a hashed version of the value that was set.</p>

<hr>

<a name=/world/var/icon_size>
<h2>icon_size var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atoms)</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>32
</dl>

<p>This is the tile size that will be used as a default for icons in the
world. It can be set to a single number that represents both the width and
height, or you can use a format like "[width]x[height]" (such as "16x48") to
specify width and height separately.

<p>This value affects several calculations, including icon operations and
gliding between turfs.

<p>Note: If you do not use a square icon size and you are using a topdown map
format, you may experience display issues if setting <tt>client.dir</tt>
to <tt>EAST</tt> or <tt>WEST</tt>. A non-square tile with a topdown map format
will also interfere with pixel movement. For this reason, square sizes are
recommended when using any topdown-view map format.

<hr>

<a name=/world/var/internet_address>
<h2>internet_address var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/port>port var (world)</a>
<dd><a href=#/world/var/url>url var (world)</a>
<dd><a href=#/world/var/address>address var (world)</a>
</dl>

<p>This is the network address of the machine hosting the world, as it is
seen by the outside network (from the Internet) and the hub.  If it cannot
be determined, it will be null.

<p>The full network address of the world may be formed by concatenating the
world address and port: "byond://[address]:[port]".

<p>This var exists because <tt>world.address</tt> may not be accurate if the
world is hosted on a machine behind a router using NAT. The value returned
by <tt>internet_address</tt> can be given to other players who wish to log
in.

<hr>

<a name=/world/var/log>
<h2>log var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/file>file proc</a>
<dd><a href=#/proc/startup>startup proc</a>
</dl>

<p>Sending output to world.log may be useful for debugging purposes.  The
output goes to the same place run-time proc errors are displayed.

<h3>Example:</h3>
<xmp>
if(1+1 != 2)
  world.log << "Uh oh."
</xmp>

<p>You can assign world.log to a file name or file() object to redirect output
to that file.  (There is also a command-line option to Dream Daemon that does
this.)

<h3>Example:</h3>
<xmp>
world.log = file("mylog.txt")
</xmp>

<hr>

<a name=/world/var/loop_checks>
<h2>loop_checks var (world)</h2>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<p>Setting this to 0 disables the very long loop protection.  By default,
loops in the code which undergo a very large number of iterations or
recursions are aborted (by crashing the proc).  This prevents the proc from
locking up the server for too long.

<p>You may need to disable this feature if your code has some very long loops
in it.  Before doing that, make sure it's not <em>infinitely</em> long!  Your
program will utterly crash if it runs out of system stack space, which can
happen in a very deep or infinite recursion.

<p>Note: The compiler will now generate a warning when you disable
<tt>loop_checks</tt>. It is not advisable to disable the check unless you're
trying to debug something, since you can cause the server to hang. Generally
if you have a loop so long it can cause the regular loop checks to freak out,
you need to make a change to the loop behavior anyway.

<hr>

<a name=/world/var/map_format>
<h2>map_format var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/view>view var (world)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
<dd><a href=#/{notes}/topdown>Topdown maps</a>
<dd><a href=#/{notes}/isometric>Isometric maps</a>
<dd><a href=#/{notes}/side>Side-view maps</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>TOPDOWN_MAP
</dl>

<dl><dt><b>Possible values:</b>
<dd><ul>
<li>TOPDOWN_MAP
<li>ISOMETRIC_MAP
<li byondver=482>SIDE_MAP
<li>TILED_ICON_MAP
</ul>
</dl>

<p>This value says how the world will display maps. In a normal overhead
tiled map the value is <tt>TOPDOWN_MAP</tt> for the top-down format. For older
games that predate this feature, the value is <tt>TILED_ICON_MAP</tt>.

<p>If you use a map format other than top-down, the HUD will still use a
tile format like it would in top-down display. HUD objects are not projected
into whatever map_format you use and they are not affected by changing
client.dir. The size of the HUD is rounded up to the nearest number of full
screen tiles; the size of each tile is defined by world.icon_size.

<h3>Top-down format</h3>

(See more at <a href=#/{notes}/topdown>Topdown maps</a>.)

<p>This is the default map format. Icons are drawn in a tile form and viewed
from overhead. In this layout, the layer assigned to each atom is very
important. The number of tiles shown is set by client.view or world.view.

<p>Because this format is familiar and easy to understand, it is the default
setting. Most of the vars related to maps and atoms are designed and
documented with this format in mind.

<h3 deprecated=1>Tiled icon format</h3>

(See more at <a href=#/{notes}/tiled-icons>Tiled icons</a>.)

In BYOND 4.0 a new feature was introduced for using "big" icons, bigger than
the standard tile size, by splitting them up into states like "0,0", "1,0",
and so on. This functionality is no longer needed since BYOND now has the
ability to display icons in their natural size. Some games that were designed
before this, however, may still need to make use of this splitting feature
that breaks icons into smaller tile-sized pieces.

When an icon is broken into chunks, each state in the icon is given a
thumbail version of the full image, and then new states are added to show
each chunk. For instance if world.icon_size is the default 32&times;32, and
the icon is 64&times;64, then the "door" state would become a thumbnail of
the full door image while "door 0,0" (the lower left corner), "door 1,0",
"door 0,1", and "door 1,1" were created to show each smaller section of the
image. If the default "" state is broken into chunks, those chunks are just
named "0,0" and so on without a space.

<p class="note deprecated">This format is deprecated. It exists to support
older games and allow them to be compiled without causing them to break,
until they can be redesigned for one of the newer formats.

<h3>Isometric format</h3>

(See more at <a href=#/{notes}/isometric>Isometric maps</a>.)

<p>If map_format is set to <tt>ISOMETRIC_MAP</tt>, the map is displayed in
isometric form. Isometric tiles are displayed in a foreshortened diagonal
perspective, where the "north" direction actually displays as northeast on
the player's screen, and "east" shows up as southeast. The value of
<tt>client.view</tt> or <tt>world.view</tt> is used to calculate the
<i>minimum</i> number of tiles to display, and extra tiles to each side will
be shown to fill in the corners.

<p>In an isometric map, the tile width set in world.icon_size is the most
important factor. This should be a multiple of 4 for best results. The
minimum tile height is half that value, and any extra height is used to show
vertical structures that "stick up" off the map surface. When you draw an
isometric tile icon, start with a flattened diamond shape at the bottom that
is only half as high as it is wide.

<p>Isometric maps behave differently during drawing than top-down maps. In
isometric, tiles that are nearer to the viewer's perspective are drawn in
front of tiles farther back, regardless of layer. Layers only count within an
individual tile. This means that if you want to have a vertical structure
"stick up" to partially hide something behind it, the icon sticking up should
always be on a tile forward from the one being partly covered. E.g. if you
have a wall taking up part of your tile, it needs to be at the "back" end of
the tile to properly hide anything on the tiles behind it.

<p>The <tt>pixel_x</tt> and <tt>pixel_y</tt> values, <tt>step_x</tt> and
<tt>step_y</tt> values, and the gliding that happens when moving between
tiles, are based on the width set by <tt>world.icon_size</tt>. If you set
<tt>world.icon_size="64x128"</tt> to show tall buildings, only the 64 matters
for pixel offsets. Use <tt>pixel_w</tt> and <tt>pixel_z</tt> to adjust the
position of atoms (or the client) horizontally or vertically without respect
to <tt>client.dir</tt> or the map format.

<p>Note: Offsets for x and y also affect the layering order used to draw
the icons. Any object with a pixel offset onto another tile is considered
part of whichever tile is closer.

<p>If you use an icon wider than one tile, the "footprint" of the isometric
icon (the actual map tiles it takes up) will always be a square. That is, if
your normal tile size is 64 and you want to show a 128x128 icon, the icon is
two tiles wide and so it will take up a 2&times;2-tile area on the map. The
height of a big icon is irrelevant--any excess height beyond width/2 is used
to show vertical features. To draw this icon properly, other tiles on that
same ground will be moved behind it in the drawing order.

<p>One important warning about using big icons in isometric mode is that you
should only do this with dense atoms. If part of a big mob icon covers the
same tile as a tall building for instance, the tall building is moved back
and it could be partially covered by other turfs that are actually behind it.
A mob walking onto a very large non-dense turf icon would experience similar
irregularities.

<h3 byondver=482>Side-view format</h3>

(See more at <a href=#/{notes}/side>Side-view maps</a>.)

<p>The <tt>SIDE_MAP</tt> format is like a cross between <tt>TOPDOWN_MAP</tt>
and <tt>ISOMETRIC_MAP</tt>. It looks very similar to a top-down view but it is
intended for more of a 3/4 perspective, where tiles lower on the screen are
considered closer to the viewer. Because this impacts the way layers work,
most of the layering behavior is the same as with isometric.

<p>In a 3/4 perspective the tiles are often foreshortened, so pixel offsets
are adjusted to account for this. For example, you may set
<tt>world.icon_size</tt> to <tt>"32x24"</tt>, but the tile is considered to be
a perfect square if you look at it from the top down. Because the width is 32
pixels, the virtual height is also 32, so if you use pixel_y=32 the atom will
appear one tile further back than it normally is. (This adjustment doesn't
affect screen objects or <tt>pixel_w</tt>/<tt>pixel_z</tt>.)

<p>Changing <tt>client.dir</tt> preserves the same tile size regardless of
orientation.

<hr>

<a name=/world/var/map_cpu>
<h2 byondver=514>map_cpu var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/cpu>cpu var (world)</a>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
<dd><a href=#/world/var/tick_usage>tick_usage var (world)</a>
<dd><a href=#/world/proc/Tick>Tick proc (world)</a>
</dl>

<p>This is the percentage of a server tick that the server spends processing
information about the map to send to players.  A value of 0 would indicate very
little cpu usage.  A value of 100 would indicate full cpu usage, which means
that the server cannot complete all the necessary computations during a tick to
finish in time for the next tick.  In this case, timed events (such as sleep)
may take longer than requested.

<hr>

<a name=/world/var/maxx>
<h2>maxx var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/area>area var (world)</a>
<dd><a href=#/world/var/maxy>maxy var (world)</a>
<dd><a href=#/world/var/maxz>maxz var (world)</a>
<dd><a href=#/world/var/turf>turf var (world)</a>
<dd><a href=#/map>Map</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>The world map is a three-dimensional block of turfs with coordinates
ranging from (1,1,1) to (maxx,maxy,maxz).  If set at compile time, it
provides a lower bound and will be increased as needed by the map files.

<p>The default value is 0, indicating no map.  If any of the map dimensions
are set to non-zero values at compile time, the others will default to 1.

<p>New territory created by increasing the map boundaries is filled in with
the default turf and area (world.turf, and world.area).

<hr>

<a name=/world/var/maxy>
<h2>maxy var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/area>area var (world)</a>
<dd><a href=#/world/var/maxx>maxx var (world)</a>
<dd><a href=#/world/var/maxz>maxz var (world)</a>
<dd><a href=#/world/var/turf>turf var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>The world map is a three-dimensional block of turfs with coordinates
ranging from (1,1,1) to (maxx,maxy,maxz).  If set at compile time, it
provides a lower bound and will be increased as needed by the map files.

<p>The default value is 0, indicating no map.  If any of the map dimensions
are set to non-zero values at compile time, the others will default to 1.

<p>New territory created by increasing the map boundaries is filled in with
the default turf and area (world.turf, and world.area).

<hr>

<a name=/world/var/maxz>
<h2>maxz var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/area>area var (world)</a>
<dd><a href=#/world/var/maxx>maxx var (world)</a>
<dd><a href=#/world/var/maxy>maxy var (world)</a>
<dd><a href=#/world/var/turf>turf var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>The world map is a three-dimensional block of turfs with coordinates
ranging from (1,1,1) to (maxx,maxy,maxz).  If set at compile time, it
provides a lower bound and will be increased as needed by the map files.

<p>The default value is 0, indicating no map.  If any of the map dimensions
are set to non-zero values at compile time, the others will default to 1.

<p>New territory created by increasing the map boundaries is filled in with
the default turf and area (world.turf, and world.area).

<hr>

<a name=/world/var/mob>
<h2>mob var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/proc/New>New proc (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>/mob.
</dl>

<p>When a player connects to the world, the world is searched for a mob with
the player's key.  If one is found, the player is connected to that mob.  If
none is found, a new mob of type world.mob is created and the player is
connected to this new mob.

<p>The default value is /mob.  Setting world.mob to 0 prevents the creation
of default mobs.

<h3>Example:</h3>
<xmp>
world
  mob = /mob/newbie

mob/newbie
  Login()
    src << "Welcome, [name]."
    ..()
</xmp>

<p>This example will connect new players to mobs of type /mob/newbie.  They
are welcomed when they connect.

<hr>

<a name=/world/var/movement_mode>
<h2>movement_mode var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/atom/proc/Enter>Enter proc (atom)</a>
<dd><a href=#/atom/proc/Exit>Exit proc (atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd><tt>LEGACY_MOVEMENT_MODE</tt>: Old BYOND behavior regarding pixel movement and turf contents (see below)
<dd><tt>TILE_MOVEMENT_MODE</tt>: All atoms are locked to the tile grid
<dd><tt>PIXEL_MOVEMENT_MODE</tt>: All movable atoms can use pixel movement unless otherwise specified (see below), but legacy behavior for turf contents is ignored
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>LEGACY_MOVEMENT_MODE
</dl>

<p>Controls how movement works on the map.

<p><tt>TILE_MOVEMENT_MODE</tt> allows you to easily discard any and all pixel
movement, so if step_x or step_y coordinates or unexpected atom bounds were
loaded from a savefile, for instance, they would be eliminated. If you use any
other movement mode, you can give an atom the
<a class=code href=#/atom/var/appearance_flags>TILE_MOVER</a> flag and it will
behave as if it were in this mode, while other atoms are free to do their own
thing.

<p><tt>LEGACY_MOVEMENT_MODE</tt> exists to distinguish between old and new
movement behavior. In older versions of BYOND before pixel movement, turfs
took their contents into consideration by default in Enter() and Exit(). This
doesn't really make sense for newer games, so in any other movement mode the
turf behavior will ignore its contents. mob.Cross() is also affected, since
it would return 0 by default in legacy mode when both mobs were dense; now
by default it checks <tt>mob.group</tt>.

<hr>

<a name=/world/var/name>
<h2>name var (world)</h2>

<dl><dt><b>Default value:</b>
<dd>The &lt;world&gt; part of the &lt;world&gt;.dmb file.
</dl>

<p>This is the name of the world.

<h3>Example:</h3>
<xmp>
world
  name = "The Void"
</xmp>

<hr>

<a name=/world/var/params>
<h2>params var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/list/associations>list associations</a>
<dd><a href=#/proc/params2list>params2list proc</a>
<dd><a href=#/proc/startup>startup proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>null
</dl>

<p>This is a list of parameters passed to the world from the command-line
-params option when the server was started.  The parameter text is passed
through params2list() to generate the world.params list.

<h3>Example:</h3>
<xmp>
world/New()
   var/p
   if(params.len) world.log << "Command-line parameters:"
   for(p in params)
      world.log << "[p] = [params[p]]"
</xmp>

<p>This example displays the value of each parameter.

<hr>

<a name=/world/var/port>
<h2>port var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/OpenPort>OpenPort proc (world)</a>
<dd><a href=#/world/var/address>address var (world)</a>
<dd><a href=#/world/var/reachable>reachable var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<p>This is the network port of the world.  If the world does not have an
open network port, this is 0.

<hr>

<a name=/world/var/process>
<h2>process var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/world/var/system_type>system_type var (world)</a>
<dd><a href=#/proc/shell>shell proc</a>
</dl>

<p>This read-only variable indicates the ID of the server's process on the
system running it. The result is a number, unless for some unexpected
reason the number won't fit in a <tt>num</tt> type, in which case it will
be text. (In practice it should always be a number.)

<hr>

<a name=/world/var/realtime>
<h2>realtime var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/time>time var (world)</a>
<dd><a href=#/world/var/timeofday>timeofday var (world)</a>
<dd><a href=#/proc/time2text>time2text proc</a>
</dl>

<p>This is the time (in 1/10 seconds) since 00:00:00 GMT, January 1, 2000
(also known as the BYOND era).

<p>Because this is a large number, BYOND's number system isn't capable of
enough precision to deliver the exact number of 1/10 second ticks. It usually
rounds off to the nearest several seconds. For more accurate readings use
<code>world.timeofday</code>.

<hr>

<a name=/world/var/reachable>
<h2 byondver=502>reachable var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/port>port var (world)</a>
<dd><a href=#/world/proc/OpenPort>OpenPort proc (world)</a>
</dl>

<p>Returns 1 if the world is currently hosted and the port can be reached by
players (as determined by the BYOND hub), 0 if not.

<p>If the port is not reachable, there may be a brief period during which the
hub is still attempting to make contact; during that time the port is assumed
to be reachable. Currently, the reachability test times out and fails after
30 seconds.

<hr>

<a name=/world/var/sleep_offline>
<h2>sleep_offline var (world)</h2>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Setting this to 1 causes the world to be suspended when there are no
players, even if you have sleeping procs waiting to happen.  The default
value is 0, which means the server will only sleep if there are no players
and no procs waiting to happen.  The main purpose of the variable is to save
the cpu from doing work when there is nobody around to appreciate it.  On the
other hand, that doesn't give the poor NPC's a break from the nasty humans.

<hr>

<a name=/world/var/status>
<h2>status var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/hub>hub var (world)</a>
<dd><a href=#/world/var/game_state>game_state var (world)</a>
<dd><a href=#/world/var/visibility>visibility var (world)</a>
</dl>

<p>This is a short text string used in BYOND hub to describe the state of a
game in progress.  For example, you might want to indicate if new players
will be able to actively play, or whether they would have to join as
spectators.

<h3>Example:</h3>
<xmp>
world
   status = "accepting players"
mob/verb/start_game()
   world.status = "accepting spectators"
   //...
</xmp>

<hr>

<a name=/world/var/system_type>
<h2>system_type var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/byond_version>byond_version var (world)</a>
<dd><a href=#/world/var/process>process var (world)</a>
<dd><a href=#/proc/shell>shell proc</a>
</dl>

<p>This variable indicates the operating system type at run-time.  It will be
one of the following constants:

<ul>
<li>MS_WINDOWS
<li>UNIX
</ul>

<hr>

<a name=/world/var/tick_lag>
<h2>tick_lag var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/fps>fps var (world)</a>
<dd><a href=#/client/var/tick_lag>tick_lag var (client)</a>
<dd><a href=#/world/var/tick_usage>tick_usage var (world)</a>
<dd><a href=#/proc/sleep>sleep proc</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1
</dl>

<p>This is the smallest unit of time (one server tick) measured in 1/10
seconds.  The duration of events that take some finite amount of time (like
sleep) will be rounded to a whole number of ticks.

<p>Players are limited to one command (including movements) per server tick,
so this value can be used to adjust the responsiveness of the game.  If the
network is too slow to keep up with players, their commands will get queued
up, which can be annoying when trying to move.  In this case, tick_lag
should be increased so that the stored up movement commands are discarded.
On the other hand, if you have a very fast network, you may wish to decrease
tick_lag to speed up the response time to player commands.

<p>Often it is more convenient to set world.fps instead of world.tick_lag,
since fps (frames per second) is an easier way to think of server ticks.
world.tick_lag is 10 / world.fps and vice-versa, so a tick_lag of 0.25 is
equal to 40 fps.

<p>If you set client.tick_lag or client.fps to a value other than 0, you can
make the client tick at a different (usually faster) rate.

<hr>

<a name=/world/var/tick_usage>
<h2 byondver=510>tick_usage var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/cpu>cpu var (world)</a>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
<dd><a href=#/world/proc/Tick>Tick proc (world)</a>
</dl>

<p>This is the approximate percentage of the server tick that has been used
already.  A value under 100 means there's time to do more calculations, which
can include any pending procs that are still waiting to run on this tick.
When the value is over 100, the tick is running long and your world will
experience lag.

<p>Keep in mind that sending maps to clients is the last thing that happens
during a tick, except for handling any events such as player commands that
might arrive before the next tick begins. Therefore in a verb,
<tt>tick_usage</tt> might have a higher value than you would expect to see in
a proc that loops and sleeps.

<hr>

<a name=/world/var/time>
<h2>time var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/realtime>realtime var (world)</a>
<dd><a href=#/world/var/tick_lag>tick_lag var (world)</a>
</dl>

<p>This gives the amount of time (in 1/10 seconds) that the world has been
running.  In actual fact, it is the number of server ticks that have passed
multiplied by world.tick_lag.  Therefore if the server sleeps (when no
players are connected) this time is not counted.  Also, if the server runs
overtime during a tick (because procs take longer than tick_lag to finish)
this still only counts as one tick.  This value is therefore a measure of
"game time" rather than real time.

<hr>

<a name=/world/var/timeofday>
<h2>timeofday var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/realtime>realtime var (world)</a>
<dd><a href=#/world/var/time>time var (world)</a>
<dd><a href=#/proc/time2text>time2text proc</a>
</dl>

<p>This is the time (in 1/10 seconds) since 00:00:00 GMT today. It is
basically identical to <code>world.realtime</code> but doesn't include any
information about the date. This is a much smaller number; hence it is more
accurate.

<hr>

<a name=/world/var/timezone>
<h2 byondver=514>timezone var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/realtime>realtime var (world)</a>
<dd><a href=#/world/var/timeofday>timeofday var (world)</a>
<dd><a href=#/client/var/timezone>timezone var (client)</a>
<dd><a href=#/proc/time2text>time2text proc</a>
</dl>

<p>This is the time offset from UTC, in hours, for the world's time zone. It
can be used in the <tt>time2text()</tt> proc, although it is the default time
zone for that proc.

<hr>

<a name=/world/var/turf>
<h2>turf var (world)</h2>

<dl><dt><b>Default value:</b>
<dd>/turf.
</dl>

<p>This is the default turf type to be placed on the map wherever no turf is
specified.  A value of 0 turns off the default turf.

<hr>

<a name=/world/var/url>
<h2>url var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/address>address var (world)</a>
</dl>

<p>This is the full network address of the world.  (For example,
byond://dan.byond.com:6005.)

<hr>

<a name=/world/var/version>
<h2>version var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/hub>hub var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>If you are distributing your game to players, you can use this variable
to automatically notify them of new releases.  To do so, you will first need
to set <a href=#/world/var/hub><code>world.hub</code></a> to the hub
path of your game.  You can then advertise the current version by
configuring that value in your
<a href=https://secure.byond.com/members/?command=edit_hub>hub console</a>.

<p>When players boot up an outdated version of your game (as indicated by
comparing <code>world.version</code> with the version advertised by BYOND
hub), they will be notified of the new release.

<hr>

<a name=/world/var/view>
<h2>view var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/client/var/lazy_eye>lazy_eye var (client)</a>
<dd><a href=#/client/var/show_map>show_map var (client)</a>
<dd><a href=#/proc/view>view proc</a>
<dd><a href=#/client/var/view>view var (client)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>5
</dl>

<dl><dt><b>Possible values:</b>
<dd>-1 to 34 or "WIDTHxHEIGHT"
</dl>

<p>This is the default map viewport range.  The default value of 5 produces an
11x11 viewport.  A value of -1 turns off the map display altogether.  The client may automatically
scale down icons in order to conveniently fit the map on the player's screen.

<p>For non-square views, you can assign this to a text string of the form
"WIDTHxHEIGHT".  For example, "11x11" is equivalent to a view depth of 5, but
you could make it wider like this: "13x11".

<p>This setting also affects the default range of the <code>view()</code>,
<code>oview()</code>, <code>range()</code>, and <code>orange()</code>
procedures.

<p>If the entire map is small enough to fit on one screen 
(arbitrarily defined to be 21x21 or less),
the default <code>view</code> is automatically adjusted to fit the map.  In
this case, <code>client.lazy_eye</code> is also automatically turned on by
default, since you probably don't want the map to scroll around.

<hr>

<a name=/world/var/visibility>
<h2>visibility var (world)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/proc/OpenPort>OpenPort proc (world)</a>
<dd><a href=#/world/var/hub>hub var (world)</a>
</dl>

<dl><dt><b>Default value:</b>
<dd>1 (visible)
</dl>

<p>This controls whether the world advertises itself in the
<a href=http://www.byond.com/games/>BYOND Hub</a> when it has an open network
port for accepting players.  The visibility of the world still depends on
whether any of the connected players has their location reporter turned on,
and that in turn relies on the pager being turned on.

<hr>

<a name=/{notes} toc="Special notes">
<h2>Special notes</h2>

<p>This section of the reference should help explain some concepts that
may be harder to understand or that can use more clarification.

<dl><dt><dt><b>Language features</b>
<dd><a href=#/{notes}/numbers>Numbers</a>
<dd><a href=#/{notes}/regex>Regular expressions</a>
<dd><a href=#/{notes}/Unicode>Unicode</a>
<dt><b>Icons</b>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>
<dt><b>Map formats</b>
<dd><a href=#/{notes}/topdown>Topdown maps</a>
<dd><a href=#/{notes}/isometric>Isometric maps</a>
<dd><a href=#/{notes}/side>Side-view maps</a>
<dt><dt><b>Movement</b>
<dd><a href=#/{notes}/gliding>Gliding</a>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
<dt><dt><b>Display</b>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
<dd><a href=#/{notes}/HUD>HUD / screen objects</a>
<dd><a href=#/{notes}/color-matrix>Color matrix</a>
<dd><a href=#/{notes}/filters>Filter effects</a>
<dd><a href=#/{notes}/particles>Particle effects</a><dl>
<dd><a href=#/{notes}/color-gradient>Color gradient</a>
<dd><a href=#/{notes}/generators>Generators</a></dl>
<dd><a href=#/{notes}/projection-matrix>Projection matrix</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{notes}/TOPDOWN_LAYER>TOPDOWN_LAYER</a>
</dl>

<hr>

<a name=/{notes}/BACKGROUND_LAYER>
<h2>BACKGROUND_LAYER</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/atom/var/plane>plane var (atom)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{notes}/TOPDOWN_LAYER>TOPDOWN_LAYER</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<p>This is mostly no longer needed. A negative value for plane is the
preferred way to do show objects in the background. It can still be used
however when you want to rearrange objects in the same plane when using
<a class=code href=#/atom/var/appearance_flags>PLANE_MASTER</a> for visual
effects.

<p><tt>BACKGROUND_LAYER</tt> is a special high value that can be added to the
regular layer of any atom.

<p>The purpose of this value is to make an atom appear below any regular
atoms, even if they share the same plane. In an isometric map for instance,
HUD objects will always appear above the map, but makeing a HUD object appear
behind the map was basically impossible without this feature until
<tt>plane</tt> was implemented.

<p>When using this special layer, it should be added to the layer an atom
normally uses. For instance an obj should have a layer of <tt>BACKGROUND_LAYER
+ OBJ_LAYER</tt>.

<p>This can be mixed with <tt>TOPDOWN_LAYER</tt> and <tt>EFFECTS_LAYER</tt>,
but it will take precedence over both. Anything with <tt>BACKGROUND_LAYER</tt>
will always appear below anything without it on the same plane.

<p>Images or overlays with <tt>FLOAT_LAYER</tt> can be left alone. They will
automatically have the same layer as whatever atom they are attached to.

<hr>

<a name=/{notes}/big-icons toc="Big icons">
<h2>Big icons</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/icon/proc/Blend>Blend proc (icon)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/{notes}/tiled-icons>Tiled icons</a>
<dd><a href=#/{notes}/isometric>Isometric maps</a>
<dd><a href=#/{notes}/side>Side-view maps</a>
</dl>

<p>BYOND allows you to use icons that are not the same size as the tile size
defined in world.icon_size. These icons can be manipulated with the /icon datum
using their raw, native size, and shown on the map in full size. To use the old
behavior where an atom can display only an icon of the normal tile size, use
the TILED_ICON_MAP value for map_format instead.

<p>When you use an icon of non-standard size on an atom, the icon is "anchored"
to the southwest corner of the atom. If you are using a top-down view
(world.map_format=TOPDOWN_MAP), the icon will appear to spread out further to
the east and north. In an isometric map (world.map_format=ISOMETRIC_MAP), the
icon will cover additional tiles north and east as well. The "footprint" of an
isometric icon--the actual map tiles it covers--is always square, so if your
tile size is 64x64 and you use a 128x64 icon, the 128-pixel width means the
icon will cover a 2x2 section of map tiles.

<p>It is important to remember that using a big icon is a visual effect
<i>only</i>. It will not affect how the atom bumps into other atoms or
vice-versa.

<p>Big icons will affect layering--the order in which icons are drawn. In
general, because a big icon is covering more than one tile of the map, it will
try to draw above any other tiles in that space that are on the same layer.
This way, you can set a turf to use a big icon without having to change the
turfs to the north and east. If an atom has a big icon, any overlays and
underlays attached to it will be pulled forward as well, so they will draw in
front of anything on their same layer. In isometric mode this is about the same,
except that the layer isn't that important--anything in the way will just be
moved back behind the big icon.

<p>Note: Big overlays will not "pull forward" on their own. If the main atom
uses a single-tile icon, a big overlay attached to it will not try to draw in
front of other icons on the same layer. This is so that name labels, health
bar overlays, etc. will not cause any odd behavior. To be safe, you should
always specify a layer when adding an overlay.

<p>In isometric mode, layering is affected by the "distance" between the atom
and the viewer, so putting a regular-sized icon and part of a big icon on the
same tile could cause layering oddities. Tiles that are covered by a big icon
will tend to be drawn behind the big icon as mentioned above. For this reason,
any atoms whose icons cover more than one tile (the extra height of an
isometric icon doesn't count) should always be dense, and you should block
movement onto any tile covered by them.

<p>When manipulating icons with the /icon datum, you can still use Blend() to
combine icons of different sizes. By default, the icons will be lined up at
their southwest corners. You can change the position at which the second icon
is blended.

<hr>

<a name=/{notes}/color-gradient toc="Color gradient">
<h2 byondver=514>Color gradient</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/gradient>gradient proc</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/{notes}/particles>Particle effects</a>
<dd><a href=#/{{appendix}}/color-space>Color space</a>
</dl>

<p>A color gradient is a special list that defines a range of colors that you
can smoothly interpolate between. A simple example is a gradient from red to
white:

<h3>Example:</h3>
<xmp>
list("red", "white")
// OR
list(0, "red", 1, "white")
</xmp>

<p>Applying a number like 0.2 to this gradient would give you a color that's
20% of the way from red to white. More complex gradients however are also
possible.

<p>The format of a gradient is a list that contains a number (the position
along the gradient, from 0 to 1 unless you use values outside that range)
followed by a color. You can have as complex a gradient as you like. If you
reuse the same number twice in a row, the gradient will have a sudden color
change at that point.

<p>It is also possible to skip numbers or colors, and they will be filled in
automatically with the previous number or color. The exceptions are at the
beginning and ends of the list; at the end of the gradient, the last color is
assigned a number 1 by default, and the first is assigned 0. If you skip
colors at the beginning, they will be filled in with the first color you use.

<p>Include "loop" anywhere in the list to make this a looped gradient. If you
don't, any numbers outside the gradient's range will be clamped to that range.
E.g., in a normal gradient ranging from 0 to 1, a number of 1.2 is
interpreted as 1 without a loop and 0.2 with a loop.

<p>Here are some more examples:

<h3>Example:</h3>
<xmp>
// color wheel; ranges 0 to 6 and loops
list(0, "#f00", 1, "#ff0", 2, "#0f0", 3, "#0ff", 4, "#00f", 5, "#f0f", 6, "#f00", "loop")

// 10% each red, yellow, green, blue, with a 20% transition zone between each
// notice no color follows 0.4 or 0.7, so the previous color is used
list(0.1, "#f00", 0.3, "#ff0", 0.4, 0.6, "#008000", 0.7, 0.9, "#00f")

// green and black stripes
list(0.5, "#008000", 0.5, "#000000", "loop")
</xmp>

<p>You can also include "space" in the list, and give it an associated value
that describes the color space this gradient uses to interpolate between
colors. For instance, <tt>"space"=COLORSPACE_HSL</tt> will use HSL
interpolation instead of the default RGB. See
<a href=#/{{appendix}}/color-space>Color space</a> for more information.

<h3>Example:</h3>
<xmp>
// color wheel with a different color space
list(0, "#f00", 3, "#0ff", 6, "#f00", "loop", "space"=COLORSPACE_HSLA)
</xmp>

<p>Currently, color gradients are only used by particle effects and the
<a href=#/proc/gradient><tt>gradient</tt> proc</a>. With particles, if you use
a gradient the particle's color is given as a number, and that number is used
to look up its real color from the gradient. The number can change over time,
thus changing the particle's color.

<hr>

<a name=/{notes}/color-matrix toc="Color matrix">
<h2 byondver=509>Color matrix</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/client/var/color>color var (client)</a>
<dd><a href=#/icon/proc/MapColors>MapColors proc (icon)</a>
</dl>

<p>A color matrix is used to transform colors, in the same way that a matrix
represented by the <tt>/matrix</tt> datum is used to transform 2D coordinates.
A transformation matrix is 3x3, of which only 6 values are needed because the
last column is always the same.  A color matrix, because it transforms four
different numbers instead of two, is 5x5.

<pre>
                |rr rg rb ra 0|
                |gr gg gb ga 0|
[r g b a 255] x |br bg bb ba 0| = [r' g' b' a' 255]
                |ar ag ab aa 0|
                |cr cg cb ca 1|
</pre>

<p>In easier-to-understand terms, this is how the result is calculated:

<xmp>
new_red   = red * rr + green * gr + blue * br + alpha * ar + 255 * cr
new_green = red * rg + green * gg + blue * bg + alpha * ag + 255 * cg
new_blue  = red * rb + green * gb + blue * bb + alpha * ab + 255 * cb
new_alpha = red * ra + green * ga + blue * ba + alpha * aa + 255 * ca
</xmp>

<p>It is helpful to think of each row in the matrix as what each component of
the original color will become. The first row of the matrix is the rgba value
you'll get for each unit of red; the second is what each green becomes, and so
on.

<p>Because the fifth column of the matrix is always the same, only 20 of the
values need to be provided.  You can use a color matrix with atom.color or
client.color in any of the following ways:

<dl class=codedd>
<dt>RGB-only (9 to 12 values)
<dd>list(rr,rg,rb, gr,gg,gb, br,bg,bb, cr,cg,cb)
<dt>RGBA (16 to 20 values)
<dd>list(rr,rg,rb,ra, gr,gg,gb,ga, br,bg,bb,ba, ar,ag,ab,aa, cr,cg,cb,ca)
<dt>Row-by-row (3 to 5 <tt>rgb()</tt> values, or null to use the default row)
<dd>list(red_row, green_row, blue_row, alpha_row, constant_row)
</dl>

<p>Reading a color var that has been set to a matrix will return the full
20-item list, where every 4 items represent a row in the matrix (without the
fifth column).

<p>In the <tt>MapColors()</tt> icon proc, the values are sent as arguments,
not as a list.

<hr>

<a name=/{notes}/EFFECTS_LAYER>
<h2>EFFECTS_LAYER</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/atom/var/plane>plane var (atom)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/TOPDOWN_LAYER>TOPDOWN_LAYER</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<p>This is mostly no longer needed. A negative value for plane is the
preferred way to do show objects in the background. It can still be used
however when you want to rearrange objects in the same plane when using
<a class=code href=#/atom/var/appearance_flags>PLANE_MASTER</a> for visual
effects.

<p><tt>EFFECTS_LAYER</tt> is a special high value that can be added to the
regular layer of any atom.

<p>The purpose of this value is to make an atom appear above any regular
atoms. For instance, in an isometric map if you want to display a character's
name below them, it does not make much sense to have nearer objects cover up
that name, so you can tell the name overlay to use <tt>EFFECTS_LAYER +
MOB_LAYER</tt> and it will show up on top of all the normal icons on the map.
This has been somewhat obviated by <tt>plane</tt> but may still be useful in
some cases.

<p>When using this special layer, it should be added to the layer an atom
normally uses. For instance an obj should have a layer of <tt>EFFECTS_LAYER +
OBJ_LAYER</tt>.

<p>This can be mixed with <tt>TOPDOWN_LAYER</tt>, in non-topdown map formats.
Anything in <tt>TOPDOWN_LAYER</tt> will display on top of
<tt>EFFECTS_LAYER</tt>, and <tt>TOPDOWN_LAYER + EFFECTS_LAYER</tt> will be
above both.

<p>This can also be mixed with <tt>BACKGROUND_LAYER</tt>, which takes priority
over everything else.

<p>Images or overlays with <tt>FLOAT_LAYER</tt> can be left alone. They will
automatically have the same layer as whatever atom they are attached to.

<hr>

<a name=/{notes}/filters toc="Filter effects">
<h2 byondver=512>Filter effects</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/filters>filters var (atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/proc/filter>filter proc</a>
<dd><a href=#/proc/animate>animate proc</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<p>Filters are a way of adding special effects to an icon, or a group of icons
(see <tt>KEEP_TOGETHER</tt> in
<a class=code href=#/atom/var/appearance_flags>appearance_flags</a>), by
post-processing the image. A filter object describes a specific form of image
processing, like for instance a blur or a drop shadow. Filters can be added or
removed at will, and can even be animated.

<p>A filter is created by using the <a href=#/proc/filter>filter proc</a> like
so:

<xmp>
// halo effect
mob.filters += filter(type="drop_shadow", x=0, y=0,\
                      size=5, offset=2, color=rgb(255,255,170))
</xmp>

<p>These are the filters currently supported:

<ul>
<li byondver=513><a href=#/{notes}/filters/alpha>Alpha mask</a></li>
<li byondver=513><a href=#/{notes}/filters/angular_blur>Angular blur</a></li>
<li byondver=514><a href=#/{notes}/filters/bloom>Bloom</a></li>
<li byondver=513><a href=#/{notes}/filters/color>Color matrix</a></li>
<li byondver=513><a href=#/{notes}/filters/displace>Displacement map</a></li>
<li><a href=#/{notes}/filters/drop_shadow>Drop shadow</a></li>
<li><a href=#/{notes}/filters/blur>Gaussian blur</a></li>
<li byondver=513><a href=#/{notes}/filters/layer>Layering (composite)</a>
<li><a href=#/{notes}/filters/motion_blur>Motion blur</a></li>
<li><a href=#/{notes}/filters/outline>Outline</a></li>
<li byondver=513><a href=#/{notes}/filters/radial_blur>Radial blur</a></li>
<li byondver=513><a href=#/{notes}/filters/rays>Rays</a></li>
<li byondver=513><a href=#/{notes}/filters/ripple>Ripple</a></li>
<li><a href=#/{notes}/filters/wave>Wave</a></li>
</ul>

<hr>

<a name=/{notes}/filters/alpha toc="Alpha mask (filters)">
<h2 byondver=513>Alpha mask filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/atom/var/render_target>render_target var (atom)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="alpha", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horizontal offset of mask (defaults to 0)</dd>
<dd>y: Vertical offset of mask (defaults to 0)</dd>
<dd>icon: Icon to use as a mask</dd>
<dd>render_source: <tt>render_target</tt> to use as a mask</dd>
<dd>flags: Defaults to 0; use see below for other flags</dd>
</dl>

<p>Uses an icon or render target as a mask over this image. Every pixel that
is transparent in either the image or the mask, is transparent in the result.

<p>The <tt>x</tt> and <tt>y</tt> values can move the mask from its normal
position. By default, the mask is centered over the center of the image.

<p>The <tt>MASK_INVERSE</tt> flag will invert the alpha mask so that opaque
areas in the mask become transparent, and vice-versa. There is also a
<tt>MASK_SWAP</tt> flag which treats the source image as the mask and
vice-versa, which might be useful for some effects.

<p>Note: Unlike many other filters, this filter <b>is</b> taken into account
for mouse-hit purposes.

<hr>

<a name=/{notes}/filters/angular_blur toc="Angular blur (filters)">
<h2 byondver=513>Angular blur filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/blur>Gaussian blur (filters)</a>
<dd><a href=#/{notes}/filters/radial_blur>Radial blur (filters)</a>
<dd><a href=#/{notes}/filters/motion_blur>Motion blur (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="angular_blur", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horizontal center of effect, in pixels, relative to image center</dd>
<dd>y: Vertical center of effect, in pixels, relative to image center</dd>
<dd>size: Amount of blur (defaults to 1)</dd>
<dd byondver=516>offset: Pixel radius before blurring occurs</dd>
</dl>

<p>Blurs the image by a certain amount in a circular formation, as if the
image is spinning. The size of the blur can roughly be thought of in "degrees"
worth of blur. As the distance from the center increases, the blur becomes
more noticeable since the same amount of angular motion has to travel farther
along a circle.

<p>Typically this blur is used with an entire plane, but it could be used to
give a sense of motion blur to a spinning object.

<p>Note: Large blurs will look worse toward the edges due to limited sampling.
Loss of accuracy will appear where <tt>size</tt> &times; distance is greater
than about 300. You can increase accuracy by breaking up large sizes into
multiple filter passes with differing sizes. The blur used is Gaussian, so
combining blur sizes A and B will give a total size of
sqrt(A<sup>2</sup>+B<sup>2</sup>).

<p>The <tt>offset</tt> parameter, if used, is effectively subtracted from the
pixel distance to the center. Pixels within that radius won't blur. Anything
outside that radius will act as if it's <tt>offset</tt> pixels closer to the
center.

<hr>

<a name=/{notes}/filters/bloom toc="Bloom (filters)">
<h2 byondver=514>Bloom filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/blur>Gaussian blur (filters)</a>
<dd><a href=#/{notes}/filters/drop_shadow>Drop shadow (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="bloom", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>threshold: Color threshold for bloom</dd>
<dd>size: Blur radius of bloom effect (see Gaussian blur)</dd>
<dd>offset: Growth/outline radius of bloom effect before blur</dd>
<dd>alpha: Opacity of effect (default is 255, max opacity)</dd>
</dl>

<p>Post-processing effect that makes bright colors look like they're a strong
light source, spreading their light additively to other nearby pixels. This is
a complex effect that involves multiple shader passes. For both performance and
visual reasons, it is usually best applied to an entire plane rather than to
individual objects.

<p>The color <tt>threshold</tt> determines which pixels this effect applies to.
If any of the red, green, or blue components of the pixel are greater than the
same component for the threshold, that pixel will bloom. The blooming pixels
then have their colors spread outward to create a glow that gets added to the
original image.

<p>The <tt>offset</tt> and <tt>size</tt> parameters are used to control the
glow effect. They work the same as they do in the drop shadow filter:
<tt>offset</tt> causes the light to grow outwards, and a blur of <tt>size</tt>
is then applied to soften it. Often just using a blur alone will produce a
pleasing effect. By playing with these two values you can make the bloom effect
appear differently.

<p>The <tt>alpha</tt> value is applied to any light contributions from bloomed
pixels that get added to the original image, so values lower than 255 can make
the effect less pronounced. This can be very useful if you choose to animate
the filter.

<hr>

<a name=/{notes}/filters/blur toc="Gaussian blur (filters)">
<h2 byondver=512>Gaussian blur filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/motion_blur>Motion blur (filters)</a>
<dd><a href=#/{notes}/filters/radial_blur>Radial blur (filters)</a>
<dd><a href=#/{notes}/filters/angular_blur>Angular blur (filters)</a>
<dd><a href=#/{notes}/filters/drop_shadow>Drop shadow (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="blur", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>size: Amount of blur (defaults to 1)</dd>
</dl>

<p>Blurs the image by a certain amount. The size of the blur can roughly be
thought of in "pixels" worth of blur.

<p class=performance>Note: Large blurs will result in reduced performance. The
highest size that can be handled easily in this filter is 6. Higher sizes
require multiple passes, although the filter will "cheat" and use low-quality
passes for much higher sizes.

<hr>

<a name=/{notes}/filters/color toc="Color matrix (filters)">
<h2 byondver=513>Color matrix filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/{notes}/color-matrix>Color matrix</a>
<dd><a href=#/{{appendix}}/color-space>Color space</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="color", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>color: A color matrix</dd>
<dd>space: Value indicating color space: defaults to <tt>FILTER_COLOR_RGB</tt></dd>
</dl>

<p>Applies a color matrix to this image. Unlike with the atom.color var, you
can apply color conversions other than the regular RGBA color space, depending
on the value of <tt>space</tt>. See <a href=#/{{appendix}}/color-space>Color
space</a> for more information.

<hr>

<a name=/{notes}/filters/displace toc="Displacement map (filters)">
<h2 byondver=513>Displacement map filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/alpha>Alpha mask (filters)</a>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/atom/var/render_target>render_target var (atom)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="displace", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horizontal offset of map (defaults to 0)</dd>
<dd>y: Vertical offset of map (defaults to 0)</dd>
<dd>size: Maximum distortion, in pixels</dd>
<dd>icon: Icon to use as a displacement map</dd>
<dd>render_source: <tt>render_target</tt> to use as a displacement map</dd>
<dd>flags: Defaults to 0; use see below for other flags</dd>
</dl>

<p>Uses an icon or render target as a template for various warping effects on
the main image. Think of displacement as "pulling" a pixel from an offset
location.

<p>In the displacement map, pixels that have a higher red component will make
the image appear to warp to the left, lower reds warp it to the right, and
gray (r=128) will cause no horizontal warping. The green component affects the
vertical: higher to warp upward, lower to warp downward. Transparent pixels in
the displacement map will have no effect.

<p>This can be used for very complex distortion, unlike other distortion
filters such as wave and ripple that are confined to specific equations.

<p>The optional <tt>FILTER_OVERLAY</tt> flag is supported for the
<tt>flags</tt> argument, which will overlay the displaced image onto the
original.

<hr>

<a name=/{notes}/filters/drop_shadow toc="Drop shadow (filters)">
<h2 byondver=512>Drop shadow filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/blur>Gaussian blur (filters)</a>
<dd><a href=#/{notes}/filters/outline>Outline (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="drop_shadow", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Shadow horizontal offset (defaults to 1)</dd>
<dd>y: Shadow horizontal offset (defaults to -1)</dd>
<dd>size: Blur amount (defaults to 1; negative values create inset shadows)</dd>
<dd>offset: Size increase before blur (defaults to 0)</dd>
<dd>color: Shadow color (defaults to 50% transparent black)</dd>
</dl>

<p>Applies a drop shadow to this image. This is a combination of multiple
filters, since it will apply an outline if <tt>offset</tt> is included, a
Gaussian blur to the shadow, and will underlay the shadow beneath the image.

<p>You can also think of this filter as an outer glow.

<p>If you use a <tt>size</tt> less than 0, the shadow will appear inside the
image instead. This would be an inset shadow, or inner glow.

<hr>

<a name=/{notes}/filters/layer toc="Layering / composite (filters)">
<h2 byondver=513>Layering (composite) filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/icon>icon var (atom)</a>
<dd><a href=#/atom/var/render_target>render_target var (atom)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="layer", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horizontal offset of second image (defaults to 0)</dd>
<dd>y: Vertical offset of second image (defaults to 0)</dd>
<dd>icon: Icon to use as a second image</dd>
<dd>render_source: <tt>render_target</tt> to use as a second image</dd>
<dd>flags: <tt>FILTER_OVERLAY</tt> (default) or <tt>FILTER_UNDERLAY</tt></dd>
<dd>color: <a href=#/atom/var/color>Color</a> or color matrix to apply to second image</dd>
<dd>transform: <a href=#/atom/var/transform>Transform</a> to apply to second image</dd>
<dd>blend_mode: <a href=#/atom/var/blend_mode>Blend mode</a> to apply to the top image</dd>
</dl>

<p>Composites another image over or under this image. Using the
<tt>FILTER_OVERLAY</tt> flag, which is the default, puts the second image
on top of what's already here. <tt>FILTER_UNDERLAY</tt> puts it underneath.

<p>The <tt>x</tt> and <tt>y</tt> values can move the mask from its normal
position. By default, the second image is centered over the center of the
first.

<p>The <tt>color</tt>, <tt>transform</tt>, and <tt>blend_mode</tt> vars are
available for convenience. Because the bottom image is drawn over a blank
background, <tt>blend_mode</tt> is always applied to the top image. All of
the other vars apply to the second image being drawn.

<p>Note: Transforms use default bilinear scaling, since
<a class=code href=#/atom/var/appearance_flags>PIXEL_SCALE</a> is not
available here.</p>

<p>Note: Like most other filters, this filter is <b>not</b> taken into account
for mouse-hit purposes. Any layered icons will be strictly visual.

<hr>

<a name=/{notes}/filters/motion_blur toc="Motion blur (filters)">
<h2 byondver=512>Motion blur filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/filters>filters var (atom)</a>
<dd><a href=#/{notes}/filters/blur>Gaussian blur (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="motion_blur", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Blur vector on the X axis (defaults to 0)</dd>
<dd>y: Blur vector on the Y axis (defaults to 0)</dd>
</dl>

<p>Applies Gaussian blur in one direction only. The amount and direction are
both specified by <tt>x</tt> and <tt>y</tt>. The size of the blur is equal to
<tt>sqrt(x*x + y*y)</tt>.

<p>See <a href=#/{notes}/filters/blur>Gaussian blur</a> for more information.

<hr>

<a name=/{notes}/filters/outline toc="Outline (filters)">
<h2 byondver=512>Outline filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/drop_shadow>Drop shadow (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="outline", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>size: Width in pixels (defaults to 1)</dd>
<dd>color: Outline color (defaults to black)</dd>
<dd byondver=513>flags: Defaults to 0 (see below)</dd>
</dl>

<p>Applies an outline to this image.

<p>At larger sizes, the outline is less accurate and will take more passes to
produce. Performance and appearance are best at sizes close to 1 or less.

<p><tt>flags</tt> can be a combination of the following values:
<dl class=codedt>
<dt>0</dt><dd>Ordinary outline</dd>
<dt>OUTLINE_SHARP</dt><dd>Avoid antialiasing in the outline</dd>
<dt>OUTLINE_SQUARE</dt><dd>Extend the outline sharply from corner pixels; for a box this will maintain a box shape without rounded corners</dd>
</dl>

<hr>

<a name=/{notes}/filters/radial_blur toc="Radial blur (filters)">
<h2 byondver=513>Radial blur filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/blur>Gaussian blur (filters)</a>
<dd><a href=#/{notes}/filters/angular_blur>Angular blur (filters)</a>
<dd><a href=#/{notes}/filters/motion_blur>Motion blur (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="radial_blur", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horizontal center of effect, in pixels, relative to image center</dd>
<dd>y: Vertical center of effect, in pixels, relative to image center</dd>
<dd>size: Amount of blur per pixel of distance (defaults to 0.01)</dd>
<dd byondver=516>offset: Pixel radius before blurring occurs</dd>
</dl>

<p>Blurs the image by a certain amount outward from the center, as if the
image is zooming in or out. As the distance from the center increases, the
amount of blurring increases, and near the center the blur is hardly visible
at all. The <tt>size</tt> value is smaller by default for this filter than it
is for other filters, since it's typically used with an entire plane where the
distance from the center can easily be several hundred pixels.

<p>Typically this blur is used with an entire plane.

<p>Note: Large blurs will look worse toward the edges due to limited sampling.
Loss of accuracy will begin when <tt>size</tt> &times; distance is greather
than 6. You can increase accuracy by breaking up large sizes into multiple
filter passes. The blur used is Gaussian, so combining blur sizes A and B will
give a total size of sqrt(A<sup>2</sup>+B<sup>2</sup>).

<p>The <tt>offset</tt> parameter, if used, is effectively subtracted from the
pixel distance to the center. Pixels within that radius won't blur. Anything
outside that radius will act as if it's <tt>offset</tt> pixels closer to the
center.

<hr>

<a name=/{notes}/filters/rays toc="Rays (filters)">
<h2 byondver=513>Rays filter</h2>

<dl><dt>Format:</dt>
<dd>filter(type="rays", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horiztonal position of ray center, relative to image center (defaults to 0)</dd>
<dd>y: Vertical position of ray center, relative to image center (defaults to 0)</dd>
<dd>size: Maximum length of rays (defaults to 1/2 tile width)</dd>
<dd>color: Ray color (defaults to white)</dd>
<dd>offset: "Time" offset of rays (defaults to 0, repeats after 1000)</dd>
<dd>density: Higher values mean more, narrower rays (defaults to 10, must be whole number)</dd>
<dd>threshold: Low-end cutoff for ray strength (defaults to 0.5, can be 0 to 1)</dd>
<dd>factor: How much ray strength is related to ray length (defaults to 0, can be 0 to 1)</dd>
<dd>flags: Defaults to <tt>FILTER_OVERLAY | FILTER_UNDERLAY</tt> (see below)</dd>
</dl>

<p>Draws random rays that radiate outward from a center point. (That point may
be outside of the image.) As they move outward, their alpha value diminishes
linearly. These are meant to be animated. The <tt>offset</tt> value determines
the "time", where every jump of +1 can be a very different set of rays, and
every 1000 units this filter will repeat.

<p>The <tt>threshold</tt> value can be thought of as a way of culling
lower-strength rays. Ray strength is anywhere from 0 to 1 at any given angle,
but values below <tt>threshold</tt> may as well be 0. Values above that are
re-scaled into a range of 0 to 1.

<p>The <tt>factor</tt> parameter allows you to tie the ray's length to its
strength. At 0, the length of every ray is the same. At 1, the length ranges
from 0 to <tt>size</tt>. Generally speaking, the higher <tt>factor</tt> is,
the more the rays will appear to move outward as they strengthen and inward
as they weaken.

<p>Ray <tt>color</tt> can be provided as a matrix. Only the diagonal values of the
color matrix will be used, but using a matrix will allow you to set values
outside of the normal color range.

<p><tt>flags</tt> can have the following values:
<dl class=codedt>
<dt>0</dt><dd>The rays are drawn alone, erasing the existing image (useful for some effects).</dd>
<dt>FILTER_OVERLAY</dt><dd>The rays are overlaid on top of the existing image.</dd>
<dt>FILTER_UNDERLAY</dt><dd>The rays are drawn underneath the existing image.</dd>
<dt>FILTER_OVERLAY | FILTER_UNDERLAY</dt><dd>Default. For plane masters, this will use the <tt>FILTER_OVERLAY</tt> behavior and draw the rays over the plane, and for all other images it will default to <tt>FILTER_UNDERLAY</tt> to draw the rays beneath them.</dd>
</dl>

<hr>

<a name=/{notes}/filters/ripple toc="Ripple (filters)">
<h2 byondver=513>Ripple filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/wave>Wave (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="ripple", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horiztonal position of ripple center, relative to image center (defaults to 0)</dd>
<dd>y: Vertical position of ripple center, relative to image center (defaults to 0)</dd>
<dd>size: Maximum distortion in pixels (defaults to 1)</dd>
<dd>repeat: Wave period, in pixels (defaults to 2)</dd>
<dd>radius: Outer radius of ripple, in pixels (defaults to 0)</dd>
<dd>falloff: How quickly ripples lose strength away from the outer edge (defaults to 1)</dd>
<dd>flags: Defaults to 0; use <tt>WAVE_BOUNDED</tt> to keep distortion within the image</dd>
</dl>

<p>Applies a ripple distortion effect to this image.

<p>This filter is meant to be animated. A good animation will typically start
at a <tt>radius</tt> of 0 and animate to a larger value, with <tt>size</tt>
decreasing to 0.

<p>The <tt>falloff</tt> parameter can be tweaked to your liking. A value of 1
should look reasonably like ripples in water, with the inner ripples losing
strength. A value of 0 will cause no reduction in strength.

<p>The equation governing the ripple distortion is size &times; sin(2&pi;r') &divide; (2.5 &times; falloff &times; r'<sup>2</sup> + 1),
where r' = (radius - distance) &divide; repeat.

<p>Up to 10 ripples can be stacked together in a single pass of the filter, as
long as they have the same <tt>repeat</tt>, <tt>falloff</tt>, and
<tt>flags</tt> values. (See the wave filter for the <tt>WAVE_BOUNDED</tt> flag.)

<hr>

<a name=/{notes}/filters/wave toc="Wave (filters)">
<h2 byondver=512>Wave filter</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/filters/ripple>Ripple (filters)</a>
</dl>

<dl><dt>Format:</dt>
<dd>filter(type="wave", ...)</dd>
</dl>

<dl><dt>Args:</dt>
<dd>x: Horiztonal direction and period of wave</dd>
<dd>y: Vertical direction and period of wave</dd>
<dd>size: Maximum distortion in pixels (defaults to 1)</dd>
<dd>offset: Phase of wave, in periods (e.g., 0 to 1)</dd>
<dd>flags: Defaults to 0; see below for other flags</dd>
</dl>

<p>Applies a wave distortion effect to this image.

<p>The <tt>x</tt> and <tt>y</tt> parameters specify both the direction and
period of the wave; the period is <tt>sqrt(x*x + y*y)</tt>.

<p>This filter is meant to be animated, from whatever <tt>offset</tt> you want
to <tt>offset+1</tt>, and then repeating. With multiple waves, you can produce
a very convincing water effect.

<h3>Example</h3>
<xmp>
#define WAVE_COUNT 7
atom/proc/WaterEffect()
    var/start = filters.len
    var/X,Y,rsq,i,f
    for(i=1, i<=WAVE_COUNT, ++i)
        // choose a wave with a random direction and a period between 10 and 30 pixels
        do
            X = 60*rand() - 30
            Y = 60*rand() - 30
            rsq = X*X + Y*Y
        while(rsq<100 || rsq>900)   // keep trying if we don't like the numbers
        // keep distortion (size) small, from 0.5 to 3 pixels
        // choose a random phase (offset)
        filters += filter(type="wave", x=X, y=Y, size=rand()*2.5+0.5, offset=rand())
    for(i=1, i<=WAVE_COUNT, ++i)
        // animate phase of each wave from its original phase to phase-1 and then reset;
        // this moves the wave forward in the X,Y direction
        f = filters[start+i]
        animate(f, offset=f:offset, time=0, loop=-1, flags=ANIMATION_PARALLEL)
        animate(offset=f:offset-1, time=rand()*20+10)
</xmp>

<p>The equation governing the wave distortion is size &times; sin(2&pi;(d - offset)),
where d is the number of wave periods' distance from the center along the x, y
direction.

<p>The <tt>WAVE_SIDEWAYS</tt> flag will cause the distortion to be transverse
(perpendicular) to the wave instead of in the same direction as the wave. The
<tt>WAVE_BOUNDED</tt> flag limits the distortion to the confines of this image,
instead of lettings its pixels spill out a little further from the distortion
(and likewise, transparent pixels spill inward).

<p>Up to 10 waves can be stacked together in a single pass of the filter, as long as they
have the same <tt>WAVE_BOUNDED</tt> flags.

<hr>

<a name=/{notes}/generators toc="Generators">
<h2 byondver=514>Generators</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/particles>Particle effects</a>
<dd><a href=#/proc/generator>generator proc</a>
<dd><a href=#/atom/var/color>color var (atom)</a>
<dd><a href=#/{notes}/color-matrix>Color matrix</a>
</dl>

<p>A generator is an object that can produce a random number, vector (list of 3 numbers), color (as a text string), or color matrix (list of 20 numbers) in a specified range according to rules you set down. It is used primarily for particle effects, since it can run on the client.

<p>There are several types of generators:

<ul>
<li><b>Numbers:</b> Generate a random real number.</li>
<li><b>Vectors:</b> Generate a random vector.</li>
<li><b>Shapes:</b> Generate a random vector within a specific shaped region.</li>
<li><b>Colors:</b> Generate a random color or color matrix.</li>
</ul>

<p>Generators can also be chained together with math operators and some procs. The second value can be a regular value instead of a generator, so for instance you can multiply a vector by 2, or by a matrix to transform it.

<table class=codefirst>
<tr><th>Operators</th><th>Action</th></tr>
<tr><td>+ - * /</td><td>Arithmetic operators. You can multiply a 3D vector by a color matrix (where red,green,blue in the matrix correspond to x,y,z) to do a 3D transform, or by a 2D matrix for a 2D transform.</td></tr>
<tr><td>- (unary)</td><td>Negate the value, same as multiplying by -1.</td></tr>
<tr><td>turn(), generator.Turn()</td><td>Rotate a vector clockwise in the XY plane.</td></tr>
</table>

<hr>

<a name=/{notes}/gliding toc="Gliding">
<h2>Gliding</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/pixel-movement>Pixel movement</a>
<dd><a href=#/atom/movable/var/animate_movement>animate_movement var (movable atom)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><a href=#/atom/movable/var/glide_size>glide_size var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
<dd><a href=#/client/var/fps>fps var (client)</a>
</dl>

<p>Gliding is a "glitz" effect applied by BYOND to cover up the visual sins
of tile-based movement, by making objects and the map appear to move smoothly
from one tile to another instead of immediately jumping. It is also available to
smooth over small jumps in pixel movement that might occur, for instance if the
client FPS is set higher than the server's.

<p>To control the gliding speed of an atom, set <code>glide_size</code> to the
value of your choice. If this is not set, the client will attempt to adjust
the speed manually.  <code>glide_size</code> is measured in server ticks, so
if <code>client.fps</code> is set to a value greater than <code>world.fps</code>,
it will be scaled appropriately.

<p>Whether an object glides or jumps is based on how far it moves relative to
its <tt>step_size</tt> value, which by default is a full tile width. If the
movement goes too far past <tt>step_size</tt> in the X or Y directions, it's
no longer a glide.

<p>The <tt>animate_movement</tt> var can be used to control the way in which
an object glides, or suppress gliding altogether.

<p>By using the <tt>LONG_GLIDE</tt> flag in <tt>appearance_flags</tt>, a
diagonal glide will take just as long as a cardinal-direction glide by moving
a fullt <tt>glide_size</tt> pixels in the dominant X or Y direction.
Otherwise, gliding tries to move by that many pixels in strict Euclidean
distance (a straight line) and diagonal glides take longer.

<p class=note>In <a class=code href=#/world/var/movement_mode>LEGACY_MOVEMENT_MODE</a>,
gliding is turned off if you set any of the bound or step vars for an atom to
a non-default value. The only gliding that occurs in this case is when
client.fps is higher than world.fps. All other movement modes base gliding on
an atom's <tt>glide_size</tt> value.

<hr>

<a name=/{notes}/HUD toc="HUD / screen objects">
<h2>HUD / screen objects</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
<dd><a href=#/client/var/screen>screen var (client)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/image>image objects</a>
</dl>

<p>HUD stands for Heads-Up Display, and refers to any atoms that appear on
the screen but don't move when the player moves. These are also called screen
objects. Any movable atom can be added to the HUD by setting its
<tt>screen_loc</tt> var, and adding it to <tt>client.screen</tt> for each user
who is supposed to see it. This can be used to display a character's vital
stats, scores, etc.

<p>If you want to have something like a health meter or name attached to a
moving atom, use overlays or <tt>/image</tt> objects instead. An
<tt>/image</tt> object is similar to a screen object in that it can be shown
to only certain players instead of being shown to everyone.

<p>The size of the screen depends on <tt>client.view</tt> (or
<tt>world.view</tt>), <tt>world.map_format</tt>, and <tt>world.icon_size</tt>.
In a normal topdown map format, <tt>client.view</tt> is the same as the screen
size; in other map formats the screen might be a different size.

<p>The <tt>screen_loc</tt> var can be set to a value like <tt>"1,1"</tt> (the
southwest tile of the screen), <tt>"4,NORTH"</tt> (fourth tile from the west,
along the north side of the screen), <tt>"SOUTHEAST"</tt>, and so on. You can
also include pixel offsets, percentages, and specify two corners to tile an
icon repeatedly from one end to the other. See
<a class=code href=#/atom/movable/var/screen_loc>screen_loc</a> for more
details.

<p><tt>screen_loc</tt> can also be used to stretch the bounds of the HUD. A
value of <tt>"0,0"</tt> will cause the atom to appear to the southwest of the
southwest-most tile on the visible map, outside of the regular map bounds.
Using HUDs in this way, you can provide a nice decorative "frame" for your map.

<p>More complex 

<p>You can use HUDs in other map controls as well, by preceding screen_loc with
the name of the map you will use followed by a colon. For instance,
<tt>screen_loc="map2:1,1"</tt> will show an icon in the southwest corner of the
<tt>map2</tt> control. The actual size of a secondary HUD is based on how far
out the icons in it extend in any direction. If you have one icon at
<tt>"map2:1,1"</tt> and another at <tt>"map2:4,3"</tt>, then that HUD will be
four tiles wide and three high.

<hr>

<a name=/{notes}/isometric toc="Isometric maps">
<h2>Isometric maps</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/client/var/dir>dir var (client)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/side>Side-view maps</a>
<dd><a href=#/{notes}/topdown>Topdown maps</a>
<dd><a href=#/{notes}/HUD>HUD</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{notes}/topdown_layer>TOPDOWN_LAYER</a>
</dl>

<div class="sidebar embed-image image-only">
<img src="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAANIAAAB4CAAAAACidfMWAAAGcklEQVR4XtzGoQ2AMBQE0BO/vpuwQi2qsiEoBsHWd4cuwQisg0OQ4ycsAOYETz3wd0CBmvIydYoYBMb1AgpU+MIxuP158578ZosIM1XsbubuY6qs4gCO/y4koFSmU7IxHdWYY8iI0cocLE3KJEsqyLDYBYKKEWkEEqSc+yAvYjfCjBmBehm+oZjELGeZL9HKuZI9KXPWLKpZrZxComR4721jc7/F5d77POece875/el2xj7z+sj3ueccI2ynDgC5J0MAAH7TAVxgZg6RK9qq8CYQNUFgdPpqgWaOJBe/3vtqqmOyMJKJf0u16XNMg46RCyTdArB5Cij4twQjLzhNgnoeKij4LsMCAChSiPQowIlGU6CvHs7PO70Mf4BypIVPA1SeMw46vijb2rccQQqShpumwtV8t0HQidSs5WeeDwZQmeS8vRHgSKsh0LdLMjPOWBGkKAkg6zGA0vP+F/Q+kZ52Nmfso1TXFXyIQ3Ps4GBhoh+Qbuut2DthLPNnGIA2sCpHirTnw0cXfYJO2b4p7wjxBPUDQBSilCFBXsch6PEB6tO+fmNH6PggQJRKJGiJG/IOOqN9WdbuHYQopUhRdUXeQGerjpY6wnyCEKUQCQp3j//B+6Hq85LWiX5BiFKHZNkcP+wJOrf2YHHzJC8g4SiLG1jnx+oDK18JNwbC6QerqqT+6v0rim42BUKUiqRfarqKVtxCAUKUWqRfaz8sXHkrFQhRKpHO1+0ueO02ahCiVCH9XrfrpeIpjCBEySf9Ub89r2QqMwhRskl/1rfnlkyjAAlBUbxt/Wt9m7VvukdUIICKpEO8LNIF+5as0xHj9VA/3AMDVKCjkA39mB5iP3gX7a3Plc3wkg+IogDhx08o6VJD87Pld3gBIYoOhChxpIF3Nj1THukDhCgaEKJEkf5ubHqqYqYfEKJoQIgSQbq8YWPam7MMgBBFA0JUoElDGzcsWR1lEIQoGhCiAkm68l7j4tV3mQAhigaEqECRrjY1LFpzt0kQouhAiOJPGt5kX1gZTQFCFA0IUbxJ/7z/1vzK2ZQgRNGAEMWTdO2D+iQSwwBCFA0IUbxI11rXPUBiGUGIogMhip3075a6e21xHECIQhANipU0srU2wRbPt4cA5rP1FEtcXHfUxO1L4N1DaTAgpKeQhKD26pjOxAD0EI+eookL57bqaNt93HtIVE95kpw7q+7U5nLvIcE9hSRw7aqaqc3j3kOiewpJrj3aDC2Zew+J7ikkuTu1adqD3HtIdE8hyb3PNrlqAfceEt5TSOqyhWsp3HtIeE8hqdsWqj3CvYck9pQlMdi2mHsPSe0pS08S9x6S3FMWN+8ektZTSOLbQxJ7Ckmce0h+TyGJvYcU6SmMC8aeSZO73ltc6Kw9JG098SAhSmYPIYoShCQ6FIIk9xTx/1+tztpDQtcTY78Q6aw9JGw9Mf5rq87aQ0LWE3NxoQvoIbb1xHwC6gJ6iH49oQt1XUAP0a0n9K9TdA49xH89YXrphSgESe4pwvRqElEIktxThM8LZF1WDyEKQWZI+JpfS/RAyeohRCHIDAm/jNESxqLaJPcQgJXzV2aYHpT5kAbAtJ7w/WJTfk8Rvl8/y+8pwnmTgPSeIvy3csjtKSJgw43QniICtkUJ7SkiYPOa0J4iArYYCu0pImYjqLieIuK264rpKSJ3UzX/niJyt77z7ymixgEFnWcPiSThMZKyiAD0FIJEkvCwz6rp/HvKKv9IFt+eImodnGPvKaLW8Ub2niJqHUJl7ymi3lFhtp4iah7opu8pou6xewoUgpS/HAFRNCD5JLzConCSQRSCVCXhRSMFEw2gEKQyCa+DeTnMHwpB8kmNjhuA7lk+Lu15MdQ3CkHySaX2G4Dvo31erZTnBSUAhNui+E3s7lO29eW5If8nxY+iEKQSyR4LABDpCxW3V7etq8iZMA4KQYEet7EpAYAv3Ibm5ONRLSMef+pwuAVNEHCfhO7Ortlbr49ZYLVKvPKPfRL379wT0+akAEh54qV+bIx1nPxUmRks8WJG/jP3oKMtdodLJon/zPuspXVOB6JUvGuy634ACDOBSj58jKwdvTD4Eia9Yg9xijmcFLfX5X6y2y1sgiDAs6Cn4e2Edz/JHlTygzc0mgphYSZRKSmfLrvmKtymIil1FFBRA2Yn4jKMbM9YKuyJJ2AOJC/NyRwS98ETMOXlIHD+A3oxNU80orubAAAAAElFTkSuQmCC">
</div>

<p>Isometric projection is a form of pseudo-3D in which the 2D icons used by
BYOND can be arranged in a way to give the appearance of three dimensions. If
you look at a map top-down, each tile on the map is a square. The map is
rotated 45&deg; clockwise and then tilted at an angle (30&deg;) so that each
square now looks like a foreshortened diamond from the viewer's perspective.
What was once north now points to the northeast end of the viewer's screen;
what was once east now points southeast to the viewer. Tiles that are more to
the south or east are "nearer" to the viewer, and tiles that are north or west
are "farther". The actual direction the map faces can be changed by using
<tt>client.dir</tt>.

<p>It is important to remember that this is an illusion of 3D, not real 3D.

<p>To use isometric mapping, set <tt>world.map_format</tt> to
<tt>ISOMETRIC_MAP</tt>. You should set <tt>world.icon_size</tt> so the tile
width is a multiple of 4 pixels. The width of the tile is highly important.
The height of your tiles should be at least half that value. BYOND uses a 2:1
isometric format, meaning that the diamond base of each tile is half as high
as its width. For example if you have a 64x64 tile size, every diamond in the
map will be 64 pixels wide by 32 high, and you have an extra 32 pixels at the
top of your icon for vertical projections like buildings. If you set the tile
size to 64x80, the base is still a 64x32 diamond and you have 48 pixels left
over for vertical structures.

<p>In this mode <tt>pixel_x</tt> and <tt>pixel_y</tt> will offset icons along the
"ground". To adjust horizontal and vertical positions, use the <tt>pixel_w</tt>
and <tt>pixel_z</tt> vars.

<h3>Layers</h3>

<p>The <tt>layer</tt> var behaves differently in isometric mode. Because some
tiles are nearer to the viewer than others, the tiles that are farther back
need to be drawn first so they are behind any tiles that should go in front of
them. So in isometric mode, the back row of tiles (a diagonal line of them) is
drawn first, followed by the next row forward, and so on. The <tt>layer</tt>
var only matters when icons overlap each other in the "physical" space, like
an obj sitting on a turf.

<p>When pixel or step offsets, or gliding, place an object on multiple turfs,
it is drawn on top of the nearer turf (assuming its layer is higher).

<p>Using icons wider than the regular tile size can have an impact on layering
as well. See <a href=#/{notes}/big-icons>Big icons</a> for more information.

<p>Because of the order in which icons are drawn, you may want to limit the
ability of an atom to cut diagonally around corners. While moving northeast
behind a dense wall, for instance, a mob might temporarily appear in front of
the wall because its pixel offsets (from gliding) temporarily put it on the
same tile as the wall. If you do not want to limit corner-cutting, a simple
workaround for this case is to give the wall a higher layer than the mob.

<p>Screen objects (in <tt>client.screen</tt>) are always drawn on top of all
isometric tiles, as is the case in other map modes as well.

<p>Since it may be desirable in some games to use a topdown map for some
situations (like a special battle map), you can add <tt>TOPDOWN_LAYER</tt> to
any atom's layer&mdash;e.g., <tt>TOPDOWN_LAYER+TURF_LAYER</tt>&mdash;to make
it appear in topdown mode. Topdown and isometric tiles really aren't meant to
be mixed, but if they do mix you'll see topdown tiles always display above
isometric tiles, just like screen objects do. The best way to use this is to
apply <tt>TOPDOWN_LAYER</tt> to every tile in a certain part of the map that
the players can't walk to.

<p>If you want to use an overlay that should not be covered by other "nearer"
icons on the map, such as a name or health meter, you can add
<tt>EFFECTS_LAYER</tt> to the overlay's layer. Icons with
<tt>EFFECTS_LAYER</tt> will draw above regular icons. Then objects with
<tt>TOPDOWN_LAYER</tt> will draw on top of everything else. However, be aware
that <tt>EFFECTS_LAYER</tt> has largely been superseded by the <tt>plane</tt>
var.

<h3>Screen size</h3>

<p>In this mode, <tt>world.view</tt> or <tt>client.view</tt> is used to define
the minimum number of map tiles you will see, <i>not</i> the screen/HUD size
which is calculated from client.view. Extra map tiles are shown to fill out
the screen size. HUD objects use screen coordinates, so 1,1 is still the lower
left.

<p>The actual HUD size is always a full number of tiles, whose size is defined
by <tt>world.icon_size</tt>. If you have a tile size of <tt>64x64</tt>, and
<tt>world.view=6</tt> (a 13x13 map), a full 13x13 diamond of map tiles will be
shown. The width of this diamond is 13 tiles. The height is only half that,
plus whatever vertical space is needed to show the icons in that area. Then
everything is rounded up to a full tile size, so the result is a 13x7-tile
screen. This is the formula you need if you want to calculate the screen size:

<xmp>
pixel_width = round(icon_width * (view_width + view_height) / 2)
pixel_height = round(icon_width * (view_width + view_height - 2) / 4) + icon_height

screen_width = round((pixel_width + icon_width - 1) / icon_width)
screen_height = round((pixel_height + icon_height - 1) / icon_height)
</xmp>

<p>If you use <tt>TOPDOWN_LAYER</tt>, any topdown sections of the map will be
limited to this same view.

<hr>

<a name=/{notes}/numbers>
<h2>Numbers</h2>

<p>In DM, all numbers are stored in floating point format. Specifically,
single-precision (32-bit) floating point. This is important to know if you
think you will be working with large numbers or decimal values a lot, because
the accuracy of the numbers is limited.

<p>32-bit floating point numbers can represent integers from -16777216
to 16777216 (2<sup>24</sup>). Non-integer values can get about as small as
2<sup>-126</sup> and as large as 2<sup>127</sup>.

<p>Floating point numbers do not handle most decimal values precisely. For
instance, 0.1 is not exactly 0.1, because floating point numbers are stored
in a binary format and in binary, 1/10 is a fraction that repeats
forever&mdash;the same way 1/3 repeats as 0.33333... in decimal numbers. It
ends up being rounded off, either a little higher or a littler lower than
its true value. This means that the following loop won't work like you might
expect:

<h3>Example:</h3>
<xmp>
for(i = 0, i < 100, i += 0.1)
    world << i
</xmp>

<p>You might expect that code to loop exactly 1000 times, with <tt>i</tt>
going from 0 up to 99.9 before stopping. The truth is more complicated,
because 0.1 stored in floating point is actually greater than the exact value
of 0.1. Other values might be more or less than their exact numbers, and as
you add these numbers together repeatedly you'll introduce more and more
rounding error.

<p>Even more insidious, if you add 0.1 a bunch of times starting from 0, and
then subtract it out again the same number of times, the result you get may
not be 0. This is counterintuitive, because you might expect rounding errors
to reverse themselves in the same order they crept in. Unfortunately it
doesn't work that way.

<p>You can correct for rounding error somewhat by using the
<a href=#/proc/round><tt>round</tt> proc</a> to adjust the loop var each time,
although for performance reasons it might be preferable to find another
alternative.

<xmp>
for(i = 0, i < 100, i = round(i + 0.1, 0.1))
    world << i
</xmp>

<p>Only fractions whose denominators are powers of 2 are immune to this
rounding error, so 0.5 is in fact stored as an exact value.

<p>Another place floating point may lose accuracy is when you try to add
numbers of very different sizes. For instance as stated above, the upper
limit for accurate integers is 16777216. If you try to use a number such
as 100 million it will only be approximate, so adding 1 to that number
won't actually change it because the 1 is so much smaller, it will be
gobbled up by rounding error.

<p>Also for the same reasons stated above, division will cost you
accuracy. Again you can divide by powers of 2 easily enough, and you can
divide an integer by any of its factors (like dividing 9 by 3) without a
problem, but a fraction like 1/3 will repeat forever so it gets rounded
to as much precision as floating point can manage.

<p>In decimal, floating point numbers have at least six decimal digits of
precision. Since they're actually stored in binary, their true precision
is exactly 24 bits.

<hr>

<a name=/{notes}/particles toc="Particle effects">
<h2 byondver=514>Particle effects</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/movable/var/particles>particles (movable atom var)</a>
<dd><a href=#/{notes}/generators>Generators</a>
<dd><a href=#/proc/generator>generator proc</a>
<dd><a href=#/{notes}/projection-matrix>Projection matrix</a>
<dd><a href=#/{skin}/commands/%2eadd-particles>.add-particles (client command)</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>A particle set is a special effect, whose computations are handled entirely
on the client, that spawns and tracks multiple pixels or icons with a
temporary lifespan. Examples of this might be confetti, sparks, rocket
exhaust, or rain or snow. Particles are rendered on a special surface and that
gets attached to an obj or a mob like an overlay.

<p>Particles can exist in 3 dimensions instead of the usual 2, so a particle's
position, velocity, and other values may have a z coordinate. To make use of
this z coordinate, you can use a <a href=#/{notes}/projection-matrix>projection
matrix</a>. (The value of the z coordinate must be between -100 and
100 after projection. Otherwise it's not guaranteed the particle will be
displayed.)

<p>To create a particle set, use <tt>new</tt> to create a new
<tt>/particles</tt> datum, and then you can set the datum's vars. The vars can
be set to constant values, or generator functions that will allow the client
to choose from a range of values when spawning those particles. (The easiest
way to handle this is to create your own type that inherits from
<tt>/particles</tt>, and set up the parameters you'll want at compile-time.)

<p>After the datum is created, it can be assigned to an obj or mob using their
<tt>particles</tt> var. The particles will appear on the map wherever that obj
or mob appears.

<h3>Example:</h3>
<xmp>
particles/snow
    width = 500     // 500 x 500 image to cover a moderately sized map
    height = 500
    count = 2500    // 2500 particles
    spawning = 12    // 12 new particles per 0.1s
    bound1 = vector(-1000, -300, -1000)   // end particles at Y=-300
    lifespan = 600  // live for 60s max
    fade = 50       // fade out over the last 5s if still on screen
    // spawn within a certain x,y,z space
    position = generator("box", vector(-300,250,0), vector(300,300,50))
    // control how the snow falls
    gravity = vector(0, -1)
    friction = 0.3  // shed 30% of velocity and drift every 0.1s
    drift = generator("sphere", 0, 2)
obj/snow
    screen_loc = "CENTER"
    particles = new/particles/snow

mob
    proc/CreateSnow()
        client?.screen += new/obj/snow
</xmp>

<p>These are the vars that can be used in a particle set. "Tick" refers to a
BYOND standard tick of 0.1s.

<table class=codefirst>
<tr><th colspan=3>Particle vars that affect the entire set (generators are not allowed for these)</th></tr>
<tr><th>Var</th><th>Type</th><th>Description</th></tr>
<tr><td>width</td><td rowspan=2>num</td><td rowspan=2>Size of particle image in pixels</td></tr>
<tr><td>height</td></tr>
<tr><td>count</td><td>num</td><td>Maximum particle count</td></tr>
<tr><td>spawning</td><td>num</td><td>Number of particles to spawn per tick (can be fractional)</td></tr>
<tr><td>bound1</td><td>vector</td><td>Minimum particle position in x,y,z space; defaults to list(-1000,-1000,-1000)</td></tr>
<tr><td>bound2</td><td>vector</td><td>Maximum particle position in x,y,z space; defaults to list(1000,1000,1000)</td></tr>
<tr><td>gravity</td><td>vector</td><td>Constant acceleration applied to all particles in this set (pixels per squared tick)</td></tr>
<tr><td>gradient</td><td><a href=#/{notes}/color-gradient>color gradient</a></td><td>Color gradient used, if any</td></tr>
<tr><td>transform</td><td><a href=#/{notes}/projection-matrix>matrix</a></td><td>Transform done to all particles, if any (can be higher than 2D)</td></tr>
<tr><th colspan=3>Vars that apply when a particle spawns</th></tr>
<tr><td>lifespan</td><td>num</td><td>Maximum life of the particle, in ticks</td></tr>
<tr><td>fade</td><td>num</td><td>Fade-out time at end of lifespan, in ticks</td></tr>
<tr><td>fadein</td><td>num</td><td>Fade-in time, in ticks</td></tr>
<tr><td>icon</td><td>icon</td><td>Icon to use, if any; no icon means this particle will be a dot<br/>Can be assigned a weighted list of icon files, to choose an icon at random</td></tr>
<tr><td>icon_state</td><td>text</td><td>Icon state to use, if any<br/>Can be assigned a weighted list of strings, to choose an icon at random</td></tr>
<tr><td>color</td><td>num or color</td><td>Particle color (not a color matrix); can be a number if a gradient is used</td></tr>
<tr><td>color_change</td><td>num</td><td>Color change per tick; only applies if gradient is used</td></tr>
<tr><td>position</td><td>num</td><td>x,y,z position, from center in pixels</td></tr>
<tr><td>velocity</td><td>num</td><td>x,y,z velocity, in pixels</td></tr>
<tr><td>scale</td><td>vector (2D)</td><td>Scale applied to icon, if used; defaults to list(1,1)</td></tr>
<tr><td>grow</td><td>num</td><td>Change in scale per tick; defaults to list(0,0)</td></tr>
<tr><td>rotation</td><td>num</td><td>Angle of rotation (clockwise); applies only if using an icon</td></tr>
<tr><td>spin</td><td>num</td><td>Change in rotation per tick</td></tr>
<tr><td>friction</td><td>num</td><td>Amount of velocity to shed (0 to 1) per tick, also applied to acceleration from drift</td></tr>
<tr><th colspan=3>Vars that are evalulated every tick</th></tr>
<tr><td>drift</td><td>vector</td><td>Added acceleration every tick; e.g. a circle or sphere generator can be applied to produce snow or ember effects</td></tr>
</table>

<p>The <tt>icon</tt> and <tt>icon_state</tt> values are special in that they can't be assigned a generator, but they can be assigned a constant icon or string, respectively, or a list of possible values to choose from like so:

<xmp>icon = list('confetti.dmi'=5, 'coin.dmi'=1)</xmp>

<p>The list used can either be a simple list, or it can contain weights as shown above.

<p>Changing a var on a particle datum will make changes to future particles.
For instance, you can set the datum's <tt>spawning</tt> var to 0 to make it
stop creating new particles. (Note: If you are changing a vector or color
matrix, such as <tt>gravity</tt>, you need to assign a new value. You can't
for instance set <tt>particles.gravity[2] = 0</tt> because it won't do
anything to update the particle stream.)

<p>The same particle datum can be assigned to more than one movable atom.
However the particles displayed by each atom will be different.

<h3>The <tt>.add-particles</tt> command</h3>

<p>If you want to spawn particles at specific times, you can use the client
<a href=#/{skin}/commands/%2eadd-particles><tt>.add-particles</tt> command</a>.
From the server, you can run this command via
<a class=code href=#/proc/winset>winset()</a>.

<h3>Example:</h3>
<xmp>
// spawn 100 particles for src's particle set right now
winset(player, null, list(command=".add-particles \ref[src] 100"))
</xmp>

<hr>

<a name=/{notes}/pixel-movement toc="Pixel movement">
<h2 byondver=490>Pixel movement</h2>

<dl><dt><b>See also:</b>
<dd><i>Bounding boxes</i>
<dd><a href=#/atom/movable/var/bound_x>bound_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_y>bound_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_width>bound_width var (movable atom)</a>
<dd><a href=#/atom/movable/var/bound_height>bound_height var (movable atom)</a>
<dd><a href=#/atom/var/icon_w>icon_w var (atom)</a>
<dd><a href=#/atom/var/icon_z>icon_z var (atom)</a>
<dd><i>Speed and position</i>
<dd><a href=#/atom/movable/var/step_size>step_size var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_x>step_x var (movable atom)</a>
<dd><a href=#/atom/movable/var/step_y>step_y var (movable atom)</a>
<dd><a href=#/atom/movable/var/locs>locs list var (movable atom)</a>
<dd><a href=#/atom/var/contents>contents list var (atom)</a>
<dd><a href=#/world/var/fps>fps var (world)</a>
<dd><i>Movement</i>
<dd><a href=#/atom/movable/proc/Move>Move proc (movable atom)</a>
<dd><a href=#/atom/proc/Cross>Cross proc (atom)</a>
<dd><a href=#/atom/proc/Crossed>Crossed proc (atom)</a>
<dd><a href=#/atom/proc/Uncross>Uncross proc (atom)</a>
<dd><a href=#/atom/proc/Uncrossed>Uncrossed proc (atom)</a>
<dd><a href=#/world/var/movement_mode>movement_mode var (world)</a>
<dd><a href=#/atom/var/appearance_flags>appearance_flags var (atom)</a>
<dd><i>Other topics</i>
<dd><a href=#/proc/bounds>bounds proc</a>
<dd><a href=#/proc/bounds_dist>bounds_dist proc</a>
<dd><a href=#/{notes}/gliding>Gliding</a>
</dl>

<p>Pixel movement is a concept that allows atoms to escape the constraints of
BYOND's historically tile-based movement, and move in smaller steps. In the
past this had to be done with soft code, but that was sometimes inconvenient
and it did not perform as well in projects with many objects moving.

<p>The key to understanding pixel movement is to use the bound and step vars.
You use the bound family of vars to define a bounding box for a movable atom,
instead of just making it one full tile in size. The step vars can give it a
movement speed and offset it from the corner of the tile it's standing on.

<ul><li>bound_x: The left edge of the bounding box</li>
<li>bound_y: The bottom edge of the bounding box</li>
<li>bound_width: Width of the bounding box</li>
<li>bound_height: Height of the bounding box</li>
<li>step_size: default movement speed</li>
<li>step_x: x offset from the corner of loc</li>
<li>step_y: y offset from the corner of loc</li></ul>

<p>Those are for movable atoms only; they do not apply to turfs.

<p>If <a class=code href=#/world/var/movement_mode>world.movement_mode</a>
is set to <tt>TILED_MOVEMENT_MODE</tt>, all movable atoms must be aligned
to the tile grid: their step_x/y/size values must be multiples of the icon
size, and their bounds must also land on tile boundaries although the atom
can be bigger than one tile. In other movement modes you can specify that
only specific atoms use this behavior, by giving them the
<a class=code href=#/atom/var/appearance_flags>TILE_MOVER</a> appearance
flag.

<h3>Bounding boxes</h3>

<div class="sidebar embed-image">
<img src="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAVQAAACOCAYAAABuQPBIAAAckElEQVR42uydB0xUWxrH52XBt09BUdT3XMHexYoKKmVWVkWfKCAsBhRFioot4irNh/jWGiNrWwTfuruWxK7RXUvM7tpLYouxl2jsJfbe/8v/JNd3E8YZQRiYme+f/ONcptx7jzm/+c73nXPGgBLW69ev0apVK5SVTp06hfDwcHyN5syZg23btsGUpk2bhqVLl5p7zq7bb9euXUhMTERRdO7cOYwcORKWdOzYMURFRUEkslWVOFBfvXqFKlWqoKx09OhRdO7cGV+jPXv24PLlyzCl8ePHY8GCBaDOnDmDnJycQs/Zc/vxi6Zfv34oih4+fIjNmzfDkg4ePIjAwECY0tOnT5GSkgKRyGGBymjr7du3MKV79+7h3bt3KKqePXsGU3rx4gVevnypA0LJ6sGDB/j48SP00Ny4cSMjKlNAJQDssf00oJq9R/6dbWVOPNfz589NAdXkZ1+/fh0NGzaESOSQQOXwt0uXLmjWrBlmzZoFTVu2bEHt2rXZadXrpk+f/glYtWrV0nfwT8fnz59Hy5YtMXToUPj5+anHhw4dAkWoDB48WL22bdu2iImJ+SwQ3rx5g6pVq+LJkyeg8vLy1Odp6tixo4pM4+PjsXz5cm24qs7Xrl07NG/eHD179lTQ3L59O+rVqwc3Nze0adMGV65cUUAdNWqUum8vLy8Fng8fPthN+2lA7d69O+9Nvc7b2xsXLlz4BOuwsDC2hzrPkiVLQB0+fBhdu3YFRdAmJSWhRo0a6r0DBw7k9WhA5WfyS0q9vnXr1jhx4gSuXbuGFi1aoEKFCvxs1QYikcMA1WAwIDc3FxTh5eHhgZs3b+L+/fsKQMePH9eiLHZkdiSLQOBn7tu3D1R+fj6GDx8OavHixejWrZuKeCgCzRwQIiMjVWRJ9e3bl52W18hhqXpM6YFqNBoxf/58UIyoPD09zUaoBC8jS4LD19cXR44csav2I1CdnJxw9epVUJmZmZg5cyaoCRMmYOzYsVp0zYhSRdh6oK5atQqdOnVS8KUyMjL0QOV1qjwuNXv2bKSlpUmEKnJsoDo7O+uHlixisOOqyMLHxwc6MVphx7EIhLp160Jf5Gjfvj2oiIgILFq0CJr2799vFggrVqxAcnKygmNwcDA7tALj2rVrkZ6ergcqocB7UbDVxOKKOaBOnTpVf8xrs6v2I1D5JaM/7t+/PyhGjwMGDCBUaRXB7969Ww9U1bYzZsyAppMnT+qBqqJkSjsOCgoSoIocG6gVK1bE+/fvoSk0NFQNrzds2MChYCEgsKpOgHA4runu3bt6IOgr34yOtGMOGQk/fQc3CwTCkUN3XsvcuXMJEBWtDRs2DAcOHNADVd1LtWrVFJw0DRo06EtyqFr0xmMbbj/LRamdO3dqx/xMRvP8m2ZG0Xqgsp0ZfesBTqCaKkoxEuexAFUkQ/7169eDYv6LUGJUdOvWLbi4uGhDOnY2lQ/UhrBazoyaN2/eFwGBkWVISAiHloQQIyRLRSkOcRmdMu/J9zDq43uY7yw05GdOcNmyZdr1cshNSGowYT7RElDtpP0sA5VfTCNGjGC6Q5sFUSiHyvez/Rn9s70TEhK+CKiPHz9WeVeRyOGA6urqiiFDhrCoogeQ0urVq1G9enU+x39VPk8TIdakSRPV+SZOnGgRCFpek52YRQvmL6dMmWIRqIxM+VpNLMTExcVBkx6ozIESAISuv7+/PkIlhDhE5b0QzmaAag/tZxmod+7cUeeuX78+AgICEBsbWwioLAwyHcBRAotSkyZNYqrAIlCp6OhodOjQAVu3boVI5AhA1YsFFVNTexjBcEhqsgLOv3GIXVTxPXxvKYnTeMzdp7SfTo8ePbL4WSyCMSJmbrhPnz5FahPRr0pNTUXv3r0LeeHChfyS57/yvJWeZ2rOADsVix2c4qQ3C1Cism2/S5cuMcpmuoKT/VWkvGbNGoiKJXZkjhLE5cD8vzBAJLKimBMeM2YM0yeMTNU0KpEAVYAqEokEqGLNHP7bD1A5hBQVf1mtyCbFTuzwICsnZk7VPoDKaURcwcSVRKKi727VqFEjtRRVZHNiJ3Z4kEmEWgriEkVW2URFE1d2cQmuSCJUseRQKW1OKNeIq2WUIsvS5qO6u7urDWFEkkMVC1ALTcmpWbMmTp8+DZFlcQ1+dnY2RAJUsQDVpLhjPpdgMjco+rx27NjBFU1qZZZIgCoup0DNNhrK3K1qGuDjwcfiz6VHuM/qpk2bIDKv8t4/GrsbMKStuJi2DaDu/MfkMvWW3DTUquGGmeOieeyo/ixQuWF1r169ILKs8t4/fFs3xl9SB4uLbgLVClV+OwAqvTAzHu5urlg/d7wAVacbN26oQtTFixchsn2gjh3Y2+HBWE6Ayils9gtUOi7s9+jg1RD/+7sAVRO35+MuWCL7AOrK2WMdHowSoVrHBSDNQuumdZE8oIcAFVD/6XXq1FE7S4kkQnV0Sw61GF49ZxyqVq6ExdnDHBqo3AaQGzmvW7cOIsmhigWoxQfLyEh4/uCObXkZDgvUnJwc9esCIgGqWID61f4xoD3tkEC9ffu22t3/7NmzEAlQxQLUrzWjU0apjFYdDqj82Rb+JIpIgCoWoJaUmUdlPpV5VYcB6t69e/m7/upXUUUCVLFU+UvSrPiz8s8ZAHYP1KxAg/oBvJUrV0IkVX6xzEMtaXNOKuemco6q3QO1d2MDjEYjRDIPVSwRammZq6e4ioqrqewWphvnT0AlZ4PafFskEapYcqilaa7z53p/rvu3S6D28m+Hzh7yk2GSQxULUK3k8O4+CPLxsjuY5v6UAHc3F6T7CVAFqGIBqpW845dJaOD5PdITQvGfJT8hpo+/zU/+Z7GtSb1aSE8MQ7ZRgCpAFQtQreh/TktGZZfv4PGDOwwGA5bPHG3TQE0Z3AetGtfhYwGqAFUsQLWuU+P7wdnpN/jmGwMqffctG9pmYbppwUS4Va6Ev/08XIAqQBVLld+6ZqNWLIBoBWcnFZ06FYB10rBwmwVqiNEbYUGd+FiAKlV+scxDtb6352dgdHQw3FwrKqhGBXexSZjmT05CtSou+NdfUwWoMg9VLBFq2fq/S7Lwp7gQpCWE2mAhajKaN6iNiUP78liAKhFqqdsQmF2eLTlUcbFNkBKoBKsAVXKoVgNq9i6URwtQxcU2h/gc6nPIX3AsQBWgClAFqOWwWDVnQqwtXCuLUCxG8bEAVYAqQBWglrz/nZuGzKRwjIjqgcSIILURyqjoYC435TxTTuL/7Ht/maK2+FNr/VfMMj8ndU3OOMxKiVHniQs1Ij68GxIKzpc1IgJb89JL+z45PYrTpDhdSoAqQBWgClBL1ouyEtGlXVM1n9Tfuxn+GNwZ0T/6IbZvACM5tcvU9+5V8G0FJzSt9zvu4K9gODk5UkFwSKiRgOIm1CxOqaF0UuQfMHXMAPx5dBS3/lPRoFdjT55Dgde7RQNE9PBFbL9ADAzxR0zB+fy9m8O10m/h174Zr6m07pcT+DmRn48FqAJUAeqvQJUq///ZO/enqMowji8XRfOCiIAYCAMpisZIcgnUuAmERhIEQYgmqTCi5CVIQStN7KY4o046GjX2Q9NMzuQ4MU1j07/2tN9Ti7ssLAsstMt+fnjmXHjPe84Zlg/vPpfvM1/78+GwbUpNsjOdDTOuDsfvX7K7Q93Wf7jBgWFFUb5VFudba33ZRFK8TGNaakvtjaLtGqOxzvyjg0ft6d2BgPfQM2hsekqSOzVrONTvq9JSlZiq1BSgEuUHqL5AJQ91vna8pdqqSnaEnY9Tz9TdHFLtVSlkSfxEIig6BqjkoQJUVqihNYmcjHlWl+FjeiY9W0jnbK17XfJ82geoxgoVoOJDXYiKp2DGRfyz/Xj9lKq6JCANUAEqPlSAuiAW7pUbgqpWqnJNyN875/fctS1bvl/tA1SAClAB6oJYuP+CPV//5VNV8GxO0f8rvS2Wm5mmMlmAClABKkCNaqB6TNF/pXfN6v2UNZCStNbuDB3TMUAFqAAVoAJUDxyVx/r7LPpZtR/YY3XlBdoHqAAVoBLlB6hepsIDVXMF9W6Pb/RZ4uqX1K0VoAJUovzkoQLUSc+rKi5VaQX1bkU7cuxUR732ASpAJQ+VFSpAnfS8KomVzsCM73W1r82yX06R/gBABaisUPGhAtQpgCp9AYm2zJi/mpqc6OlzBVABKj5UgApQpwCqxFqkgBXwnSS2Ul26U/sAFaACVIAKUKcBqpSvJCc47ftIOlDtrX8dPQ9QASpABagANQBQJSMobdZp36e04BXrad2vfYAKUAEqQAWo0wBV8oHSZJ020DTS326b0zfY8++vAFSAClCJ8gPUAECVzqoErv2i+ddOtzl1/ukp6+zbj7t0HqACVKL85KEC1ABAlbiJugX4nFM3gJgYl6WuT7Tinbk6B1ABKnmorFAB6gxAlfK/X1K//KVxsbHmcrksYVm8k/j/x4MhgApQWaHiQwWoAYCqdirqY+XXcUAwlS13A1VtV57cvgBQlyBQXa6Q/I1oHnyoABWgqn+VmgJ6n3urYrf+QBzf6sPPT/KVf+kCVboM6pg7n9+trtc8ABWgAlQ1A1SHVe9zl3uapXfqOQaoSxio+8telcvHT4FMn4Gjhyqsp61Wmrfa6ljnJzee1PWaB6ACVIDq6af/6GrP5PcAqFEAVImLZ2xMtoK8LPnT/2s7vlKuIAegW7I2WuH2bG11rPP6ucZpvK7T9ZoHoAJUgOo29f5XX3/9YgFqFAallGM88lGH9XXU2+XeFu8VqP7Ryv2jrfcKVuM0XtfpevJQifIDVI9dPN5kyevW2K2BIwCVKP9UpclE+clDBajBJvavT1yten2+8gPUqUxlyeShskIFqMEAtaW21E7+W6cPUAEqeaj4UAHqfICqHNPr/e0AFaBSyw9QAWooEvu/OPMeQAWoU9qtgS4VfgBUgApQgyw9Ve0+QAWofvbLzbMWHxcrgRyAClABarB9+RsrdwNUgOpj0m7YlJpkMS6XxcfHqRoKoAJUgDoTUEcHj9rOLZkAFaBO2N8/OKLiWp169BzUcwygEuUHqDMB9endAVu1MgGgAlSflje1ZQWWkZbsADUmJkZdHYjyk4cKUINI7FeVlL7SAVSA6mP6Q8/PzdBnQyLj6nwbrnmo4WqsUKMRqLvzc+zr850AFaD62NmuA9awr3C2eaiYr+FDjTKgekSmASpA9bGmmuLZfC7kQ416MAJUgGpHDlXYsaZKgApQfUwqU1+d6wSoABWgzgaohxv32YfN1QAVoHqbNB6UiwpQAeqLD4zq1Me/u7gYINV9dL+IA2rnwb12/N0agApQJ+zZvUFbkbBMKVQAFaC++MCUF+bZuSMHFwOouo/uF2lAlViw2qAAVIDqo0K2NTvdvQ9QQ2iRH+V/8NkJ56vLs3ufBPwwKB9TIrq/3RnwPq9jndfPA12v+XUf3S+igCqx4DWrVmgLUAHqhF34oNHqygu0T5Q/tBb5eaiKVmZt2mCD3W/bz9/0K59OOXNO36R3akpUYudAJTczTVtHMOSvsSvaep/XOI3XdfItaR7Np3k1v+4TkaWne1/bRmI/QPXL/DgxOzeQ/qaiHowBbGnlod4c6LI9hXmO0EPC8mVOH6XyXVvtzPtv2k9fnp4Y9/zRZScvc3P6Bm117PmZxmm8rtP1mkfzaV7NH1FBqbFrvVZVssP9/EnqBwRQAaqfSv9IfzsrVHyo84/yP7l9Xo3ItJ1rlD+sTSvrnMw0626ucu8P65kBKkD1sZSktSpBxYcKUEOTNvX4Rt9CQ0YZAQpiye+q4//LACpA9bHx+5ckiOKO8H8KUAFqSIC6WGlWygxQMEv+13/YO9OYKs4oDFOWmgoKChQEA1WwrKIie5UWLLWGiixKXIK2IMgmuKBRqU1rQ5SoiURExBprbKL9YZOaYlO0P9yiJsZE4w+jxmjUuESNxn095Z10brgE3O7Mnbu8b/Llzs1FZHK/75kzc95zPgKVsgmgtiyfjbwBjglUAtVOgGruEEBSC89hCVTKcKAuLpkk45JjCVQCVTug/lRVaE3AwSmA5BaBShkO1KkT0vB8nUBlll87oGKfeg93d9WXqveA/QqOAQKVMhyoKSOGIaDAMbP89KFaDlQkiTzc3ZTGunGfhqjld3oOZN5hwyJQKcOBigv7rw1VOKYPlRGqxUBFKSZgim7lAKvede7qZIS3lUCljAQqLuyY8yhsYYTKZ6iWAhUe1IXi5uoKoJq2fsD+On/p22AF1VcoGCBQKUOB2vZjmYQG+eOYz1AJVMuBipr97SurpX3jEmxSpl6p9R4oaUUVFoFKGQrUZWV5KLkmUAlU7W1TSEz9rvaD1HegTwBKWwlUykigopUjGo4TqASq9kCNGhoszfXFesMGUTGar9DYTxkNVFj30MqRQCVQtQdqeoLufUIx0B4QlSkEKmU4UAcHDJQtP1cQqMzyaw/UgqxkvTevU3uuIkJFZysClTIMqB2d88/d3Q2veM8sP32omgIVMEVfSGsAB4kAtAtEhysClTICqIhMEaGq7+lDZYSqKVBxu4/bfmsAB24C9GBF20B0uiJQKWsDFfNdLX9mhMpnqJoDFQkpJKYYoRKozgBUZPeR5ccxn6ESqJoDFZYpWKcMfYa6ZHaufJeXIb+sKJd/t/xAoFJ6rQ9c1OFDJVAJVF2Aittw1dxvWJa/etrXKIFVGv56dI7IocGytDSPQKW0Xh+okEKlFIFKoOoAVHNzv2E+VPRKdXdzA1RRCotnrNggkECltFwfCBpQw49afgKVQNUNqKq539BKqYhPglSgwnXAW35K6/WB7lKWto/E7rlITCHbj1cAtvvg5718PszXBRBEdh6WJ7zifdfxTp9v3brVJoGqmvsNreWfO32CEj001E5TOvtPGZ/a2VKQQKU0Wx/of4o+qDh26oEdgCeMGalsYlmSn2nP60M3oGpl7jes2xQeOai7B/y5frESNY//bARu0whUSov1gQ796NTv1DBF0jfQz0eKJqbLhu9LsCMwgaoxUFVzv031Q/27dZkkxAxVdkz9p62eQKUsXR/YQwp7STl9hPpVWpzMKcxS3xOoGgNVNffbXMd+WKy+SIqRuIhQ9GolUClL1gdcJtjt1KlhCrfNsNBAAlVHoKrmfpvcUwr7pk/KSJDwkED5o6mOQKXeZ31gHsGWh/34nRKk21fNlYTYMCXxOyrqE9z6E6g6AVU199v0rqczc9Il+OOBnVCuJVCpd14fvzXOFf8B/Z3+dp8RqgVA1dbcb/y+/HAI+A3ohwYXBCr1TuujoWYqIjSngCZKuyunjUdxDJ+hagtU48397S1LZP7MbBno7SW54xIt/n31Zfni06+vrF9WTKBSb70+SiePUxOvDjlgnP/m83gEHLAf4tYeUGWWX1ugGm/uL5vyJTL12LZas9+5av508fbqi1cClXqr9YGobOG3Ex0WqFtWlMtHfT4ESDEAVUSq9KG+x4TRZET7u8jkaBzbxyge5SKeHi6SH2UzfxOBaqNAxQjqhzmDY8cdeZEu8sH/QO3fx+b+PgOAaqBqa2tlzZo1Yk86deqUBAcHS1NTk1BUb3r16pV4enrK7du3xVF18OBBCQwMlG3btomXl5eUlpaKDcp5gAqYzps3T+xNFy5ckPDwcFm+fLlQVE+6ePGiBAQEODxM8QqdPHkSzUMIVCO1c+dOKSgoEHvU9evXZeTIkVJRUSEvX74UiuqqPXv2SEZGhuPD1FwEqpE6fPiwJCcni73q7t27kp6eLoWFhfL06VOhqK53X1VVVYQpgWo9Xbp0SYKCgsSe9fjxY8nJyZGsrCx58OCBUBRUXFwsGzZsIEwJVOvp+fPn4uHhobzas/D3z5o1S4m2b926JRSVkpKCZ4qEKYFqVSFCRaTqEFndBQsWSFRUlFy+fFko55a3t7fcuHGDMCVQrStEdXiW6ihauXKlhIaGypkzZ4RyTl25ckV8fX0JUwLV+kKWH9l+R9LmzZuVSXj8+HGhnE8dHR0yduxYwpRANcbcv27dOnE07dq1S/z8/JTHGZRzaePGjTJnzhyxY2HeEqb2CFQkdBxV586dE8op5Qg2OgYD1gIqJsvw4cPFKJ0+fVry8/OlN/F8KYqyG6A+efJEyWIapRMnTkhqaqr0Jp4vZUXBwI+LLs+DQLUcMDh+9uyZ9KSbN2++1y39/fv3pSc9fPhQHj169EbA8HwpPYXv68WLF2YWKcyLrsIcwXfXg/Bv8RnPg0A1B0xDQ4OkpaVJZGSkNDY2iqr29nZ0ZAIETD8H3blzRwYNGiSq8GWo78+ePSvR0dFKhcmYMWMkJiZGjh49amacx8+ifn7GjBmvBUxeXp60trYKtG/fPpSHwifqkOeLv83f31+uXbtmdv67d+8WSluhZ0Nubi6q4mCNU6K5pKQkcXV1lbi4OFMHsrVr10pISIgy7yorK01RH+YIErCJiYnwK8O3rECpJ6EoIDY2Fp8rIz4+Xo4dO2Z357F06VKpr68XVfv375fMzEwCtfsiRv/DlpYWge7duyeDBw+Wq1evKpVCPj4+iKpMURvAcOTIkTcCBr/z0KFDAm3atEnKy8sFamtrw5dguhpWV1cDMK/1AaIbFFqnjR49GskhPc4X/49NnG9NTY3JKYFzHjJkiDLBKW21d+9eyc7OVqHUY2SH7zMiIsL0vqioCDYqE4jq6upwccfnSjXVgQMHXlu+isCgublZFi1aZJfncf78eQkLCxNVJSUlsmPHDgK1G2BQMmp2q4peiAABorXuDU/Kyspk9erVbwQMrpaqYIzHVRn6r53zdzkuDOP4rgzsSga72aIMStkoykBZDRaDREwmix0lgyg2/gKrQcikDP4A/8D19jl16TlyeN569fpxf+v0PI7nOK7nvvve1/d7X+dKJpOUotiaqjySwExCMsl2u/028YZCIQGpVMoW73K5JN67PVr1O0D61WpVDJ5TsO/z+fj/MpY3iaher5O5UQ5oHdFoVEql0oWINpuNKFA55XJZHMD8IWOEsOgZ8bZx0HWLBIMYAoEA9zCEek0wLpfLlgUhISCB6XSKhL0mGOSDRUgej0cUPJr3g2BsO+nH4/HyOpvNymAwEMV8Pn9EqDS95bNZ4Z8ebzgc/u/xItnIBvguh8NBDJ4DFEihUJBgMKhkZCMieuTSfQzJrsdut7sQEeOsIMvjcML5fCapgNjwMt82juFwKMVikQd4IGXjoTpJYIrXlQy8Xq+VZZ1OJ7p3U+pzGTgGYLVaCWDFpRktwKv5DcGMx2NJJBJMKovU0un0PYLhWjxJVmImDPV0/yTeyWTykvGqTZDL5SQWi4nBc0DGyHiwUCJjdcxRGthduvhhN/E32jcXG0aJSL13ziGpF4uFOCGfz0u325VKpSK1Wu1t4yAzxWuNx+Oy3W4Nod4iGLfbzYCzSWN5iJ1ORxSj0YinhHiPn5Y/qCDzguTIpJAJvyEY2uLRyJlNHGRxo9FwIhh8HfxHMke9H+b7h8Zrz2YgdsjY4DmYzWYQEORgLV6KZrPJ2KnHThbGHEEmI3dRDkpEbO5gz/CsP1nd3XtFIhGt9uC+LNLvFoeCDBXlanb5H4ANGnalbxEbEvdmN3vOMUn+FlzDtY/wjfGSKfj9fiurNXgSnMuIWNCYA7ZF+Ko/LkTEJibnef+r4uBR3H6/bwj1lbFer5G4tgN59G3xYjvwO5mxwctCiehWQf31uGJTfUQcKLFer6c+sCFUg9cHcqzVaonBS4NqFRTOV8WBfZDJZGS/38un4A8tC/bB5D9F8QAAAABJRU5ErkJggg==">
<p><b>Left:</b> The bounding box (blue) is the only part of the mob that actually collides with anything. By default, it would cover the whole turf (brown). Any turfs covered by the bounding box are in the mob's locs var. <b>Right:</b> The atom's true position (shaded) is offset from the turf by step_x and step_y.</p>
</div>

<p>As an example, if your players' mobs have icons that only cover the center
24&times;24 pixels of a regular 32&times;32 icon, then you would set the
mobs' bound_x and bound_y to 4--because there are 4 pixels unused to the left
and bottom--and bound_width and bound_height to 24.

<p>The mob's physical location on the map depends on four things: Its loc,
its step_x/y values, its bound_x/y values, and its bound_width/height. The
lower left corner of the bounding box, relative to the turf the mob is
actually standing on, begins at step_x+bound_x on the left and step_y+bound_y
on the bottom.

<p>The physical position of the bounding box is <b>not affected</b> by the
pixel_x/y/z vars. Those are still strictly visual offsets.

<p>The turfs the mob is covering can be read from the read-only locs var. The
mob will also appear in the contents of those turfs.

<p>Note: This means if an atom is in a turf's contents, its loc is <i>not
necessarily</i> that turf. The contents list is made to include "overhangers"
from another tile for ease of use.

<h3>Movement</h3>

<p>All of the step and walk procs have been upgraded to take an additional
argument, which is the speed at which the atom should move. If that argument
is left out, the atom's own step_size is used by default. The step_size
determines how fast the step_x and step_y values will change when moving.

<p>Move() has two new arguments that handle the position change gracefully.
These are the step_x and step_y values for the target location.

<p>Pixel movement changes the behavior of the Move() proc, because a lot of
things are possible that were not possible when BYOND only supported moving
one tile at a time. For starters, a Move() is either a "slide" or a "jump"
depending on the distance. A slide is when the move can be stopped partway;
a jump is strictly pass/fail. Anything greater than one tile <i>and</i> the
mover's regular step_size is considered a jump. Changing z levels is also a
jump, as is moving to/from a non-turf.

<p>If step_x and step_y aren't within a good range, the new loc and the
step_x/y values may be changed so that the southwest corner of the mover's
bounding box is standing on its actual loc, or as close to it as possible.

<p>Enter() and Exit() can be called for several turfs and/or areas, not
just one at a time. It is also possible for them not to be called at all,
if the moving atom moves within a turf but doesn't cross a new turf
boundary. Enter() and Exit() are only called when first attempting to enter
or fully exit. The behavior of these procs depends on
<a class=code href=#/world/var/movement_mode>world.movement_mode</a>; in
legacy mode, they look at some of the contents of the turfs as well as the
turfs themselves, to preserve behavior found in older BYOND versions.

<p>Cross() and Uncross() are the equivalent of Enter() and Exit() but apply
to objects the mover will either overlap or stop overlapping. (For turfs,
Enter() and Exit() call these procs by default, since the mover is both
stepping <i>into</i> and <i>onto</i> a turf.) Likewise Crossed() and
Uncrossed() are the equivalents of Entered() and Exited().

<p>If an atom is sliding, its movement can be halted if it encounters an
obstacle partway along its route. Bump() will still be called for any
obstacles the atom runs into, but Move() will return the number of pixels
moved (the most in any direction). When sliding at a speed so fast that the
distance is bigger than the atom itself, the move will be split up into
several smaller slides to avoid skipping over any obstacles.

<p>Gliding, which is used to show smooth movement between atoms in tile
movement, is mostly not used in pixel movement. It only applies when the
client uses a higher <a class=code href=#/client/var/fps>fps</a> than the
server.

<h3>Pixel procs</h3>

<p>The bounds() and obounds() procs have been added to grab a list of atoms
within a given bounding box. That box can be relative to an atom, or in
absolute coordinates.

<p>bounds_dist() tells the distance between two atoms, in pixels. If it is
positive, that is the minimum distance the atoms would have to traverse to be
touching. At 0, they are touching but not in collision. A negative value
means the two atoms are in collision.

<hr>

<a name=/{notes}/projection-matrix toc="Projection matrix">
<h2 byondver=514>Projection matrix</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/particles>Particle effects</a>
<dd><a href=#/atom/var/transform>transform var (atom)</a>
<dd><a href=#/matrix>matrix</a>
<dd><a href=#/{notes}/color-matrix>Color matrix</a>
</dl>

<p>Note: Currently this feature applies only to particle effects, using the
<tt>transform</tt> var.

<p>Normally icons in BYOND can only be transformed in 2D, using a simple 3x3
matrix. This is represented by the <tt>/matrix</tt> object, which cuts off the
last column because it isn't used. However particles can have coordinates in x,
y, and z, and the whole particle set can be given a transformation matrix that
handles all three dimensions.

<h3>Simple 2D transforms</h3>

<p>The easiest transformation for particles is a simple 2D one, which you can
do by setting the particle datum's <tt>transform</tt> var to a <tt>/matrix</tt>
object.

<pre>          a d 0
x y 1  *  b e 0  =  x' y' 1
          c f 1</pre>

<p>When an x,y point is multiplied by the matrix, it becomes the new point
x',y'. This is equivalent to:

<pre>x' = a*x + b*y + c
y' = d*x + e*y + f</pre>

<p>This is called an <b>affine transform</b> because all the operations are
"linear" in math terms. (That is, every term in the formula above has a single
variable, not raised to a higher power than 1.)

<h3>3x4 matrix (x,y,z with translation)</h3>

<p>3D affine transforms of this type are also affine transformations. There is
no special object for this so a list is used (see below).

<pre>            xx xy xz 0
x y z 1  *  yx yy yz 0  =  x' y' z' 1
            zx zy zz 0
            cx cy cz 1</pre>

<p>The way to read the vars above is that the first letter says what input
component is being transformed (x,y,z, or c for "constant"), and the second
letter is the output component.

<pre>x' = xx*x + yx*y + zx*z + cx
y' = xy*x + yy*y + zy*z + cy
z' = xz*x + yz*y + zz*z + cz</pre>

<p>To use this kind of matrix, you can cut off the 4th column and provide the
values in a list form, in row-major order:

<xmp>list(xx,xy,xz, yx,yy,yz, zx,zy,zz, cx,cy,cz)</xmp>

<p>Note the 4th row is also optional.</p>

<h3>4x4 matrix (x,y,z,w with projection)</h3>

<p>This is the most interesting matrix, since if you use all 4 columns you're
actually altering an "axis" called w. This isn't a real axis, but is just a
number that the resulting vector will be divided by.

<pre>            xx xy xz xw
x y z 1  *  yx yy yz yw  =  x'w' y'w' z'w' w'
            zx zy zz zw
            wx wy wz ww

w' = xw*x + yw*y + zw*z + ww
x' = (xx*x + yx*y + zx*z + wx) / w'
y' = (xy*x + yy*y + zy*z + wy) / w'
z' = (xz*x + yz*y + zz*z + wz) / w'</pre>

<p>In a regular affine transform, w always stays at 1. In projection you can
think of w as a distance from the "camera". 1 is where objects are their
"normal" size. If you make the z value affect w' by setting zw, you basically
make an object look smaller at higher z values.

<p>This is a simple projection matrix where x,y,z are left untouched, but
there's a projection effect. The "D" value is how far away the "camera" is
from z=0, so a point at z=D looks like it's twice as far away.

<pre>
1  0  0  0
0  1  0  0
0  0  1  1/D
0  0  0  1
</pre>

<p>This 4x4 matrix is handled as a list just like the 3x4 affine matrix:

<xmp>list(xx,xy,xz,xw, yx,yy,yz,yw, zx,zy,zz,zw, wx,wy,wz,ww)</xmp>

<hr>

<a name=/{notes}/regex toc="Regular expressions">
<h2>Regular expressions</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/regex>regex datum</a>
<dd><a href=#/proc/regex>regex proc</a>
<dd><a href=#/proc/findtext>findtext proc</a>
<dd><a href=#/proc/replacetext>replacetext proc</a>
<dd><a href=#/proc/splittext>splittext proc</a>
<dd><a href=#/proc/REGEX_QUOTE>REGEX_QUOTE proc</a>
</dl>

<p>Regular expressions are patterns that can be searched for within a text
string, instead of searching for an exact match to a known piece of text.
They are much more versatile for find and replace operations, and therefore
useful for parsing, filtering, etc.

<p>Some example regular expressions are:

<table class="regex">
<tr><th>Pattern</th><th>Code</th><th>Meaning</th></tr>
<tr><td>B.*D</td><td>regex("B.*D")</td><td>Find <tt>B</tt>, followed by any number of characters (including none), followed by a <tt>D</tt>.</td></tr>
<tr><td>[0-3]</td><td>regex(@"[0-3]")</td><td>Find any digit from 0 to 3</td></tr>
<tr><td>foo|bar</td><td>regex("foo|bar","i")</td><td>Find <tt>foo</tt> or <tt>bar</tt>, case-insensitive</td></tr>
<tr><td>\d+</td><td>regex(@"\d+","g")</td><td>Find all sequences of digits</td></tr>
</table>

<p>These are some of the patterns you can use. If you want to use any of the
operators as an actual character, it must be escaped with a backslash.

<p>It is highly recommended that you use <a href=#/DM/text>raw strings</a>
like <code>@"..."</code> for your regular expression patterns, because with a
regular DM string you have to escape all backslash <code>\</code> and open
bracket <code>[</code> characters, which will make your regular expression
much harder for you to read. It's easier to write <code>@"[\d]\n"</code> than
<code>"\[\\d]\\n"</code>.

<table class="regex">
<tr><th>Pattern</th><th>Matches</th></tr>
<tr><td><i>a</i>|<i>b</i></td><td><i>a</i> or <i>b</i></td></tr>
<tr><td>.</td><td>Any character (except a line break)</td></tr>
<tr><td>^</td><td>Beginning of text; or line if <tt>m</tt> flag is used</td></tr>
<tr><td>$</td><td>End of text; or line if <tt>m</tt> flag is used</td></tr>
<tr><td>\A</td><td>Beginning of text</td></tr>
<tr><td>\Z</td><td>End of text</td></tr>
<tr><td>[<i>chars</i>]</td><td>Any character between the brackets. Ranges can be specified with a hyphen, like 0-9. Character classes like <tt>\d</tt> and <tt>\s</tt> can also be used (see below).</td></tr>
<tr><td>[^<i>chars</i>]</td><td>Any character NOT matching the ones between the brackets.</td></tr>
<tr><td>\b</td><td>Word break</td></tr>
<tr><td>\B</td><td>Word non-break</td></tr>
<tr><td>(<i>pattern</i>)</td><td>Capturing group: the pattern must match, and its contents will be captured in the group list.</td></tr>
<tr><td>(?:<i>pattern</i>)</td><td>Non-capturing group: Match the pattern, but do not capture its contents.</td></tr>
<tr><td>\1 <i>through</i> \9</td><td>Backreference; <tt>\<i>N</i></tt> is whatever was captured in the <i>N</i>th capturing group.</td></tr>

<tr><th colspan=2>Modifiers</th></tr>
<tr><td colspan=2>Modifiers are "greedy" by default, looking for the longest match possible.  When following a word, they only apply to the last character.</td></tr>
<tr><td><i>a</i>*</td><td>Match <i>a</i> zero or more times</td></tr>
<tr><td><i>a</i>+</td><td>Match <i>a</i> one or more times</td></tr>
<tr><td><i>a</i>?</td><td>Match <i>a</i> zero or one time</td></tr>
<tr><td><i>a</i>{<i>n</i>}</td><td>Match <i>a</i>, exactly <i>n</i> times</td></tr>
<tr><td><i>a</i>{<i>n</i>,}</td><td>Match <i>a</i>, <i>n</i> or more times</td></tr>
<tr><td><i>a</i>{<i>n</i>,<i>m</i>}</td><td>Match <i>a</i>, <i>n</i> to <i>m</i> times</td></tr>
<tr><td><i>modifier</i>?</td><td>Make the previous modifier non-greedy (match as little as possible)</td></tr>

<tr><th colspan=2>Escape codes and character classes</th></tr>
<tr><td>\x<i>NN</i></td><td>Escape code for a single character, where <i>NN</i> is its hexadecimal ASCII value</td></tr>
<tr><td>\u<i>NNNN</i></td><td>Escape code for a single 16-bit Unicode character, where <i>NNNN</i> is its hexadecimal value</td></tr>
<tr><td>\U<i>NNNNNN</i></td><td>Escape code for a single 21-bit Unicode character, where <i>NNNNNN</i> is its hexadecimal value</td></tr>
<tr><td>\d</td><td>Any digit 0 through 9</td></tr>
<tr><td>\D</td><td>Any character except a digit or line break</td></tr>
<tr><td>\l</td><td>Any letter A through Z, case-insensitive</td></tr>
<tr><td>\L</td><td>Any character except a letter or line break</td></tr>
<tr><td>\w</td><td>Any identifier character: digits, letters, or underscore</td></tr>
<tr><td>\W</td><td>Any character except an identifier character or line break</td></tr>
<tr><td>\s</td><td>Any space character</td></tr>
<tr><td>\S</td><td>Any character except a space or line break</td></tr>

<tr><th colspan=2>Assertions</th></tr>
<tr><td>(?=<i>pattern</i>)</td><td>Look-ahead: Require this pattern to come next, but don't include it in the match</td></tr>
<tr><td>(?!<i>pattern</i>)</td><td>Look-ahead: Require this pattern NOT to come next</td></tr>
<tr><td>(?&lt;=<i>pattern</i>)</td><td>Look-behind: Require this pattern to come before, but don't include it in the match (must be a fixed byte length)</td></tr>
<tr><td>(?&lt;!<i>pattern</i>)</td><td>Look-behind: Require this pattern NOT to come before (must be a fixed byte length)</td></tr>
</table>

<p>The optional flags can be any combination of these:

<table class="regex">
<tr><th>Flag</th><th>Meaning</th></tr>
<tr><td>i</td><td>Case-insensitive matching</td></tr>
<tr><td>g</td><td>Global: In Find() subsequent calls will start where this left off, and in Replace() all matches are replaced.</td></tr>
<tr><td>m</td><td>Multi-line: ^ and $ refer to the beginning and end of a line, respectively.</td></tr>
</table>

<p>After calling <tt>Find()</tt> on a <tt>/regex</tt> datum, the datum's
<tt>group</tt> var will contain a list&mdash;if applicable&mdash;of any
sub-patterns found with the <tt>()</tt> parentheses operator. For instance,
searching the string <tt>"123"</tt> for <tt>1(\d)(\d)</tt> will match
<tt>"123"</tt>, and the <tt>group</tt> var will be <tt>list("2","3")</tt>.
Groups can also be used in replacement expressions; see the
<a class=code href=#/regex/proc/Replace>Replace() proc</a> for more details.

<hr>

<a name=/{notes}/renderer toc="Understanding the renderer">
<h2>Understanding the renderer</h2>

<style>
  .renderlist {position: relative; display: inline-block; margin-left: 3em; text-align: center;}
  .renderlist-label, .renderlist-caption, .renderlist-note {display: block; margin: 3px 0; width: 100%;}
  .renderlist-caption {font-size: 1.1em; font-weight: bold;}
  .renderlist-note {font-size: 0.9em;}
  .renderlist-box {background: #eee; border: 1px solid #333; padding: 3px 10px; margin: 3px 0; border-radius: 10px;}
  body.dark .renderlist-box {color: white; background: #333; border-color: #aaa;}
  .renderlist-box .renderlist-box {background: #ddd; width: 100%;}
  body.dark .renderlist-box .renderlist-box {background: #444; width: 100%;}
  .renderlist-box .renderlist-box .renderlist-box {background: #ccc;}
  body.dark .renderlist-box .renderlist-box .renderlist-box {background: #555;}
</style>

<p>To get the most out of BYOND's visual effects, it helps to understand how
the map is displayed.

<p>Every atom has an <a href=#/atom/var/appearance>appearance</a> that holds
all of its visual info (and sometimes a little non-visual info). This
appearance has to be turned into sprites in order to be rendered.

<p>Although many atoms need little more than a simple
<a class=code href=#/atom/var/icon>icon</a> and
<a class=code href=#/atom/var/icon_state>icon_state</a> and produce only a
single sprite, some are more complex with overlays, underlays, maptext, etc.
Also there may be <a href=#/image>image objects</a> and
<a href=#/atom/var/vis_contents>visual contents</a> involved, although
they're not part of the atom's appearance.

<p>For a simple <tt>icon</tt> and <tt>icon_state</tt>, just one sprite is
generated. The client looks up the icon it's given. Then it looks up an icon
state, which may be influenced by whether the atom is moving or not since you
can have moving and non-moving icon states. Then it determines which
<a href=#/atom/var/dir>direction</a> to draw and which frame of the icon's
animation (if any) to use.

<p>So with several simple icons, and not worrying about layers for now, a list
of sprites lays out like this:

<div class=renderlist>
<div class=renderlist-box>Atom #1</div>
<div class=renderlist-box>Atom #2</div>
<div class=renderlist-label>&vellip;</div>
<div class=renderlist-box>Atom #N</div>
</div>

<h3>Overlays and underlays</h3>

<p>Now let's consider what happens when an appearance has overlays.

<div class=renderlist>
<div class=renderlist-box>Underlay #1</div>
<div class=renderlist-label>&vellip;</div>
<div class=renderlist-box>Underlay #N</div>
<div class=renderlist-box>Main icon</div>
<div class=renderlist-box>Overlay #1</div>
<div class=renderlist-label>&vellip;</div>
<div class=renderlist-box>Overlay #N</div>
</div>

<p>The <a class=code href=#/atom/var/underlays>underlays</a> list is processed
first, then <a class=code href=#/atom/var/overlays>overlays</a>. These lists
contain appearances themselves, rather than actual atoms. This means that
overlays are recursive: an overlay can have overlays itself. To picture how
that works, just replace
one of the overlays above with another list.

<div class=renderlist>
<div class=renderlist-box>Underlay #1</div>
<div class=renderlist-box>Underlay #2</div>
<div class=renderlist-box>Main icon</div>
<div class=renderlist-box>Underlays of overlay #1</div>
<div class=renderlist-box>Overlay #1 icon</div>
<div class=renderlist-box>Overlays of overlay #1</div>
<div class=renderlist-box>Overlay #2</div>
</div>

<h3>Image objects and visual contents</h3>

<p>Any atom can have an <a href=#/image>image object</a> attached, which can
be shown to only specific players. Most atoms, and image objects, can have
<a href=#/atom/var/vis_contents>visual contents</a> that display other atoms
as if they're overlays.

<div class=renderlist>
<div class=renderlist-box>Underlays</div>
<div class=renderlist-box>Main icon</div>
<div class=renderlist-box>Overlays</div>
<div class=renderlist-box>Image objects</div>
<div class=renderlist-box>Visual contents</div>
</div>

<p>As you see this is very similar to overlays. Just like overlays, image
objects and visual contents have appearances of their own (and may also have
their own images or visual contents), so this may be recursive as they add
new overlays, etc.

<p>A couple of things to keep in mind:

<ul>
<li>If an image object uses the <a class=code href=#/atom/var/override>override</a>
  var, it will replace the main appearance's icon and overlays, although it
  won't replace other images or visual contents.</li>
<li>An object in visual contents can use
  <a class=code href=#/atom/var/vis_flags>vis_flags</a> to set
  <tt>VIS_UNDERLAY</tt> and move itself before the parent's underlays.</li>
</ul>

<h3>Maptext and particles</h3>

<p>Any appearance may have <a class=code href=#/atom/var/maptext>maptext</a>
attached. That maptext draws above the icon but is grouped with it. That
grouping will be discussed further below.

<p>Particle effects also get grouped with the main icon in a similar way to
maptext.

<p>For simplicity, from this point forward the diagram will just treat underlays,
overlays, image objects, and visual contents as overlays.

<div class=renderlist>
<div class=renderlist-box>
  <div class=renderlist-box>Main icon</div>
  <div class=renderlist-box>Maptext</div>
  <div class=renderlist-box>Particles</div>
</div>
<div class=renderlist-box>Overlays</div>
</div>

<h3>Color, transform, and filters</h3>

<p>An appearance's <a class=code href=#/atom/var/color>color</a> and
<a class=code href=#/atom/var/alpha>alpha</a> vars (from here forwarded
they'll just be referred to by <tt>color</tt>) and
<a class=code href=#/atom/var/transform>transform</a> are inherited by any
overlays, which also includes images and visual contents. You can avoid that
inheritance by giving those overlays special
<a class=code href=#/var/appearance_flags>appearance_flags</a>:
<tt>RESET_COLOR</tt>, <tt>RESET_ALPHA</tt>, and <tt>RESET_TRANSFORM</tt>.

<p>The appearance's filters are only applied to the main icon.

<div class=renderlist>
<div class=renderlist-box>
  <div class=renderlist-box>Main icon</div>
  <div class=renderlist-box>Maptext</div>
  <div class=renderlist-note>Main <tt>color</tt>, <tt>transform</tt>, and <tt>filters</tt> apply</div>
</div>
<div class=renderlist-box>
  <div class=renderlist-label>Overlays</div>
  <div class=renderlist-note><tt>color</tt> and <tt>transform</tt> are inherited from Main<br><tt>filters</tt> are not inherited from Main</div>
</div>
</div>

<p>When <tt>color</tt> and <tt>transform</tt> are inherited, they "stack". The
inherited color and transform values are applied after those of the overlays.

<h3><tt>KEEP_TOGETHER</tt> and <tt>KEEP_APART</tt></h3>

<p>There are times it's desirable for an appearance and all its overlays to be
treated as a single unit so any colors or filters can be applied all at once.
One simple example is if the appearance has an <tt>alpha</tt> of 128 to make it
translucent, you probably want to draw the whole atom faded instead of drawing
each sprite faded, one on top of the other.

<p>By using the <tt>KEEP_TOGETHER</tt> value in
<a class=code href=#/var/appearance_flags>appearance_flags</a> (called KT for
short), an appearance will group all of its underlays and overlays together.
If this is an atom with image objects and visual contents, those will be
grouped with it as well.

<div class=renderlist>
<div class=renderlist-box>
  <div class=renderlist-label>KT group</div>
  <div class=renderlist-note>Main <tt>color</tt>, <tt>transform</tt>, and <tt>filters</tt> apply</div>
  <div class=renderlist-box>
    <div class=renderlist-box>Main icon</div>
    <div class=renderlist-box>Maptext</div>
  </div>
  <div class=renderlist-box>Overlays</div>
</div>
</div>

<p>With <tt>KEEP_TOGETHER</tt> all of these sprites are rendered to a
temporary drawing surface, and then the main appearance's <tt>color</tt>,
<tt>transform</tt>, and <tt>filters</tt> are all applied to the combined
drawing. This comes with a trade-off, since you can no longer use flags
such as <tt>RESET_COLOR</tt> to opt out of inheritance.

<p>If an overlay doesn't want to be part of a KT group, it can use the
<tt>KEEP_APART</tt> flag (KA for short). If there are multiple nested
KT groups, KA will only escape the innermost group.

<p>If an overlay inside a KT group has a different
<a class=code href=#/atom/var/plane>plane</a> than the group's owner, it
will be separated as if it defined <tt>KEEP_APART</tt>, except it can
escape multiple nested groups.

<h3>Layers and planes</h3>

<p>Any appearance can have a <a class=code href=#/atom/var/layer>layer</a>
or <a class=code href=#/atom/var/layer>plane</a>, and these influence how
it gets sorted. (There's also a concept called a "sub-plane" that's
influenced by whether an atom is a
<a href=#/{notes}/HUD>HUD/screen object</a> or special layers like
<a class=code href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>.)

<p>If a sprite is created with <tt>FLOAT_LAYER</tt> (any negative value
counts as a floating layer) its layer has to be resolved, or "unfloated".
The main sprite for an atom can never float; it has to have a real layer.
Its overlays and underlays with floating layers will reorder themselves in
numerical order, then look for the next closest sprites in the rendering
list that has a non-negative layer.

<p>A similar process happens with <tt>FLOAT_PLANE</tt>. Planes can have
negative values but <TT>FLOAT_PLANE</TT> and the values close to it are
special. Sprites with floating planes have to resolve those as well.

<p>Once all atoms that will appear on the map are assembled into a rendering
list of sprites, the order in which they're rendered on the map is determined
in this order:

<ol>
  <li>The <tt>plane</tt> var matters most.</li>
  <li>Subplane is counted next. E.g., HUD objects render above non-HUD objects.</li>
  <li>Depending on <a class=code href=#/world/var/map_format>world.map_format</a>, <tt>layer</tt> or physical position determine the drawing order from here.</li>
  <li>After everything else has been checked, the order the sprites were generated in is the final tie-breaker.</li>
</ol>

<p>In a typical topdown map, <tt>layer</tt> is basically all that matters
after the plane and subplane are taken into account. There is a legacy
concept called micro-layers that helps break ties between sprites with the
same layer; for instance if an atom is moving it's usually desirable to
draw it above other atoms with the same layer; this applies only to topdown
maps.

<h3>Plane masters</h3>

<p>Sometimes it's helpful to group multiple sprites on one plane as if the
plane itself were a KT group. For this,
<a class=code href=#/var/appearance_flags>appearance_flags</a> has a value
called <tt>PLANE_MASTER</tt>. An object with this flag will act as a "parent"
for everything else on the plane. All other sprites on the plane will be
grouped together and rendered on a temporary drawing surface, and then the
plane master's <tt>color</tt>, <tt>transform</tt>, and <tt>filters</tt> will
be applied.

<p>A plane master does not, however, get an icon or maptext of its own;
they're simply ignored. It can have overlays added to the group.

<h3>Advanced topics</h3>

<p>There are other topics not covered in this article, such as
<a href=#/atom/var/render_target>render targets</a> and special map formats.
Any details on how those features impact rendering are discussed in their
own articles.

<hr>

<a name=/{notes}/side toc="Side-view maps">
<h2 byondver=482>Side-view maps</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/client/var/dir>dir var (client)</a>
<dd><a href=#/atom/var/pixel_w>pixel_w var (atom)</a>
<dd><a href=#/atom/var/pixel_z>pixel_z var (atom)</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/isometric>Isometric maps</a>
<dd><a href=#/{notes}/topdown>Topdown maps</a>
<dd><a href=#/{notes}/HUD>HUD</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{notes}/topdown_layer>TOPDOWN_LAYER</a>
</dl>

<p>The side-view map format is used for 3/4 perspective, where the map is
basically similar to a top-down view but is usually foreshortened. Just like
with isometric projection, tiles that are closer to the bottom of the screen
are considered to be closer to the viewer. This is a form of pseudo-3D in
which the 2D icons used by BYOND can be arranged in a way to give the
appearance of three dimensions.

<p>It is important to remember that this is an illusion of 3D, not real 3D.

<p>The <tt>layer</tt> var behaves much the same way it does in
<tt>ISOMETRIC_MAP</tt> mode.See <a href=#/{notes}/isometric>isometric maps</a>
for more information.

<p>When using this mode you may want to use a foreshortened
<tt>world.icon_size</tt>, like a 32x24 format instead of 32x32 for example,
and use taller icons for any vertical structures like walls or buildings. If
you set <tt>world.icon_size</tt> to use foreshortening, then <tt>pixel_y</tt>
(or <tt>pixel_x</tt>, depending on the orientation of client.dir) will be
adjusted for you; the same applies to <tt>step_x</tt> and <tt>step_y</tt>.
For example, with <tt>world.icon_size</tt> set to <tt>"64x32"</tt>, the
<i>physical</i> tile&mdash;what you would see if you were to look at it
straight down from above&mdash; is considered to be 64x64, so you would need
<tt>pixel_y=64</tt> or <tt>step_y=64</tt> to offset by a whole tile. This
adjustment does not apply to screen objects, <tt>pixel_w</tt>, or
<tt>pixel_z</tt>.

<hr>

<a name=/{notes}/tiled-icons toc="Tiled icons">
<h2>Tiled icons</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/icon>icon</a>
<dd><a href=#/icon/proc>procs (icon)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
</dl>

<p>In BYOND 3.0, any file like a large .bmp would be treated like a regular
icon that had been broken up into several tile-sized icon states. All tiles
then were 32x32 pixels. An image that was 100x100 would therefore take at
least 4x4 tiles to display. The icon was padded to the right and the top with
blank space to become an even multiple of 32x32, and then broken up into
sections. The lower left section was given an icon_state of <tt>"0,0"</tt>,
the next to the right was <tt>"1,0"</tt>, and so on, up to the upper right
which was <tt>"3,3"</tt>. Another icon state, a 32x32 thumbnail of the big
image, was also included.

<p>BYOND 4.0 expanded on this concept by allowing icons to be defined that had
individual graphics bigger than 32x32, and it would break each one up into
tiles just like 3.0 did. If an icon had a state called <tt>"open"</tt> then it
might break down into <tt>"open 0,0"</tt>, <tt>"open 1,0"</tt>, and so on,
while the actual <tt>"open"</tt> state would be a thumbnail image. To show the
whole image, you would have to have a separate atom or overlay for each
individual tile.

<p>In newer versions, breaking big icons into tiles is no longer done by
default. Instead, icons are shown and manipulated in their
<a href=#/{notes}/big-icons>native size</a>. To use the old method of breaking
icons into tiles, set <tt>world.map_format</tt> to <tt>TILED_ICON_MAP</tt>.
This is the default for all projects compiled before version 455.

<p>When using tiled icons, there are some important things to note:

<ul>
  <li>You need to use extra atoms or overlays to show any icon bigger than a
    single tile, where each atom/overlay shows an individual tile-sized piece
    of the big icon.</li>
  <li>The icon_state names of each tile are always the original name followed
    by a space, followed by x,y tile coordinates such as 0,0 or 2,1, so the
    northeast corner of <tt>"flag"</tt> might for instance be
    <tt>"flag 3,2"</tt>. If the original icon_state had no name, the space is
    left out and only the x,y coordinates are used.</li>
  <li>Every icon's size is a multiple of world.icon_size. If an icon of an
    incompatible size is used, it will be padded to the nearest full tile
    size.</li>
  <li><tt>Crop()</tt> and <tt>Scale()</tt> always pad their results to the
    nearest full tile size.</li>
  <li><tt>icon.Insert()</tt> can insert a single-tile icon into a multi-tiled
    big icon using the appropriate icon_state; e.g., inserting into
    <tt>"door 0,0"</tt> will replace the southwest corner of the
    <tt>"door"</tt> state.</li>
  <li>Using the <tt>icon()</tt> proc, you can extract a single tile from a
    multi-tiled big icon.</li>
</ul>

<p>This example shows a big icon being applied to an atom in tiled mode, as
overlays:

<h3>Example:</h3>
<xmp>
// icon is 3 tiles wide by 2 high
icon_state = "0,0"

// A temporary object used for the overlays
var/obj/O = new
O.icon = icon
O.layer = FLOAT_LAYER

for(var/tile_y=0, tile_y<2, ++tile_y)
   for(var/tile_x=0, tile_x<3, ++tile_x)
      if(tile_x && tile_y)
         O.pixel_x = tile_x * 32
         O.pixel_y = tile_y * 32
         O.icon_state = "[tile_x],[tile_y]"
         overlays += O
</xmp>

<hr>

<a name=/{notes}/topdown toc="Topdown maps">
<h2>Topdown maps</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/client/var/dir>dir var (client)</a>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/atom/var/plane>plane var (atom)</a>
<dd><a href=#/atom/movable/var/screen_loc>screen_loc var (movable atoms)</a>
<dd><a href=#/{notes}/big-icons>Big icons</a>
<dd><a href=#/{notes}/HUD>HUD</a>
<dd><a href=#/{notes}/isometric>Isometric maps</a>
<dd><a href=#/{notes}/side>Side-view maps</a>
<dd><a href=#/{notes}/renderer>Understanding the renderer</a>
</dl>

<p>By default, BYOND displays all maps in top-down format, so
<tt>world.map_format</tt> is set to <tt>TOPDOWN_MAP</tt> unless you say
otherwise. This view means players are looking down on the map, and
"north" corresponds to the top of their screen. (This can be changed by
setting <tt>client.dir</tt>.)

<p>A related map_format, used by older games, is <tt>TILED_ICON_MAP</tt>. This
is also topdown but it handles icons differently.

<p>In this form, the <tt>layer</tt> var behaves exactly as you would expect:
Icons with a lower layer are drawn beneath icons with a higher layer. The only
exception is when you use <a href=#/{notes}/big-icons>big icons</a>, which will
be drawn above any other icons on the same layer. Also an atom's underlays will
be drawn behind it unless their layer is changed, and its overlays will draw in
front of it unless otherwise stated.

<p>Topdown mode also guarantees that <tt>world.view</tt> or <tt>client.view</tt>
will set the exact screen size used by the HUD, except for HUD objects that
appear outside of the normal bounds.

<p>Screen objects (also called the HUD) cannot be intermixed with topdown
icons. They will appear on top of other icons, unless using a lower plane or a
special layer like <tt>BACKGROUND_LAYER</tt>.

<hr>

<a name=/{notes}/TOPDOWN_LAYER>
<h2>TOPDOWN_LAYER</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/layer>layer var (atom)</a>
<dd><a href=#/world/var/map_format>map_format var (world)</a>
<dd><a href=#/{notes}/BACKGROUND_LAYER>BACKGROUND_LAYER</a>
<dd><a href=#/{notes}/EFFECTS_LAYER>EFFECTS_LAYER</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<p>TOPDOWN_LAYER is a special high value that can be added to the regular layer
of any atom. This is only available when using a non-topdown world.map_format,
such as isometric mapping.

<p>The purpose of this value is to make an atom appear as if it belongs in a
top-down map, when using a map_format other than TOPDOWN_MAP or TILED_ICON_MAP.
This can be handy for title screens, or for special battle maps or the inside
of a building in an RPG.

<p>When using this special layer, it should be added to the layer an atom
normally uses. For instance a turf should have a layer of TOPDOWN_LAYER +
TURF_LAYER. Usually you will want one part of the map to have TOPDOWN_LAYER,
and for players to be unable to walk to there from the regular map. Mixing
topdown icons and icons in the normal map_format in view of each other could
look very strange. For safety's sake, the easiest thing to do is to keep them
on separate z layers.

<p>This can be mixed with EFFECTS_LAYER. Anything in TOPDOWN_LAYER will
display on top of EFFECTS_LAYER, and TOPDOWN_LAYER + EFFECTS_LAYER will be
above both.

<p>This can also be mixed with BACKGROUND_LAYER, which takes priority over
everything else.

<p>Images or overlays with FLOAT_LAYER can be left alone. They will
automatically have the same layer as whatever atom they are attached to.

<hr>

<a name=/{notes}/Unicode>
<h2 byondver=513>Unicode</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/text>text</a>
</dl>

<p>BYOND was originally written to handle 8-bit ("ANSI") characters only.
However as time has marched on, Unicode has become ubiquitous for supporting
multiple languages, special characters, and emojis. To adapt to this, BYOND
now supports Unicode.

<p>When ANSI was king, every character was exactly one byte in width, because
the only valid characters were between 1 and 255. (And technically, BYOND
reserved 255 for its own use.) Now, BYOND uses an encoding called UTF-8 to
store characters that can't fit in one byte.

<p>UTF-8 breaks up characters with codes of 128 or higher into multiple
bytes, like so:

<table class=withborder>
<tr><th>Character code</th><th>Size in bytes</th></tr>
<tr><td>0 - 0x7F</td><td>1</td></tr>
<tr><td>0x80 - 0x7FF</td><td>2</td></tr>
<tr><td>0x800 - 0xFFFF</td><td>3</td></tr>
<tr><td>0x10000 - 0x10FFFF</td><td>4</td></tr>
</table>

<h3>Text handling</h3>

<p>Importantly, BYOND's text procs are based on the byte position, not the
character position which may be lower. In other words,
<tt>length("abcd&eacute;fg")</tt> is greater than 7; it's 8, because
<tt>&eacute;</tt> takes up 2 bytes in UTF-8. That also means <tt>f</tt> is at
position 7, not position 6.

<p>Why do the text procs work with byte position instead of character
position? Because ultimately, it's faster. Going by character position would
require counting every byte in a string (at least when it uses UTF-8) until
the right character position was found. This would be detrimental to
performance in most cases.

<p>For the most part, this distinction should be fairly invisible to you.
Most code isn't going to encounter problems, but if you do a lot of text
processing you should be aware of it.

<p>In particular, <a class=code href=#/proc/text2ascii>text2ascii()</a>
returns the Unicode value at a specific position, which may cover several
bytes. If you loop through a string calling this proc for each character,
you'll have to make adjustments for cases when multiple bytes have been
read.

<p>The read-only <tt>[]</tt> index operator also uses byte positions.

<p>If you read a byte or cut text at an inappropriate point, any broken
characters resulting from the cut will be turned into the Unicode
replacement character &#xfffd; which is 0xFFFD.

<h3><tt>_char</tt> procs</h3>

<p>Most of the text handling procs have slower <tt>_char</tt> versions (e.g.,
<tt>copytext_char</tt>) that use character positions instead of byte
positions.

<p>These should be used sparingly if at all; whenever it's possible to use
byte positions, you should. When you do use a <tt>_char</tt> version of a
proc, prefer using <tt>-offset</tt> instead of
<tt>length_char(text)-offset</tt> for positions near the end of the string.
Most text procs allow negative position values that count backwards from the
end, and counting a small number of characters backward is faster than
counting a lot of characters going forward.

<h3>Old code</h3>

<p>Code written in ANSI will be up-converted to UTF-8 by Dream Maker, based on
your current locale when the code is loaded.

<hr>

<a name=/{skin} toc="User interface skins">
<h2>User interface skins</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/proc/winget>winget proc</a>
<dd><a href=#/proc/output>output proc</a>
<dd><a href=#/proc/winclone>winclone proc</a>
<dd><a href=#/proc/winexists>winexists proc</a>
<dd><a href=#/proc/winshow>winshow proc</a>
<dd><a href=#/{skin}/control>controls</a>
<dd><a href=#/{skin}/param>parameters</a>
<dd><a href=#/{skin}/macros>macros (skin)</a>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<p>BYOND games used to have very limited interface options, all effectively
sharing the same layout. In BYOND 4.0, skins were introduced, allowing
developers more control over the layout.

<p>A skin consists of <a href=#/{skin}/macros>macro sets</a> for
keyboard/gamepad input, menus, and windows and/or panes. All of these are
considered <a href=#/{skin}/control>controls</a> that a game can interact with
via <a class=code href=#/proc/winset>winset()</a>,
<a class=code href=#/proc/winget>winget()</a>,
<a class=code href=#/proc/output>output()</a>, and a few other procs.

<p>About the simplest possible skin is a single window with a single
<a href=#/{skin}/control/map>map control</a>, and a single macro set.

<hr>

<a name=/{skin}/commands>
<h2>Client commands</h2>

<p>Several commands can be executed on the client that are not verbs, but
instructions for Dream Seeker. Some of these commands have detailed syntax
described in their own reference entries.

<dl class=codedt>
<dt><a href=#/{skin}/commands/%2ewinset>.winset</a></dt><dd>Sets skin parameters, and includes special syntax for conditional actions.</dd>
<dt byondver=514><a href=#/{skin}/commands/%2eoutput>.output</a></dt><dd>Sends output to a control.</dd>
<dt>.options</dt><dd>Shows the Options &amp; Messages box.</dd>
<dt>.reboot</dt><dd>Reboots the world, when Dream Seeker is also acting as a server.</dd>
<dt>.reconnect</dt><dd>Reconnects to the same world.</dd>
<dt>.host</dt><dd>Opens hosting options box, when Dream Seeker is also acting as a server.</dd>
<dt>.profile</dt><dd>Opens the profiler. On a remote connection you may not have access to profile server procs, but you can look at the client and network profilers.</dd>
<dt>.screenshot</dt><dd>Saves a screenshot of the map. If there's more than one map control, the default map is used.</dd>
<dt>.screenshot auto</dt><dd>Saves a screenshot of the map, but does not prompt for a filename. The file will be saved in the client's user directory in BYOND/screenshots.</dd>
<dt>.gamepad-mapping</dt><dd>Opens the gamepad mapping dialog. Helpful if the user's gamepad is not supported or not configured to their liking.</dd>
<dt>.command</dt><dd>Prompts the user to enter a command, which can be one of these commands as well.</dd>
<dt byondver=516><a href=#/{skin}/commands/%2esound>.sound</a></dt><dd>Play, stop, or update sound.</dd>
<dt byondver=516><a href=#/{skin}/commands/%2eadd-particles>.add-particles</a></dt><dd>Adds a batch of particles to a <a href=#/{notes}/particles>particle set</a>.</dd>
<dt>.configure <i>option</i> <i>value</i></dt><dd>Toggle certain Dream Seeker config options, such as <tt>.configure graphics-hwmode on</tt>. The only supported options you can use are <tt>graphics-hwmode</tt>, <tt>sound</tt>, and <tt>delay</tt> which is an old mechanism for dynamically adapting to network delay. (Usually the <tt>delay</tt> is reset to 0.)</dd>
<dt>.quit</dt><dd>Closes Dream Seeker.</dd>
</dl>

<p>Client commands have a special syntax that allows you to query information
from the skin and include it directly in the command, as if you had called
<a class=code href=#/proc/winget>winget()</a>. Embedded expressions look like
<tt>[[<i>expression</i>]]</tt> in your command text. Some commands have
built-in data that gets filled in via <tt>[[*]]</tt>. See
<a href=#/{skin}/commands/embed>embedded winget</a> for more information.

<hr>

<a name=/{skin}/commands/%2eadd-particles>
<h2 byondver=516>.add-particles (client command)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{notes}/particles>Particle effects</a>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<dl><dt><b>Format:</b>
<dd>.add-particles <i>object</i> <i>count</i></dt>
</dl>

<p>Immediately spawns a batch of particles for a known particle set.

<p>The object parameter is a <a href=#/proc/ref>reference string</a> for the
object that holds the particles.

<p>A negative count is allowed, which will absorb some ordinary particle
spawns.

<pre class=client-command>.add-particles [0x200004f] 50</pre>

<p>If the object isn't known to the client, nothing will happen.

<hr>

<a name=/{skin}/commands/%2eoutput>
<h2 byondver=514>.output (client command)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/output>output proc</a>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<dl><dt><b>Format:</b>
<dd>.output <i>control</i> <i>text</i></dt>
</dl>

<p>Sends output to a control. The text does not need quotes, but any
backslashes, newlines, and tabs should be escaped with a backslash. This works
similarly to the <a href=#/proc/output><tt>output()</tt> proc</a>. If text is
omitted, the control is cleared.

<p>Here is an example of using a map control's
<a class=code href=#/{skin}/params/on-status>on-status</a> event to set a
label rather than using the window's own statusbar.

<pre class=client-command>.output statuslabel [[* as escaped]]</pre>

<hr>

<a name=/{skin}/commands/%2esound>
<h2 byondver=516>.sound (client command)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/sound>sound proc</a>
<dd><a href=#/sound>sound datum</a>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<dl><dt><b>Format:</b>
<dd>.sound <i>file</i> <i>options</i></dt>
<dd>.sound none <i>options</i></dt>
</dl>

<p>Plays, stops, or modifies a sound. This command can be used for instance to
play a click sound when using mouse macros, for instance, without waiting for
the server to initiate the sound which would introduce a small delay.

<pre class=client-command>.sound 'click.ogg'</pre>

<p>The file can be <tt>none</tt> or <tt>-</tt> when updating or stopping a
sound. Any options should be separated by spaces; most are in a
<tt>name=value</tt> format, as seen below.

<p>Supported options are:

<dl class=codedt>
<dt>update</dt><dd>This action is updating a channel rather than playing a new sound. It corresponds to the <a class=code href=#/sound/var/status>SOUND_UPDATE</a> status flag.</dd>
<dt>channel=<i>N</i></dt><dd>Specifies a channel.</dd>
<dt>volume=<i>N</i></dt><dd>Sets the volume.</dd>
<dt>mute<br/>mute=<i>T</i></dt><dd>Mutes the sound; the <tt>update</tt> option is implied.</dd>
<dt>pause<br/>pause=<i>T</i></dt><dd>Pauses the sound; the <tt>update</tt> option is implied.</dd>
<dt>wait</dt><dd>The new sound will queue up in the specified channel, and play after the current sound is done.</dd>
<dt>repeat<br/>repeat=<i>T</i><br/>repeat=once/infinite/rewind</dt><dd>Specifies whether, and how, the sound repeats.</dd>
<dt>falloff=<i>N</i></dt><dd>Sets the <a href=#/sound/var/falloff>falloff</a> value for 3D sound.</dd>
<dt>x=<i>N</i><br/>y=<i>N</i><br/>z=<i>N</i></dt><dd>Sets the <a href=#/sound/var/xyz>x, y, or z</a> value for 3D sound.</dd>
<dt>atom=<i>ref</i></dt><dd>Sets the atom for <a href=#/sound/var/atom>atom-linked</a> 3D sound. The reference is in a format such as <tt>[0x200001b]</tt> without quotes (see <a href=#/proc/ref>ref() proc</a>).</dd>
<dt>transform=<i>list</i></dt><dd>Sets the <a href=#/sound/var/transform>transform</a> value for 3D sound. The list is up to 9 numbers, separated by commas without spaces.</dd>
</dl>
<p class=small>*<i>T</i> represents a true/false value. True values include <tt>true</tt>, <tt>on</tt>, or 1. False would be <tt>false</tt>, <tt>off</tt>, or 0.

<hr>

<a name=/{skin}/commands/%2ewinset>
<h2>.winset (client command)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<dl><dt><b>Format:</b>
<dd>.winset "<i>[control.param=value;...]</i>"</dt></dd>
</dl>

<p>Sets skin parameters like the <a href=#/proc/winset><tt>winset()</tt> proc</a>.
You can set more than one parameter by separating them with semicolons.

<p>This command also allows you to use conditional expressions, like so:

<pre class=client-command>condition ? choice1 : choice2</pre>

<p>The condition is the same as any other parameter you might use in
<tt>.winset</tt>, but instead of setting the parameter, it checks to see if
it's true. If so, then the parameters in <tt>choice1</tt> will be set.
Otherwise, the parameters in <tt>choice2</tt> are set. This example makes the
window background red if bigbutton is checked.

<pre class=client-command>.winset "bigbutton.is-checked=true ? window.background-color=#ff0000 : window.background-color=none"</pre>

<p>If you want to look for values that don't match instead of values that do,
use <tt>!=</tt> instead of <tt>=</tt> in the condition.

<pre class=client-command>.winset "bigbutton.is-checked!=false ? window.background-color=#f00 : window.background-color=none"</pre>

<p>The <tt>choice2</tt> item is optional.

<pre class=client-command>.winset "bigbutton.is-checked=true ? window.background-color=#f00"</pre>

<p>Because it's often useful to do more than one thing at a time,
<tt>choice1</tt> and <tt>choice2</tt> don't have to be just one parameter. You
can use multiple parameters, but they are separated with a space instead of a
semicolon. (A semicolon indicates the conditional expression is over.)

<pre class=client-command>.winset "bigbutton.is-checked=true ? window.text-color=#fff window.background-color=#f00 : window.text-color=none window.background-color=none"</pre>

<hr>

<a name=/{skin}/commands/embed></a>
<h2>Embedded Winget</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<p>Commands that are initiated by the skin (like button.command, map.on-show,
etc.) have a special syntax that allows you to include information that would
normally require a winget call. By including <tt>[[<i>something</i>]]</tt> in
the command, the double-bracketed text will be replaced by the result of
running a winget on that parameter.

<p>A value of <tt>[[id.parameter]]</tt> will run a winget on the control with
the given ID. Just using <tt>[[parameter]]</tt> will run a winget for the
control that initiated this command. You can also use <tt>parent</tt> in place
of the ID to do something with the parent of the control, or <tt>parent.id</tt>
for access to a sibling control. Position and size parameters can be further
broken down by appending <tt>.x</tt> or <tt>.y</tt> to get at the numbers
directly.

<p>Several commands already support some special cases like <tt>[[*]]</tt> or
<tt>[[width]]</tt> or such, where the special-case values are relevant to the
command. An example is that in <tt>on-size</tt> the value of <tt>[[*]]</tt> is
a size value. The Any macro, gamepad macros, and mouse macros, also support this
syntax; see <a href=#/{skin}/macros>macros</a> for more info.

<p>You can choose how embedded wingets get formatted by following the value with
<tt>as</tt> and a type, such as <tt>[[window.size as string]]</tt>. There are
several types you can use, and different types of parameters get formatted differently:

<dl class="codedt">
<dt>arg</dt><dd>Value is formatted as if it's an argument on a command line. Numbers are left alone; booleans are 0 or 1; size and position have their X and Y values separated by a space; pretty much everything else is DM-escaped and enclosed in quotes.</dd>
<dt>escaped</dt><dd>DM-escape the value as if it's in a quoted string but do not include the quotes. Size and position values both use <tt>,</tt> to separate their X and Y values.</dd>
<dt>string</dt><dd>Value is formatted as a DM-escaped string with surrounding quotes.</dd>
<dt>params</dt><dd>Format value for a URL-encoded parameter list (see <a class=code href=#/proc/list2params>list2params</a>), escaping characters as needed.</dd>
<dt>json</dt><dd>JSON formatting. Numbers are left unchanged; size or position values are turned into objects with x and y items; boolean values are <tt>true</tt> or <tt>false</tt>.</dd>
<dt>json-dm</dt><dd>JSON formatting, but DM-escaped so it can be included in a quoted string. Quotes are not included.</dd>
<dt>raw</dt><dd>Does not change the value's text representation in any way; assumes it's already formatted correctly for the purpose. This is similar to <tt>as arg</tt> but does no escaping and no quotes.</dd>
</dl>

<p>The <tt>arg</tt> type is the default, unless the <tt>[[</tt><i>...</i><tt>]]</tt>
expression has double quotes on both sides, in which case <tt>escaped</tt> is the
default.

<hr>

<a name=/{skin}/control>
<h2>controls (skin)</h2>

<dl><dt><b>Control types:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>: A progress bar or slider
<dd><a href=#/{skin}/control/browser>Browser</a>: A browser
<dd><a href=#/{skin}/control/button>Button</a>: A pushbutton or toggle button
<dd><a href=#/{skin}/control/child>Child</a>: A container holding one or two panes, with a movable splitter
<dd><a href=#/{skin}/control/grid>Grid</a>: For table-like or list-like output
<dd><a href=#/{skin}/control/info>Info</a>: Classic BYOND statpanel
<dd><a href=#/{skin}/control/input>Input</a>: Command input or other user-entered text
<dd><a href=#/{skin}/control/label>Label</a>: Non-interactive text label
<dd><a href=#/{skin}/control/main>Main</a>: A window or pane that holds other controls
<dd><a href=#/{skin}/control/macro>Macro</a>: A <a href=#/{skin}/macros>keyboard/gamepad/mouse macro</a>
<dd><a href=#/{skin}/control/map>Map</a>: The game map display
<dd><a href=#/{skin}/control/menu>Menu</a>: An item in a drop-down menu
<dd><a href=#/{skin}/control/output>Output</a>: Text output
<dd><a href=#/{skin}/control/tab>Tab</a>: A tab control holding multiple panes, showing one at a time
</dl>

<dl class=codedd><dt><b>Parameters common to all controls:</b>
<dd><a href=#/{skin}/param/id>id</a>
<dd><a href=#/{skin}/param/is-disabled>is-disabled</a>
<dd><a href=#/{skin}/param/parent>parent</a>
<dd><a href=#/{skin}/param/saved-params>saved-params</a>
<dd><a href=#/{skin}/param/type>type</a>
<dt><b>Positionable controls only (not Macro or Menu):</b>
<dd><a href=#/{skin}/param/anchor>anchor1, anchor2</a>
<dd><a href=#/{skin}/param/background-color>background-color</a>
<dd><a href=#/{skin}/param/border>border</a>
<dd><a href=#/{skin}/param/drop-zone>drop-zone</a>
<dd><a href=#/{skin}/param/flash>flash</a>
<dd><a href=#/{skin}/param/focus>focus</a>
<dd><a href=#/{skin}/param/font-family>font-family</a>
<dd><a href=#/{skin}/param/font-size>font-size</a>
<dd><a href=#/{skin}/param/font-style>font-style</a>
<dd><a href=#/{skin}/param/inner-mouse-pos>inner-mouse-pos</a>
<dd><a href=#/{skin}/param/is-visible>is-visible</a>
<dd><a href=#/{skin}/param/is-transparent>is-transparent</a>
<dd><a href=#/{skin}/param/inner-mouse-pos>mouse-pos</a>
<dd><a href=#/{skin}/param/on-size>on-size</a>
<dd><a href=#/{skin}/param/outer-mouse-pos>outer-mouse-pos</a>
<dd><a href=#/{skin}/param/pos>pos</a>
<dd><a href=#/{skin}/param/right-click>right-click</a>
<dd><a href=#/{skin}/param/size>size</a>
<dd><a href=#/{skin}/param/text-color>text-color</a>
</dl>

<h3>Creating/Destroying at runtime</h3>

<p>Controls can be created or deleted at runtime. (Only controls you created
during runtime may be deleted.) To create a control, call
<a class=code href=#/proc/winset>winset()</a> using the
<a class=code href=#/{skin}/param/id>id</a> of the new control, and the
parameter list should include <a class=code href=#/{skin}/param/type>type</a>,
<a class=code href=#/{skin}/param/parent>parent</a>, and probably also
<a class=code href=#/{skin}/param/pos>pos</a>,
<a class=code href=#/{skin}/param/size>size</a>, and any
<a href=#/{skin}/param/anchor>anchors</a>.

<p>To delete the control again, set its <tt>parent</tt> to a blank value.

<p>Menu items and macros work similarly, except they have no positional info.
For those, the <a class=code href=#/{skin}/param/name>name</a> parameter is
important when you create them, and you will either need
<a class=code href=#/{skin}/param/command>command</a> or (for macros)
<a class=code href=#/{skin}/param/map-to>map-to</a> to do anything with them.

<hr>

<a name=/{skin}/control/bar>
<h2>bar control (skin)</h2>

<p>A progress bar or interactive slider. This can be made to use several different orientations. Its <tt>value</tt> can be read or set as a percentage from 0 to 100.

<dl class=codedd><dt><b>Bar-specific parameters:</b>
<dd><a href=#/{skin}/param/angle>angle1, angle2</a>
<dd><a href=#/{skin}/param/bar-color>bar-color</a>
<dd><a href=#/{skin}/param/dir>dir</a>
<dd><a href=#/{skin}/param/is-slider>is-slider</a>
<dd><a href=#/{skin}/param/bar-color>on-change</a>
<dd><a href=#/{skin}/param/value>value</a>
<dd><a href=#/{skin}/param/width>width</a>
</dl>

<hr>

<a name=/{skin}/control/browser>
<h2>browser control (skin)</h2>

<p>A browser panel integrated into the skin.

<dl class=codedd><dt><b>Browser-specific parameters:</b>
<dd><a href=#/{skin}/param/auto-format>auto-format</a>
<dd><a href=#/{skin}/param/on-hide>on-hide</a>
<dd><a href=#/{skin}/param/on-show>on-show</a>
<dd><a href=#/{skin}/param/show-history>show-history</a>
<dd><a href=#/{skin}/param/show-url>show-url</a>
<dd><a href=#/{skin}/param/use-title>use-title</a>
</dl>

<p>Browsers are capable of displaying HTML documents, and can also interact with the skin.

<h3>Browsers and popups</h3>

<p>A longstanding behavior of BYOND is the ability to create a new browser window by sending an extra argument to the <a class=code href=#/proc/browse>browse()</a> proc. Since the advent of skins in BYOND 4.0, this behavior was kept. When you create a new browser popup, the window name you specify for the popup is used for the name of a new <a href=#/{skin}/control/main>window control</a>, and within that window there will be a new browser control simply called <tt>browser</tt>.

<p>If you want to interact with the new browser, its full "decorated" <a class=code href=#/{skin}/param/id>id</a> is <tt><i>windowname</i>.browser</tt>.

<h3>Running JavaScript from DM</h3>

<p>Sending <a class=code href=#/proc/output>output()</a> to a browser will send a document to display there, but if you follow the browser's control name with a colon and a function name, you can call a JavaScript function in the document displayed within that browser.

<h3>Example:</h3>
<xmp>
var/list/info = list("name"="fridge", "power"=12)
// send {"name":"fridge","power":12} to a JavaScript function
usr << output(url_encode(json_encode(info)), "mybrowser:myJSfunction")
</xmp>

<p>The text that you send as output will be parsed like URL parameters, where mutliple arguments to the function are separated by <tt>&amp;</tt> or <tt>;</tt>, which is why <a class=code href=#/proc/url_encode>url_encode()</a> is wrapped around the <a class=code href=#/proc/json_encode>json_encode()</a> call in this example.

<h3>More browser options</h3>

<p>These topics cover more advanced uses of the browser control.

<dl>
<dt><a href=#/{skin}/control/browser/BYOND>BYOND object (JavaScript)</a></dt><dd>Shortcuts for client interaction</dd>
<dt><a href=#/{skin}/control/browser/winset>winset and winget (JavaScript)</a></dt><dd>Interact with the skin via JavaScript</dd>
<dt><a href=#/{skin}/control/browser/byondStorage>byondStorage (browser control)</a></dt><dd>Provides persistent storage options for small data</dd>
</dl>

<hr>

<a name=/{skin}/control/browser/BYOND>
<h2>BYOND object (JavaScript)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/control/browser>browser control (skin)</a>
</dl>

<p>The BYOND object is a built-in shortcut for interacting with the client
via JavaScript in a browser control. It contains the following methods:

<h3 class=code>BYOND.winset(id, params)</h3>

<p>Performs a <a href=#/{skin}/control/browser/winset>winset</a>, where
<tt>id</tt> is the ID of the control to change (or null for global settings),
and <tt>params</tt> is an object with parameter,value pairs such as
<tt>{"text-color": "red"}</tt>. Parameters can use camelCase, where a capital
letter indicates where a hyphen would normally go, e.g. <tt>"textColor"</tt>
and <tt>"text-color"</tt> are the same.

<h3>Example:</h3>
<xmp>
// uncheck a button from JavaScript
BYOND.winset("inventory_button", {isChecked: false});
</xmp>

<h3 class=code>BYOND.winget(id, props)</h3>

<p>Sends a <a href=#/{skin}/control/browser/winset>winget</a>, where
<tt>id</tt> is the ID of the control to retrieve (or null for global
settings), and <tt>props</tt> is a single property or an array of properties
to retrieve. As with <tt>winset</tt>, camelCase is allowed, but the result
will not use camelCase.

<p>Returns a Promise object, so this call can be used with the <tt>await</tt>
keyword or followed by <tt>then()</tt>. The result inside the promise is an
object with parameter,value pairs, such as
<tt>{"background-color": {value: "#ff0000", red: 255, green: 0, blue: 0, isDefault: false}}</tt>.

<h3>Example:</h3>
<xmp>
// get a button's status JavaScript
let buttonData = await BYOND.winget("inventory_button", "isChecked");
if(buttonData["is-checked"]) {
    alert("The button is checked!");
}
</xmp>

<h3 class=code>BYOND.command(command)</h3>

<p>Initiates a <a href=#/{skin}/commands>client command</a>. This is basically just a shortcut for using <tt>winset</tt> to run a command.

<h3>Example:</h3>
<xmp>
// play a sound
BYOND.command(".sound 'ding.ogg'");
</xmp>

<hr>

<a name=/{skin}/control/browser/byondStorage>
<h2>byondStorage (browser control)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/control/browser>browser control (skin)</a>
<dd><a href=#/proc/winset>winset proc</a>
</dl>

<p>A replacement for <tt>localStorage</tt> that can be used to hold
information for reuse in later sessions of the same game. (This must be
enabled via <tt>browser-options</tt> with the
<a href=#/proc/winset><tt>winset()</tt> proc</a>.)

<p>There are three actual storage objects you can use:

<table class=codefirst>
<tr><td>hubStorage</td><td>Stores info that can be shared for all games falling under this same <a href=#/world/var/hub>hub entry</a>. (This will not be available without a hub path.)</td></tr>
<tr><td>serverStorage</td><td>Stores info that can be shared for all games with the same hub path using this same server address.</td></tr>
<tr><td>domainStorage</td><td>Same as serverStorage, but ignores the connection port.</td></tr>
</table>

<p>Interacting with these storage objects is done in JavaScript, the same way
you would use <tt>localStorage</tt> or <tt>sessionStorage</tt>.

<p>Note: Technically <tt>localStorage</tt> does work, but because of the way
BYOND handles browser controls it acts more like <tt>sessionStorage</tt> in
practice.

<hr>

<a name=/{skin}/control/browser/winset>
<h2>winset and winget (JavaScript)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/control/browser>browser control (skin)</a>
<dd><a href=#/{skin}/control/browser/BYOND>BYOND object (JavaScript)</a>
<dd><a href=#/proc/winset>winset proc</a>
<dd><a href=#/proc/winget>winget proc</a>
</dl>

<p>Browser controls can interact with the skin via JavaScript, by setting <tt>window.location</tt> to a special URL.

<h3>Winset</h3>

<tt>byond://winset?id=<i>[control ID]</i>&<i>[property]</i>=<i>[value]</i>&...</tt>

<p>This works like an ordinary <a class=code href=#/proc/winset>winset()</a> call from the server. If <tt>id</tt> is omitted, it's the same as a winset with a null ID. You can also leave the <tt>id</tt> blank if you use "fully decorated" property names such as <tt>mybutton.is-checked</tt> instead of just <tt>is-checked</tt>.

<p>Any text you use other than letters, numbers, hyphens, commas, and periods should be encoded via the <tt>encodeURIComponent()</tt> function in JavaScript.

<h3>Winget</h3>

<tt>byond://winget?callback=<i>[callback function]</i>&id=<i>[control ID/list]</i>&property=<i>[property/list]</i></tt>

<p>In this winget, the IDs and properties you want can be separated by commas if you want to retrieve more than one. The winget operation works via a callback function you must define in JavaScript. The callback is given just one argument, a JavaScript object with all of the properties you requested. For example, this URL:

<pre>byond://winget?callback=wgcb&id=button1&property=is-checked,size,background-color</pre>

<p>...might send this to the callback function <tt>wgcb</tt>:

<pre>
{
    "is-checked": true,
    "size": {
        "x": 60,
        "y": 20
    },
    "background-color": {
        "value": "none",
        "isDefault": true,
        "red": 236,
        "green": 233,
        "blue": 216,
        "alpha": 255,
        "css": "#ece9d8"
    }
}
</pre>

<p>The property names will be in the same format you would expect from <a class=code href=#/proc/winget>winget()</a>, so when you're looking at multiple elements' properties, you'll get the full names in <tt>id.property</tt> format. The values are always sent back in a convenient form for JavaScript to work with; in the case of size, position, and color these will always be objects.

<p>An optional <tt>control</tt> parameter for the winget call can be used if you want to send data to a callback in a different browser control.</p>

<hr>

<a name=/{skin}/control/button>
<h2>button control (skin)</h2>

<p>A button that can be pressed to run a <a href=#/{skin}/commands>command</a>, or possibly toggled.

<dl class=codedd><dt><b>Button-specific parameters:</b>
<dd><a href=#/{skin}/param/button-type>button-type</a>
<dd><a href=#/{skin}/param/command>command</a>
<dd><a href=#/{skin}/param/group>group</a>
<dd><a href=#/{skin}/param/image>image</a>
<dd><a href=#/{skin}/param/is-checked>is-checked</a>
<dd><a href=#/{skin}/param/is-flat>is-flat</a>
<dd><a href=#/{skin}/param/text>text</a>
</dl>

<hr>

<a name=/{skin}/control/child>
<h2>child control (skin)</h2>

<p>A container that can hold one or two <a href=#/{skin}/control/main>panes</a>. If it holds two panes, a splitter may appear between them. This control can therefore be used to subdivide a window or pane into smaller units.

<dl class=codedd><dt><b>Child-specific parameters:</b>
<dd><a href=#/{skin}/param/is-vert>is-vert</a>
<dd><a href=#/{skin}/param/left>left, top</a>
<dd><a href=#/{skin}/param/lock>lock</a>
<dd><a href=#/{skin}/param/right>right, bottom</a>
<dd><a href=#/{skin}/param/show-splitter>show-splitter</a>
<dd><a href=#/{skin}/param/splitter>splitter</a>
</dl>

<hr>

<a name=/{skin}/control/grid>
<h2>grid control (skin)</h2>

<p>A grid that contains multiple cells that can show various kinds of output data.

<dl class=codedd><dt><b>Grid-specific parameters:</b>
<dd><a href=#/{skin}/param/cell-span>cell-span</a>
<dd><a href=#/{skin}/param/cells>cells</a>
<dd><a href=#/{skin}/param/current-cell>current-cell</a>
<dd><a href=#/{skin}/param/enable-http-images>enable-http-images</a>
<dd><a href=#/{skin}/param/highlight-color>highlight-color</a>
<dd><a href=#/{skin}/param/is-list>is-list</a>
<dd><a href=#/{skin}/param/line-color>line-color</a>
<dd><a href=#/{skin}/param/link-color>link-color</a>
<dd><a href=#/{skin}/param/show-lines>show-lines</a>
<dd><a href=#/{skin}/param/show-names>show-names</a>
<dd><a href=#/{skin}/param/small-icons>small-icons</a>
<dd><a href=#/{skin}/param/style>style</a>
<dd><a href=#/{skin}/param/visited-color>visited-color</a>
</dl>

<p>Sending output to a grid looks like this:

<h3>Example:</h3>
<xmp>
// output to column 3, row 2
winset(usr, "thegrid", "current-cell=3,2")
usr << output("Text", "thegrid")

// or even easier:
usr << output("Text", "thegrid:3,2")

// when is-list is true:
usr << output("5th item", "thegrid:5")
</xmp>

<p>You can output an atom to the grid, which can be clicked, dragged, etc.
However, you should make sure that atom is <i>not</i> temporary and will
persist until you no longer need it, or else the server may recycle it and
the object in the cell will either disappear or be impossible to interact
with anymore.

<p>There are some limitations to output in grid controls:

<ul>
<li>Only one character style (font, color, bold, etc.) may appear within a single cell.</li>
<li>A cell is either a link, or not.
<li>One image is allowed per cell.</li>
<li>A cell can hold an object (atom), sent to it via the <a href=#/proc/output><tt>output()</tt> proc</a>, which can be clicked, dragged, etc.; it will not act as a link.</li>
<li>The same margin is used all around the cell, not different margins for left, right, top, bottom.</li>
<li>There will always be a 1-pixel space for grid lines, whether they're shown or not.</li>
</ul>

<hr>

<a name=/{skin}/control/info>
<h2>info control (skin)</h2>

<p>The classic BYOND statpanel, which contains both stat and verb tabs. This
is technically a 3-column grid with a variable number of rows.

<dl class=codedd><dt><b>Info-specific parameters:</b>
<dd><a href=#/{skin}/param/allow-html>allow-html</a>
<dd><a href=#/{skin}/param/has-stats>has-stats</a>
<dd><a href=#/{skin}/param/has-verbs>has-verbs</a>
<dd><a href=#/{skin}/param/highlight-color>highlight-color</a>
<dd><a href=#/{skin}/param/multi-line>multi-line</a>
<dd><a href=#/{skin}/param/on-hide>on-hide</a>
<dd><a href=#/{skin}/param/on-show>on-show</a>
<dd><a href=#/{skin}/param/on-tab>on-tab</a>
<dd><a href=#/{skin}/param/prefix-color>prefix-color</a>
<dd><a href=#/{skin}/param/suffix-color>suffix-color</a>
<dd><a href=#/{skin}/param/tab-background-color>tab-background-color</a>
<dd><a href=#/{skin}/param/tab-font>tab-font-family, tab-font-size, tab-font-style</a>
<dd><a href=#/{skin}/param/tab-text-color>tab-text-color</a>
</dl>

<p>Output to a statpanel is done via the <a class=code href=#/proc/stat>stat()</a>
and <a class=code href=#/proc/statpanel>statpanel()</a> procs, during
<a class=code href=#/atom/proc/stat>mob/Stat()</a>.

<p>The same limitations that apply to <a href=#/{skin}/control/grid>grid</a>
output apply here.

<p>Info controls can now be split so that one displays stats and another
handles verbs.

<hr>

<a name=/{skin}/control/input>
<h2>input control (skin)</h2>

<p>A text box into which the user can type. By default this is used for sending <a href=#/{skin}/commands>client commands</a>, but it can be used for other purposes as well.

<dl class=codedd><dt><b>Input-specific parameters:</b>
<dd><a href=#/{skin}/param/command>command</a>
<dd><a href=#/{skin}/param/is-password>is-password</a>
<dd><a href=#/{skin}/param/multi-line>multi-line</a>
<dd><a href=#/{skin}/param/no-command>no-command</a>
<dd><a href=#/{skin}/param/on-blur>on-blur</a>
<dd><a href=#/{skin}/param/on-focus>on-focus</a>
<dd><a href=#/{skin}/param/text>text</a>
</dl>

<p>Note that when in "standard" mode of accepting user commands, built-in verbs like <tt>.click</tt>, or local commands like <tt>.winset</tt>, are not accepted when typed in. This kind of command can still be entered manually through the Client menu of the Options &amp; Messages window.

<hr>

<a name=/{skin}/control/label>
<h2>label control (skin)</h2>

<p>A text label that appears on the skin.

<dl class=codedd><dt><b>Label-specific parameters:</b>
<dd><a href=#/{skin}/param/align>align</a>
<dd><a href=#/{skin}/param/allow-html>allow-html</a>
<dd><a href=#/{skin}/param/image>image</a>
<dd><a href=#/{skin}/param/image-mode>image-mode</a>
<dd><a href=#/{skin}/param/keep-aspect>keep-aspect</a>
<dd><a href=#/{skin}/param/text>text</a>
<dd><a href=#/{skin}/param/text-wrap>text-wrap</a>
</dl>

<hr>

<a name=/{skin}/control/macro>
<h2>macro control (skin)</h2>

<p>A <a href=#/{skin}/macros>keyboard/gamepad/mouse macro</a>, usually designed to run a <a href=#/{skin}/commands>command</a>. The control is a means of interacting with the macro as an object, allowing some of its properties to be changed at runtime.

<dl class=codedd><dt><b>Macro-specific parameters:</b>
<dd><a href=#/{skin}/param/command>command</a>
<dd><a href=#/{skin}/param/map-to>map-to</a>
<dd><a href=#/{skin}/param/name>name</a>
</dl>

<hr>

<a name=/{skin}/control/main>
<h2>main control (skin)</h2>

<p>A container for other controls. The Main control takes two forms: a window or a pane. 

<p>A window exists independently and can be moved around on the screen. A pane has to be used within another container control such as a <a href=#/{skin}/control/child>Child</a> or <a href=#/{skin}/control/tab>Tab control</a>.

<dl class=codedd><dt><b>Main-specific parameters:</b>
<dd><a href=#/{skin}/param/icon>icon</a>
<dd><a href=#/{skin}/param/image>image</a>
<dd><a href=#/{skin}/param/image-mode>image-mode</a>
<dd><a href=#/{skin}/param/inner-size>inner-pos</a>
<dd><a href=#/{skin}/param/inner-size>inner-size</a>
<dd><a href=#/{skin}/param/is-pane>is-pane</a>
<dd><a href=#/{skin}/param/keep-aspect>keep-aspect</a>
<dd><a href=#/{skin}/param/outer-pos>outer-pos</a>
<dd><a href=#/{skin}/param/outer-size>outer-size</a>
<dd><a href=#/{skin}/param/title>title</a>
<dd><a href=#/{skin}/param/on-status>on-status</a>
<dt><b>Windows only:</b>
<dd><a href=#/{skin}/param/alpha>alpha</a>
<dd><a href=#/{skin}/param/can-close>can-close</a>
<dd><a href=#/{skin}/param/can-minimize>can-minimize</a>
<dd><a href=#/{skin}/param/can-resize>can-resize</a>
<dd><a href=#/{skin}/param/is-fullscreen>is-fullscreen</a>
<dd><a href=#/{skin}/param/is-maximized>is-maximized</a>
<dd><a href=#/{skin}/param/is-minimized>is-minimized</a>
<dd><a href=#/{skin}/param/macro>macro</a>
<dd><a href=#/{skin}/param/menu>menu</a>
<dd><a href=#/{skin}/param/on-close>on-close</a>
<dd><a href=#/{skin}/param/screen-pos>screen-pos</a>
<dd><a href=#/{skin}/param/screen-size>screen-size</a>
<dd><a href=#/{skin}/param/statusbar>statusbar</a>
<dd><a href=#/{skin}/param/titlebar>titlebar</a>
<dd><a href=#/{skin}/param/transparent-color>transparent-color</a>
<dt><b>Panes only:</b>
<dd><a href=#/{skin}/param/can-scroll>can-scroll</a>
</dl>

<p>The font parameters have no impact on a window's statusbar or titlebar; those are drawn by the operating system.

<hr>

<a name=/{skin}/control/map>
<h2>map control (skin)</h2>

<p>A map that will display icons from the game.

<dl class=codedd><dt><b>Map-specific parameters:</b>
<dd deprecated><a href=#/{skin}/param/icon-size>icon-size</a>
<dd><a href=#/{skin}/param/letterbox>letterbox</a>
<dd><a href=#/{skin}/param/on-hide>on-hide</a>
<dd><a href=#/{skin}/param/on-show>on-show</a>
<dd><a href=#/{skin}/param/style>style</a>
<dd><a href=#/{skin}/param/text-mode>text-mode</a>
<dd><a href=#/{skin}/param/view-size>view-size</a>
<dd><a href=#/{skin}/param/zoom>zoom</a>
<dd><a href=#/{skin}/param/zoom-mode>zoom-mode</a>
</dl>

<hr>

<a name=/{skin}/control/menu>
<h2>menu control (skin)</h2>

<p>A menu item, that when activate will run a <a href=#/{skin}/commands>command</a>.

<dl class=codedd><dt><b>Menu-specific parameters:</b>
<dd><a href=#/{skin}/param/can-check>can-check</a>
<dd><a href=#/{skin}/param/command>command</a>
<dd><a href=#/{skin}/param/group>group</a>
<dd><a href=#/{skin}/param/index>index</a>
<dd><a href=#/{skin}/param/is-checked>is-checked</a>
<dd><a href=#/{skin}/param/name>name</a>
</dl>

<hr>

<a name=/{skin}/control/output>
<h2>output control (skin)</h2>

<p>Displays text output.

<dl class=codedd><dt><b>Output-specific parameters:</b>
<dd><a href=#/{skin}/param/enable-http-images>enable-http-images</a>
<dd><a href=#/{skin}/param/image>image</a>
<dd><a href=#/{skin}/param/legacy-size>legacy-size</a>
<dd><a href=#/{skin}/param/link-color>link-color</a>
<dd><a href=#/{skin}/param/max-lines>max-lines</a>
<dd><a href=#/{skin}/param/style>style</a>
<dd><a href=#/{skin}/param/visited-color>visited-color</a>
</dl>

<hr>

<a name=/{skin}/control/tab>
<h2>tab control (skin)</h2>

<p>A tab control, where each tab holds a different <a href=#/{skin}/control/main>pane</a>.

<dl class=codedd><dt><b>Tab-specific parameters:</b>
<dd><a href=#/{skin}/param/current-tab>current-tab</a>
<dd><a href=#/{skin}/param/multi-line>multi-line</a>
<dd><a href=#/{skin}/param/on-tab>on-tab</a>
<dd><a href=#/{skin}/param/tabs>tabs</a>
</dl>

<hr>

<a name=/{skin}/macros>
<h2>macros (skin)</h2>

<p>Macros are used to convert keyboard and gamepad events into actions. There
are two ways this works: A macro can run a command, or in some cases (such as
gamepad controls) it can be used to remap one control to another.

<p>A collection of macros is called a macro set, and the window currently in
use defines which macro set will be used via its
<a class=code href=#/{skin}/param/macro>macro</a> parameter.

<p>Macros can be changed at runtime. If a macro does not have an
<a class=code href=#/{skin}/param/id>id</a>, you can refer to it by its key
combination (<a class=code href=#/{skin}/param/name>name</a>). If you have a
macro set named <tt>macro1</tt> and have a <tt>Ctrl+E</tt> macro for instance,
you could use <a class=code href=#/proc/winset>winset()</a> with
<tt>"macro1.Ctrl+E"</tt>. See the <a href=#/{skin}/control/macro>Macro
control</a> for information on which parameters you can change with
<tt>winset()</tt>.

<p>The <tt>name</tt> of the macro is actually the full key combination as it
would appear in the macro editor, like <tt>CTRL+E</tt>, <tt>Space+REP</tt>, or
<tt>Alt+Shift+F1</tt>. This is not case-specific and it doesn't matter where
you put modifiers like <tt>CTRL+</tt>, <tt>SHIFT+</tt>, etc.

<h3 byondver=511>The Any macro</h3>

<p>Oftentimes it's desirable to keep track of key presses yourself rather than
have a hundred different macros defined. BYOND makes this possible via the
<tt>Any</tt> and <tt>Any+UP</tt> macros, which respond to any key or gamepad
button. <tt>UP</tt> is the only allowed modifier for this macro, since other
modifier keys are handled by this same macro.

<p>Typically, you will want to use <a class=code href=#/verb/set/instant>set
instant=1</a> on the verbs that will be tied to the Any macro, so that
keyboard input doesn't queue up and lag behind.

<p>In the <a class=code href=#/{skin}/param/command>command</a> that goes with
this macro, <tt>[[*]]</tt> will be replaced with the name of the key or gamepad
button that was pressed/released. (See
<a href=#/{skin}/commands/embed>embedded winget</a> for more details on the
<tt>[[...]]</tt> format.)

<h3 byondver=511>Mapping</h3>

<p>The <a class=code href=#/{skin}/param/map-to>map-to</a> parameter is used
by <b>mappings</b>, which are like macros but are used to convert gamepad
inputs easily and quickly to keyboard inputs. E.g., <tt>GamepadLeft</tt> can
map to <tt>West</tt> which is the left arrow key. A set of default mappings
will be added automatically at runtime if you don't include any gamepad
mapping in your project.

<h3 byondver=511>Gamepads</h3>

<p>BYOND will support up to four gamepads, and breaks up their input into the
following categories:

<ul>
<li><b>Buttons:</b> Buttons on the controller that are either pressed or not pressed.</li>
<li><b>Directions:</b> Directions pressed on the D-pad, which act like buttons. Diagonals are also included.</li>
<li><b>D-pad:</b> The D-pad itself, which can be used to read a <a class=code href=#/atom/var/dir>dir</a> number.</li>
<li><b>Analog:</b> The analog sticks (BYOND supports left and right).</li>
</ul>

<p>See the list of available macros below for information on how to harness
these inputs.

<p>To let a user configure their gamepad, you need to call the client-side
<tt>.gamepad-mapping</tt> <a href=#/{skin}/commands>command</a>. Or, if they
have access to the Options &amp; Messages window and Dream Seeker's default
menus, they can reach it from there. However it's a good idea to make this
easy for them to find. Several common gamepads are already known by BYOND.

<p>There is also the <tt>GamepadRaw</tt> macro, which is similar
to <tt>Any</tt> in some ways and will avoid doing any processing (e.g.
checking for dead zones on the analog sticks) so you can handle all input
yourself. <tt>GamepadRaw</tt> does not rely on BYOND's controller
configuration, so it will not, for instance, know that button 0 should be
<tt>GamepadFace1</tt>. See below for more information on how to use this
macro.

<h3 byondver=514>Mouse macros</h3>

<p>You can add macros (not local player-defined ones) for any of the mouse
input commands, thereby bypassing the normal mouse verbs. This can be helpful
for designing custom setups where you don't want to have to parse the normal
parameter string that provides most of the info, and instead want to provide
data directly to the verb. You will want <tt>set instant=1</tt> on any such
verb.

<p>Mouse macro commands use the <tt>[[...]]</tt> syntax to embed values, just
like <a href=#/{skin}/commands/embed>embedded wingets</a>. These are the
values you can include in a mouse macro:

<table class="macro_info">
<tr><th>Embedded keyword</th><th>Meaning</th></tr>
<tr><td><tt>action</tt></td><td>Name of the mouse action (e.g. MouseDown, MouseMove, etc.).</td></tr>
<tr><td><tt>src</tt></td><td>Object the mouse is touching, or dragging/dropping.</td></tr>
<tr><td><tt>loc</tt></td><td>Turf or statpanel that <tt>src</tt> is over; in a drag-drop you should split this into <tt>src.loc</tt> and <tt>over.loc</tt>.</td></tr>
<tr><td><tt>button</tt></td><td>Mouse button used for this action, if any: <tt>left</tt>, <tt>middle</tt>, or <tt>right</tt>.</td></tr>
<tr><td><tt>drag</tt></td><td>Mouse button currently used for dragging.</td></tr>
<tr><td><tt>buttons</tt></td><td>Mouse buttons currently down or involved in this action, separated by commas.</td></tr>
<tr><td><tt>keys</tt></td><td>Modifier keys currently held (<tt>shift</tt>, <tt>ctrl</tt>, <tt>alt</tt>), separated by commas.</td></tr>
<tr><td><tt>over</tt></td><td>Object the mouse is over in a drag/drop operation.</td></tr>
<tr><td><tt>id</tt></td><td>Control ID; in a drag-drop you should split this into <tt>src.id</tt> and <tt>over.id</tt>.</td></tr>
<tr><td><tt>icon</tt></td><td>The icon offset (starting from 1,1 at the lower left) where the mouse action occurred.<sup>*</sup></td></tr>
<tr><td><tt>tile</tt></td><td>The tile where the mouse action occurred, if relevant.<sup>*</sup></td></tr>
<tr><td><tt>vis</tt></td><td>Pixel coordinates relative to the icon's position on screen (same as <tt>icon</tt> but without taking transform into account).<sup>*</sup></td></tr>
<tr><td><tt>screen_loc</tt></td><td>The regular <tt>screen_loc</tt> cordinate string.<sup>*</sup></td></tr>
<tr><td><tt>screen</tt></td><td><tt>screen_loc</tt> coordinates but entirely in pixels starting at 0,0 from lower left.<sup>*</sup></td></tr>
<tr><td><tt>screen_tile</tt></td><td><tt>screen_loc</tt> coordinates but only the tile number starting at 1,1.<sup>*</sup></td></tr>
<tr><td><tt>screen_offset</tt></td><td><tt>screen_loc</tt> coordinates but only the pixel offset from the tile, starting at 0,0.<sup>*</sup></td></tr>
<tr><td><tt>delta</tt></td><td>Wheel changes in a mouse wheel command.<sup>*</sup></td></tr>
<tr><td><tt>left</tt>, <tt>right</tt>, <tt>middle</tt></td><td>1 if this button is down or involved in this action, 0 otherwise</td></tr>
<tr><td><tt>shift</tt>, <tt>ctrl</tt>, <tt>alt</tt></td><td>1 if this modifier key is held, 0 otherwise</td></tr>
<tr><td><tt>link</tt></td><td>1 if the mouse is over a maptext link, 0 otherwise</td></tr>
<tr><td><tt>cell</tt></td><td>Grid cell involved in a mouse action. In a drag/drop action, <tt>src.cell</tt> is the dragging cell and <tt>over.cell</tt> is the drop cell.</td></tr>
<tr><td><tt>drag-cell</tt></td><td>Alias for <tt>src.cell</tt>.</td></tr>
<tr><td><tt>drop-cell</tt></td><td>Alias for <tt>over.cell</tt>.</td></tr>
<tr><td colspan=2><sup>*</sup> Coordinate values are comma-separated, but you can follow them with <tt>.x</tt> or <tt>.y</tt> to get the individual X and Y numbers.</td></tr>
</table>

<p>An example mouse macro command might look like this:

<blockquote><pre>my-mousedown-verb [[src]] [[button]] "keys=[[keys as params]];drag=[[drag as params]]"</pre></blockquote>

<p>And the verb to go with it looks like this:

<xmp>
client
    // "in src" is the same as "in usr.client" here
    verb/my_mousedown_verb(object as anything in src, button as text, params as text)
</xmp>

<p>In the example, the <tt>src</tt> value is a reference such as you would get
with the <a href=#/proc/ref><tt>ref()</tt> proc</a>. It can be used as a verb
argument directly and won't be enclosed by quotes by default. The <tt>button</tt>
value is a string and the default formatting will put quotes around it. The
<tt>keys</tt> and <tt>drag</tt> values were given the <tt>as params</tt> format
specifier so they would behave as part of a <a href=#/proc/list2params>parameter
list</a>.

<p>In drag/drop actions, you can precede any value with <tt>src</tt> or
<tt>over</tt> if there may be different information for the dragged object and
the mouseover object/location. This also applies to things like <tt>keys</tt>,
which by default will be the currently held keys but you can use <tt>src.keys</tt>
to refer to the values from when the drag began.

<h3>Available macros</h3>

<p>This is a list of all keys and gamepad events that can be used in macros.

<table class="macro_info">
  <thead>
    <tr><td class="macro_head" colspan=2><b>Macro modifiers</b> are part of the macro name, and control the conditions in which the macro will fire.</td></tr>
    <tr><th>Modifier</th><th>Meaning</th></tr>
  </thead>
  <tbody>
  <tr><td><tt>SHIFT+</tt></td><td>This macro only counts if either Shift key is pressed.</td></tr>
  <tr><td><tt>CTRL+</tt></td><td>This macro only counts if either Ctrl key is pressed.</td></tr>
  <tr><td><tt>ALT+</tt></td><td>This macro only counts if either Alt key is pressed.</td></tr>
  <tr><td><tt>+REP</tt></td><td>If a key/button is held down, this macro repeats.</td></tr>
  <tr><td><tt>+UP</tt></td><td>This macro fires when the key/button is released.</td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2><b>Keyboard keys</b> are the garden-variety macros. (This list is abridged to exclude keys probably no one has.)</td></tr>
    <tr><th>Key</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td><tt>A</tt> - <tt>Z</tt></td><td>Letter key</td></tr>
    <tr><td><tt>0</tt> - <tt>9</tt></td><td>Number key</td></tr>
    <tr><td><tt>Numpad0</tt> - <tt>Numpad9</tt></td><td>Numpad numbers</td></tr>
    <tr><td><tt>North</tt></td><td>Up arrow</td></tr>
    <tr><td><tt>South</tt></td><td>Down arrow</td></tr>
    <tr><td><tt>East</tt></td><td>Right arrow</td></tr>
    <tr><td><tt>West</tt></td><td>Left arrow</td></tr>
    <tr><td><tt>Northwest</tt></td><td>Home key</td></tr>
    <tr><td><tt>Southwest</tt></td><td>End key</td></tr>
    <tr><td><tt>Northeast</tt></td><td>Page Up key</td></tr>
    <tr><td><tt>Southeast</tt></td><td>Page Down key</td></tr>
    <tr><td><tt>Center</tt></td><td>Center key (numpad)</td></tr>
    <tr><td><tt>Return</tt></td><td>Enter / Return key</td></tr>
    <tr><td><tt>Escape</tt></td><td>Esc key</td></tr>
    <tr><td><tt>Tab</tt></td><td>Tab key</td></tr>
    <tr><td><tt>Space</tt></td><td>Space bar</td></tr>
    <tr><td><tt>Back</tt></td><td>Backspace key</td></tr>
    <tr><td><tt>Insert</tt></td><td>Ins key</td></tr>
    <tr><td><tt>Delete</tt></td><td>Del key</td></tr>
    <tr><td><tt>Pause</tt></td><td>Pause key</td></tr>
    <tr><td><tt>Snapshot</tt></td><td>Snapshot / Print Screen key</td></tr>
    <tr><td><tt>LWin</tt></td><td>Left Windows key</td></tr>
    <tr><td><tt>RWin</tt></td><td>Right Windows key</td></tr>
    <tr><td><tt>Apps</tt></td><td>Apps key</td></tr>
    <tr><td><tt>Multiply</tt></td><td>Multiply key</td></tr>
    <tr><td><tt>Add</tt></td><td>Add key</td></tr>
    <tr><td><tt>Subtract</tt></td><td>Subtract key</td></tr>
    <tr><td><tt>Divide</tt></td><td>Divide / Slash key</td></tr>
    <tr><td><tt>Separator</tt></td><td>Separator / Backslash key</td></tr>
    <tr><td><tt>Shift</tt></td><td>Shift key (when not used as a modifier)</td></tr>
    <tr><td><tt>Ctrl</tt></td><td>Ctrl key (when not used as a modifier)</td></tr>
    <tr><td><tt>Alt</tt></td><td>Alt key (when not used as a modifier)</td></tr>
    <tr><td><tt>VolumeMute</tt></td><td>Mute key</td></tr>
    <tr><td><tt>VolumeUp</tt></td><td>Volume up key</td></tr>
    <tr><td><tt>VolumeDown</tt></td><td>Volume down key</td></tr>
    <tr><td><tt>MediaPlayPause</tt></td><td>Play/pause media key</td></tr>
    <tr><td><tt>MediaStop</tt></td><td>Stop media key</td></tr>
    <tr><td><tt>MediaNext</tt></td><td>Next track key</td></tr>
    <tr><td><tt>MediaPrev</tt></td><td>Previous track key</td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2><b>Special macros</b></td></tr>
  </thead>
  <tbody>
    <tr><td><tt><b>Any</b></tt></td><td>A special macro that can run a command on press/release of any key or gamepad button. <tt>UP</tt> is the only modifier allowed. In the command, <tt>[[*]]</tt> is replaced with the key/button name.<sup>*</sup></td></tr>
    <tr><td><tt><b>GamepadRaw</b></tt><sup>*</sup></td><td>Captures raw input from a gamepad, without regard to the adjustments done by the Gamepad Setup dialog. In the command, <tt>[[id]]</tt> is replaced by the name of the button or axis changed ("Button0" through "Button15" and "Axis0" through "Axis11"), <tt>[[value]]</tt> is replaced with the value of the button or axis, and <tt>[[*]]</tt> is equivalent to <tt>[[id]] [[value]]</tt>.</td></tr>
    <tr><td colspan=2 class="macro_foot">
      <p><sup>*</sup> If no gamepad mappings are included in a game's interface, the default mappings are used instead, which will map the Dpad buttons to the arrow keys. This will cause the Any macro to register both a gamepad directional button and the mapped key on the same press. If you plan on using macros to capture gamepad input, you may wish instead to map any one of the directional buttons to "None", which will override the default gamepad mappings completely.</p>
    </td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2><b>Gamepad buttons</b><sup>&dagger;</sup> can use another gamepad button as a modifier (but not CTRL, SHIFT, ALT), and can be mapped to one or two keyboard keys or mouse buttons.</td></tr>
    <tr><th>Button</th><th>Description</th></tr>
  </thead>
  <tbody>
    <tr><td><tt>GamepadFace1</tt></td><td>A (Xbox), X (PS), bottom of diamond</td></tr>
    <tr><td><tt>GamepadFace2</tt></td><td>B (Xbox), Circle (PS), right of diamond</td></tr>
    <tr><td><tt>GamepadFace3</tt></td><td>X (Xbox), Square (PS), left of diamond</td></tr>
    <tr><td><tt>GamepadFace4</tt></td><td>Y (Xbox), Triangle (PS), top of diamond</td></tr>
    <tr><td><tt>GamepadL1</tt></td><td>Left top shoulder</td></tr>
    <tr><td><tt>GamepadR1</tt></td><td>Right top shoulder</td></tr>
    <tr><td><tt>GamepadL2</tt></td><td>Left bottom shoulder</td></tr>
    <tr><td><tt>GamepadR2</tt></td><td>Right bottom shoulder</td></tr>
    <tr><td><tt>GamepadSelect</tt></td><td>Select / Back</td></tr>
    <tr><td><tt>GamepadStart</tt></td><td>Start / Forward</td></tr>
    <tr><td><tt>GamepadL3</tt></td><td>Left analog click</td></tr>
    <tr><td><tt>GamepadR3</tt></td><td>Right analog click</td></tr>
    <tr><td class="macro_subhead" colspan=2>Directional buttons: only one can pressed at a time, and the diagonal buttons are virtual.</tr>
    <tr><td><tt>GamepadUp</tt></td><td>Up button</td></tr>
    <tr><td><tt>GamepadDown</tt></td><td>Down button</td></tr>
    <tr><td><tt>GamepadLeft</tt></td><td>Left button</td></tr>
    <tr><td><tt>GamepadRight</tt></td><td>Right button</td></tr>
    <tr><td><tt>GamepadUpLeft</tt></td><td>Up+left virtual button</td></tr>
    <tr><td><tt>GamepadUpRight</tt></td><td>Up+right virtual button</td></tr>
    <tr><td><tt>GamepadDownLeft</tt></td><td>Down+left virtual button</td></tr>
    <tr><td><tt>GamepadDownRight</tt></td><td>Down+right virtual button</td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2><b>Gamepad analog sticks</b><sup>&dagger;</sup> can have commands and/or map to <tt>GamepadDir</tt>, <tt>GamepadDir4</tt>, or <tt>Mouse</tt>. They can use a gamepad button as a modifier. In a command, <tt>[[x]]</tt> and <tt>[[y]]</tt> are replaced by coordinates, and <tt>[[*]]</tt> is replaced by both with a comma for separation.</td></tr>
  </thead>
  <tbody>
    <tr><td><tt>GamepadLeftAnalog</tt></td><td>Left analog stick</td></tr>
    <tr><td><tt>GamepadRightAnalog</tt></td><td>Left analog stick</td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2><b>Gamepad Dpads</b><sup>&dagger;&Dagger;</sup> can have commands or are used as mapping targets for analog sticks. A gamepad button can be used as a modifier. In a command, <tt>[[*]]</tt> is replaced by a direction number, which can be 0.</td></tr>
  </thead>
  <tbody>
    <tr><td><tt>GamepadDir</tt></td><td>Dpad, converted to one of the eight standard directions.</td></tr>
    <tr><td><tt>GamepadDir4</tt></td><td>Dpad, converted to a cardinal direction.</td></tr>
    <tr><td colspan=2 class="macro_foot">
      <p><sup>&dagger;</sup> All of the gamepad macros defined above apply to the first gamepad. BYOND can now support up to four gamepads, and you can replace Gamepad in the names above with Gamepad2, Gamepad3, or Gamepad4 to access them. Each gamepad also has its own raw macro (i.e., Gamepad2Raw).</p>
      <p><sup>&Dagger;</sup> If you use a Dpad macro like GamepadDir as a <tt>map-to</tt> target, you don't have to specify gamepad 2-4 in map-to; the mapping will automatically know that when Gamepad2LeftAnalog is mapped to GamepadDir, it means Gamepad2Dir.</p>
    </td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2 byondver=514><b>Mouse macros</b> can have commands but not be used as mapping targets.</td></tr>
  </thead>
  <tbody>
    <tr><td><tt>MouseDown</tt></td><td>Mouse button pressed (replaces MouseDown verb)</td></tr>
    <tr><td><tt>MouseUp</tt></td><td>Mouse button released (replaces MouseUp verb)</td></tr>
    <tr><td><tt>MouseClick</tt></td><td>A click action has occurred (replaces Click verb)</td></tr>
    <tr><td><tt>MouseDblClick</tt></td><td>A double-click action has occurred (replaces DblClick verb)</td></tr>
    <tr><td><tt>MouseOver</tt></td><td>Mouse has moved over a new icon or entered/exited a control (replaces MouseEntered and MouseExited verbs)</td></tr>
    <tr><td><tt>MouseMove</tt></td><td>Mouse has moved to a new pixel of the same icon (replaces MouseMove verb)</td></tr>
    <tr><td><tt>MouseDrag</tt></td><td>Mouse has begin dragging or is over a new drop target (replaces MouseDrag verb)</td></tr>
    <tr><td><tt>MouseDragMove</tt></td><td>Mouse is dragging and is over a new pixel of the same drop target (replaces MouseDrag verb in situations where MouseMove would apply)</td></tr>
    <tr><td><tt>MouseDrop</tt></td><td>Mouse drag has been released over a target (replaces MouseDrop verb)</td></tr>
    <tr><td><tt>MouseWheel</tt></td><td>A wheel movement has occurred (replaces MouseWheel verb)</td></tr>
  </tbody>

  <thead>
    <tr><td class="macro_head" colspan=2><b>Mouse targets</b> can only be used as mapping targets for another macro.</td></tr>
  </thead>
  <tbody>
    <tr><td><tt>Mouse</tt></td><td>The mouse cursor, mappable by a gamepad analog stick.</td></tr>
    <tr><td><tt>MouseLeftButton</tt></td><td>Left button, mappable by a gamepad button.</td></tr>
    <tr><td><tt>MouseRightButton</tt></td><td>Right button, mappable by a gamepad button.</td></tr>
    <tr><td><tt>MouseMiddleButton</tt></td><td>Middle button, mappable by a gamepad button.</td></tr>
  </tbody>

</table>

<hr>

<a name=/{skin}/param>
<h2>parameters (skin)</h2>

<p>Controls can be interacted with via <a class=code href=#/proc/winset>winset()</a>
and <a class=code href=#/proc/winset>winget()</a> to change or read various
parameters.

<p>Parameters come in a few different formats:

<ul>
<li>Boolean: <tt>true</tt> or <tt>false</tt></li>
<li>Numeric: any number, sometimes allowing decimal or negative numbers</li>
<li>String: text</li>
<li>Position: <i>x</i><tt>,</tt><i>y</i></li>
<li>Size: <i>width</i><tt>x</tt><i>height</i></li>
<li>Enumerated: one of several text choices, sometimes accepting numbers or true/false values as shortcuts</li>
</ul>

<p>The list of <a href=#/{skin}/control>all controls</a> which shows which
parameters are universal, and each individual control type lists additional
parameters that apply to that type specifically.

<p>Note: In any parameter's "Applies to" section, "all" refers to positionable
controls only, not Macro or Menu controls. Macro and Menu will be listed
separately if supported.

<hr>

<a name=/{skin}/param/align>
<h2>align parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/allow-html>allow-html parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/label>Label</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>center
<dd>left
<dd>right
<dd>top
<dd>bottom
<dd>top-left
<dd>top-right
<dd>bottom-left
<dd>bottom-right
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>center
</dl>

<p>Default alignment of text/image, both horizontal and vertical.

<p>A BYOND direction flag like <tt>WEST</tt> may be assigned to this parameter, or 0 for center alignment.

<hr>

<a name=/{skin}/param/allow-html>
<h2>allow-html parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd byondver=507><a href=#/{skin}/control/label>Label</a>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Info control: Allow HTML tags to be used in <a class=code href=#/proc/stat>stat()</a> info. The same limitations apply as to the <a href=#/{skin}/control/grid>Grid control</a>.

<p>Label control: Currently, the label control will not actually use the HTML; it will simply strip it out. Full support may appear in a later version.

<hr>

<a name=/{skin}/param/alpha>
<h2>alpha parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/transparent-color>transparent-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>255
</dl>

<p>Opacity of the window, from 0 (invisible) to 255 (opaque).

<hr>

<a name=/{skin}/param/anchor toc="anchor1, anchor2">
<h2>anchor1, anchor2 parameters (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
<dd><a href=#/{skin}/param/size>size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a> (except <a href=#/{skin}/control/main>Main</a>)
</dl>

<dl><dt><b>Format:</b>
<dd>none
<dd><i>x</i>,<i>y</i>
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>Anchors the control within the window or pane. If the anchor is not <tt>none</tt>, it is expressed as pecentages of the container's width and height. For example, an anchor of 100,100 means that the X and Y position are tied to the lower right of the container, and 50,0 is tied to the top center.

<p>Setting only <tt>anchor1</tt> will control the position of the control but won't affect its size.

<p>Setting <tt>anchor2</tt> as well will allow you to stretch the control as the container's size changes. You can think of this <tt>anchor1</tt> controlling the top left corner, and <tt>anchor2</tt> the bottom right corner.

<hr>

<a name=/{skin}/param/angle toc="angle1, angle2">
<h2>angle1, angle2 parameters (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/dir>dir parameter</a>
<dd><a href=#/{skin}/param/width>width parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd><tt>angle1</tt>: 0
<dd><tt>angle2</tt>: 180
</dl>

<p>The angle of the bar control's arc when its <a class=code href=#/{skin}/param/dir>dir</a> is <tt>clockwise</tt> or <tt>counterclockwise</tt>. Angles are measured clockwise from due north, so 0 is north, 90 is east, and so on.

<tt>angle1</tt> is the beginning of the arc, and <tt>angle2</tt> is the end.

<hr>

<a name=/{skin}/param/auto-format>
<h2 deprecated=508>auto-format parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/browser>Browser</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false (was once true in old versions)
</dl>

<p class="note deprecated">This parameter only existed to inject compatibility scripts into very old versions of the embedded browser. It is no longer used.

<hr>

<a name=/{skin}/param/background-color>
<h2>background-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/tab-background-color>tab-background-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<p>The control's background color. The exact way this applies depends on the control.

<hr>

<a name=/{skin}/param/bar-color>
<h2>bar-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/background-color>background-color parameter</a>
<dd><a href=#/{skin}/param/is-transparent>is-transparent parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<p>The color of the bar or slider.

<hr>

<a name=/{skin}/param/border>
<h2>border parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>none
<dd>line
<dd>sunken
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>Border type around the control or window. May not work the same in all controls.

<hr>

<a name=/{skin}/param/button-type>
<h2>button-type parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/group>group parameter</a>
<dd><a href=#/{skin}/param/is-checked>is-checked parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>pushbutton: press once
<dd>pushbox: press to toggle
<dd>checkbox: press to toggle, and displays a checkmark if checked
<dd>radio: press to check, and other buttons with the same <tt>group</tt> will be unchecked
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>pushbutton
</dl>

<p>Changes the type of button.

<hr>

<a name=/{skin}/param/can-check>
<h2>can-check parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/group>group parameter</a>
<dd><a href=#/{skin}/param/is-checked>is-checked parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>If true, this menu item is toggled like a checkbox or radio button when clicked.

<hr>

<a name=/{skin}/param/can-close>
<h2>can-close parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/on-close>on-close parameter</a>
<dd><a href=#/{skin}/param/can-resize>can-resize parameter</a>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>Allow the window to be closed, and also shows a system menu for the window.

<hr>

<a name=/{skin}/param/can-minimize>
<h2>can-minimize parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/can-resize>can-resize parameter</a>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>Allow the window to be minimized.

<hr>

<a name=/{skin}/param/can-resize>
<h2>can-resize parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/on-size>on-size parameter</a>
<dd><a href=#/{skin}/param/can-minimize>can-minimize parameter</a>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
<dd><a href=#/{skin}/param/is-fullscreen>is-fullscreen parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>Allow the window to be resized or maximized.

<p>If <tt>is-fullscreen</tt> is true, <tt>can-resize</tt> is ignored, so this value represents the state of the window when <tt>is-fullscreen</tt> is turned off again.

<hr>

<a name=/{skin}/param/can-scroll>
<h2>can-scroll parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/on-size>on-size parameter</a>
<dd><a href=#/{skin}/param/size>size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (pane only)
</dl>

<dl><dt><b>Possible values:</b>
<dd>none
<dd>horizontal
<dd>vertical
<dd>both
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>Allow this pane to retain its horizontal and/or vertical size and show scrollbars if necessary, instead of shrinking to fit the container.

<hr>

<a name=/{skin}/param/command>
<h2>command parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/commands>Client commands</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
<dd><a href=#/{skin}/control/input>Input</a>
<dd><a href=#/{skin}/control/macro>Macro</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when this control is activated.

<p>For the Input control, whatever the user types in follows this command. If your command starts with an exclamation point <tt>!</tt>, everything after the <tt>!</tt> is shown as a default prompt that may be cleared by the user.

<hr>

<a name=/{skin}/param/cell-span>
<h2>cell-span parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/cells>cells parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>columns</i>,<i>rows</i>
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>1x1
</dl>

<p>The span of the current grid cell; it can be merged with cells to the right and down. If <tt>is-list</tt> is true, this setting is ignored. This setting is only available at runtime.

<hr>

<a name=/{skin}/param/cells>
<h2>cells parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/cell-span>cell-span parameter</a>
<dd><a href=#/{skin}/param/current-cell>current-cell parameter</a>
<dd><a href=#/{skin}/param/is-list>is-list parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>columns</i>,<i>rows</i>
<dd><i>items</i>
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>0x0
</dl>

<p>The number of columns and rows in the grid. Using -1 for either columns or rows will leave that value unchanged.

<p>If <a class=code href=#/{skin}/param/is-list>is-list</a> is true, this value can be set to a single number.

<hr>

<a name=/{skin}/param/current-cell>
<h2>current-cell parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/cell-span>cell-span parameter</a>
<dd><a href=#/{skin}/param/cells>cells parameter</a>
<dd><a href=#/{skin}/param/is-list>is-list parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>columns</i>,<i>rows</i>
<dd><i>items</i>
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>0x0
</dl>

<p>The active cell. Any output sent to the grid, that is not sent to a specific cell, will go into this cell.

<p>If <a class=code href=#/{skin}/param/is-list>is-list</a> is true, this value can be set to a single number.

<hr>

<a name=/{skin}/param/current-tab>
<h2>current-tab parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/on-tab>on-tab parameter</a>
<dd><a href=#/{skin}/param/tabs>tabs parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/tab>Tab</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The name of the <a href=#/{skin}/control/main>pane</a> in the active/default tab. If set to a pane that is not currently in this tab control, the pane by that name will be added as another tab.

<hr>

<a name=/{skin}/param/dir>
<h2>dir parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/angle>value parameter</a>
<dd><a href=#/{skin}/param/angle>angle1, angle2 parameters</a>
<dd><a href=#/{skin}/param/width>width parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>north
<dd>south
<dd>east
<dd>west
<dd>clockwise
<dd>counterclockwise
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>east
</dl>

<p>The direction/orientation of the bar. As the <a class=code href=#/{skin}/param/value>value</a> increases the bar will move further in this direction.

<p>Shorthand values like <tt>cw</tt> and <tt>ccw</tt> can be used, or also numerical BYOND directions.

<hr>

<a name=/{skin}/param/dpi>
<h2 byondver=516>dpi parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/proc/winget>winget proc</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>, global
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>1
</dl>

<p>Read-only and unlisted parameter that returns the DPI scaling factor. A value of 1 indicates 100%. This is currently system-wide for the whole application and won't vary by window, but is implemented for windows in case future scaling changes allow them to differ.

<p>This is also a special global parameter. Calling <a class=code href=#/proc/winget>winget()</a> with no <tt>id</tt> and <tt>dpi</tt> as the parameter will return the system DPI scaling.

<p>Note: The DPI scale is currently set at the time Dream Seeker starts, and does not change after that.

<hr>

<a name=/{skin}/param/drop-zone>
<h2>drop-zone parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/mouse>mouse handling</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd><tt>true</tt> for <a href=#/{skin}/control/grid>Grid</a>, <a href=#/{skin}/control/info>Info</a>, <a href=#/{skin}/control/map>Map</a>
<dd><tt>false</tt> for everything else
</dl>

<p>True if dragged objects may be dropped here. Default is true for Map, Info, and Grid controls, false for others. When in use, this will be the value of the <tt>over_control</tt> argument in <a class=code href=#/client/proc/MouseDrop>MouseDrop()</a> if you drop an atom here.

<p>Grids can also add <tt>drag-cell</tt> and <tt>drop-cell</tt> to mouse proc parameters. The mouse procs' <tt>src_location</tt> and <tt>over_location</tt> arguments are in the form <tt>"[column],[row]"</tt> (or <tt>"[item"]</tt> if <a class=code href=#/{skin}/param/is-list>is-list</a> is true) when dragging to/from a grid cell.

<p>In Info controls, <tt>src_location</tt> and <tt>over_location</tt> in mouse procs will be the name of the statpanel tab.

<hr>

<a name=/{skin}/param/enable-http-images>
<h2>enable-http-images parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/small-icons>small-icons parameter</a>
<dd><a href=#/{skin}/param/style>style parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Allows images to be pulled from the Web when using the <tt>&lt;img&gt;</tt> tag; otherwise only locally stored images can be shown.

<hr>

<a name=/{skin}/param/flash>
<h2>flash parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Set to a positive number to make the window flash that many times, -1 to flash forever, and 0 to stop flashing.

<hr>

<a name=/{skin}/param/focus>
<h2>focus parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/proc/winget>winget proc</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>This parameter is true if this control currently has focus.

<p>This is also a special read-only global parameter. Calling <a class=code href=#/proc/winget>winget()</a> with no <tt>id</tt> and <tt>focus</tt> as the parameter will return the <a class=code href=#/{skin}/param/id>id</a> of the currently focused control, if any.

<hr>

<a name=/{skin}/param/font-family>
<h2>font-family parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/font-size>font-size parameter</a>
<dd><a href=#/{skin}/param/font-style>font-style parameter</a>
<dd><a href=#/{skin}/param/tab-font>tab-font-family, tab-font-size, tab-font-style parameters</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>Leave blank to use the default font. This can be used for CSS-style fallback fonts, e.g. "Arial,Helvetica".

<p>You can include fonts in your resource file, making them available to the client, like so:

<xmp>
var/list/extra_resources = list(\
    'myfont.ttf',
    'myfont_bold.ttf')
</xmp>

<hr>

<a name=/{skin}/param/font-size>
<h2>font-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/font-family>font-family parameter</a>
<dd><a href=#/{skin}/param/font-style>font-style parameter</a>
<dd><a href=#/{skin}/param/tab-font>tab-font-family, tab-font-size, tab-font-style parameters</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>0
</dl>

<p>Point size of the font, or leave at 0 for the default size.

<p>The <a href=#/{skin}/control/output>Output control</a> behaves differently for legacy reasons, unless <a href=#/{skin}/param/legacy-size>legacy-size</a> is false.

<hr>

<a name=/{skin}/param/font-style>
<h2>font-style parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/font-family>font-family parameter</a>
<dd><a href=#/{skin}/param/font-size>font-size parameter</a>
<dd><a href=#/{skin}/param/tab-font>tab-font-family, tab-font-size, tab-font-style parameters</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>bold
<dd>italic
<dd>underline
<dd>strike
</dl>

<dl><dt><b>Default value:</b>
<dd><i>empty</i>
</dl>

<p>Sets the font style. Any combination of the above values may be used, or none of them. Multiple values may be separated by spaces or commas.

<hr>

<a name=/{skin}/param/group>
<h2>group parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/button-type>button-type parameter</a>
<dd><a href=#/{skin}/param/can-check>can-check parameter</a>
<dd><a href=#/{skin}/param/is-checked>is-checked parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>Used for "radio" buttons and menu items, where only one of them in the same group may be checked at a time. This value is a text string, or may be left empty.

<p>Buttons in different windows/panes, or menu items in another menu/submenu, are always treated as a different group.

<hr>

<a name=/{skin}/param/has-stats>
<h2 byondver=516>has-stats parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/has-verbs>has-verbs parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>True if this info control contains the statpanels created via <a class=code href=#/proc/stat>stat()</a> and <a class=code href=#/proc/statpanel>statpanel()</a>.

<p>Only one info control can have statpanels.

<hr>

<a name=/{skin}/param/has-verbs>
<h2 byondver=516>has-verbs parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/has-stats>has-stats parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>True if this info control contains the verbs used in the game.

<p>Currently only one info control can have verbs.

<hr>

<a name=/{skin}/param/highlight-color>
<h2>highlight-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/background-color>background-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd byondver=507><a href=#/{skin}/control/grid>Grid</a>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>#00ff00
</dl>

<p>The color used to highlight moused-over statpanel items or verbs. In grids, this color is used when hovering over objects or links.

<hr>

<a name=/{skin}/param/icon>
<h2>icon parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/title>title parameter</a>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl class=codedd><dt><b>Format:</b>
<dd>'<i>file</i>'
</dl>

<dl><dt><b>Default value:</b>
<dd><i>empty</i>
</dl>

<p>Custom icon used for the window. If no icon is specified, the Dream Seeker icon is used by windows by default.

<p>If this control is a pane, its icon will appear on the tab if the pane is inside a tab control. Lack of an icon will mean no icon appears in the tab.

<p>Note: The Windows <tt>.ico</tt> format is not used. Only image formats BYOND can already use are supported.

<hr>

<a name=/{skin}/param/icon-size>
<h2 deprecated=1>icon-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/zoom>zoom parameter</a>
<dd><a href=#/{skin}/param/zoom-mode>zoom-mode parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Size, in pixels, of icons on the map. A size of 0 stretches to fit available space.

<p class="note deprecated">This parameter has been deprecated. Use <a class=code href=#/{skin}/param/zoom>zoom</a> instead.

<hr>

<a name=/{skin}/param/id>
<h2>id parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/parent>parent parameter</a>
<dd><a href=#/{skin}/param/type>type parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The name of this control. Read-only.

<p>If this is a <a href=#/{skin}/control/main>Main control</a>, the name should always be unique. For others, it is usually still a good idea to use a unique name, but they can be referenced by <i>window</i>.<i>id</i> at runtime.

<p byondver=511>You can use a colon in front of the <a class=code href=#/{skin}/param/type>type</a> to refer to the default control of a certain type, if one exists, e.g. <tt>:map</tt> is the default map.

<hr>

<a name=/{skin}/param/image>
<h2>image parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/image-mode>image-mode parameter</a>
<dd><a href=#/{skin}/param/keep-aspect>keep-aspect parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
<dd><a href=#/{skin}/control/label>Label</a>
<dd><a href=#/{skin}/control/main>Main</a>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd>'<i>file</i>'
</dl>

<p>A background image to show in this control.

<p>In the Output control this image is always tiled.

<p>Note: Icons displayed in the output control will not show the background image underneath their transparent parts, but will instead show the background color.</p>

<p>For Label and Main, use <a class=code href=#/{skin}/param/image-mode>image-mode</a> to control how the image is displayed.

<hr>

<a name=/{skin}/param/image-mode>
<h2>image-mode parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/image>image parameter</a>
<dd><a href=#/{skin}/param/keep-aspect>keep-aspect parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/label>Label</a>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>center
<dd>stretch
<dd>tile
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>center
</dl>

<p>Determines how the background image is displayed.

<hr>

<a name=/{skin}/param/index>
<h2>index parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>1000
</dl>

<p>Moves the menu item to the <i>N</i>th position among its siblings. 0 or less is no change. Write-only.

<hr>

<a name=/{skin}/param/inner-mouse-pos>
<h2 byondver=516>inner-mouse-pos / mouse-pos parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/outer-mouse-pos>outer-mouse-pos parameter</a>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>x</i>,<i>y</i>
</dl>

<p>Read-only.

<p>Reads the position of the mouse cursor relative to the upper left corner of this control, not including the control's borders.

<p><tt>mouse-pos</tt> is an alias for <tt>inner-mouse-pos</tt>.

<p>This parameter is "unlisted" and must be explicitly queried. It won't appear when sending <tt>*</tt> as the parameter in <a class=code href=#/proc/winget>winget()</a>.

<hr>

<a name=/{skin}/param/inner-pos>
<h2 byondver=515>inner-pos parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
<dd><a href=#/{skin}/param/outer-pos>outer-pos parameter</a>
<dd><a href=#/{skin}/param/inner-size>inner-size parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>x</i>,<i>y</i>
</dl>

<p>Read-only.

<p>Reads the position where the window's interior contents begin (i.e., not counting titlebar, statusbar, borders, etc.), relative to its <tt>outer-pos</tt>.

<hr>

<a name=/{skin}/param/inner-size>
<h2 byondver=513>inner-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/size>size parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
<dd><a href=#/{skin}/param/inner-pos>inner-pos parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>width</i>x<i>height</i>
</dl>

<p>Read-only.

<p>If the control is a window, this refers to its current interior size: i.e., not counting titlebar, statusbar, borders, etc. If it's maximized, this will be the true size of the window interior, as opposed to <tt>size</tt> which is the interior size once this window is no longer maximized.

<p>If this control is a pane and <a class=code href=#/{skin}/param/can-scroll>can-scroll</a> is true, this is the size of the display area not including the scrollbars.

<hr>

<a name=/{skin}/param/is-checked>
<h2>is-checked parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/button-type>button-type parameter</a>
<dd><a href=#/{skin}/param/can-check>can-check parameter</a>
<dd><a href=#/{skin}/param/group>group parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>True if the button or menu item is checked. Menu items can set this even if <a class=code href=#/{skin}/param/can-check>can-check</a> is false.

<hr>

<a name=/{skin}/param/is-default>
<h2>is-default parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/{skin}/param/parent>parent parameter</a>
<dd><a href=#/{skin}/param/type>type parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Specifies that this is a default control. This should be true for your main window, and for your primary map, info, output, input, and browser controls.

<p>The default control of a given type can be referenced in <a class=code href=#/proc/winset>winset()</a> and other skin-related procs by the name <tt>":<i>type</i>"</tt>, e.g. <tt>":map"</tt>.

<p>Changing this value at runtime should be avoided, especially for windows. Results may be unpredictable.

<hr>

<a name=/{skin}/param/is-disabled>
<h2>is-disabled parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/is-checked>is-checked parameter</a>
<dd><a href=#/{skin}/param/is-visible>is-visible parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
<dd><a href=#/{skin}/control/macro>Macro</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Disables the control, menu item, or macro.

<hr>

<a name=/{skin}/param/is-flat>
<h2>is-flat parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/button-type>button-type parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
</dl>

<dl><dt><b>Format:</b>
<dd class=codedd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd>false
</dl>

<p>Gives this button a flat appearance instead of pseudo-3D highlights.

<hr>

<a name=/{skin}/param/is-fullscreen>
<h2 byondver=515>is-fullscreen parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/can-resize>can-resize parameter</a>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
<dd><a href=#/{skin}/param/is-maximized>is-maximized parameter</a>
<dd><a href=#/{skin}/param/is-minimized>is-minimized parameter</a>
<dd><a href=#/{skin}/param/size>size parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
<dd><a href=#/{skin}/param/screen-pos>screen-pos parameter</a>
<dd><a href=#/{skin}/param/screen-size>screen-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>True if the window should be in fullscreen mode. This suppresses
<tt>can-resize</tt>, <tt>titlebar</tt>, <tt>is-maximized</tt>, and
<tt>is-minimized</tt>. They will continue to return the values that would apply
if fullscreen mode were turned off.

<hr>

<a name=/{skin}/param/is-list>
<h2>is-list parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/cells>cells parameter</a>
<dd><a href=#/{skin}/param/current-cell>current-cell parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>True if the grid is used for a flexible list of items; the number of columns and rows may change to fit them.

<hr>

<a name=/{skin}/param/is-maximized>
<h2>is-maximized parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/can-resize>can-resize parameter</a>
<dd><a href=#/{skin}/param/is-minimized>is-minimized parameter</a>
<dd><a href=#/{skin}/param/is-fullscreen>is-fullscreen parameter</a>
<dd><a href=#/{skin}/param/size>size parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>True if the window is maximized.

<p>If <tt>is-fullscreen</tt> is true, this value represents the state of the window when <tt>is-fullscreen</tt> is turned off again.

<hr>

<a name=/{skin}/param/is-minimized>
<h2>is-minimized parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/can-resize>can-resize parameter</a>
<dd><a href=#/{skin}/param/is-maximized>is-maximized parameter</a>
<dd><a href=#/{skin}/param/is-fullscreen>is-fullscreen parameter</a>
<dd><a href=#/{skin}/param/size>size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>True if the window is minimized.

<p>If <tt>is-fullscreen</tt> is true, this value represents the state of the window when <tt>is-fullscreen</tt> is turned off again.

<hr>

<a name=/{skin}/param/is-pane>
<h2>is-pane parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/{skin}/control/child>Child control</a>
<dd><a href=#/{skin}/control/tab>Tab control</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>True if this is a pane that will be used in other container controls, instead of an independent window. Read-only.

<hr>

<a name=/{skin}/param/is-password>
<h2>is-password parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/command>command parameter</a>
<dd><a href=#/{skin}/param/multi-line>multi-line parameter</a>
<dd><a href=#/{skin}/param/no-command>no-command parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/input>Input</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>Hide text with asterisks. Copy to clipboard is not available in this mode, but the <a class=code href=#/{skin}/param/text>text</a> parameter can still read the control's contents.

<p class=security>Note: For obvious reasons, you should never use the same password in a game that you would use anywhere else.

<hr>

<a name=/{skin}/param/is-slider>
<h2>is-slider parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/value>value parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd class=codedd>false
</dl>

<p>Make this an adjustable slider capable of being changed by the user, instead of a progress bar.

<hr>

<a name=/{skin}/param/is-transparent>
<h2>is-transparent parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Make this control transparent.

<p>Transparency support is extremely limited. Only some controls can actually use it, and only when on top of certain other controls.

<p>Bars and labels handle transparency reasonably well, when not on top of other controls (or only on top of other conrols of these types).

<hr>

<a name=/{skin}/param/is-vert>
<h2>is-vert parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/left>left parameter</a>
<dd><a href=#/{skin}/param/right>right parameter</a>
<dd><a href=#/{skin}/param/show-splitter>show-splitter parameter</a>
<dd><a href=#/{skin}/param/splitter>splitter parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/child>Child</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>The splitter between the two panes in this control is vertical.

<hr>

<a name=/{skin}/param/is-visible>
<h2>is-visible parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/is-disabled>is-disabled parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>True if this control can be seen. The main window should usually be made visible.

<hr>

<a name=/{skin}/param/keep-aspect>
<h2>keep-aspect parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/image>image parameter</a>
<dd><a href=#/{skin}/param/image-mode>image-mode parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd byondver=507><a href=#/{skin}/control/label>Label</a>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>If stretching a background image, preserve its aspect ratio.

<hr>

<a name=/{skin}/param/left>
<h2>left, top parameters (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/right>right parameter</a>
<dd><a href=#/{skin}/param/is-vert>is-vert parameter</a>
<dd><a href=#/{skin}/param/show-splitter>show-splitter parameter</a>
<dd><a href=#/{skin}/param/splitter>splitter parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/child>Child</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>The <a class=code href=#/{skin}/param/id>id</a> of the left/top pane in this control. The parameter names <tt>left</tt> and <tt>top</tt> can be used interchangeably.

<hr>

<a name=/{skin}/param/legacy-size>
<h2 byondver=512>legacy-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/font-size>font-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>When true, font sizes are scaled slightly larger for readability, which is legacy (and default) BYOND behavior. Set to false for exact font sizing.

<hr>

<a name=/{skin}/param/letterbox>
<h2 byondver=500>letterbox parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/view-size>view-size parameter</a>
<dd><a href=#/{skin}/param/zoom>zoom parameter</a>
<dd><a href=#/{skin}/param/zoom-mode>zoom-mode parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>If map auto-scales its icons (<a class=code href=#/{skin}/param/zoom>zoom</a> is 0), make sure the entire map fits, and fill excess space with the background color.

<p>If <tt>letterbox</tt> is not enabled, auto-zoom will fill all available space, and any excess will be cut off.

<hr>

<a name=/{skin}/param/line-color>
<h2>line-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/background-color>background-color parameter</a>
<dd><a href=#/{skin}/param/show-lines>show-lines parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>#c0c0c0
</dl>

<p>The color of grid lines.

<hr>

<a name=/{skin}/param/link-color>
<h2>link-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/visited-color>visited-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>#0000ff
</dl>

<p>The color used for links. In some controls <a href=#/{skin}/param/visited-color>visited links</a> may have a different color.

<hr>

<a name=/{skin}/param/lock>
<h2>lock parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/left>left parameter</a>
<dd><a href=#/{skin}/param/right>right parameter</a>
<dd><a href=#/{skin}/param/is-vert>is-vert parameter</a>
<dd><a href=#/{skin}/param/show-splitter>show-splitter parameter</a>
<dd><a href=#/{skin}/param/splitter>splitter parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/child>Child</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>left
<dd>right
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>Allows one pane to "lock" the splitter so if this Child control is resized, the splitter will stay put on that side.

<hr>

<a name=/{skin}/param/macro>
<h2>macro parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/menu>Keyboard/gamepad macros</a>
<dd><a href=#/{skin}/param/menu>menu parameter</a>
<dd><a href=#/{skin}/param/id>id parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The <a class=code href=#/{skin}/param/id>id</a> of the macro set this window will use, if any, when it's active.

<hr>

<a name=/{skin}/param/map-to>
<h2 byondver=511>map-to parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/macros>macros (skin)</a>
<dd><a href=#/{skin}/param/command>command parameter</a>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/{skin}/param/name>name parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/macro>Macro</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The <a href=#/{skin}/macros>macro name</a> (e.g., "SOUTH") of a key combo, Dpad, mouse button, etc. that this macro maps to.

<hr>

<a name=/{skin}/param/max-lines>
<h2>max-lines parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>1000
</dl>

<p>Maximum number of lines before the control drops old text to make room for more. 0 is no limit.

<p>An overflow of 5% is allowed, to reduce flicker.

<hr>

<a name=/{skin}/param/menu>
<h2>menu parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/macro>macro parameter</a>
<dd><a href=#/{skin}/param/id>id parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The <a class=code href=#/{skin}/param/id>id</a> of the menu this window will use, if any, when it's active.

<hr>

<a name=/{skin}/param/multi-line>
<h2>multi-line parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
<dd><a href=#/{skin}/control/input>Input</a>
<dd><a href=#/{skin}/control/tab>Tab</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl><dt><b>Default value:</b>
<dd><tt>false</tt>: Input control
<dd><tt>true</tt>: Info and Tab controls
</dl>

<p>Input control: Create a multi-line input control. Read-only for this control.

<p>Info and Tab controls: Show tabs in multiple rows if there are too many to fit in a single row.

<hr>

<a name=/{skin}/param/name>
<h2>name parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/macros>macros (skin)</a>
<dd><a href=#/{skin}/param/id>id parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/macro>Macro</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>Macro control: The key/gamepad combination such as <tt>R+REP</tt>, <tt>CTRL+Northwest</tt>, <tt>GamepadLeft</tt>.

<p>Menu control: This is the menu item label. A tab character can be used between the name and a keyboard shortcut, like "Help\tF1". (Keyboard shortcuts must be implemented as macros in order to work. This is just a label.) A blank name shows just a separator.

<hr>

<a name=/{skin}/param/no-command>
<h2>no-command parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/command>command parameter</a>
<dd><a href=#/{skin}/param/is-password>is-password parameter</a>
<dd><a href=#/{skin}/param/multi-line>multi-line parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/input>Input</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>True if this input control is for typing only; hitting Enter will not run a command.

<hr>

<a name=/{skin}/param/on-blur>
<h2>on-blur parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/focus>focus parameter</a>
<dd><a href=#/{skin}/param/on-focus>on-focus parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/input>Input</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when the control loses focus.

<hr>

<a name=/{skin}/param/on-close>
<h2>on-close parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/can-close>can-close parameter</a>
<dd><a href=#/{skin}/param/on-size>on-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when the window is closed.

<hr>

<a name=/{skin}/param/on-change>
<h2>on-change parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/value>value parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when the <a class=code href=#/{skin}/param/value>value</a> of the bar/slider is changed. If you drag the slider around, the command will not run until you let go.

<p>If you include <tt>[[*]]</tt> in the command, it will be replaced by the control's new <tt>value</tt>.  (See <a href=#/{skin}/commands/embed>embedded winget</a> for more details on the <tt>[[...]]</tt> format.)

<hr>

<a name=/{skin}/param/on-focus>
<h2>on-focus parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/focus>focus parameter</a>
<dd><a href=#/{skin}/param/on-blur>on-blur parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/input>Input</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when the control gains focus.

<hr>

<a name=/{skin}/param/on-hide>
<h2>on-hide parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/on-show>on-show parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/browser>Browser</a>
<dd><a href=#/{skin}/control/info>Info</a>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a>executed when this control is hidden by the game. Must be the default control for the game to show/hide it.

<p>Currently not editable in Dream Maker.

<hr>

<a name=/{skin}/param/on-show>
<h2>on-show parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/on-hide>on-hide parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/browser>Browser</a>
<dd><a href=#/{skin}/control/info>Info</a>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when this control is shown by the game. Must be the default control for the game to show/hide it.

<p>Currently not editable in Dream Maker.

<hr>

<a name=/{skin}/param/on-size>
<h2 byondver=482>on-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/size>size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when this control is resized. If you are dragging a window edge or splitter, the command won't run until you finish.

<p>No command will be sent in response to size or splitter changes made by <a class=code href=#/proc/winset>winset()</a>.

<p>If you include <tt>[[*]]</tt> in the command, it will be replaced by the control's new size. Likewise, <tt>[[width]]</tt> will be replaced with the width and <tt>[[height]]</tt> with the height. (See <a href=#/{skin}/commands/embed>embedded winget</a> for more details on the <tt>[[...]]</tt> format.)

<hr>

<a name=/{skin}/param/on-status>
<h2>on-status parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/statusbar>statusbar parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when the text that would go in the statusbar is changed. This applies even if this control is a pane and not a window, or is a window without a statusbar. It applies to all panes and windows that directly or indirectly contain whatever control generated the statusbar text (e.g., a map).

<p>If you include <tt>[[*]]</tt> in the command, it will be replaced by the new text. (See <a href=#/{skin}/commands/embed>embedded winget</a> for more details on the <tt>[[...]]</tt> format.)

<p><tt>[[from]]</tt> can be used to reference the control (if any) that generated the next text. You can also use expressions like <tt>[[from.type]]</tt>, <tt>[[from.parent.pos.x]]</tt>, etc.

<hr>

<a name=/{skin}/param/on-tab>
<h2>on-tab parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/current-tab>current-tab parameter</a>
<dd><a href=#/{skin}/param/tabs>tabs parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
<dd><a href=#/{skin}/control/tab>Tab</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p><a href=#/{skin}/commands>Command</a> executed when the current tab is changed.

<p>If you include <tt>[[*]]</tt> in the command, it will be replaced by the new tab's <a class=code href=#/{skin}/param/id>id</a>. (See <a href=#/{skin}/commands/embed>embedded winget</a> for more details on the <tt>[[...]]</tt> format.)

<hr>

<a name=/{skin}/param/outer-mouse-pos>
<h2 byondver=516>outer-mouse-pos parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/inner-mouse-pos>outer-mouse-pos parameter</a>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>x</i>,<i>y</i>
</dl>

<p>Read-only.

<p>Reads the position of the mouse cursor relative to the upper left corner of this control, including the control's borders.

<p>This parameter is "unlisted" and must be explicitly queried. It won't appear when sending <tt>*</tt> as the parameter in <a class=code href=#/proc/winget>winget()</a>.

<hr>

<a name=/{skin}/param/outer-pos>
<h2 byondver=515>outer-pos parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
<dd><a href=#/{skin}/param/inner-pos>inner-pos parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>x</i>,<i>y</i>
</dl>

<p>Read-only.

<p>Reads the control's current exterior position <i>including</i> titlebar, statusbar, borders, etc. If the window is not minimized or maximized, this is identical to <tt>pos</tt>.

<hr>

<a name=/{skin}/param/outer-size>
<h2 byondver=513>outer-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/size>size parameter</a>
<dd><a href=#/{skin}/param/inner-size>inner-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>width</i>x<i>height</i>
</dl>

<p>Read-only.

<p>If the control is a window, this refers to its current exterior size <i>including</i> titlebar, statusbar, borders, etc. If the window is maximized, this is the maximized size.

<p>If this control is a pane and <a class=code href=#/{skin}/param/can-scroll>can-scroll</a> is true, this is the size of the display area including the scrollbars.

<hr>

<a name=/{skin}/param/parent>
<h2>parent parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/{skin}/param/type>type parameter</a>
<dd><a href=#/{skin}/param/name>name parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
<dd><a href=#/{skin}/control/macro>Macro</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The <a class=code href=#/{skin}/param/id>id</a> of this control's parent. Write-only, used when creating a new control at runtime or deleting a control that was created this way.

<hr>

<a name=/{skin}/param/pos>
<h2>pos parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/anchor>anchor1, anchor2 parameters</a>
<dd><a href=#/{skin}/param/size>size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>x</i>,<i>y</i>
<dd>none
</dl>

<dl><dt><b>Default value:</b>
<dd><i>x</i>,<i>y</i>
<dd>none
</dl>

<p>Position of this control's upper left corner, relative to its container. (Not applicable to panes.)

<hr>

<a name=/{skin}/param/prefix-color>
<h2>prefix-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/suffix-color>suffix-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>The color used for the prefix/header column of statpanel displays. No color means the default <a class=code href=#/{skin}/param/text-color>text-color</a> will be used.

<p>In BYOND 3.0, this color was red.

<hr>

<a name=/{skin}/param/right>
<h2>right, bottom parameters (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/left>left parameter</a>
<dd><a href=#/{skin}/param/is-vert>is-vert parameter</a>
<dd><a href=#/{skin}/param/show-splitter>show-splitter parameter</a>
<dd><a href=#/{skin}/param/splitter>splitter parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/child>Child</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>The <a class=code href=#/{skin}/param/id>id</a> of the right/bottom pane in this control. The parameter names <tt>top</tt> and <tt>bottom</tt> can be used interchangeably.

<hr>

<a name=/{skin}/param/right-click>
<h2>right-click parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/DM/mose>mouse handling</a>
<dd><a href=#/set/popup_menu>popup_menu setting (verb)</a>
<dd><a href=#/{skin}/param/drop-zone>drop-zone parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>True if this control should allow right-clicks to behave like any other click instead of opening up popup menus or similar special behavior.

<hr>

<a name=/{skin}/param/saved-params>
<h2>saved-params parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<dl><dt><b>Default value:</b>
<dd><i>varies</i>
</dl>

<p>A semicolon-separated list of parameters that get saved with this control. This is often used for things a user might set, like zoom level for a map.

<p>Currently not editable in Dream Maker.

<hr>

<a name=/{skin}/param/screen-pos>
<h2 byondver=515>screen-pos parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
<dd><a href=#/{skin}/param/outer-pos>outer-pos parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>x</i>,<i>y</i>
</dl>

<p>Read-only.

<p>For windows, this is the upper left corner of the nearest monitor's area.

<hr>

<a name=/{skin}/param/screen-size>
<h2 byondver=515>screen-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/size>size parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>width</i>x<i>height</i>
</dl>

<p>Read-only.

<p>For windows, this is the size of the nearest monitor's area.

<hr>

<a name=/{skin}/param/size>
<h2>size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/pos>pos parameter</a>
<dd><a href=#/{skin}/param/anchor>anchor1, anchor2 parameters</a>
<dd><a href=#/{skin}/param/on-size>on-size parameter</a>
<dd><a href=#/{skin}/param/inner-size>inner-size parameter</a>
<dd><a href=#/{skin}/param/outer-size>outer-size parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd><i>width</i>x<i>height</i>
</dl>

<p>The size of this control.

<p>Setting 0 for width or height uses up any available space right/downward.

<p>If the control is a window, this refers to its <i>interior size when not maximized or minimized</i>. That is, it does not count borders, titlebar, menu, or statusbar, and if the window is minimized/maximized, this refers to the window's normal size when it is restored. See the <a class=code href=#/{skin}/param/inner-size>inner-size</a> and <a class=code href=#/{skin}/param/outer-size>outer-size</a> params for comparison.

<p>If this control is a pane and <a class=code href=#/{skin}/param/can-scroll>can-scroll</a> is true, <tt>size</tt> refers to the total scrollable size of the pane, NOT the smaller size displayed. In this case, <tt>outer-size</tt> and <tt>inner-size</tt> refer to the display area with and without scrollbars, respectively.

<hr>

<a name=/{skin}/param/show-history>
<h2>show-history parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/show-url>show-url parameter</a>
<dd><a href=#/{skin}/param/use-title>use-title parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/browser>Browser</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Show forward/back navigation buttons.

<hr>

<a name=/{skin}/param/show-lines>
<h2>show-lines parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/line-color>line-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Possible values:</b>
<dd>none
<dd>horizontal
<dd>vertical
<dd>both
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>both
</dl>

<p>Determines which grid lines to display.

<hr>

<a name=/{skin}/param/show-names>
<h2>show-names parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/atom/var/name>name var (atom)</a>
<dd><a href=#/{skin}/param/small-icons>small-icons parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>When atoms are output to the grid, show the atom's name next to its icon.

<p>If the atom has no icon and <tt>show-names</tt> is false, the grid cell will be blank.

<hr>

<a name=/{skin}/param/show-splitter>
<h2>show-splitter parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/left>left parameter</a>
<dd><a href=#/{skin}/param/right>right parameter</a>
<dd><a href=#/{skin}/param/is-vert>is-vert parameter</a>
<dd><a href=#/{skin}/param/splitter>splitter parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/child>Child</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>Show a splitter if both the left and right (or top and bottom) panes are in use. The splitter can be dragged to resize the panes.

<hr>

<a name=/{skin}/param/show-url>
<h2>show-url parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/show-history>show-history parameter</a>
<dd><a href=#/{skin}/param/use-title>use-title parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/browser>Browser</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Shows an address bar for this browser control.

<hr>

<a name=/{skin}/param/small-icons>
<h2>small-icons parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/show-names>show-names parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>When output(object,grid) is sent, show smaller icons in this control instead of larger ones.

<hr>

<a name=/{skin}/param/splitter>
<h2>splitter parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/left>left parameter</a>
<dd><a href=#/{skin}/param/right>right parameter</a>
<dd><a href=#/{skin}/param/is-vert>is-vert parameter</a>
<dd><a href=#/{skin}/param/show-splitter>show-splitter parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/child>Child</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number (0 to 100)
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>50
</dl>

<p>Position of the splitter when two panes are in use, whether <a class=code href=#/{skin}/param/show-splitter>show-splitter</a> is true or not. This value is a percentage. Specifically, it is the percentage of the available width/height that is given to the left/top pane. 

<hr>

<a name=/{skin}/param/suffix-color>
<h2>suffix-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/prefix-color>prefix-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>The color used for the suffix column of statpanel displays. No color means the default <a class=code href=#/{skin}/param/text-color>text-color</a> will be used.

<p>In BYOND 3.0, this color was blue.

<hr>

<a name=/{skin}/param/statusbar>
<h2>statusbar parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
<dd><a href=#/{skin}/param/on-status>on-status parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>Shows a status bar at the bottom of the window. This will show the name of an atom when you hover over it with the mouse.

<hr>

<a name=/{skin}/param/stretch>
<h2 deprecated=1>stretch parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/image>image parameter</a>
<dd><a href=#/{skin}/param/image-mode>image-mode parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/label>Label</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Stretch the background image.

<p class="note deprecated">Deprecated; use <a class=code href=#/{skin}/param/image-mode>image-mode</a> instead.

<hr>

<a name=/{skin}/param/style>
<h2>style parameter (skin)</h2>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
<dd byondver=494><a href=#/{skin}/control/map>Map</a>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>Custom stylesheet used for the control. Changes made at runtime will usually not impact any existing text.

<p>For Map controls, this affects any <a href=#/atom/var/maptext>maptext</a> drawn, and changes to the style should appear on the next refresh.

<hr>

<a name=/{skin}/param/tab-background-color>
<h2>tab-background-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/background-color>background-color parameter</a>
<dd><a href=#/{skin}/param/tab-text-color>tab-text-color parameter</a>
<dd><a href=#/{skin}/param/tab-font>tab-font-family, tab-font-size, tab-font-style parameters</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>Affects the background color for tabs. The regular <a class=code href=#/{skin}/param/background-color>background-color</a> is used for the content area.

<hr>

<a name=/{skin}/param/tab-font toc="tab-font-family, tab-font-size, tab-font-style">
<h2>tab-font-family, tab-font-size, tab-font-style parameters (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/font-family>font-family parameter</a>
<dd><a href=#/{skin}/param/font-size>font-size parameter</a>
<dd><a href=#/{skin}/param/font-style>font-style parameter</a>
<dd><a href=#/{skin}/param/tab-text-color>tab-text-color parameter</a>
<dd><a href=#/{skin}/param/tab-background-color>tab-background-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<p>Affects the font for tabs. The regular versions of these without the <tt>tab-</tt> prefix are used for the content area.

<hr>

<a name=/{skin}/param/tab-text-color>
<h2>tab-text-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/tab-background-color>tab-background-color parameter</a>
<dd><a href=#/{skin}/param/tab-font>tab-font-family, tab-font-size, tab-font-style parameters</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/info>Info</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>Affects the text color for tabs. The regular <a class=code href=#/{skin}/param/text-color>text-color</a> is used for the content area.

<hr>

<a name=/{skin}/param/tabs>
<h2>tabs parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/current-tab>current-tab parameter</a>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/{skin}/param/multi-line>multi-line parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/tab>Tab</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>A comma-separated list of <a class=code href=#/{skin}/param/id>id</a> values for the panes included as tabs in this control.

<p>When setting this value, you can put <tt>+</tt> in front of the list to add tabs to the existing control, without affecting current tabs. You can likewise use <tt>-</tt> in front of the list to remove tabs.

<p>Note: When using this with <a class=code href=#/proc/winset>winset()</a>, remember you will need to escape <tt>+</tt> as <tt>%2B</tt> via <a class=code href=#/proc/url_encode>url_encode()</a> or <a class=code href=#/proc/list2params>list2params()</a>.

<hr>

<a name=/{skin}/param/text>
<h2>text parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/font-family>font-family parameter</a>
<dd><a href=#/{skin}/param/font-size>font-size parameter</a>
<dd><a href=#/{skin}/param/font-style>font-style parameter</a>
<dd><a href=#/{skin}/param/text-wrap>text-wrap parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/button>Button</a>
<dd><a href=#/{skin}/control/input>Input</a>
<dd><a href=#/{skin}/control/label>Label</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>Text shown in this control. For Input controls this setting is only available at runtime.

<hr>

<a name=/{skin}/param/text-color>
<h2>text-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/background-color>background-color parameter</a>
<dd><a href=#/{skin}/param/font-family>font-family parameter</a>
<dd><a href=#/{skin}/param/font-size>font-size parameter</a>
<dd><a href=#/{skin}/param/font-style>font-style parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<p>The control's foreground text color.

<hr>

<a name=/{skin}/param/text-mode>
<h2>text-mode parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/zoom>zoom parameter</a>
<dd><a href=#/{skin}/param/zoom-mode>zoom-mode parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Show text mode even if icons are available. Text mode will be used if no icons are present, regardless of this setting.

<hr>

<a name=/{skin}/param/text-wrap>
<h2>text-wrap parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text>text parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/label>Label</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Wrap text that is too long for the width of the label.

<hr>

<a name=/{skin}/param/title>
<h2>title parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/world/var/name>name var (world)</a>
<dd><a href=#/{skin}/param/icon>icon parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The title of this window or pane. For a window, the title will appear in the titlebar if present. For a pane, this will be displayed on the tab if this pane is in a <a href=#/{skin}/control/tab>Tab control</a>.

<p>If this is the default window, <a class=code href=#/world/var/name>world.name</a> takes precedence over the window title.

<hr>

<a name=/{skin}/param/titlebar>
<h2>titlebar parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/can-close>can-close parameter</a>
<dd><a href=#/{skin}/param/can-minimize>can-minimize parameter</a>
<dd><a href=#/{skin}/param/can-resize>can-resize parameter</a>
<dd><a href=#/{skin}/param/icon>icon parameter</a>
<dd><a href=#/{skin}/param/title>title parameter</a>
<dd><a href=#/{skin}/param/use-title>use-title parameter</a>
<dd><a href=#/{skin}/param/statusbar>statusbar parameter</a>
<dd><a href=#/{skin}/param/is-fullscreen>is-fullscreen parameter</a>
<dd><a href=#/world/var/name>name var (world)</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>true
</dl>

<p>Show a titlebar for this window. This is also required for the close, minimize, and maximize buttons to appear.

<p>If <tt>is-fullscreen</tt> is true, <tt>titlebar</tt> is ignored, so this value represents the state of the window when <tt>is-fullscreen</tt> is turned off again.

<hr>

<a name=/{skin}/param/transparent-color>
<h2 deprecated=1>transparent-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/alpha>alpha parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/main>Main</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>none
</dl>

<p>A color that will be turned into transparency wherever it appears in this window. Overall, this method of transparency comes with many limitations, so it is considered deprecated.

<hr>

<a name=/{skin}/param/type>
<h2>type parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/id>id parameter</a>
<dd><a href=#/{skin}/param/parent>parent parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control>All</a>
<dd><a href=#/{skin}/control/macro>Macro</a>
<dd><a href=#/{skin}/control/menu>Menu</a>
</dl>

<dl><dt><b>Format:</b>
<dd>string
</dl>

<p>The type of this control. Read-only.

<hr>

<a name=/{skin}/param/use-title>
<h2>use-title parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/show-history>show-history parameter</a>
<dd><a href=#/{skin}/param/show-url>show-url parameter</a>
<dd><a href=#/{skin}/param/title>title parameter</a>
<dd><a href=#/{skin}/param/titlebar>titlebar parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/browser>Browser</a>
</dl>

<dl><dt><b>Format:</b>
<dd>true/false
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>false
</dl>

<p>Use the browser's document title to override the title of the window or pane it appears in.

<hr>

<a name=/{skin}/param/value>
<h2>value parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/is-slider>is-slider parameter</a>
<dd><a href=#/{skin}/param/dir>dir parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>The "fullness" of this bar/slider, as a percentage.

<hr>

<a name=/{skin}/param/view-size>
<h2>view-size parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/letterbox>letterbox parameter</a>
<dd><a href=#/{skin}/param/zoom>zoom parameter</a>
<dd><a href=#/{skin}/param/zoom-mode>zoom-mode parameter</a>
<dd><a href=#/world/var/icon_size>icon_size var (world)</a>
<dd><a href=#/world/var/view>view var (world)</a>
<dd><a href=#/client/var/view>view var (client)</a>
<dd><a href=#/{notes}/HUD>HUD / screen objects</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/map>Map</a> (window only)
</dl>

<dl><dt><b>Format:</b>
<dd><i>width</i>x<i>height</i>
</dl>

<p>The size, in pixels, of the map after <tt>zoom</tt> has been applied.

<p>For instance, if the client view has 10&times;10 tiles (this includes any extended tiles caused by HUD objects) and <tt>world.icon_size</tt> is 32x32, the map has a native size of 320&times;320 pixels. If the map has a zoom level of 2, then <tt>view-size</tt> will be 640x640.

<p>With a <tt>zoom</tt> value of 0, which is the default for most projects, the actual zoom level is automatically determined by the size of the map control, the map's native pixel size as explained above, and the value of the <a class=code href=#/{skin}/param/letterbox>letterbox</a> parameter.

<hr>

<a name=/{skin}/param/visited-color>
<h2>visited-color parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/text-color>text-color parameter</a>
<dd><a href=#/{skin}/param/link-color>link-color parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/grid>Grid</a>
<dd><a href=#/{skin}/control/output>Output</a>
</dl>

<dl><dt><b>Format:</b>
<dd><a href=#/{{appendix}}/html-colors>#rrggbb</a>
<dd>none
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>#0000ff
</dl>

<p>The color used for visited links.

<hr>

<a name=/{skin}/param/width>
<h2>width parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/dir>dir parameter</a>
<dd><a href=#/{skin}/param/is-slider>is-slider parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/bar>Bar</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>10
</dl>

<p>Width, in pixels, of the bar or slider. A value of 0 uses all available width.

<hr>

<a name=/{skin}/param/zoom>
<h2>zoom parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/letterbox>letterbox parameter</a>
<dd><a href=#/{skin}/param/view-size>view-size parameter</a>
<dd><a href=#/{skin}/param/zoom-mode>zoom-mode parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Format:</b>
<dd>number
</dl>

<dl><dt><b>Default value:</b>
<dd>0
</dl>

<p>Zoom factor for icons on the map. 1 means to show the icons at their original size, 2 is 200%, 0.5 is 50%, and so on. A value of 0 stretches to fit available space.

<hr>

<a name=/{skin}/param/zoom-mode>
<h2 byondver=511>zoom-mode parameter (skin)</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/{skin}/param/letterbox>letterbox parameter</a>
<dd><a href=#/{skin}/param/view-size>view-size parameter</a>
<dd><a href=#/{skin}/param/zoom>zoom parameter</a>
</dl>

<dl><dt><b>Applies to:</b>
<dd><a href=#/{skin}/control/map>Map</a>
</dl>

<dl><dt><b>Posisble values:</b>
<dd>normal
<dd>distort
<dd>blur
</dl>

<dl class=codedd><dt><b>Default value:</b>
<dd>normal
</dl>

<p>Controls the way the map is upscaled.

<dl class=codedt>
<dt>normal</dl><dd>Preserves a pixelated look, but does some blending between adjacent pixels when the zoom factor is not an integer. This is equivalent to upscaling by the next highest integer, then downscaling.</dd>
<dt>distort</dl><dd>Uses nearest-neighbor sampling to upscale. This may look odd if the zoom factor is not an integer, since for instance some pixels might scale up to be 2 pixels wide, others 3 pixels wide. Some users prefer it anyway.</dd>
<dt>blur</dl><dd>Uses bilinear sampling to upscale. This will cause a blurry appearance if the zoom factor is high, but it may be desired in some cases.</dd>
</dl>

<hr>

<a name=/{{appendix}} toc="Appendix">
<h2>Appendix</h2>

<p>This section contains miscellaneous information that may apply to multiple
vars or procs.

<dl>
<dd><a href=#/{{appendix}}/Byondapi group="lang,flow">Byondapi</a>
<dd><a href=#/{{appendix}}/css group="text,map,output">CSS attributes</a>
<dd><a href=#/{{appendix}}/html-colors group="text,map,output">HTML colors</a>
<dd><a href=#/{{appendix}}/color-space group="effects">Color space</a>
<dd><a href=#/{{appendix}}/stddef%2edm>stddef.dm file</a>
</dl>

<hr>

<a name=/{{appendix}}/Byondapi>
<h2 byondver=515>Byondapi</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/call_ext>call_ext() proc</a>
</dl>

<p>Byondapi is a set of exported functions from BYOND's core library that can
be used by external libraries that you call via the
<a href=#/proc/call_ext><tt>call_ext()</tt> proc</a>. The purpose is to make
interfacing with native code easier, and to allow external access to BYOND's
functionality. Before this existed, all external calls had to use text strings
to pass data back and forth, which was inefficient for many uses and very
limited.

<p>To build your external library with Byondapi, you have to include the
<tt>byondapi.h</tt> header file that's included in BYOND's distribution. When
compiling in Windows, you'll also need to link with <tt>byondapi.lib</tt>; in
Linux, your makefile should link with <tt>byondcore.so</tt> from BYOND's own
<tt>bin</tt> directory.

<h3>Simple BYOND types</h3>

<p>For simplicity, BYOND defines some basic types and macros in
<tt>byondapi.h</tt>. The one most relevant to you is <tt>u4c</tt>, which is an
unsigned 4-byte integer. There's also <tt>s4c</tt> which is a signed integer,
as well as simple 1-byte and 2-byte ints that use <tt>1c</tt> and <tt>2c</tt>
(respectively) insteaed of the <tt>4c</tt> suffix.

<h3>CByondValue struct</h3>

<p>The main structure used to pass data back and forth is
<tt>CByondValue</tt>. This mimics an internal structure in BYOND that holds
values of all sorts: numbers, null, references to strings, references to
objects and lists, and so on.

<p>The exact functions used for interfacing with this structure are documented
in <tt>byondapi.h</tt>.

<p>The main tricky aspect of working with BYOND data is strings. If you need
to get the contents of a string, you'll need to allocate memory for the
character data and call <tt>Byond_ToString()</tt> to get a copy of the string.
For converting character data to an internal string stored in CByondValue,
you'll need to call <tt>ByondValue_SetStr()</tt>.

<h3>Other function calls</h3>

<p>There are many function calls available in Byondapi for interacting with
the server. These include the ability to read and write vars, call procs,
create lists, read and write from lists, and so on.

<p>Most of these procs return boolean values: true if they succeed, false if
not. In the event of a failure, you can call <tt>Byond_LastError()</tt> to
get the error message.

<p>In any functions that read data from lists, or read string data, they
require the caller to allocate the needed memory for a copy of the string or
list items. In these cases, the functions also take a <tt>u4c</tt> pointer for
the length. If the return value is false and the length is set to zero, an
error occurred. If the return value is false and the length is non-zero, the
new length value is the required length of the array; the memory should be
allocated and the function called again.

<h3>Threads and reference counting</h3>

<p>BYOND servers handle proc execution and the management of data in a single
thread. If your library tries to call any BYOND server functions in a
different thread of its own, the call will block until the server thread can
handle it.

<p>The results you get from calls to Byondapi functions, such as reading a
var or getting a return value from a proc call, are reference counted.
Anything done on the main thread creates a <b>temporary reference</b>, which
will be removed at the end of the current server tick. You don't have to do
anything to clean this up, but you can call <tt>ByondValue_DecTempRef()</tt>
to get rid of it immediately if you wish.

<p>If your library spawns any threads, Byondapi will sync execution with the
main thread, and any references will be <b>persistent references</b>. These
references MUST be cleaned up with <tt>ByondValue_DecRef()</tt>, or else
you'll have a memory leak.

<p>If you have a temporary reference that you need to hold onto for longer,
you can call <tt>ByondValue_IncRef()</tt> to create a persistent reference,
and call <tt>ByondValue_DecRef()</tt> to clean it up later.

<p>The special function <tt>Byond_ThreadSync()</tt> will run a callback
function on the main thread, avoiding the need to keep syncing over multiple
Byondapi calls. Any references created during this call are persistent, since
the assumption is that you're calling this from another thread.

<h3>C++ wrappers</h3>

<p>If you want to use the handy C++ wrappers and classes, you can include
<tt>byondapi_cpp_wrappers.cpp</tt> and <tt>byondapi_cpp_wrappers.h</tt> in
your library.

<p>The <tt>ByondValue</tt> class is a wrapper around <tt>CByondValue</tt>
that handles a number of operations for you. You can redefine the <tt>argv</tt>
argument of any <tt>call_ext()</tt> functions as an array of
<tt>ByondValue</tt> instead of <tt>CByondValue</tt>, but the return value
should stay a <tt>CByondValue</tt>.

<h3 class=cpp>Example:</h3>
<pre class=cpp>
#include &lt;string&gt;
#include &lt;byondapi.h&gt;
#include &lt;byondapi_cpp_wrappers.h&gt;
#include &lt;string&gt;

extern "C" BYOND_EXPORT CByondValue merge(int n, ByondValue v[])
{
    ByondValue result;
    std::string merged, str;
    for(int i=0; i&lt;n; i++) {
        v[i].ToString(str);
        if(str) merged += str;
    }
    result = merged.c_str();   // ByondValue's assignment operator takes care of everything
    return result;
}
</pre>

<p>There is also a <tt>ByondValueList</tt> wrapper class for the list structure.

<p>The external function calls like <tt>ByondValue_CallProc()</tt> have C++
wrappers that use the C calls internally, but if an error happens they'll throw
a <tt>ByondExtException</tt> for you to catch. This replaces the more
cumbersome approach of checking if the return value is false and then calling
<tt>Byond_LastError()</tt>.

<hr>

<a name=/{{appendix}}/css toc="CSS attributes">
<h2>CSS attributes</h2>

<p>DM-CSS is a subset of CSS, and only supports some kinds of selectors and
attributes.

<p>The following table lists all supported attributes, and whether they are
supported in text output, maptext, and in other controls (labels/etc.) Other
controls will often allow only one style for an entire unit of text. A
checkbox in "Other" only indicates that <i>some</i> support exists in other
controls, but it may vary by the type of control.

<table class="withborder codefirst">
<colgroup><col /><col class=center /><col /></colgroup>
<tr><th>Attribute</th><th>Output</th><th>Maptext</th><th>Other</th><th>Notes</th></tr>
<tr><td>color</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>Alpha colors may not be supported in some controls.</td></tr>
<tr><td>background</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>In most cases, only applies to the entire text body.</td></tr>
<tr><td>background-color</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td><td></td></tr>
<tr><td>background-image</td><td>&#x2714;&#xfe0f;</td><td></td><td></td><td></td></tr>
<tr><td>font</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>font-family</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>font-style</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>font-weight</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>font-size</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>text-decoration</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>Limited to <tt>underline</tt>, <tt>overline</tt>, <tt>line-through</tt>, <tt>blink</tt>, and <tt>none</tt>. Support for each of these may vary depending on where they are used.</td></tr>
<tr><td>text-align</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td><tt>justify</tt> is supported in output and maptext.</td></tr>
<tr><td>vertical-align</td><td></td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>Limited to <tt>top</tt>, <tt>middle</tt>, and <tt>bottom</tt>.</td></tr>
<tr><td>text-indent</td><td>&#x2714;&#xfe0f;</td><td byondver=513>&#x2714;&#xfe0f;</td><td></td><td></td></tr>
<tr><td>margin-left</td><td>&#x2714;&#xfe0f;</td><td byondver=513>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>margin-right</td><td>&#x2714;&#xfe0f;</td><td byondver=513>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>margin-top</td><td></td><td></td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>margin-bottom</td><td></td><td></td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>margin</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>width</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td><td>Applies only to some elements such as images.</td></tr>
<tr><td>height</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td><td>Applies only to some elements such as images.</td></tr>
<tr><td byondver=512>line-height</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td><td>Support in output control is limited; line heights less than 1 are not respected.<br/>Only unitless numbers, percentages, or em units are allowed.</td></tr>
<tr><td>white-space</td><td>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td><td><tt>normal</tt>, <tt>nowrap</tt>, <tt>pre</tt>, <tt>pre-wrap</tt>, <tt>pre-line</tt></td></tr>
<tr><td byondver=512>text-shadow</td><td></td><td>&#x2714;&#xfe0f;</td><td></td><td></td></tr>
<tr><td byondver=512>-dm-text-outline</td><td></td><td>&#x2714;&#xfe0f;</td><td></td><td>Custom attribute: Adds an outline to text. Values are in the form: <tt><i>width color style</i></tt>.<br>The style is either blank, or any combination of the <tt>sharp</tt> and <tt>square</tt> keywords (see <a href=#/{notes}/filters/outline>Outline filter</a>).</td></tr>
</table>

<p>These pseudo-classes are allowed in some contexts, but they can only change
the text color.

<table class="withborder codefirst">
<colgroup><col /><col span=3 class=center /><col /></colgroup>
<tr><th>Psuedo-class</th><th>Output</th><th>Maptext</th><th>Other</th><th>Notes</th></tr>
<tr><td>:link</td><td>&#x2714;&#xfe0f;</td><td byondver=512>&#x2714;&#xfe0f;</td><td>&#x2714;&#xfe0f;</td><td></td></tr>
<tr><td>:visited</td><td>&#x2714;&#xfe0f;</td><td></td><td></td><td></td></tr>
<tr><td>:active</td><td></td><td></td><td></td><td>Currently not used, but future support is planned.</td></tr>
<tr><td>:hover</td><td></td><td byondver=512>&#x2714;&#xfe0f;</td><td></td><td></td></tr>
</table>

<hr>

<a name=/{{appendix}}/html-colors toc="HTML colors">
<h2>HTML colors</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/rgb>rgb proc</a>
</dl>

<p>Text colors may be specified by name or RGB value. The RGB color format
uses hexadecimal numbers, with 2 hex digits each for red, green, and blue.
These range from 0 (00 in hex) to 255 (FF in hex). In certain situations
BYOND will also honor a fourth pair of digits for alpha.

<pre>
#<span style="color:red">rr</span><span style="color:green">gg</span><span style="color:blue">bb</span>
#<span style="color:red">rr</span><span style="color:green">gg</span><span style="color:blue">bb</span><span style="opacity:0.67">aa</span>
</pre>

<p>It is also possible to use 4 bit values by using only one hex digit per
color.  The full 8 bit color is produced by repeating each digit. For example,
<code>#F00</code> (red) is the same as <code>#FF0000</code>.

<p>The named colors supported by BYOND, and their corresponding RGB values,
are listed in the following table:

<table class="withborder">
<colgroup><col /><col class=code /><col style="min-width:100px" /></colgroup>
<tr><td>black</td>   <td>#000000</td> <td style="background:#000000"></td></tr>
<tr><td>silver</td>  <td>#C0C0C0</td> <td style="background:#C0C0C0"></td></tr>
<tr><td>gray <i>or</i>
        grey</td>    <td>#808080</td> <td style="background:#808080"></td></tr>
<tr><td>white</td>   <td>#FFFFFF</td> <td style="background:#FFFFFF"></td></tr>
<tr><td>maroon</td>  <td>#800000</td> <td style="background:#800000"></td></tr>
<tr><td>red</td>     <td>#FF0000</td> <td style="background:#FF0000"></td></tr>
<tr><td>purple</td>  <td>#800080</td> <td style="background:#800080"></td></tr>
<tr><td>fuchsia <i>or</i>
        magenta</td> <td>#FF00FF</td> <td style="background:#FF00FF"></td></tr>
<tr><td>green</td>   <td>#00C000</td> <td style="background:#00C000"></td></tr>
<tr><td>lime</td>    <td>#00FF00</td> <td style="background:#00FF00"></td></tr>
<tr><td>olive <i>or</i>
        gold</td>    <td>#808000</td> <td style="background:#808000"></td></tr>
<tr><td>yellow</td>  <td>#FFFF00</td> <td style="background:#FFFF00"></td></tr>
<tr><td>navy</td>    <td>#000080</td> <td style="background:#000080"></td></tr>
<tr><td>blue</td>    <td>#0000FF</td> <td style="background:#0000FF"></td></tr>
<tr><td>teal</td>    <td>#008080</td> <td style="background:#008080"></td></tr>
<tr><td>aqua <i>or</i>
        cyan</td>    <td>#00FFFF</td> <td style="background:#00FFFF"></td></tr>
</table>

<hr>

<a name=/{{appendix}}/color-space toc="Color space">
<h2>Color space</h2>

<dl><dt><b>See also:</b>
<dd><a href=#/proc/rgb>rgb proc</a>
<dd><a href=#/proc/rgb2num>rgb2num proc</a>
<dd><a href=#/proc/gradient>gradient proc</a>
<dd><a href=#/proc/animate>animate proc</a>
<dd><a href=#/{notes}/color-gradient>Color gradient</a>
<dd><a href=#/{notes}/filters/color>Color matrix filter</a>
</dl>

<p>There are different ways of interpreting color besides RGB. Several parts of
BYOND are capable of using other color spaces.

<h3 class=code>COLORSPACE_RGB</h3>

<p>The default color space is RGB, where each color is split into red, green,
and blue components, as well as an optional alpha. All of these components range
from 0 to 255.

<p>The color yellow for instance is <tt>rgb(255,255,0)</tt> which is red and
green mixed together at their maximum brightness, but no blue component.

<h3 class=code>COLORSPACE_HSV</h3>

<div class="sidebar embed-image image-only">
  <img src="data:image/png;charset=utf-8;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAYAAAA8AXHiAAAgQklEQVR4Xu2dDbAW1XnHz+677718XLkXAlEJUFCJWoGEWAtJDNUq0WrSRJNiVWq0EjRCk4ramphpTJ2mSRW1qZgPNMZINNRomvhVqxhQ0qEEO1WjQEDUCKiBGECC3Pved7f/uf5nntfnuc+cC5MZnZ1d5jfPOWfv7uXd/d/nefbsOedNiqII1Vbx+yalraiohFVRCauiElZFxe+PrLWSJAlLFYoZ4AwwGDwEfgAKUG1EPwRWHivObLAcXAjOAbeDL4Jqq0LhfpOBhSCh15pOT3UxvVe1VcLaL6aAd4KN4GdgDcvDwdRKPpWw9pcxtC8G2bbSHkxbUQlrnzmAtjvI1pAwWW2VsPaPX9MOD7KNoN1CW1EJa5/Z0JJrdVJgR9FrPeMcU1G58yjPs99qJljGtnZwM3gVVFvlsfab2eAucDg4BHwT/M3v48SVx6ryrE+G0myVx6qohFVRUQmrohJWRSWs8nMlKe9WCauiElZFJayKikpYFVXPexFWwjRJTktCrymLbbCs6eH+HtYbYonXxnZtR4Ep4CjUD8G5x6N8EOxIMALUQ8g7+vx7LVwCGiELr8Juh30Z9nnYTaEenoZ9EmxDOfSR0WqyAbTVQBtta1umqCmb0tZISsu2ZHo5hAVqtAno1bJrLZOUttbSlrOet7RntE0ek4BUkRgLDgMngQ+iAsI4wC3l+RICQ8umDjYOR/lQEEjrKX6FOkacgjQ8iPJG/nqfmion0kYrbQJF5NWdnw/lEhbJKIQg4pGyEpoWVBCPxzZeSSW4Zn/iOgJ2NuwZ4DCqwWCFnti/gcSpUzx9Qk1AGs5k20aIYCnKS1BeB1pE45Qz62msF7KCtG3alinHsp+Y1BxSY3mltZ+P3KFkBOrzwSqwFvUr3hBVsF5M1CGIglxxAXtYasqHgStQXgu7CsxHeQQ9kxaBkEX3wXpezIRH7i+Jx7L6TXRZUbhleimSSl28GG16OM69APYcMMgPjcEVk/VaNOZjGTGxLigBTSNXg+9h37Ww6ykKP4xlghWMxQ+1JfJY9mplOpGIXSHnKpsr926wBOVnsH/uG6KSu8qyIGITXPF7niqGm1MNgp0L+wz4Psrvln02FHrh01pFpnOvUgkrca5IJtYJb84+fY6RYBF4GpyNfamKH76YiGxWYD5+BLW/1o3YKTgLPA0WgZHAj+6ZLltLrEdLSiesLCKYNCI2tz3BceejvgFchHoGjKB0G4kLzBcT0VfRRlwS9zJZyGAvAhvAHLQntjtBl3VbhKx0oTCNXRXbHmc8jnkE3IRyV//h0oqMVvDzrn30WCrSiqYdz+Um3F2oL4Z9BHa8mx3EHTzPWf4cy/Eg0T9FscJstD0BjuvnSTHmKtzcygqsGGDoc9rTAYjJj/DHgSfAbOA78nqsK0JfzrdOWBM5POS74HowI9jtdHAT+BY4Ue0bCi4Dt4KvggkmxxLcsEe0aNrBYrTdhrZh/STysbgQCYXRkBgXWmqRMCQ43koLZxj23Qa7GLTHuxbsJbAh2P0Ufw6+wfv2aaWRc8At4AYwfX+F9RnwD+AT4HNgBTgzyHYVuIu/bC6nR81qmRr1KPgXHvP3YHUSJhzkeKOIwFJQD6zjHNljsHPQ5h4L7JW0sUnwXc++iSlR1ATdRvxuAyuyOeAxcHDsdQ6Iey+rgR+AH4MLed/PD7ItptjOBvPAY2DGPguLv2QEp5dfw7azaN8FLge76dlms/3ztOeC94FloAPcCUaCuf36/YF32EwC/4PyMao98jxuMl8To2wSFFxL4/9IKrAt6kF8UUidf0fHgFVonyT7JRRaXHHpbS6YRcGM5n07g/umgr8GW8FB4O9ARrvPwloNdrC8Wy2KMYMnXg5eoOdqgPdSjCfwuDtAD1jK+p9Ge9v98DUd+x4F4/TP2Le3vuiIERkwapDNvuax+lM6DfE+Jisghf80OA72UdjpVkBeSIyGwgtbbIMO5YXA+0Z7L3iVToft+yosOdETDIk/AV9yVl/ZC37D8sH0aNyvVmbx44C98iKUGbAPoW0420226ovJv+IWEZhVTyHlwguBfsSF9ckEu89lOHgIl2GGPc7J6TJiQ+EQMBl0Mx/eRqfyT+p+b6Z9iVdhMBi+P8IaD97J/RPBEWwfRtsTZOulrYNOlrv1yixRf22v8DSc8j60dYBAtKfSQtXC06HSy7+0+1GYl8/+U2DNtXHtE/vRzMfqAPeiPC0iToqNWGENZ2s72AMuZpT6AjgaDFP3swlylrP9EdYkeqBzwZHg+2r1lS65rFCuqPoVtTrLO2i3+IEf1l7FybAPou6IKhOk7uwzV1lZIzAS2bz8KnE/HqwRif0bqXvezIjuANgHYSe7OVx82Mx2kJNzwfVMbwKFpe9nF8/SzWMHLizl4tbQjqACNrD+AapgKrsXtjAkcn/4EO2xtE+a8OO/lxgNez9spxKTf9XtHfAFJXUlJLZFuxpsCBT8m+lHZ3cgn/3YdXNsJ+z9YIz/9ssXFgWyka2jlTN4GWxQ9/GDtE+BYl+F9TgfPb8DHmTb3VT1I+BZMJH7/h0EKr3gMTmYx8R9AdV948CS9XobLH5XNkbaoh5L4+VikcFLCTH5luOlIiKzIoo72rrg/7wR0BjwQ9DmXF43FJLraR/kU/xHeY8fBj8C2ymse8C3eMx1+5O8r2An2NlMzv8ZfKYltzoV/JTqHcLO1IUtT5Rn8ani42AT+FgR9jxjQw+wIlsEpgH/qtt9GraL9UWX+q997OYPm0kdMsEXmKn7//3MZRrOf6N7iVknevsm7+FQMBPcBz4M9jCRPwWsZlsP+Cy4fX/GY51H67E+8ri5lJhRo8x6Sa7Dzmz8zBzJEbnxOP8dXmHg+CxFrwiPZT+ZF7jZp0Lb1QC8Tk/fUwmeF3MEasc/ng+Wo32JfuCVMrGf6ssExvBzMO3tOmwmMno0G4+2Rf1muWIdTOzwQmOkazohLGuR+T3ufoSN/7dt2dZ9z2fztkWw4/3Xo6Uc3ZDg36DrkjB4fhKGZiKuLIH9jnr3F3seJ20xIam2WNe0DYXSQUqTOk+Cok+dlFutt0WidUxc/giHYbC3gIQiCslgXOBBYX7SFq4rp7AA4/mfgV8kYcgpvBrnwx7vDFLyMtkIbUp4hO061yKRUQ+RvqvMWt8jiTW0EdcZRwb8peE4MAd1iKovZflfcBq4Be0hT0okrBwUIQX5enAqqvPBNaPDhOVNWPfxyb9DniuI3y0h7rVg7RYZFpMpHL0T7ot3z/mh0JKHcPXYQ8N/8CnuqqIIJ+RFeDKn0y2NsNhdC5JQ9FE8jOp7loY7anhK7vRHkYolnmhIRmuIhMpabKyWJfFe3ajTa723s12LjPuk7oqL+H29aT10fveWvn6pyRDUnTLdBLY8M6HpsdTtgrgmwEyn5OSqoGyfHPPIZIeCSJ3nFWSWNWlQVD3Ouw9nM09bNp/yQ54rKlrPaXvj1/3BsSecGKY2izAOQvolYIpYMmE1QaLEhfKXUM4SaREBGZogeHVVLgS5nKQJ2iisOsWl3UKP47nEALcrzjpS0i4WKC/m5VSR5wwr8tZPn+Vv9E+dlYuoyuexkpYypHQ4+MuC7Sn2JiIMWk1qBCXYjcKyopJ+LdKjXILgnjsVbMIeCYOsi8ikbvMposKeN02S4mm1Z8D+I+w61kGJhNVQ1wLSuQSkSkoUmCMoCig+e9nK2nqtXoqsQUtxEd1Z6udWRESlRKPLqi5CE2reu3Nih5GJkKxNwQKU55ZMWPbWQhIjwWyWKbQ3WcqrJrJz863UWWgkifbGS57VY2KQHwpVs+rLJSYECmqf7Y7zR2jbaZLyyRxhsTwb9guw2xkGy+mxIItzYAd7czoJ6yms7kDK/VF2FgmLxms1SDvF1a3vpucFrah8L2UZRHTinilS/2G1AEZIfnkw7KfAQraVK3kvRBKfFpHBEu1jUrEgNd6K4XHgC3qwLA/d8nRIJUTFZecGmnwKaCE5XktyKzmPP4SfgoqIyN83B3Zh6UJhr9yPo2GPgBUPZt6KUD4si/gSUHNyr9TxeWbop+p+IPRYKtlRAvUmSKjwNigKxeW8cTIrzMQF1Yx7riPA0Sg/DsrTQdqQWzgLiK8QdBuzIGtzZ0imSloicWgwMXebxxuv5U7qFg9kBcRf4f8alq24RNt5YnvhGrT7Ugaz2FYaYbUK5nRJmSkoKyorulaxkcLGIj9zppgsQ5w7L+KiqFQotLmVaJV2qLTJPqVx74U0KBIrEisWQa6rPY6cTlsujwUOBYc54qHQnAvmXrSEAlOeizjeSjGEUBU81nY70IieVfhTp5O67xzbrbgKnLup/5B8zx4XHeG1P7SnbB4LnGyFFKfHvWitNwAC06FRBOUIaSitYB/ZakSEJaFKRCXa1KfXkdfpv6pRUMlArgcwbRZ7nXkPypS88yXJsbIaqZ9upxHkVjOxF8ulplDy6LfromhJ4PeSPXLnjceS931Gqx1kKBmixWS7ywognSBCLrCuyzaBD7rd7jsW9UWl6seCED6oOgm0mPxBmbqdVgQl9aYIzJzFn43Tq8QlYVGOU2GQzpDeiaKSMsUmpzHPBf4C5az7glLtRaRPK0j92FINm+kOYRRu2VjPbXcLuk38iGrrdugR+AQp+ZbNrjs4o3wYQTl0KEVkcpkSVtvlFDgEyOE8hZxGh0GcMq+9OVR1a6vK7mc357A0uI92DNpGlSl5n6JFpesiItbtRZU2A9sdoTUZu1oU4QirU8rYL49uKaCp8xQd6jBCYTEUUlQiKBGL4nW2w8rnUaKyImPdCtNea8lR31smYR3VHfVSxAiIdV9IvDG0xHq5JBSh3uqxyAFUxHDQRUuBQRkSDmna2CyHyaHDSMebRZVDjI1EC8YXF8v+zzt/hKpMTNuRZUreD7Fr7NNG1tZwE/vIRH0ZJKAnfaVobwtJv8MHAmhSirvBq2Bwq7DorSikES10UWxDpBuhyEx3gGBeiducirY1f2KdODlWYDmoNh5zSJmENcF9mwfSiOCcyfBEC4ttKle2E2BqYLBaQRbwdsl8zVd4BA8eSg81Eozi0invoKcSUUmoV6+8tbBylpWQWCexpJxYgVmRhTIJC254tPJWIhxbjq8S5DwluqtCkLZ+RwbX+wiEZ6YkdoGXqBZG0S5wIBhNRrGN+X5DhSLT76a8VC6WOIKyQmLZEmi192L94DJ5rJEiKOu5Ck9YntC8BYnduQ3xgQiDUGrjHnoosIceayOgtzoIjCOj6b0gqp6U+ZAIy3bwWlEBG/KskGgdQkRYqm1UmTxWl7MQI4XliwrY0GnFJz1Vbpj0h1BJl1QK7XRgXzv3BobDdYDhbyI4EkwAEFUDJ/pdy0NDN7GCovWE5Ic3trMeL4uXUvCYzjJ1kNaUeLjZeqLrjrjcsOlOUvbXj203XVP10IV4V0cNG9gAHnlj+bn3g6MgHCTwO1F8DVBYVlAkd3ImzyuFmDeyYqHnt/uCHX+blcljHcAP7i2OJ3UKQAtR6oITXmWf49kSR2itnREHgJHwXmPCNPquG/vWie6ZFsJmLga2k4LqIcojgXiiHVxLtGAcUZnj/GM6ypNj+R+WWAEVTpvzVYEWfQ4jQv8c9v8wDeUiJNMS+38hqt0KwV9t0j2n/3N2s+3+7y6Tx3qtoNeKiatwLmJBlDCAP5vQQq9hPIuEr26m7LvolTYDeKkQVoEwPdRRGMt0i91W9t0yqJFAmygi4Z1bNH3w23yx7i6Tx2r6bloE4O+Ll/28RWgqGoS5UXid+dJrDHPIo5BPgb8K3GbjmCJsCk+HF3F/OuXlj7y5IWZaoCIRq1Azlhxx8WdsThoXW2+ZhLUDIugy3sXzTFY0LFtyW5Zk2fdMsPZF7x4Kq1FnN8IEJut8CYICG3B8eC5sD7+FABsUFnBHyID4d5BJ2WL7+4h5gtbWtu0sUyjcDhGMj3gdWoUWl37NERFTL8veiNVu8jpopIxtI9iNeASYyLgn/Q1gB6WwBef4LWp78C+XSTl2pIw/X4IoYVkbFxw3v43t28okrK0sWu+jQpdtB5H3Y01fVPRSYnvtC1q0UxFDQSd70/+AnaAHst30kO4BBSWzA+faA/aGbmetDyCdtLHvBY+Li3VfXKmfy71UplD4HIvRd1xBys5MX4u8cxPbJGZCgqKo08UMBcNavNVoaqiL+wPVFzqptl0yhFEkA3F1o7UBG1mgz+ny8L9KypZDRGyOyJ4rk7A2uTlTXEgsi+2l9b2UNyFBbFGTrncOg4GIwDvJKOZZHaAulwsN8hYaXkpy4Rp5PRRhL4TVgz1NWK4S0SKwlNb/EgniCKwWGxVCQv9tz5ap5/2ZwvdW/nRx0nQTc2Lrdm4iyVPqQ0Qlg/beAUaQTrbLqBkWBlOFw5nq96iVncUP5aEHQF4o6VdKFJr9Cs/IQuHRhF8LznYYry3T0OQngHkSAzJYjVbKTKpp1QA4Qe0jZn8PBJUz7PU7MrlLj/Pjz7RpYbUpNfIgWDOElM+JeahDYgloHdRnR43S2gGM7oja+LDubjuS9MkyjSDdBjbrMdhSR1kLTaEvrtRFTFas9FwyI4yzapSwOgWOXcd+GVslVymVOV+iSmJOYOYrNkMWGhSYfF5jiW3zr5P9o2z0374ZXvuV0giLAlrZLWXrnXSb4I9pVyLV589rdi4FhQXsPArrbECmhcWTarfHk/EEZtC7UIfAUhGBY6OTRlxBsa3/LpaVpZqwSq+00kyoMJ7LislOvvBF2SBNZsd6CrxM17JTtsTJkHbJsM36RXZihqgS8GREpunoxbHykOrefyEiIuBfB6nra/OznrKtj5WH8J9uT7nFDs9162KLRH+VNK2ZAaYcS4eavdyu5qsaj2VnrIoEevXgYOcZr7fPFvgUTZCjxM8icyZJ7sy1bHo9+H5i/0BawtVmnm0AEBzP5ZZZ9xcLSdh9oNZT95ZtoICIaCO+LkhhF28QN0grZbsiiL9GZIFzNkMiXSP+Z7fXjUSWKHiWlMtj0UvdnYdwmTMdPOK1VLcDsWuBkrr1VrJQR2RNkDphfmW7Gv0xqHaqhP+NmeK5EpL3ebBeWP6U9VoEdeOpmsZbCTB3cV9phNUaHJbCXuZ2fqpZKr7o7Ne30RIjKqCdiLd+Fcmcbmwq2RdXQwkLyEAgRWoXkqPN+U/LMCeJ03FqwqDU72S9dKEQNjwOuw4EwYY3O1ZcyJPIIv0UEq0w2AmLZk1Qp2fSLJkMKC6e2K5wYy0xyym7L33ykNg5iA4NostgPVhTxoXXWrnJfHDTS27LuSwh5Ia8+NJYtIT7nJX1SOJ9iY5N6vwl/dp9QRErrJoWmC8q/erKlhdLWzlDIQi3onwV7OAm2/yw6HyNYI2Y8KeFZkOc1AW7Goz7dTpmegYPUk8MPbQSEtVwRmduUkOFyKbUUS5CTtCqrl1KWG5tfx32VtlXFo9lvc92lJdQbPqvTkicGaittGkhWVH5S2GTurcOqJeQ2K9TtTGY2DVQzX/EUldkxlUXIZWX7p4VloDtoHweq2n7r64F56Oc2pfQ8cUaJFR53koEZD2Tn97IOU0G7E060/kWadd/Jt7qC8540Ib97iA7rwmlAuQys8lOAM4hwOvUvhKFQtspuo5PiGdKW2QVEPX63ybwTp5l6lZQQvS7A1xB2YSvoYRmQ6I/aspcDAlkFBnbKLUiNEFq5bcUrBUJl+5LmqxXAleCv0A9s7NM457Kdi2oMq3NlQU5zlu0n9jswf8GTIoKVgX4NjXwJ0SmmGqaRPbrToic56MEe7H3y0DyrVJ1N7gTG5Ln8mTlKgpHUHURT/wbtmwy7llzTtp44k5r3aeNy0bd/pcU2n1C5lBzvxulgHzyZeH/oKwXKGOhTMLKTYdnciLME6GY1Qy15i4b8sw1BN63vXuJvCsyS03hDce0K3y1kDkCyxwhRRTPstjod81JPU93FeeGLag81Uz6okIQyvnVvYdDVPeheAO4NNS3HhfS2qX+l2cLVlBKSMZRaGt+Lj43y9/8JNDmW7Tmu3s9XFGRyF9fEvqu6YvZx1G5AHwxT8IyCGxKKT1WkfQVLwQPgEmhrbifN/ImsNx6K3uvrLj8LgfBejYRruOphIiooosnDfDbxn18MRHr6pejfhMIoag/goajwY/AeaX7hlXxAMXFUpaUAJwHnoCIhul8WMoa7zv/NJ4wdV7lhUATCjWRPpDeFttkGdYmCMQRMjCvnHkL5VzJLpTPg5UTFfjFobiBKTx/Q1EKj2X/uBNzD54H86x3dyKCJ6C2iKic3DcuKkELSkicWF63CWI8lrvxmnjt81F/vv8LnYp9i0Lh+8CPwctgF1gW/CWc7+F0og8H2SaDFWAv2Ao+r9bw92ZrLgE3Ww9l634a4iTmRlQOKfFFZbsERJHEPC1adceVb9tsu3bpN8Pexroi1R9uBPhXutHPBW5s/yp4ErwCfgZOVfr4NHgabAcPgSMHKqxzwXTwc/A8+FPwExs2w2ngI+CQlrnCneC/wIfAvZTAV0JP8gmVhhCT68yDCFY7T+/KAXhi8u6B9zujK3ZE+plSYn6BY+vuByM23scT+DUozwNBYQWf9H4WhS0AFo3cyAywAOzlvf8AuLtFPGeCb4OR4BfgRN7n2kCEdSeYAD4K/hjsBmPBoYEbBfRv9iEjnA0Oosf7JLic7RcoUXmdnt2wn4DdrMUgYjI2Tl0LVQnJ5liRXEfXU/81T/zpznO7zvFGsJthTwPdNuxZuH7OL+k49LYRTOF9nwaWUdl/wv2Xtzif4ymuQ8DJAxHWY2APy8PBINBUc/4X0UstVcdOoV1O+9+0R9k/HuXJhc3gFLATxEVUj0Qaf1aoYD2UrdtOUkXqUBP8mO2JKSaunbCngM1eTy9Q5XAJeA94SouBQlmnHEhoWZN8Et32T2lXSvoTFRYRz5OBb4BdbJ9Lz/S3wc5Rexftq8oeGHYmifVUFrY/BXsy2G2jhy37eW4kHKYKV0wxcaWC++EyHxv7/fAp59qN8smwTwF9AX2BFcOiC6/xoIXgj8B6cD/1kDKC7eUBv6E9eEDCYmx9HBwDbgYXs/04hsAl4NZgt0Kdt077uzCyKLSnsNdO2sAqcCrFZb2UTWGEmrWCt6yLIrgey8VfcZ5ELoArMvvBd8OeivoqLVz/w0o5so1gX+MCJukngW79vXykRrsnKiy6yQdBF9eym9MyjOdTjLkfozf6DNu/By5sCZejacfQvui9E6T1rs+jKM8EOyJ/6G7K4t9f7akM/kqfwBcWsQKLeCYjMM/z7cBxM1F+VJ1XC8gXmL8NAg+DmeBmOpYXuO9lUAROolT3efNAOkivBh187FzLntvA8gq1Vu37wWTmUhu4by6YxcfZs3nsspDZyXFo8yOIeKVVsDNg7wXjuD8qMFuPrLYhGB3FRx/EBWa9VLOlnJMMFGJJy/YrnP8jb86PEvm7bx27xbJs+UBi/EVgKrsRviIhjotEIwcDk3l/f9jSzbQiJqyUYZBPAEC2qeC7JJBrKaxvgmVU/AL2e+0EGb3Y1xh2dKSwNnNzrungx+AYKyonx3K9pJdvO+Ew+mSYOlhFU1SeuETAlp+Dj6OwlT9HGo4XKpxvlA0+8vQ3Uy13dClzrispqMXgetDBlOgXMWEl4CpHzVuD3e5lAv8063vBsVT+4eBX4BthTLE1HiV8cTFivAQ7A/YG7D/f9Uqpdx6SuoLyt8QUHPV5K1XVNBSRiEpswXaWAcPSfJSZNA+I2NK3D4BtYI1qWxvstpr2bnASI9EQ8FOKLMSE1QRfk2qUR0jrtoNuNBARTeL2Y7EcTcb3ws6BXQ67CHaYk5/RxsXkf8WFioBR1aVOp2mTmFBIS4GxrgZp70J5Psq3SVsSm5jhrSqvw+EPSRAQeeLbQ+Rt8a7QzyttfmWxuewSlKeCFX7uSry2RDAdo344jK8CynbB/08RL36vQHkq7G3uwD6bN/gXUz5kaYbN+MlzJkSTbrtvE+zxsHNxzh02L1MoAam2yEr9LvH1joWBdj/sgJ0LezzsJiUWbXXZis8eWx5h2T8yx5sYgYnV15f1AnYx6hPBjSj36nNaR2HmKlrs5sTFqCfzVxO1C3P3wt4IOxEsBoUSTERUce9FsZfNY8Xe07pP5n6bHL8ddh7aJqF8O2xuk/n9WDSddeK5tIG+5vFygBz1O8AklOehbTvswFy3HwrcdlAujyVERQYiQkzd7oT14Gzwh+DbYK/rpVK/70qsgz0wkrgBG4v3wn4bHIXyWWC96dyLd4DGUOdLyhQKtZfRAtHYF9W+CN2+yPWwF8COg70UrHNfOKcRocW9leO13OHL68ClKI+DvYB17osk32yPvov0/3pLlrxnINEeOhYCiT+8yGInr2wDC6GHI2GPgb0GdqP/1LfP+VW0z4Jq3oi2a8Ax4EjUF8JuE8EkzhNfKliRedO/Yo/JZUzeB/q+MN557b/zc8ewr4G9DEwk88EdaN8senC6guLhUPdjbEH5Dtj5YCLKILkMdo3/slra46Ewi4jI1klZQ2Hc49hUwhGUfy4/1Ilj2QgWgbPQPhb2QL7GuBh8HdyDttVgUyjCb1H/XYuYUE7QFjaxR/oe1L/OY2eifCAYA5A3pYvorbTqvcfiyPTvqGh8AUp7iWbprErC23z7NXiYeNuVylbEPFZFRSWsikpYFZWwKireiuS9okraK49VUQmrohJWRUUlrIpKWG897uor5ETwKOfVrQZnDGT1lUpY1eauvsKZRvdyEu9dYCy4A5wQW32lEla1uauvcDmmdi4rMA9cARJwfGz1lUpY1eauvsLQ1wtm0HudBHKwLLb6StVBWm27g789CS7ghNF1bFtAIY2lx3/NWX2lElaFyzQm9c8xtzqNE3rXktjqK5YqFFYwh+oAc5hfncEQ+PmBr75SCavC0lQLyo2j7QXdTNYTMAt0qtVXqlBY4XI912L9DriMCXwOrgUhuvpK5bEqwAPga2r1lZVgCrgOPANuAFPBfWr1le/x+IsAwma1JUVRhGqrqDxWRSWsikpYFRWVsCre/vw/jy4G2fRxv14AAAAASUVORK5CYII=">
  Hue values on the color wheel
</div>

<p>HSV stands for hue, saturation, and value.

<ul>
<li>Hue ranges from 0 to 360 on a color wheel, where 0 is red, 60 is yellow,
120 is green, and so on as seen in the image.</li>
<li>Saturation is how colorful this color is; it ranges from 0 which means a
shade of gray, to 100 which is fully colored.</li>
<li>Value is the brightness of the biggest red, green, or blue component, and
ranges from 0 to 100. A value of 0 is always black.</li>
</ul>

<p>All pure hues such as red (hue=0) have a saturation of 100 and a value of
100. As saturation decreases, the colors turns whiter. Lower values mean
darker colors and darker shades of gray.

<p>In HSV, saturation is less meaningful as value gets closer to 0. Black
of course always has a value of 0. With 10 as the value, saturation=100 gives
you a very dark color whereas saturation=0 is a 10% shade of gray.

<h3 class=code>COLORSPACE_HSL</h3>

<p>HSL is a little more intuitive than HSV. Here, the value is replaced by
luminance, which again ranges from 0 to 100. Luminance is the average of the
minimum and maximum values of the red, green, and blue components.

<p>Black has a luminance of 0; white has a luminance of 100. Pure hues all
have a saturation of 100 and luminance of 50. As saturation decreases, the
color will approach a grayscale shade of L%.

<p>Saturation is less meaningful the closer luminance is to 0 or 100. At a
luminance of 100, the saturation is totally irrelevant. At 90, high saturation
will get you a very light shade of the hue but that isn't very far off from a
90% shade of gray.

<h3 class=code>COLORSPACE_HCY</h3>

<p>HCY stands for <b>hue</b>, <b>chroma</b>, and the Y is for grayscale
luminance. (Again chroma and Y range from 0 to 100.) This color space is
based around the apparent brightness of each color according to a rough
approximation of human vision.

<p>Chroma is similar to saturation in that it determines how far from
grayscale the color is. As chroma decreases toward 0, the color approaches
a grayscale shade of Y%. What's different about HCY color from HSV or HSL
is that at chroma=0 and chroma=100 the colors should appear equally
bright. Pure red, therefore, has a hue of 0, a chroma of 100, and a Y
luminance of only 29.9&mdash;roughly what red would look like in black &amp;
white with all the color leached out.

<hr>

<a name=/{{appendix}}/stddef%2edm toc="stddef.dm file">
<h2>stddef.dm file</h2>

<p>This is a special file that's included in all projects when you compile.
It contains various constants, definitions of some built-in datums, and so on.

<p>You can see the contents of this file by creating a new file in Dream
Maker called <tt>stddef.dm</tt>. It will automatically be filled with the
standard definitions.

<p>The contents of <tt>stddef.dm</tt> may change with new BYOND versions.
However an eye is always kept on backwards-compatibility.

<hr>

</div></body>
</html>
